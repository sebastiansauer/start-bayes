{
  "hash": "9d18fb6d302137f55f9a20807f96bfef",
  "result": {
    "markdown": "\n# Die Post befragen\n\n\n\n\n\n\n\n\n## Mit Stichproben die Post-Verteilung zusammenfassen\n\n\n### Zur Erinnerung: Gitterwerte in R berechnen\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nn <- 10\nn_success <- 6\nn_trials  <- 9\n\nd <-\n  tibble(p_grid = seq(from = 0, to = 1, length.out = n),\n         prior  = 1) %>% \n  mutate(likelihood = dbinom(n_success, \n                             size = n_trials, \n                             prob = p_grid)) %>% \n  mutate(unstand_post = (likelihood * prior),\n         post = unstand_post / sum(unstand_post))\n```\n:::\n\n\n\nVoil√†:\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n| p_grid| prior| likelihood| unstand_post| post|\n|------:|-----:|----------:|------------:|----:|\n|   0.00|     1|       0.00|         0.00| 0.00|\n|   0.11|     1|       0.00|         0.00| 0.00|\n|   0.22|     1|       0.00|         0.00| 0.01|\n|   0.33|     1|       0.03|         0.03| 0.04|\n|   0.44|     1|       0.11|         0.11| 0.12|\n|   0.56|     1|       0.22|         0.22| 0.24|\n|   0.67|     1|       0.27|         0.27| 0.30|\n|   0.78|     1|       0.20|         0.20| 0.23|\n|   0.89|     1|       0.06|         0.06| 0.06|\n|   1.00|     1|       0.00|         0.00| 0.00|\n:::\n:::\n\n\n\n### Zur Erinnerung, die Gittermethode\n\nDie Gittermethode ist ein Weg, die Posteriori-Verteilung zu berechnen. Die Posteriori-Verteilung birgt viele n√ºtzliche Informationen.\n\nModell: $W=6$ Wasser, $N=9$ W√ºrfen und $k=10$ Gitterwerten.\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Post_files/figure-html/plot-post-d-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n```{=html}\n<div id=\"ymsegbumen\" style=\"overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>html {\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;\n}\n\n#ymsegbumen .gt_table {\n  display: table;\n  border-collapse: collapse;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#ymsegbumen .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ymsegbumen .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#ymsegbumen .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 0;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#ymsegbumen .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ymsegbumen .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ymsegbumen .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#ymsegbumen .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#ymsegbumen .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#ymsegbumen .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#ymsegbumen .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#ymsegbumen .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#ymsegbumen .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#ymsegbumen .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#ymsegbumen .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#ymsegbumen .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#ymsegbumen .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ymsegbumen .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#ymsegbumen .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#ymsegbumen .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ymsegbumen .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#ymsegbumen .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#ymsegbumen .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ymsegbumen .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ymsegbumen .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#ymsegbumen .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#ymsegbumen .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ymsegbumen .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ymsegbumen .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-left: 4px;\n  padding-right: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ymsegbumen .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ymsegbumen .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ymsegbumen .gt_left {\n  text-align: left;\n}\n\n#ymsegbumen .gt_center {\n  text-align: center;\n}\n\n#ymsegbumen .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#ymsegbumen .gt_font_normal {\n  font-weight: normal;\n}\n\n#ymsegbumen .gt_font_bold {\n  font-weight: bold;\n}\n\n#ymsegbumen .gt_font_italic {\n  font-style: italic;\n}\n\n#ymsegbumen .gt_super {\n  font-size: 65%;\n}\n\n#ymsegbumen .gt_footnote_marks {\n  font-style: italic;\n  font-weight: normal;\n  font-size: 75%;\n  vertical-align: 0.4em;\n}\n\n#ymsegbumen .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#ymsegbumen .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#ymsegbumen .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#ymsegbumen .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#ymsegbumen .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#ymsegbumen .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\">\n  <thead class=\"gt_header\">\n    <tr>\n      <td colspan=\"5\" class=\"gt_heading gt_title gt_font_normal gt_bottom_border\" style>Tabelle <em>d</em> mit Daten zur Posteriori-Verteilung</td>\n    </tr>\n    \n  </thead>\n  <thead class=\"gt_col_headings\">\n    <tr>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\">p_grid</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\">prior</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\">likelihood</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\">unstand_post</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\">post</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td class=\"gt_row gt_right\">0</td>\n<td class=\"gt_row gt_right\">1</td>\n<td class=\"gt_row gt_right\">0</td>\n<td class=\"gt_row gt_right\">0</td>\n<td class=\"gt_row gt_right\">0</td></tr>\n    <tr><td class=\"gt_row gt_right\">1 √ó 10<sup style='font-size: 65%;'>‚àí1</sup></td>\n<td class=\"gt_row gt_right\">1</td>\n<td class=\"gt_row gt_right\">1 √ó 10<sup style='font-size: 65%;'>‚àí4</sup></td>\n<td class=\"gt_row gt_right\">1 √ó 10<sup style='font-size: 65%;'>‚àí4</sup></td>\n<td class=\"gt_row gt_right\">1 √ó 10<sup style='font-size: 65%;'>‚àí4</sup></td></tr>\n    <tr><td class=\"gt_row gt_right\">2 √ó 10<sup style='font-size: 65%;'>‚àí1</sup></td>\n<td class=\"gt_row gt_right\">1</td>\n<td class=\"gt_row gt_right\">5 √ó 10<sup style='font-size: 65%;'>‚àí3</sup></td>\n<td class=\"gt_row gt_right\">5 √ó 10<sup style='font-size: 65%;'>‚àí3</sup></td>\n<td class=\"gt_row gt_right\">5 √ó 10<sup style='font-size: 65%;'>‚àí3</sup></td></tr>\n    <tr><td class=\"gt_row gt_right\">3 √ó 10<sup style='font-size: 65%;'>‚àí1</sup></td>\n<td class=\"gt_row gt_right\">1</td>\n<td class=\"gt_row gt_right\">3 √ó 10<sup style='font-size: 65%;'>‚àí2</sup></td>\n<td class=\"gt_row gt_right\">3 √ó 10<sup style='font-size: 65%;'>‚àí2</sup></td>\n<td class=\"gt_row gt_right\">4 √ó 10<sup style='font-size: 65%;'>‚àí2</sup></td></tr>\n    <tr><td class=\"gt_row gt_right\">4 √ó 10<sup style='font-size: 65%;'>‚àí1</sup></td>\n<td class=\"gt_row gt_right\">1</td>\n<td class=\"gt_row gt_right\">1 √ó 10<sup style='font-size: 65%;'>‚àí1</sup></td>\n<td class=\"gt_row gt_right\">1 √ó 10<sup style='font-size: 65%;'>‚àí1</sup></td>\n<td class=\"gt_row gt_right\">1 √ó 10<sup style='font-size: 65%;'>‚àí1</sup></td></tr>\n    <tr><td class=\"gt_row gt_right\">6 √ó 10<sup style='font-size: 65%;'>‚àí1</sup></td>\n<td class=\"gt_row gt_right\">1</td>\n<td class=\"gt_row gt_right\">2 √ó 10<sup style='font-size: 65%;'>‚àí1</sup></td>\n<td class=\"gt_row gt_right\">2 √ó 10<sup style='font-size: 65%;'>‚àí1</sup></td>\n<td class=\"gt_row gt_right\">2 √ó 10<sup style='font-size: 65%;'>‚àí1</sup></td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\n\n### Beispiele f√ºr Fragen an die Post-Verteilung\n\n- Mit welcher Wahrscheinlichkeit liegt der Parameter unter einem bestimmten Wert?\n- Mit welcher Wahrscheinlichkeit liegt der Parameter zwischen zwei bestimmten Werten?\n- Mit 5% Wahrscheinlichkeit liegt der Parameterwert nicht unter welchem Wert?\n- Welcher Parameterwert hat die h√∂chste Wahrscheinlichkeit?\n- Wie ungewiss ist das Modell √ºber die Parameterwerte?\n\n\nSolche Fragen kann man in zwei Gruppen aufteilen:\n\n1. Fragen zu Parametern\n3. Fragen zu Wahrscheinlichkeiten\n\n\n\n### Wir arbeiten jetzt mit H√§ufigkeit, nicht mit Wahrscheinlichkeit\n\nKomplexere Bayes-Modelle k√∂nnen nicht mehr \"einfach mal eben\" ausgerechnet werden; die Integrale, auf die man dabei st√∂√üt, treiben einem gestandenen Mathematiker die Schwei√üperlen auf die Stirn.\n\nGl√ºcklicherwei√üe gibt es einen Trick, der die Sache nicht nur rechnerisch, sondern auch konzeptionell viel einfacher macht.\n\nDieser Trick lautet: Wir arbeiten nicht mehr mit Wahrscheinlichkeiten, sondern mit H√§ufigkeiten.\n\n\nPraktischerweise werden wir in K√ºrze einen R-Golem kennenlernen,\nder uns das meiste an Arbeit abnimmt. \nDieser Golem liefert uns Stichproben aus der Post-Verteilung zur√ºck.\n\nLernen wir jetz also, wie man mit solchen Stichproben umgeht.\n\n\n:::callout-important\nDie Post-Verteilung in Stichprobenform ist viel einfach zu handbaben als das direkte Arbeiten mit Wahrscheinlichkeiten. Daher sind viele R-Funktionen f√ºr Bayes auf Stichproben eingestellt.\n:::\n\nDie Grid-Methode ist bei gr√∂√üeren Datens√§tzen (oder gr√∂√üeren Modellen) zu rechenintensiv.\nIn der Praxis werden daher andere, schnellere Verfahren verwendet, sog. Monte-Carlo-Markov-Ketten (MCMC).\nDiese Verfahren sind aber nicht mehr Gegenstand dieses Kurses.\n\n\n### H√§ufigkeiten sind einfacher als Wahrscheinlichkeiten\n\n\nWie gesagt, typische R-Werkzeuge (\"R-Golems\") liefern uns die Post-Verteilung in Stichprobenform zur√ºck.\n\nBevor wir uns aber mit diesen R-Werkzeugen besch√§ftigen,\nsollten wir uns vertraut machen mit einer Post-Verteilung in Stichprobenform.\n\n\nErsstellen wir uns also einen Tabelle mit Stichprobendaten aus der Posteriori-Verteilung (Tabelle `d`):\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsamples <-\n  d %>%  # nimmt die Tabelle mit Posteriori-Daten,\n  slice_sample(  # Ziehe daraus eine Stichprobe,\n    n = 1e4,  # mit insgesamt n=10000 Elementen,\n    weight_by = post,  # Gewichte nach Spalte mit Post-Wskt.,\n    replace = T)  # Ziehe mit Zur√ºcklegen\n```\n:::\n\n\nDie Wahrscheinlichkeit, einen Parameterwert aus Tabelle `d` zu ziehen, ist proportional zur Posteriori-Wahrscheinlichkeit (`post`) dieses Werts. Ziehen mit Zur√ºcklegen h√§lt die Wahrscheinlichkeiten w√§hrend des Ziehens konstant.\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n```{=html}\n<div id=\"kywsqpwpyg\" style=\"overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>html {\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;\n}\n\n#kywsqpwpyg .gt_table {\n  display: table;\n  border-collapse: collapse;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#kywsqpwpyg .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#kywsqpwpyg .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#kywsqpwpyg .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 0;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#kywsqpwpyg .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#kywsqpwpyg .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#kywsqpwpyg .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#kywsqpwpyg .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#kywsqpwpyg .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#kywsqpwpyg .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#kywsqpwpyg .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#kywsqpwpyg .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#kywsqpwpyg .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#kywsqpwpyg .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#kywsqpwpyg .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#kywsqpwpyg .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#kywsqpwpyg .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#kywsqpwpyg .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#kywsqpwpyg .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#kywsqpwpyg .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#kywsqpwpyg .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#kywsqpwpyg .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#kywsqpwpyg .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#kywsqpwpyg .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#kywsqpwpyg .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#kywsqpwpyg .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#kywsqpwpyg .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#kywsqpwpyg .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#kywsqpwpyg .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-left: 4px;\n  padding-right: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#kywsqpwpyg .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#kywsqpwpyg .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#kywsqpwpyg .gt_left {\n  text-align: left;\n}\n\n#kywsqpwpyg .gt_center {\n  text-align: center;\n}\n\n#kywsqpwpyg .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#kywsqpwpyg .gt_font_normal {\n  font-weight: normal;\n}\n\n#kywsqpwpyg .gt_font_bold {\n  font-weight: bold;\n}\n\n#kywsqpwpyg .gt_font_italic {\n  font-style: italic;\n}\n\n#kywsqpwpyg .gt_super {\n  font-size: 65%;\n}\n\n#kywsqpwpyg .gt_footnote_marks {\n  font-style: italic;\n  font-weight: normal;\n  font-size: 75%;\n  vertical-align: 0.4em;\n}\n\n#kywsqpwpyg .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#kywsqpwpyg .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#kywsqpwpyg .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#kywsqpwpyg .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#kywsqpwpyg .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#kywsqpwpyg .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\">\n  <thead class=\"gt_header\">\n    <tr>\n      <td colspan=\"5\" class=\"gt_heading gt_title gt_font_normal\" style>Stichprobendaten aus der Post-Verteilung</td>\n    </tr>\n    <tr>\n      <td colspan=\"5\" class=\"gt_heading gt_subtitle gt_font_normal gt_bottom_border\" style>Nur die ersten Zeilen abgebildet</td>\n    </tr>\n  </thead>\n  <thead class=\"gt_col_headings\">\n    <tr>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\">p_grid</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\">prior</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\">likelihood</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\">unstand_post</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\">post</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td class=\"gt_row gt_right\">0.778</td>\n<td class=\"gt_row gt_right\">1</td>\n<td class=\"gt_row gt_right\">0.204</td>\n<td class=\"gt_row gt_right\">2 √ó 10<sup style='font-size: 65%;'>‚àí1</sup></td>\n<td class=\"gt_row gt_right\">0.227</td></tr>\n    <tr><td class=\"gt_row gt_right\">0.667</td>\n<td class=\"gt_row gt_right\">1</td>\n<td class=\"gt_row gt_right\">0.273</td>\n<td class=\"gt_row gt_right\">3 √ó 10<sup style='font-size: 65%;'>‚àí1</sup></td>\n<td class=\"gt_row gt_right\">0.303</td></tr>\n    <tr><td class=\"gt_row gt_right\">0.667</td>\n<td class=\"gt_row gt_right\">1</td>\n<td class=\"gt_row gt_right\">0.273</td>\n<td class=\"gt_row gt_right\">3 √ó 10<sup style='font-size: 65%;'>‚àí1</sup></td>\n<td class=\"gt_row gt_right\">0.303</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\n\nWie sieht diese Tabelle dann als Histogramm aus?\n\nHier erstmal die ersten 100 gesampelten Gitterwerte (`p_grid`):\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n  [1] 0.78 0.67 0.67 0.56 0.44 0.67 0.44 0.56 0.67 0.67 0.78 0.78 0.67 0.44 0.89\n [16] 0.67 0.67 0.67 0.78 0.78 0.89 0.67 0.67 0.56 0.78 0.89 0.67 0.44 0.44 0.78\n [31] 0.56 0.33 0.56 0.67 0.56 0.44 0.89 0.89 0.44 0.67 0.67 0.44 0.67 0.56 0.44\n [46] 0.67 0.67 0.78 0.67 0.67 0.33 0.89 0.78 0.44 0.67 0.89 0.67 0.56 0.67 0.78\n [61] 0.33 0.67 0.78 0.67 0.78 0.56 0.78 0.78 0.44 0.78 0.67 0.78 0.78 0.89 0.56\n [76] 0.56 0.56 0.56 0.67 0.33 0.78 0.78 0.56 0.44 0.78 0.67 0.67 0.44 0.56 0.67\n [91] 0.78 0.56 0.56 0.78 0.44 0.67 0.67 0.56 0.56 0.67\n```\n:::\n:::\n\n\n\nSo:\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stderr}\n```\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n```\n:::\n\n::: {.cell-output-display}\n![](Post_files/figure-html/QM2-Thema3-Teil1-3-1.png){width=672}\n:::\n:::\n\n\n\n\n### Visualisierung der Stichprobendaten mit $k=100$ Gitterwerten\n\n\nDatensatz `samples`, $n=10^3$, $k=100$ Gitterwerte, basierend auf dem Modell oben.\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsamples_k100 <-\n  d_k100 %>%  # nimmt die Tabelle mit Posteriori-Daten,\n  slice_sample(  # Ziehe daraus eine Stichprobe,\n    n = n,  # mit insgesamt n=1000 Elementen,\n    weight_by = post,  # Gewichte nach Spalte mit Post-Wskt.,\n    replace = T)  # Ziehe mit Zur√ºcklegen\n```\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](Post_files/figure-html/samplesplot-1.png){width=672}\n:::\n:::\n\n\nDie Stichprobendaten n√§hern sich der Posteriori-Verteilung an.\n\n\n::: callout-note\nMehr Stichproben und mehr Gitterwerte gl√§tten die Verteilung\n:::\n\n$n=10^6$ Stichproben bei $k=100$ Gitterwerten aus der Posteriori-Verteilung\n\n\n::: {.cell}\n\n```{.r .cell-code}\nd_k100 %>% \n  slice_sample(n = 1e6, weight_by = post, replace = T) %>% \n  ggplot(aes(x = p_grid)) +\n  geom_density(fill = \"black\") +\n  scale_x_continuous(\"Anteil Wasser (p)\", limits = c(0, 1)) +\n  labs(y = \"\")\n```\n\n::: {.cell-output-display}\n![](Post_files/figure-html/QM2-Thema3-Post-befragen-5-1.png){width=672}\n:::\n:::\n\n\n\n\n## Fragen zu Wahrscheinlichkeiten\n\n\n\nSagen wir, dass sei unsere Forschungsfrage: *Wie gro√ü ist die Wahrscheinlichkeit, dass der Wasseranteil unter 50% liegt?*\n\n\nWir filtern einfach die passenden Stichproben und und summieren die Wahrscheinlichkeiten dieser Stichproben:\n\n\n<!-- ```{r QM2-Thema3-Post-befragen-6} -->\n<!-- d %>%  -->\n<!--   filter(p_grid < .5) %>%  -->\n<!--   summarise(sum = sum(post)) -->\n<!-- ``` -->\n\n\n\nWir z√§hlen (`count`) einfach die Stichproben, die sich f√ºr einen Wasseranteil (`p_grid`) von weniger als 50% aussprechen:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsamples %>%\n  count(p_grid < .5) \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2 √ó 2\n  `p_grid < 0.5`     n\n  <lgl>          <int>\n1 FALSE           8338\n2 TRUE            1662\n```\n:::\n:::\n\n\nDa wir insgesamt 10000 (1e4) Stichproben gezogen haben, k√∂nnen wir noch durch diese Zahl teilen, um einen Anteil zu bekommen.\nDieser Anteil ist die Antwort auf die Forschungsfrage: \nWie Wahrscheinlichkeit (laut Modell) f√ºr einen Wasseranteil kleiner als 50%.\n\n\nEinfach wie üç∞ essen.\n\n\n\n\n\n\nNoch eine Forschungsfrage: *Mit welcher Wahrscheinlichkeit liegt der Parameter zwischen 0.5 und 0.75?*\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsamples %>% \n  count(p_grid > .5 & p_grid < .75)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2 √ó 2\n  `p_grid > 0.5 & p_grid < 0.75`     n\n  <lgl>                          <int>\n1 FALSE                           4571\n2 TRUE                            5429\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsamples %>% \n  count(p_grid > .5 & p_grid < .75) %>% \n  summarise(Anteil = n / 1e4,\n            Prozent = 100 * n / 1e4)  # In Prozent\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2 √ó 2\n  Anteil Prozent\n   <dbl>   <dbl>\n1  0.457    45.7\n2  0.543    54.3\n```\n:::\n:::\n\n\nAnteile von `count()` k√∂nnte man, wenn man m√∂chte, auch `filter()` verwenden:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsamples %>% \n  filter(p_grid > .5 & p_grid < .75) %>% \n  summarise(sum     =       n() / 1e4,\n            anteil = 100 * n() / 1e4)  # In Prozent\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 √ó 2\n    sum anteil\n  <dbl>  <dbl>\n1 0.543   54.3\n```\n:::\n:::\n\n\n\nNoch ein Beispiel f√ºr eine Forschungsfrage: Mit welcher Wahrscheinlichkeit liegt der Parameter zwischen 0.9 und 1?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsamples %>% \n  count(p_grid >= .9 & p_grid <= 1) %>% \n  summarise(prop = 100 * n() / 1e4)  # prop wie \"proportion\", Anteil\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 √ó 1\n   prop\n  <dbl>\n1  0.01\n```\n:::\n:::\n\n\nLaut unserem Modell ist es also sehr unwahrscheinlich, dass der Wasseranteil der Erde mind.  90% betr√§gt.\n\n\n\n### Fragen nach Parameterwerten\n\n::: callout-important\nSch√§tzbereiche von Parameterwerten nennt man auch *Konfidenz- oder Vertrauensintervall* (synonym: *Kompatibilit√§tsintervall* oder *Passungsbereich*).\n:::\n\n\n\nWelcher Parameterwert wird mit 90% Wahrscheinlichkeit nicht √ºberschritten, laut unserem Modell? (Gesucht sind also die unteren 90% Posteriori-Wahrscheinlichkeit)\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsamples %>% \n  summarise(quantil90 = quantile(p_grid, p = .9))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 √ó 1\n  quantil90\n      <dbl>\n1     0.778\n```\n:::\n:::\n\n\n\nLaut unserem Modell k√∂nnen wir zu 90% sicher sein, dass der Wasseranteil kleiner ist als ca. 78%.\n\nEs hilft vielleicht, sich die Post-Verteilung noch einmal vor Augen zu f√ºhren:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsamples %>% \n  ggplot(aes(x = p_grid)) +\n  geom_bar()\n```\n\n::: {.cell-output-display}\n![](Post_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n\n\n\nWas ist das *mittlere* Intervall, das mit 90% Wahrscheinlichkeit den Parameterwert enth√§lt, laut dem Modell?\n\nDaf√ºr \"schneiden\" wir links und rechts die 5% der Stichproben mit den extremsten Werten ab und schauen, bei welchem Parameterwert wir landen:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsamples %>% \n  summarise(\n    quant_10 = quantile(p_grid, 0.05),\n    quant_90 = quantile(p_grid, 0.95))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 √ó 2\n  quant_10 quant_90\n     <dbl>    <dbl>\n1    0.444    0.889\n```\n:::\n:::\n\n\n\nSolche Fragen lassen sich mit Hilfe von *Quantilen* beantworten.\n\n\n\n### Zur Erinnerung: Quantile\n\nBeispiel: Wie gro√ü sind die Studentis ([Quelle des Datensatzes](https://rdrr.io/cran/openintro/man/speed_gender_height.html))? Das Quantil von z.B. 25% zeigt die K√∂rpergr√∂√üe der 25% kleinsten Studentis an, analog f√ºr 50%, 75%:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nspeed_gender_height <- read_csv(\"https://raw.githubusercontent.com/rpruim/OpenIntro/master/data/speed_gender_height.csv\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nNew names:\nRows: 1325 Columns: 4\n‚îÄ‚îÄ Column specification\n‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ Delimiter: \",\" chr\n(1): gender dbl (3): ...1, speed, height\n‚Ñπ Use `spec()` to retrieve the full column specification for this data. ‚Ñπ\nSpecify the column types or set `show_col_types = FALSE` to quiet this message.\n‚Ä¢ `` -> `...1`\n```\n:::\n\n```{.r .cell-code}\nheight_summary <- \n  speed_gender_height %>% \n  drop_na(height) %>% \n  summarise(q25 = quantile(height, prob = .25),\n            q50 = quantile(height, prob = .5),\n            q75 = quantile(height, prob = .75))\n\nheight_summary\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 √ó 3\n    q25   q50   q75\n  <dbl> <dbl> <dbl>\n1    63    66    69\n```\n:::\n:::\n\n\nVisualisierung der Quantile:\n\n\n::: {.cell fig.asp='0.4'}\n\n```{.r .cell-code}\np1 <- speed_gender_height %>% \n  ggplot() +\n  aes(x = 1, y = height) +\n  geom_boxplot() +\n  labs(x = \"\",\n       y = \"Gr√∂√üe in Inch\",\n       title = \"Die Box zeigt das 25%-, 50%- und 75%-Quantil\")\n\nheight_summary_long <- \n  height_summary %>% \n  pivot_longer(everything(),\n               names_to = \"q\",\n               values_to = \"height\")\n\np2 <- speed_gender_height %>% \n  ggplot() +\n  aes(x = height) +\n  geom_histogram() +\n  geom_vline(data = height_summary_long,\n             aes(xintercept = height)) +\n  geom_text(data = height_summary_long,\n             aes(x = height+1,\n                 y = 0,\n                 label = paste0(q, \": \",height)),\n             angle = 90,\n            hjust = 0,\n            color = \"white\"\n             ) +\n  labs(title = \"Die vertikalen Striche zeigen die Quantile\",\n       y = \"H√§ufigkeit\")\n\np1+p2\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 5 rows containing non-finite values (`stat_boxplot()`).\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 5 rows containing non-finite values (`stat_bin()`).\n```\n:::\n\n::: {.cell-output-display}\n![](Post_files/figure-html/QM2-Thema3-Teil1-6-1.png){width=768}\n:::\n:::\n\n\n\n### `quantile()` unter die Motorhaube geschaut\n\nDen R-Befehl `quantile()` kann man sich, wenn man will, einfach nachbauen und entmystifizieren.\n\nAngenommen, wir wollen wissen, welcher Wasseranteil mit 90% Wahrscheinlichkeit nicht √ºberschritten wird:\n\n1. Sortiere die Stichproben aufsteigend.\n2. Schneide die oberen 10% ab.\n3. Schaue, was der gr√∂√üte verbleibende Wert ist.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsamples %>% \n  arrange(p_grid) %>%   # sortiere\n  slice_head(n = 9000) %>%  # nur die ersten 90000, also die obersten 1000 abschneiden\n  summarise(max(p_grid))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 √ó 1\n  `max(p_grid)`\n          <dbl>\n1         0.778\n```\n:::\n:::\n\n\n\nDas (ann√§hernd) gleiche Ergebnis liefert `quantile()`:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsamples %>% \n  summarise(q90 = quantile(p_grid, .9))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 √ó 1\n    q90\n  <dbl>\n1 0.778\n```\n:::\n:::\n\n\n\n### Visualisierung der Intervalle\n\nIntervalle (Bereiche), die die  Wahrscheinlichkeitsmasse h√§lftig auf die beiden R√§nder aufteilen, nennen wir *Perzentilintervalle* oder *Equal-Tails-Intervalle* (ETI):\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Post_files/figure-html/piplot-1.png){width=672}\n:::\n:::\n\n\n\n\n## Schiefe Posteriori-Verteilungen sind m√∂glich\n\n\nGehen wir von 3 W√ºrfen mit 3 Treffern aus; auf welche Wasseranteile (Parameterwerte) werden wir jetzt schlie√üen?\n\nVermutlich ziemlich hohe.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nd_33 <- \n  tibble(p_grid = seq(0,1, by =.01),\n         prior = 1) %>% \n  mutate(likelihood = dbinom(3, size = 3, prob = p_grid)) %>% \n  mutate(unstand_post = likelihood * prior) %>% \n  mutate(post_33  = unstand_post / sum(unstand_post)) \n\nsamples_33 <- \n  d_33 %>% \n    slice_sample(n = 1e4, \n                 weight_by = post_33, \n                 replace = T)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsamples_33 %>% \n  select(-post_33) %>% \n  head() %>% \n  gt() %>% \n  fmt_number(columns = c(1,3,4), decimals = 2)\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"kmxwmajbdg\" style=\"overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>html {\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;\n}\n\n#kmxwmajbdg .gt_table {\n  display: table;\n  border-collapse: collapse;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#kmxwmajbdg .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#kmxwmajbdg .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#kmxwmajbdg .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 0;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#kmxwmajbdg .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#kmxwmajbdg .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#kmxwmajbdg .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#kmxwmajbdg .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#kmxwmajbdg .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#kmxwmajbdg .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#kmxwmajbdg .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#kmxwmajbdg .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#kmxwmajbdg .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#kmxwmajbdg .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#kmxwmajbdg .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#kmxwmajbdg .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#kmxwmajbdg .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#kmxwmajbdg .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#kmxwmajbdg .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#kmxwmajbdg .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#kmxwmajbdg .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#kmxwmajbdg .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#kmxwmajbdg .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#kmxwmajbdg .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#kmxwmajbdg .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#kmxwmajbdg .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#kmxwmajbdg .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#kmxwmajbdg .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#kmxwmajbdg .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-left: 4px;\n  padding-right: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#kmxwmajbdg .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#kmxwmajbdg .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#kmxwmajbdg .gt_left {\n  text-align: left;\n}\n\n#kmxwmajbdg .gt_center {\n  text-align: center;\n}\n\n#kmxwmajbdg .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#kmxwmajbdg .gt_font_normal {\n  font-weight: normal;\n}\n\n#kmxwmajbdg .gt_font_bold {\n  font-weight: bold;\n}\n\n#kmxwmajbdg .gt_font_italic {\n  font-style: italic;\n}\n\n#kmxwmajbdg .gt_super {\n  font-size: 65%;\n}\n\n#kmxwmajbdg .gt_footnote_marks {\n  font-style: italic;\n  font-weight: normal;\n  font-size: 75%;\n  vertical-align: 0.4em;\n}\n\n#kmxwmajbdg .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#kmxwmajbdg .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#kmxwmajbdg .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#kmxwmajbdg .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#kmxwmajbdg .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#kmxwmajbdg .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\">\n  \n  <thead class=\"gt_col_headings\">\n    <tr>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\">p_grid</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\">prior</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\">likelihood</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\">unstand_post</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td class=\"gt_row gt_right\">0.99</td>\n<td class=\"gt_row gt_right\">1</td>\n<td class=\"gt_row gt_right\">0.97</td>\n<td class=\"gt_row gt_right\">0.97</td></tr>\n    <tr><td class=\"gt_row gt_right\">0.99</td>\n<td class=\"gt_row gt_right\">1</td>\n<td class=\"gt_row gt_right\">0.97</td>\n<td class=\"gt_row gt_right\">0.97</td></tr>\n    <tr><td class=\"gt_row gt_right\">0.83</td>\n<td class=\"gt_row gt_right\">1</td>\n<td class=\"gt_row gt_right\">0.57</td>\n<td class=\"gt_row gt_right\">0.57</td></tr>\n    <tr><td class=\"gt_row gt_right\">0.86</td>\n<td class=\"gt_row gt_right\">1</td>\n<td class=\"gt_row gt_right\">0.64</td>\n<td class=\"gt_row gt_right\">0.64</td></tr>\n    <tr><td class=\"gt_row gt_right\">0.95</td>\n<td class=\"gt_row gt_right\">1</td>\n<td class=\"gt_row gt_right\">0.86</td>\n<td class=\"gt_row gt_right\">0.86</td></tr>\n    <tr><td class=\"gt_row gt_right\">0.69</td>\n<td class=\"gt_row gt_right\">1</td>\n<td class=\"gt_row gt_right\">0.33</td>\n<td class=\"gt_row gt_right\">0.33</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\n\n\n\n\n### 50%-Perzentil-Intervall\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nqi_50_low <- eti(samples_33$p_grid, ci = .5)$CI_low\nqi_50_up <- eti(samples_33$p_grid, ci = .5)$CI_high\np1 <-\n  d_33 %>% \n  ggplot(aes(x = p_grid, y = post_33)) +\n  # check out our sweet `qi()` indexing\n  geom_area(data = . %>% \n              filter(p_grid > qi_50_low &  \n                    p_grid < qi_50_up),\n            fill = \"grey75\") +\n  geom_line() +\n  scale_x_continuous(breaks = seq(from = 0, to = 1, by = .1))\n\np1\n```\n\n::: {.cell-output-display}\n![](Post_files/figure-html/QM2-Thema3-Post-befragen-15-1.png){width=672}\n:::\n:::\n\n\nDie Grenzwerte dieses ETI (oder jedes beliebig breiten) kann man sich z.B. so ausgeben lassen:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(easystats)\n\nsamples %>% \n  select(p_grid) %>% \n  eti(ci = .5)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nEqual-Tailed Interval\n\nParameter |      50% ETI\n------------------------\np_grid    | [0.56, 0.78]\n```\n:::\n:::\n\n\n\n\nDer wahrscheinlichste Parameterwert (1) ist *nicht* im Intervall enthalten.\nDas ist ein Nachteil der ETI.\n\n\n\n\n### 50%-Intervall h√∂chster Dichte\n\nIntervalle h√∂chster Dichte (Highest density Intervals) sind definiert als die schm√§lsten Intervalle, die den gesuchten Parameter enthalten.\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Post_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n\nDer wahrscheinlichste Paramterwert (1) *ist* im Intervall enthalten. \n\n\nSo kann man sich die Grenzwerte eines 50%-HDI ausgeben lassen:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsamples %>% \n  select(p_grid) %>% \n  hdi(ci = .5)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Identical densities found along different segments of the distribution,\nchoosing rightmost.\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nHighest Density Interval\n\nParameter |      50% HDI\n------------------------\np_grid    | [0.67, 0.78]\n```\n:::\n:::\n\n\nDas Modell ist sich also zu 50% sicher, dass der gesuchte Parameter (der Wasseranteil der Erdoberfl√§che) sich in diesem Bereich befindet (auf Basis eines HDI).\n\n\n\n\n## Intervalle h√∂chster Dichte vs. Perzentilintervalle\n\n- Bei symmetrischer Posteriori-Verteilung sind beide Intervalle √§hnlich\n- Perzentilintervalle sind verbreiteter\n- *Intervalle h√∂chster Dichte* (Highest Density Interval, HDI) sind bei schiefen Post-Verteilungen zu bevorzugen\n- Intervalle h√∂chster Dichte sind die *schmalsten* Intervalle f√ºr eine gegebene Wahrscheinlichkeitsmasse\n\n\n\n\n## Punktsch√§tzungen \n\nDatendatz `samples`,  6 Treffer bei 9 W√ºrfen.\n\n\n\n\n### Lageparameter\n\nZ.B. Welchen mittleren Wasseranteil muss man annehmen?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsamples %>% \n  summarise(\n    mean   = mean(p_grid),\n    median = median(p_grid))  \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 √ó 2\n   mean median\n  <dbl>  <dbl>\n1 0.637  0.667\n```\n:::\n:::\n\n\n### Streuungsparameter\n\nZ.B. \"Wie unsicher sind wir in der Sch√§tzung des mittleren Wasseranteils?\"\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsamples %>% \n  summarise(\n    p_sd   = sd(p_grid),\n    p_iqr = IQR(p_grid),\n    p_mad = mad(p_grid))  \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 √ó 3\n   p_sd p_iqr p_mad\n  <dbl> <dbl> <dbl>\n1 0.139 0.222 0.165\n```\n:::\n:::\n\n\n\n\n\n## Visualisierungen der Punktsch√§tzer\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Post_files/figure-html/pointestimators-1.png){width=672}\n:::\n:::\n\n\n\nJe symmetrischer die Verteilung, desto n√§her liegen die Punktsch√§tzer aneinander (und umgekehrt).\n\n\n\n## Der zwielichte Dozent: Stichproben-Vert. vs. Post-Vert.\n\n\nDaten: 9 von 10 Treffern beim M√ºnzwurf. Ist die M√ºnze fair?\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntibble(\n  Trefferzahl = rbinom(n = 1e4, size = 10, prob = 1/2)\n) %>% \n  mutate(signifikant = ifelse(Trefferzahl %in% c(9,10), TRUE, FALSE)) %>% \n  ggplot() +\n  aes(x = Trefferzahl, fill = signifikant) +\n  geom_bar() +\n  scale_x_continuous(breaks = 0:10) +\n  theme(legend.position = c(0.1, 0.8)) +\n  geom_vline(xintercept = 9) +\n  labs(title = \"Stichprobenverteilung f√ºr p=0.5\")\n```\n\n::: {.cell-output-display}\n![](Post_files/figure-html/QM2-Thema3-Post-befragen-21-1.png){width=672}\n:::\n:::\n\n\nDie *Stichprobenverteilung* zeigt, wie Wahrscheinlich der empirischen Daten $D$ (z.B. 9 von 10 Treffer) ist *gegeben* eines Parameterwerts $p$ (z.B. $p=0.5$): $Pr(D|p)$.\n\n\n\n\n\n::: {.cell hash='Post_cache/html/zwielicht-daten_5f53e0e34ff1b186acbc2a1b4c37c67c'}\n\n:::\n\n::: {.cell hash='Post_cache/html/QM2-Thema3-Post-befragen-22_b6c52676d55c2686ff4ce563ba9c8249'}\n::: {.cell-output-display}\n![](Post_files/figure-html/QM2-Thema3-Post-befragen-22-1.png){width=672}\n:::\n:::\n\n\nDie *Posteriori-Verteilung* gibt die Wahrscheinlichkeit jedes Parameterwerts $p$ wider, gegeben der empirischen Daten $D$: $Pr(p|D)$. \n\n\nDie meisten Forschungsfragen lassen sich mit der Post-Verteilung beantworten, nicht mit der Stichprobenverteilung.\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}