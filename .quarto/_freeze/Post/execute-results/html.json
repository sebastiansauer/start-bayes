{
  "hash": "9d8e81ae18b7c30cf454b6381c185be4",
  "result": {
    "markdown": "\n# Die Post befragen\n\n\n\n![Bayes:Start!](img/Golem_hex.png){width=5%}\n\n\n\n\n\n\n\n## Mit Stichproben die Post-Verteilung zusammenfassen\n\n\n### Zur Erinnerung: Gitterwerte in R berechnen\n\nBerechnen wir mit der Gittermethoden die Postverteilung für den Globusversuch.\n\n\n\n::: {.cell hash='Post_cache/html/QM2-Thema2-kleineModelle-28_7767aaa1182730fed160577332001410'}\n\n```{.r .cell-code}\nn <- 10\nn_success <- 6\nn_trials  <- 9\n\nd <-\n  tibble(p_grid = seq(from = 0, to = 1, length.out = n),\n         prior  = 1) %>% \n  mutate(likelihood = dbinom(n_success, \n                             size = n_trials, \n                             prob = p_grid)) %>% \n  mutate(unstand_post = (likelihood * prior),\n         post = unstand_post / sum(unstand_post))\n```\n:::\n\n\n\nVoilà, die Post-Verteilung als Tabelle: s. Tab. @tbl-post1.\n\n\n\n::: {#tbl-post1 .cell tbl-cap='Postverteilung mit der Gittermethode berechnet' hash='Post_cache/html/tbl-post1_c797636c19c78de2ed94fd16ee9409a4'}\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n| p_grid| prior| likelihood| unstand_post| post|\n|------:|-----:|----------:|------------:|----:|\n|   0.00|     1|       0.00|         0.00| 0.00|\n|   0.11|     1|       0.00|         0.00| 0.00|\n|   0.22|     1|       0.00|         0.00| 0.01|\n|   0.33|     1|       0.03|         0.03| 0.04|\n|   0.44|     1|       0.11|         0.11| 0.12|\n|   0.56|     1|       0.22|         0.22| 0.24|\n|   0.67|     1|       0.27|         0.27| 0.30|\n|   0.78|     1|       0.20|         0.20| 0.23|\n|   0.89|     1|       0.06|         0.06| 0.06|\n|   1.00|     1|       0.00|         0.00| 0.00|\n\n</div>\n:::\n:::\n\n\n\n### Zur Erinnerung, die Gittermethode\n\nDie Gittermethode ist ein Weg, die Posteriori-Verteilung zu berechnen. Die Posteriori-Verteilung birgt viele nützliche Informationen.\n\nModell: $W=6$ Wasser, $N=9$ Würfen und $k=10$ Gitterwerten.\n\nAbb. @fig-post1 zeigt die resultierende Post-Verteilung.\n\n\n::: {.cell hash='Post_cache/html/fig-post1_6bc2791aa21392938d1fbefc4a09e483'}\n::: {.cell-output-display}\n![Die Postverteilung für W=6, N=9, k=10](Post_files/figure-html/fig-post1-1.png){#fig-post1 width=672}\n:::\n:::\n\n::: {.cell hash='Post_cache/html/QM2-Thema3-Post-befragen-2_2a1cd2ae63316bb99135df1764b4acd4'}\n::: {.cell-output-display}\n```{=html}\n<div id=\"zsuhpuxepo\" style=\"overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>html {\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;\n}\n\n#zsuhpuxepo .gt_table {\n  display: table;\n  border-collapse: collapse;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#zsuhpuxepo .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#zsuhpuxepo .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#zsuhpuxepo .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 0;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#zsuhpuxepo .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#zsuhpuxepo .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#zsuhpuxepo .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#zsuhpuxepo .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#zsuhpuxepo .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#zsuhpuxepo .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#zsuhpuxepo .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#zsuhpuxepo .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#zsuhpuxepo .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#zsuhpuxepo .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#zsuhpuxepo .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#zsuhpuxepo .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#zsuhpuxepo .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#zsuhpuxepo .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#zsuhpuxepo .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#zsuhpuxepo .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#zsuhpuxepo .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#zsuhpuxepo .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#zsuhpuxepo .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#zsuhpuxepo .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#zsuhpuxepo .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#zsuhpuxepo .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#zsuhpuxepo .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#zsuhpuxepo .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#zsuhpuxepo .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-left: 4px;\n  padding-right: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#zsuhpuxepo .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#zsuhpuxepo .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#zsuhpuxepo .gt_left {\n  text-align: left;\n}\n\n#zsuhpuxepo .gt_center {\n  text-align: center;\n}\n\n#zsuhpuxepo .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#zsuhpuxepo .gt_font_normal {\n  font-weight: normal;\n}\n\n#zsuhpuxepo .gt_font_bold {\n  font-weight: bold;\n}\n\n#zsuhpuxepo .gt_font_italic {\n  font-style: italic;\n}\n\n#zsuhpuxepo .gt_super {\n  font-size: 65%;\n}\n\n#zsuhpuxepo .gt_footnote_marks {\n  font-style: italic;\n  font-weight: normal;\n  font-size: 75%;\n  vertical-align: 0.4em;\n}\n\n#zsuhpuxepo .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#zsuhpuxepo .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#zsuhpuxepo .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#zsuhpuxepo .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#zsuhpuxepo .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#zsuhpuxepo .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\">\n  <thead class=\"gt_header\">\n    <tr>\n      <td colspan=\"5\" class=\"gt_heading gt_title gt_font_normal gt_bottom_border\" style>Tabelle <em>d</em> mit Daten zur Posteriori-Verteilung</td>\n    </tr>\n    \n  </thead>\n  <thead class=\"gt_col_headings\">\n    <tr>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\">p_grid</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\">prior</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\">likelihood</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\">unstand_post</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\">post</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td class=\"gt_row gt_right\">0</td>\n<td class=\"gt_row gt_right\">1</td>\n<td class=\"gt_row gt_right\">0</td>\n<td class=\"gt_row gt_right\">0</td>\n<td class=\"gt_row gt_right\">0</td></tr>\n    <tr><td class=\"gt_row gt_right\">1 × 10<sup style='font-size: 65%;'>−1</sup></td>\n<td class=\"gt_row gt_right\">1</td>\n<td class=\"gt_row gt_right\">1 × 10<sup style='font-size: 65%;'>−4</sup></td>\n<td class=\"gt_row gt_right\">1 × 10<sup style='font-size: 65%;'>−4</sup></td>\n<td class=\"gt_row gt_right\">1 × 10<sup style='font-size: 65%;'>−4</sup></td></tr>\n    <tr><td class=\"gt_row gt_right\">2 × 10<sup style='font-size: 65%;'>−1</sup></td>\n<td class=\"gt_row gt_right\">1</td>\n<td class=\"gt_row gt_right\">5 × 10<sup style='font-size: 65%;'>−3</sup></td>\n<td class=\"gt_row gt_right\">5 × 10<sup style='font-size: 65%;'>−3</sup></td>\n<td class=\"gt_row gt_right\">5 × 10<sup style='font-size: 65%;'>−3</sup></td></tr>\n    <tr><td class=\"gt_row gt_right\">3 × 10<sup style='font-size: 65%;'>−1</sup></td>\n<td class=\"gt_row gt_right\">1</td>\n<td class=\"gt_row gt_right\">3 × 10<sup style='font-size: 65%;'>−2</sup></td>\n<td class=\"gt_row gt_right\">3 × 10<sup style='font-size: 65%;'>−2</sup></td>\n<td class=\"gt_row gt_right\">4 × 10<sup style='font-size: 65%;'>−2</sup></td></tr>\n    <tr><td class=\"gt_row gt_right\">4 × 10<sup style='font-size: 65%;'>−1</sup></td>\n<td class=\"gt_row gt_right\">1</td>\n<td class=\"gt_row gt_right\">1 × 10<sup style='font-size: 65%;'>−1</sup></td>\n<td class=\"gt_row gt_right\">1 × 10<sup style='font-size: 65%;'>−1</sup></td>\n<td class=\"gt_row gt_right\">1 × 10<sup style='font-size: 65%;'>−1</sup></td></tr>\n    <tr><td class=\"gt_row gt_right\">6 × 10<sup style='font-size: 65%;'>−1</sup></td>\n<td class=\"gt_row gt_right\">1</td>\n<td class=\"gt_row gt_right\">2 × 10<sup style='font-size: 65%;'>−1</sup></td>\n<td class=\"gt_row gt_right\">2 × 10<sup style='font-size: 65%;'>−1</sup></td>\n<td class=\"gt_row gt_right\">2 × 10<sup style='font-size: 65%;'>−1</sup></td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\n\nViele nützliche Fragen (und Antworten) leiten sich ab aus Abb. @fig-post1.\n\n\n### Beispiele für Fragen an die Post-Verteilung\n\n- Mit welcher Wahrscheinlichkeit liegt der Parameter unter einem bestimmten Wert?\n- Mit welcher Wahrscheinlichkeit liegt der Parameter zwischen zwei bestimmten Werten?\n- Mit 5% Wahrscheinlichkeit liegt der Parameterwert nicht unter welchem Wert?\n- Welcher Parameterwert hat die höchste Wahrscheinlichkeit?\n- Wie ungewiss ist das Modell über die Parameterwerte?\n\n\nSolche Fragen kann man in zwei Gruppen aufteilen:\n\n1. Fragen zu Parametern\n3. Fragen zu Wahrscheinlichkeiten\n\n\n\n### Wir arbeiten jetzt mit Häufigkeit, nicht mit Wahrscheinlichkeit\n\nKomplexere Bayes-Modelle können nicht mehr \"einfach mal eben\" ausgerechnet werden; die Integrale, auf die man dabei stößt, treiben einem gestandenen Mathematiker die Schweißperlen auf die Stirn.\n\nGlücklicherweiße gibt es einen Trick, der die Sache nicht nur rechnerisch, sondern auch konzeptionell viel einfacher macht.\n\nDieser Trick lautet: Wir arbeiten nicht mehr mit Wahrscheinlichkeiten, sondern mit Häufigkeiten.\n\n\nPraktischerweise werden wir in Kürze einen R-Golem kennenlernen,\nder uns das meiste an Arbeit abnimmt. \nDieser Golem liefert uns Stichproben aus der Post-Verteilung zurück.\n\nLernen wir jetz also, wie man mit solchen Stichproben umgeht.\n\n\n:::callout-important\nDie Post-Verteilung in Stichprobenform ist viel einfach zu handbaben als das direkte Arbeiten mit Wahrscheinlichkeiten. Daher sind viele R-Funktionen für Bayes auf Stichproben eingestellt.\n:::\n\nDie Grid-Methode ist bei größeren Datensätzen (oder größeren Modellen) zu rechenintensiv.\nIn der Praxis werden daher andere, schnellere Verfahren verwendet, sog. Monte-Carlo-Markov-Ketten (MCMC).\nWie diese Verfahren funktionieren sind aber nicht mehr Gegenstand dieses Kurses.\nWir wenden Sie einfach an, freuen uns und lassen es damit gut sein[Eine gute Einführung in die Hintergründe findet sich bei @mcelreath_statistical_2020.]\n\n\n### Häufigkeiten sind einfacher als Wahrscheinlichkeiten\n\n\nWie gesagt, typische R-Werkzeuge (\"R-Golems\") liefern uns die Post-Verteilung in Stichprobenform zurück.\n\nBevor wir uns aber mit diesen R-Werkzeugen beschäftigen,\nsollten wir uns vertraut machen mit einer Post-Verteilung in Stichprobenform.\n\n\nErstellen wir uns also einen Tabelle mit Stichprobendaten aus der Posteriori-Verteilung (Tabelle `d`), s. Syntax @lst-post-sample.\n\n\n\n```{#lst-post-sample .r lst-cap=\"Wir stellen eine Tabelle mit Stichproben aus der Post-Verteilung\"}\nsamples <-\n  d %>%  # nimmt die Tabelle mit Posteriori-Daten,\n  slice_sample(  # Ziehe daraus eine Stichprobe,\n    n = 1e4,  # mit insgesamt n=10000 Zeilen,\n    weight_by = post,  # Gewichte nach Post-Wskt.,\n    replace = T)  # Ziehe mit Zurücklegen\n```\n\n\n\n\n::: {.cell hash='Post_cache/html/lst-post-sample2_e166818c8e518c91b69d4dc073b8c025'}\n\n:::\n\n\nDie Wahrscheinlichkeit, einen bestimmten Parameterwert aus Tabelle `d` zu ziehen, ist proportional zur Posteriori-Wahrscheinlichkeit (`post`) dieses Werts. \nZiehen mit Zurücklegen hält die Wahrscheinlichkeiten während des Ziehens konstant.\nDas Argument `weight_by` legt die Wahrscheinlichkeit fest, mit der eine Zeile gezogen wird.\n\nDas Ergebnis, eine Tabelle mit Stichproben aus der Post-Verteilung, ist (in Auszügen) in Tab. @tbl-postsample1 dargestellt.\n\n\n\n::: {#tbl-postsample1 .cell tbl-cap='Die ersten Zeilen der Stichproben aus der Post-Verteilung' hash='Post_cache/html/tbl-postsample1_775a160cf64aae8048b9341c9a6e4da6'}\n::: {.cell-output-display}\n```{=html}\n<div id=\"fppyczqjyr\" style=\"overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>html {\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;\n}\n\n#fppyczqjyr .gt_table {\n  display: table;\n  border-collapse: collapse;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#fppyczqjyr .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#fppyczqjyr .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#fppyczqjyr .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 0;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#fppyczqjyr .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#fppyczqjyr .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#fppyczqjyr .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#fppyczqjyr .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#fppyczqjyr .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#fppyczqjyr .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#fppyczqjyr .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#fppyczqjyr .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#fppyczqjyr .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#fppyczqjyr .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#fppyczqjyr .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#fppyczqjyr .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#fppyczqjyr .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#fppyczqjyr .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#fppyczqjyr .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#fppyczqjyr .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#fppyczqjyr .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#fppyczqjyr .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#fppyczqjyr .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#fppyczqjyr .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#fppyczqjyr .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#fppyczqjyr .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#fppyczqjyr .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#fppyczqjyr .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#fppyczqjyr .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-left: 4px;\n  padding-right: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#fppyczqjyr .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#fppyczqjyr .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#fppyczqjyr .gt_left {\n  text-align: left;\n}\n\n#fppyczqjyr .gt_center {\n  text-align: center;\n}\n\n#fppyczqjyr .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#fppyczqjyr .gt_font_normal {\n  font-weight: normal;\n}\n\n#fppyczqjyr .gt_font_bold {\n  font-weight: bold;\n}\n\n#fppyczqjyr .gt_font_italic {\n  font-style: italic;\n}\n\n#fppyczqjyr .gt_super {\n  font-size: 65%;\n}\n\n#fppyczqjyr .gt_footnote_marks {\n  font-style: italic;\n  font-weight: normal;\n  font-size: 75%;\n  vertical-align: 0.4em;\n}\n\n#fppyczqjyr .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#fppyczqjyr .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#fppyczqjyr .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#fppyczqjyr .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#fppyczqjyr .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#fppyczqjyr .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\">\n  <thead class=\"gt_header\">\n    <tr>\n      <td colspan=\"5\" class=\"gt_heading gt_title gt_font_normal\" style>Stichprobendaten aus der Post-Verteilung</td>\n    </tr>\n    <tr>\n      <td colspan=\"5\" class=\"gt_heading gt_subtitle gt_font_normal gt_bottom_border\" style>Nur die ersten Zeilen abgebildet</td>\n    </tr>\n  </thead>\n  <thead class=\"gt_col_headings\">\n    <tr>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\">p_grid</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\">prior</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\">likelihood</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\">unstand_post</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\">post</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td class=\"gt_row gt_right\">0.333</td>\n<td class=\"gt_row gt_right\">1</td>\n<td class=\"gt_row gt_right\">0.034</td>\n<td class=\"gt_row gt_right\">3 × 10<sup style='font-size: 65%;'>−2</sup></td>\n<td class=\"gt_row gt_right\">0.038</td></tr>\n    <tr><td class=\"gt_row gt_right\">0.667</td>\n<td class=\"gt_row gt_right\">1</td>\n<td class=\"gt_row gt_right\">0.273</td>\n<td class=\"gt_row gt_right\">3 × 10<sup style='font-size: 65%;'>−1</sup></td>\n<td class=\"gt_row gt_right\">0.303</td></tr>\n    <tr><td class=\"gt_row gt_right\">0.556</td>\n<td class=\"gt_row gt_right\">1</td>\n<td class=\"gt_row gt_right\">0.217</td>\n<td class=\"gt_row gt_right\">2 × 10<sup style='font-size: 65%;'>−1</sup></td>\n<td class=\"gt_row gt_right\">0.241</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\n\nWenn Sie jetzt denken: \"Warum machen wir das jetzt? Brauchen wir doch gar nicht!\" - Dann haben Sie Recht.\nKünftig werden wir aber, wenn wir mit komplexeren Modellen zu tun haben, nur noch mit Post-Verteilungen auf Stichprobenbasis arbeiten, weil es damit viel einfacher ist.\n\n\n\n\n\n\nHier erstmal die ersten 100 gesampelten Gitterwerte (`p_grid`):\n\n\n::: {.cell hash='Post_cache/html/QM2-Thema3-Teil1-2_4eaba81a1435545a28bcdc82218e78ef'}\n\n```\n##   [1] 0.67 0.56 0.56 0.67 0.67 0.56 0.78 0.67 0.67 0.56 0.78 0.67 0.56 0.56 0.78\n##  [16] 0.89 0.78 0.67 0.56 0.78 0.56 0.67 0.89 0.56 0.33 0.56 0.67 0.44 0.78 0.67\n##  [31] 0.78 0.89 0.78 0.56 0.44 0.56 0.22 0.78 0.89 0.78 0.56 0.67 0.33 0.78 0.33\n##  [46] 0.67 0.89 0.56 0.44 0.56 0.67 0.33 0.44 0.67 0.67 0.78 0.44 0.56 0.67 0.78\n##  [61] 0.56 0.67 0.89 0.44 0.78 0.67 0.67 0.78 0.44 0.78 0.44 0.67 0.67 0.56 0.89\n##  [76] 0.67 0.89 0.89 0.56 0.22 0.56 0.67 0.78 0.78 0.89 0.67 0.56 0.67 0.67 0.67\n##  [91] 0.67 0.67 0.78 0.78 0.44 0.67 0.89 0.67 0.78 0.56\n```\n:::\n\n\n\n\nWie sieht diese Tabelle wohl als Histogramm^[hier als Balkendiagramm, kommt fast aufs selbe raus, sieht aber etwas schöner aus in diesem Fall, da er nur wenige Balken sind] aus?\n\n\nSo sieht die Post-Verteilung auf Basis von Stichproben dann aus, s. Abb. @fig-samples1.\n\n\n::: {.cell hash='Post_cache/html/fig-samples1_39e038aa3ffd9bef929d48f4247ab685'}\n::: {.cell-output-display}\n![Stichprobenverteilung auf Basis von Stichproben](Post_files/figure-html/fig-samples1-1.png){#fig-samples1 width=672}\n:::\n:::\n\n\nAus @fig-samples1 können wir einfach auslesen, wie wahrscheinlich gewisse Parameterwerte sind.\nSo sehen wir, dass das Modell Parameterwerte (Wasseranteil, $\\pi$) zwischen ca. 50% und 70% für am wahrscheinlichsten hält.\nAber auch kleine Anteile wie 25% sind nicht auszuschließen (auf Basis der Daten und der Modellannahmen).\n\n\n### Visualisierung der Stichprobendaten mit $k=100$ Gitterwerten\n\n$k=10$ Gitterwerte ist ein grobes Raster.\nDrehen wir mal die Auflösung auf $k=100$ Gitterwerten nach oben.\n\nDatensatz `samples`, $n=10^3$, $k=100$ Gitterwerte, basierend auf dem Modell oben.\n\n\n::: {.cell hash='Post_cache/html/QM2-Thema2-kleineModelle-28a_fa5ab1a6b671a064211020bb0aa59a58'}\n\n:::\n\n::: {.cell hash='Post_cache/html/QM2-Thema3-Teil1-4_26cb7d7f36e05d3183d9afebe87243c0'}\n\n```{.r .cell-code}\nsamples_k100 <-\n  d_k100 %>%  # nimmt die Tabelle mit Posteriori-Daten,\n  slice_sample(  # Ziehe daraus eine Stichprobe,\n    n = n,  # mit insgesamt n=1000 Elementen,\n    weight_by = post,  # Gewichte nach Spalte mit Post-Wskt.,\n    replace = T)  # Ziehe mit Zurücklegen\n```\n:::\n\n\n\nAbb. @fig-post100 zeigt die Stichproben. Im linken Teildiagramm sind die Stichproben einzeln als Kreis dargestellt.\nIm rechten Teildiagramm sind die gleichen Daten als Dichtediagramm dargestellt.\nIn beiden Fällen erkennt man gut die zentrale Tendenz: ein Wasseranteil von 70% scheint der \"typische\" Wert des Modells zu sein.\nAußerdem erkennt man, dass das Modell durchaus einige Streuung in der Schätzung des Wasseranteils bereithält.\nDas Modell ist sich nicht sehr sicher, könnte man sagen.\n\n\n\n::: {.cell hash='Post_cache/html/fig-post100_f56e8afa04d295684ff5838f1c46e2cc'}\n::: {.cell-output-display}\n![Post-Stichproben mit 100 Gitterwerten](Post_files/figure-html/fig-post100-1.png){#fig-post100 width=672}\n:::\n:::\n\n\nDie Stichprobendaten nähern sich der \"echten\" Posteriori-Verteilung an:\nDie Stichproben-Post-Verteilung hat jetzt \"glattere\" Ränder.\n\n\n::: callout-note\nMehr Stichproben und mehr Gitterwerte glätten die Verteilung.\n:::\n\nJetzt noch mal mit mehr Stichproben: $n=10^6$ Stichproben bei $k=100$ Gitterwerten aus der Posteriori-Verteilung.\n\n\n::: {.cell hash='Post_cache/html/QM2-Thema3-Post-befragen-5_d942af6e1d9fbf2e8c46d2416fff33a4'}\n\n```{.r .cell-code}\nd_k100 %>% \n  slice_sample(n = 1e6, weight_by = post, replace = T) %>% \n  ggplot(aes(x = p_grid)) +\n  geom_density(fill = \"black\") +\n  scale_x_continuous(\"Anteil Wasser (p)\", limits = c(0, 1)) +\n  labs(y = \"\")\n```\n\n::: {.cell-output-display}\n![](Post_files/figure-html/QM2-Thema3-Post-befragen-5-1.png){width=672}\n:::\n:::\n\n\n\n## Die Post-Verteilung befragen\n\n\n\nSo, jetzt befragen wir die Post-Verteilung.\n\n\n:::callout-important\nDie Post-Verteilung ist das zentrale Ergebnis einer Bayes-Analyse.\nWir können viele nützliche Fragen an sie stellen.\n:::\n\nEs gibt zwei Arten von Fragen:\n\n1. nach Wahrscheinlichkeiten (p)\n2. nach Parameterwerten (Quantilen, q)\n\n\nDer Unterschied zwischen beiden Arten von Fragen ist in Abb. @fig-p-vs-q illustriert.\n\n![Fragen nach p vs. Fragen nach q](img/p-vs-q.png){#fig-p-vs-q}\n\nIm linken Teildiagramm von @fig-p-vs-q fragen wir: \"Wie wahrscheinlich ist ein Wasseranteil von höchtens 80%?\".\nIm rechten Teildiagramm fragen wir: \"Welcher Wasseranteil wird mit einer Wahrscheinlichkeit von 78% nicht überschritten?\".\n\n\n### Fragen nach Wahrscheinlichkeiten\n\n\n\n\nSagen wir, dass sei unsere Forschungsfrage: *Wie groß ist die Wahrscheinlichkeit, dass der Wasseranteil unter 50% liegt?*\n\n\nUm diese Frage zu beantworten, zählen wir einfach, wie viele Stichproben die Bedingung erfüllen:\n\nund und summieren die Wahrscheinlichkeiten dieser Stichproben:\n\n\n\n\n\nWir zählen (`count`) also die Stichproben, die sich für einen Wasseranteil (`p_grid`) von weniger als 50% aussprechen:\n\n\n::: {.cell hash='Post_cache/html/QM2-Thema3-Post-befragen-7_e855fece2af5f6e631e1e8511de4d44a'}\n\n```{.r .cell-code}\nsamples %>%\n  count(p_grid < .5) \n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|p_grid < 0.5 |    n|\n|:------------|----:|\n|FALSE        | 8399|\n|TRUE         | 1601|\n\n</div>\n:::\n:::\n\n\nDa wir insgesamt 10000 (1e4) Stichproben gezogen haben, können wir noch durch diese Zahl teilen, um einen Anteil zu bekommen.\nDieser Anteil ist die Antwort auf die Forschungsfrage: \nWie Wahrscheinlichkeit (laut Modell) für einen Wasseranteil kleiner als 50%.^[Der Befehl `count` macht Folgendes: Er gruppiert die Stichprobe nach dem Prüfkriterium, Wasseranteil höchstens 50%. Dann zählt er in jeder der beiden Teiltabelle die Zeilen und liefert diese zwei Zahlen dann zurück. Man könnte also auch in etwa schreiben:\n\n\n::: {.cell hash='Post_cache/html/QM2-Thema3-Post-befragen-6_7869da8e54dce83872f0909b35c9a66e'}\n\n```{.r .cell-code}\nd %>%\n  filter(p_grid < .5) %>%\n  summarise(sum = sum(post))\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|     sum|\n|-------:|\n| 0.16653|\n\n</div>\n:::\n:::\n\n\n\nEinfach wie 🍰 essen.\n\n\n\n\n\n:::{#exm-param2}\n\n## Wasseranteil zwischen 50 und 75%?\n\nNoch eine Forschungsfrage: *Mit welcher Wahrscheinlichkeit liegt der Parameter (Wasseranteil) zwischen 0.5 und 0.75?*\n\n\n\n::: {.cell hash='Post_cache/html/QM2-Thema3-Post-befragen-8_a5b2c2bb5e345412fedc2a11f08acb20'}\n\n```{.r .cell-code}\nsamples %>% \n  count(p_grid > .5 & p_grid < .75)\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|p_grid > 0.5 & p_grid < 0.75 |    n|\n|:----------------------------|----:|\n|FALSE                        | 4513|\n|TRUE                         | 5487|\n\n</div>\n:::\n:::\n\n::: {.cell hash='Post_cache/html/QM2-Thema3-Post-befragen-8a_44c2557962c18d494092a99fd671df4c'}\n\n```{.r .cell-code}\nsamples %>% \n  count(p_grid > .5 & p_grid < .75) %>% \n  summarise(Anteil = n / 1e4,\n            Prozent = 100 * n / 1e4)  # In Prozent\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n| Anteil| Prozent|\n|------:|-------:|\n| 0.4513|   45.13|\n| 0.5487|   54.87|\n\n</div>\n:::\n:::\n\n\nAnteile von `count()` könnte man, wenn man möchte, auch `filter()` verwenden:\n\n\n\n::: {.cell hash='Post_cache/html/unnamed-chunk-2_f9ac3bd2509107bf19e28370920c0768'}\n\n```{.r .cell-code}\nsamples %>% \n  filter(p_grid > .5 & p_grid < .75) %>% \n  summarise(sum     =       n() / 1e4,\n            anteil = 100 * n() / 1e4)  # In Prozent\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|    sum| anteil|\n|------:|------:|\n| 0.5376|  53.76|\n\n</div>\n:::\n:::\n\n\n\n:::\n\n:::{#exm-param3}\n\n## Wasseranteil zwischen 90 und 100%?\n\nNoch ein Beispiel für eine Forschungsfrage: Mit welcher Wahrscheinlichkeit liegt der Parameter zwischen 0.9 und 1?\n\n\n::: {.cell hash='Post_cache/html/QM2-Thema3-Post-befragen-9_5de5ff1a8856948c4574398978b6f4bd'}\n\n```{.r .cell-code}\nsamples %>% \n  count(p_grid >= .9 & p_grid <= 1) %>% \n  summarise(prop = 100 * n() / 1e4)  # prop wie \"proportion\", Anteil\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n| prop|\n|----:|\n| 0.01|\n\n</div>\n:::\n:::\n\n\nLaut unserem Modell ist es also sehr unwahrscheinlich, dass der Wasseranteil der Erde mind.  90% beträgt.\n\n\n:::\n\n### Fragen nach Parameterwerten\n\n::: callout-important\nSchätzbereiche von Parameterwerten nennt man auch *Konfidenz- oder Vertrauensintervall*^[Tatsächlich gibt es eine Vielzahl an Begriffen, die in der Literatur nicht immer konsistent verwendet werden, etwa Kompatibilitätsintervall, Ungewissheitsintervall, Passungsbereich.]\n:::\n\n\n\nWelcher Parameterwert wird mit 90% Wahrscheinlichkeit nicht überschritten, laut unserem Modell? (Gesucht sind also die unteren 90% der Posteriori-Wahrscheinlichkeit)\nWir möchten also ziemlich sicher, was die Obergrenze an Wasser auf diesem Planeten ist^[Vieleicht damit es genug Berge zum Schifahren gibt.].\n\n\n\n::: {.cell hash='Post_cache/html/QM2-Thema3-Post-befragen-11_fe3ba5429b903d9f4af4d9df062dd695'}\n\n```{.r .cell-code}\nsamples %>% \n  summarise(quantil90 = quantile(p_grid, p = .9))\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n| quantil90|\n|---------:|\n| 0.7777778|\n\n</div>\n:::\n:::\n\n\n\nLaut unserem Modell können wir zu 90% sicher sein, dass der Wasseranteil kleiner ist als ca. 78%.\n\nEs hilft vielleicht, sich die Post-Verteilung noch einmal vor Augen zu führen:\n\n\n::: {.cell hash='Post_cache/html/unnamed-chunk-3_f0de167e1129650be9bbdace40c6b4d8'}\n\n```{.r .cell-code}\nsamples %>% \n  ggplot(aes(x = p_grid)) +\n  geom_bar()\n```\n\n::: {.cell-output-display}\n![](Post_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n\n\n\nWas ist das *mittlere* Intervall, das mit 90% Wahrscheinlichkeit den Parameterwert enthält, laut dem Modell?\n\nDafür \"schneiden\" wir links und rechts die 5% der Stichproben mit den extremsten Werten ab und schauen, bei welchen Parameterwerten wir als Grenzwerte landen:\n\n\n::: {.cell hash='Post_cache/html/QM2-Thema3-Post-befragen-12_13d4efc341f200d8069033e8a37a1cf8'}\n\n```{.r .cell-code}\nsamples %>% \n  summarise(\n    quant_10 = quantile(p_grid, 0.05),\n    quant_90 = quantile(p_grid, 0.95))\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|  quant_10|  quant_90|\n|---------:|---------:|\n| 0.4444444| 0.8888889|\n\n</div>\n:::\n:::\n\n\n\nSolche Fragen lassen sich also mit Hilfe von *Quantilen* beantworten.\n\n\n\n### Zur Erinnerung: Quantile\n\nBeispiel: Wie groß sind die Studentis ([Quelle des Datensatzes](https://rdrr.io/cran/openintro/man/speed_gender_height.html))? \n\nDas Quantil von z.B. 25% zeigt die Körpergröße der 25% kleinsten Studentis an, analog für 50%, 75%, in Inches^[1 Inch entspricht 2.54cm]:\n\n\n::: {.cell hash='Post_cache/html/QM2-Thema3-Teil1-5_604e480a4b0f2f009741329bb752bc4c'}\n\n```{.r .cell-code}\nspeed_gender_height <- read_csv(\"https://raw.githubusercontent.com/rpruim/OpenIntro/master/data/speed_gender_height.csv\")\n\nheight_summary <- \n  speed_gender_height %>% \n  mutate(height_cm = height*2.54) %>% \n  select(height_inch = height, height_cm) %>% \n  drop_na() %>% \n  pivot_longer(everything(), names_to = \"Einheit\", values_to = \"Messwert\") %>% \n  group_by(Einheit) %>% \n  summarise(q25 = quantile(Messwert, prob = .25),\n            q50 = quantile(Messwert, prob = .5),\n            q75 = quantile(Messwert, prob = .75))\n\nheight_summary\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|Einheit     |    q25|    q50|    q75|\n|:-----------|------:|------:|------:|\n|height_cm   | 160.02| 167.64| 175.26|\n|height_inch |  63.00|  66.00|  69.00|\n\n</div>\n:::\n:::\n\n\nDas 25%-Quantil nennt man auch 1. Quartil; das 50%-Quantil (Median) auch 2. Quartil und das 75%-Quantil auch 3. Quartil.\n\n\nAbb. @fig-stud-height visualisiert die Quantile und die Häufigkeitsverteilung.\n\n\n::: {.cell hash='Post_cache/html/fig-stud-height_2ec9ded767090c6ed4d40cd12825e715'}\n::: {.cell-output-display}\n![Größenverteilung von 1325 amerikanischen Studentis](Post_files/figure-html/fig-stud-height-1.png){#fig-stud-height width=960}\n:::\n:::\n\n\n\n###  Den Quantilen unter die Motorhaube geschaut\n\nDen R-Befehl `quantile()` kann man sich, wenn man will, einfach nachbauen und entmystifizieren.\n\nAngenommen, wir wollen wissen, welcher Wasseranteil mit 90% Wahrscheinlichkeit nicht überschritten wird.\nDas können wir mit im Datensatz `samples` so erreichen.\n\n1. Sortiere die Stichproben aufsteigend.\n2. Schneide die oberen 10% ab.\n3. Schaue, was der größte verbleibende Wert ist.\n\n\n::: {.cell hash='Post_cache/html/unnamed-chunk-4_36ff6484236032e6b801f92d7d01f0bf'}\n\n```{.r .cell-code}\nsamples %>% \n  arrange(p_grid) %>%   # sortiere\n  slice_head(n = 9000) %>%  # nur die ersten 90000, also die obersten 1000 abschneiden\n  summarise(p90 = max(p_grid))\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|       p90|\n|---------:|\n| 0.7777778|\n\n</div>\n:::\n:::\n\n\n\nDas (annähernd) gleiche Ergebnis liefert `quantile()`:\n\n\n::: {.cell hash='Post_cache/html/unnamed-chunk-5_10fd2b27ae2827f7c7ab19e9abc0f7bd'}\n\n```{.r .cell-code}\nsamples %>% \n  summarise(q90 = quantile(p_grid, .9))\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|       q90|\n|---------:|\n| 0.7777778|\n\n</div>\n:::\n:::\n\n\n\n### Visualisierung der Intervalle\n\nIntervalle (Bereiche), die die \"abzuschneidende\" Wahrscheinlichkeitsmasse hälftig auf die beiden Ränder aufteilen, nennen wir *Perzentilintervalle* oder *Equal-Tails-Intervalle* (ETI), s. Abb. @fig-eti, rechtes Teildiagramm.\n\n\n\n\n::: {.cell hash='Post_cache/html/fig-eti_ef4156e979991398976df330d0900796'}\n::: {.cell-output-display}\n![Perzintilintervalle](Post_files/figure-html/fig-eti-1.png){#fig-eti width=672}\n:::\n:::\n\n\n\n\n## Schiefe Posteriori-Verteilungen sind möglich\n\n\nNoch einmal zum Globusversuch: Gehen wir von 3 Würfen mit 3 Treffern aus; auf welche Wasseranteile (Parameterwerte) werden wir jetzt schließen?\n\nVermutlich ziemlich hohe.\n\nErstellen wir uns dazu mal eine Post-Verteilung (3 Treffer, 3 Würfe):\n\n\n::: {.cell hash='Post_cache/html/QM2-Thema3-Post-befragen-13_906ea5b11ee6da235b3ea23a9c3c6974'}\n\n```{.r .cell-code}\nd_33 <- \n  tibble(p_grid = seq(0,1, by =.01),\n         prior = 1) %>% \n  mutate(likelihood = dbinom(3, size = 3, prob = p_grid)) %>% \n  mutate(unstand_post = likelihood * prior) %>% \n  mutate(post_33  = unstand_post / sum(unstand_post)) \n\nsamples_33 <- \n  d_33 %>% \n    slice_sample(n = 1e4, \n                 weight_by = post_33, \n                 replace = T)\n```\n:::\n\n\nSo sehen die ersten paar Zeilen der Post-Verteilung, `samples_33`, aus.\n\n\n::: {.cell hash='Post_cache/html/QM2-Thema3-Post-befragen-14_93bb68373aa9147a24be14b394b30b13'}\n::: {.cell-output-display}\n```{=html}\n<div id=\"bqchoxdkax\" style=\"overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>html {\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;\n}\n\n#bqchoxdkax .gt_table {\n  display: table;\n  border-collapse: collapse;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#bqchoxdkax .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#bqchoxdkax .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#bqchoxdkax .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 0;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#bqchoxdkax .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#bqchoxdkax .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#bqchoxdkax .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#bqchoxdkax .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#bqchoxdkax .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#bqchoxdkax .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#bqchoxdkax .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#bqchoxdkax .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#bqchoxdkax .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#bqchoxdkax .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#bqchoxdkax .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#bqchoxdkax .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#bqchoxdkax .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#bqchoxdkax .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#bqchoxdkax .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#bqchoxdkax .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#bqchoxdkax .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#bqchoxdkax .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#bqchoxdkax .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#bqchoxdkax .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#bqchoxdkax .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#bqchoxdkax .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#bqchoxdkax .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#bqchoxdkax .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#bqchoxdkax .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-left: 4px;\n  padding-right: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#bqchoxdkax .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#bqchoxdkax .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#bqchoxdkax .gt_left {\n  text-align: left;\n}\n\n#bqchoxdkax .gt_center {\n  text-align: center;\n}\n\n#bqchoxdkax .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#bqchoxdkax .gt_font_normal {\n  font-weight: normal;\n}\n\n#bqchoxdkax .gt_font_bold {\n  font-weight: bold;\n}\n\n#bqchoxdkax .gt_font_italic {\n  font-style: italic;\n}\n\n#bqchoxdkax .gt_super {\n  font-size: 65%;\n}\n\n#bqchoxdkax .gt_footnote_marks {\n  font-style: italic;\n  font-weight: normal;\n  font-size: 75%;\n  vertical-align: 0.4em;\n}\n\n#bqchoxdkax .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#bqchoxdkax .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#bqchoxdkax .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#bqchoxdkax .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#bqchoxdkax .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#bqchoxdkax .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\">\n  \n  <thead class=\"gt_col_headings\">\n    <tr>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\">p_grid</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\">prior</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\">likelihood</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\">unstand_post</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td class=\"gt_row gt_right\">1.00</td>\n<td class=\"gt_row gt_right\">1</td>\n<td class=\"gt_row gt_right\">1.00</td>\n<td class=\"gt_row gt_right\">1.00</td></tr>\n    <tr><td class=\"gt_row gt_right\">0.91</td>\n<td class=\"gt_row gt_right\">1</td>\n<td class=\"gt_row gt_right\">0.75</td>\n<td class=\"gt_row gt_right\">0.75</td></tr>\n    <tr><td class=\"gt_row gt_right\">0.93</td>\n<td class=\"gt_row gt_right\">1</td>\n<td class=\"gt_row gt_right\">0.80</td>\n<td class=\"gt_row gt_right\">0.80</td></tr>\n    <tr><td class=\"gt_row gt_right\">0.98</td>\n<td class=\"gt_row gt_right\">1</td>\n<td class=\"gt_row gt_right\">0.94</td>\n<td class=\"gt_row gt_right\">0.94</td></tr>\n    <tr><td class=\"gt_row gt_right\">0.71</td>\n<td class=\"gt_row gt_right\">1</td>\n<td class=\"gt_row gt_right\">0.36</td>\n<td class=\"gt_row gt_right\">0.36</td></tr>\n    <tr><td class=\"gt_row gt_right\">0.88</td>\n<td class=\"gt_row gt_right\">1</td>\n<td class=\"gt_row gt_right\">0.68</td>\n<td class=\"gt_row gt_right\">0.68</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\n\nMit dieser \"schiefen\" Post-Verteilung können wir gut die Auswirkungen auf das Perzentil- und das Höchste-Dichte-Intervall anschauen.\n\n\n### 50%-Perzentil-Intervall\n\nHier z.B. ein 50%-Perzentilintervall, s. Abb. @fig-schief-pi.\n\n\n::: {.cell hash='Post_cache/html/fig-schief-pi_49001b2184b1c5272854427d6e9fa1f5'}\n::: {.cell-output-display}\n![Ein Perzentilintervall kann, wenn es dumm läuft, den wahrscheinlichsten Parameterwert nicht enthalten, diesen Wert also plausiblen Wert also zurückweisen. Das ist nicht so toll.](Post_files/figure-html/fig-schief-pi-1.png){#fig-schief-pi width=672}\n:::\n:::\n\n\nDie Grenzwerte dieses ETI (oder jedes beliebig breiten) kann man sich z.B. so ausgeben lassen:\n\n\n::: {.cell hash='Post_cache/html/unnamed-chunk-6_6a06b9a62442a8f24f8ef140e90057d4'}\n\n```{.r .cell-code}\nlibrary(easystats)\n\nsamples_33 %>% \n  select(p_grid) %>% \n  eti(ci = .5)\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|Parameter |  CI| CI_low| CI_high|\n|:---------|---:|------:|-------:|\n|p_grid    | 0.5|   0.71|    0.94|\n\n</div>\n:::\n:::\n\n\n\n\nDer wahrscheinlichste Parameterwert (1) ist *nicht* im Intervall enthalten.\nDas ist ein Nachteil der ETI.\n\n\n\n\n### 50%-Intervall höchster Dichte\n\nIntervalle höchster Dichte (Highest density Intervals, HDI oder HDPI) sind definiert als die *schmälsten* Intervalle, die den gesuchten Parameter enthalten.\n\n\n\n::: {.cell hash='Post_cache/html/unnamed-chunk-7_f461f420242d714f46ab13b47a931b36'}\n::: {.cell-output-display}\n![](Post_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n\n\n\nDer wahrscheinlichste Parameterwert (1) *ist* im Intervall enthalten, was Sinn macht.\nBei einem HDI sind die abgeschnitten Ränder nicht mehr gleich groß, im Sinne von enthalten nicht (zwangsläufig) die gleiche Wahrscheinlichkeitsmasse. \n\n\nJe symmetrischer die Verteilung, desto näher liegen die Punktschätzer aneinander (und umgekehrt), s. Abb. @fig-schief-post-pointestimates.\n\n\n\n::: {.cell hash='Post_cache/html/Visualisierung der Punktschätzer bei einer schiefen Post-Verteilung_6d9814fd1606a6dec984bd0292e2721c'}\n::: {.cell-output-display}\n![fig-schief-post-pointestimates](Post_files/figure-html/Visualisierung der Punktschätzer bei einer schiefen Post-Verteilung-1.png){width=672}\n:::\n:::\n\n\n\n\n\nSo kann man sich die Grenzwerte eines 50%-HDI ausgeben lassen:\n\n\n\n::: {.cell hash='Post_cache/html/hdi-samples-50_2fde804858b0490307abc548b3f79256'}\n\n```{.r .cell-code}\nsamples %>% \n  select(p_grid) %>% \n  bayestestR::hdi(ci = .5)  # aus dem Paket `bayestestR`\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|Parameter |  CI|    CI_low|   CI_high|\n|:---------|---:|---------:|---------:|\n|p_grid    | 0.5| 0.6666667| 0.7777778|\n\n</div>\n:::\n:::\n\n\nDas Modell ist sich also zu 50% sicher, dass der gesuchte Parameter (der Wasseranteil der Erdoberfläche) sich in diesem Bereich befindet (auf Basis eines HDI).\n\n\n:::callout-note\nDas R-Paket `{bayestestR}` ist Teil des Meta-Pakets `{easystats}`.\nEs reicht, wenn Sie `easystats` laden, damit wird `bayestestR` automatisch geladen.\n:::\n\n\n## Fazit\n\n\n### Intervalle höchster Dichte vs. Perzentilintervalle\n\n- Bei symmetrischer Posteriori-Verteilung sind beide Intervalle ähnlich\n- Perzentilintervalle sind verbreiteter\n- *Intervalle höchster Dichte* (Highest Density Interval, HDI) sind bei schiefen Post-Verteilungen zu bevorzugen\n- Intervalle höchster Dichte sind die *schmalsten* Intervalle für eine gegebene Wahrscheinlichkeitsmasse\n\n\n\n\n### Zusammenfassung\n\nFassen wir zentrale Punkte an einem Beispiel zusammen.\n\nIm Globusversuch, Datendatz `samples`, s. Syntax @lst-post-sample. Sagen wir, wir haben 6 Treffer bei 9 Würfen erzielt.\n\n\n\n\nLageparmameter: Welchen mittleren Wasseranteil muss man annehmen?\n\n\n::: {.cell hash='Post_cache/html/QM2-Thema3-Post-befragen-19_cdc979f8967fad18e6c8d779ed57501d'}\n\n```{.r .cell-code}\nsamples %>% \n  summarise(\n    mean   = mean(p_grid),\n    median = median(p_grid))  \n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|      mean|    median|\n|---------:|---------:|\n| 0.6380556| 0.6666667|\n\n</div>\n:::\n:::\n\n\nStreuungsparameter: Wie unsicher sind wir in der Schätzung des Wasseranteils?\n\n\n::: {.cell hash='Post_cache/html/QM2-Thema3-Post-befragen-20_43f7e9099fe183e5f4c5a1c24d5e8a64'}\n\n```{.r .cell-code}\nsamples %>% \n  summarise(\n    p_sd   = sd(p_grid),\n    p_iqr = IQR(p_grid),\n    p_mad = mad(p_grid))  \n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|      p_sd|     p_iqr|     p_mad|\n|---------:|---------:|---------:|\n| 0.1380887| 0.2222222| 0.1647333|\n\n</div>\n:::\n:::\n\n\nAnstelle der Streuungsparameter ist es aber üblicher, ein HDI oder PI anzugeben.\n\n\n\n\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}