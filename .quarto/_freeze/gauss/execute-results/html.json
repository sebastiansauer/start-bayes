{
  "hash": "a50fc7e88ba06dde908c9ad8c515abb1",
  "result": {
    "markdown": "---\noutput: html_document\neditor_options: \n  chunk_output_type: console\n---\n\n# Gauss-Modelle\n\n\n![Bayes:Start!](img/Golem_hex.png){width=10%}\n\n\n\n\n## Software\n\nF√ºr dieses Thema ben√∂tigen Sie einige R-Pakete, die Sie wie folgt installieren k√∂nnen:\n\n\n::: {.cell hash='gauss_cache/html/install-libs_d44708dd0d07ecabdb1e844118f9472d'}\n\n```{.r .cell-code}\npakete <- c(\"tidyverse\", \"rstanarm\", \"easystats\")\n\ninstall.packages(pakete)\n```\n:::\n\n\nF√ºr `rstanarm` wird [weitere Software](https://github.com/stan-dev/rstan/wiki/RStan-Getting-Started) ben√∂tigt.\n\n:::callout-note\nSoftware, und das sind R-Pakete, m√ºssen Sie nur einmalig installieren. Aber bei jedem\nStart von R bzw. RStudio m√ºssen Sie die (ben√∂tigten!) Pakete starten.\n:::\n\n\n\n\n\n::: {.cell hash='gauss_cache/html/load-libs-non-hidden_14b66b01ac17a58fa8ef2f8f6070bb9a'}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(rstanarm)\nlibrary(easystats)\n```\n:::\n\n\n\n## Wie gro√ü sind die !Kung San?\n\nDieser Abschnitt basiert auf @mcelreath_statistical_2020, Kap. 4.3.\n\n### !Kung San \n\n\n\n\n::: {.cell hash='gauss_cache/html/Kung-1_9c6421e449389d51f350b5876de7aa62'}\n::: {.cell-output-display}\n![](https://upload.wikimedia.org/wikipedia/commons/b/b5/Wandering_hunters_%28Masarwa_bushmen%29%2C_North_Kalahari_Desert.jpg)\n:::\n:::\n\n\n\n\n\n\n[Quelle](https://upload.wikimedia.org/wikipedia/commons/b/b5/Wandering_hunters_%28Masarwa_bushmen%29%2C_North_Kalahari_Desert.jpg) Internet Archive Book Images, No restrictions, via Wikimedia Commons]\n\n\n\n\n::: {.cell hash='gauss_cache/html/Kung-2_6e2239eb169aadf174d4992a1a5b4f25'}\n::: {.cell-output-display}\n![](https://upload.wikimedia.org/wikipedia/commons/thumb/2/21/KhoisanLanguagesModernDistribution.png/1024px-KhoisanLanguagesModernDistribution.png)\n:::\n:::\n\n\n\nBy Andrewwik.0 - Own work, CC BY-SA 4.0, [Quelle](https://commons.wikimedia.org/w/index.php?curid=79801340)]\n\n\n\n### !Kung Data\n\n\n\n[Datenquelle](https://raw.githubusercontent.com/sebastiansauer/2021-wise/main/Data/Howell1a.csv)\n\n\n\n::: {.cell hash='gauss_cache/html/Post-Regression-3_46efaf36422ee29459ef6784b06ceb42'}\n\n```{.r .cell-code}\nKung_path <-  \n  \"https://raw.githubusercontent.com/sebastiansauer/Lehre/main/data/Howell1a.csv\"  \n\nd <- read_csv(Kung_path)  \n\nhead(d)\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|  height|   weight| age| male|\n|-------:|--------:|---:|----:|\n| 151.765| 47.82561|  63|    1|\n| 139.700| 36.48581|  63|    0|\n| 136.525| 31.86484|  65|    0|\n| 156.845| 53.04191|  41|    1|\n| 145.415| 41.27687|  51|    0|\n| 163.830| 62.99259|  35|    1|\n\n</div>\n:::\n:::\n\n\n\nWir interessieren uns f√ºr die Gr√∂√üe der erwachsenen !Kung:\n\n::: {.cell hash='gauss_cache/html/Kung-5_e523b35e1c11466858955ce1c88aa16c'}\n\n```{.r .cell-code}\nd2 <- d %>% \n  filter(age >= 18)\n```\n:::\n\n\n\n$N=352$.\n\n\n::: {.cell hash='gauss_cache/html/Kung-7_24758a814cb0f5b57a0a46109a1cde74'}\n\n```{.r .cell-code}\ndescribe_distribution(d2)\n```\n:::\n\n::: {.cell hash='gauss_cache/html/Kung-7a_4371545a4649fbf1d844193d664414e4'}\n::: {.cell-output-display}\n```{=html}\n<div id=\"ionakbtmik\" style=\"overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>html {\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;\n}\n\n#ionakbtmik .gt_table {\n  display: table;\n  border-collapse: collapse;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#ionakbtmik .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ionakbtmik .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#ionakbtmik .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 0;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#ionakbtmik .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ionakbtmik .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ionakbtmik .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#ionakbtmik .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#ionakbtmik .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#ionakbtmik .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#ionakbtmik .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#ionakbtmik .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#ionakbtmik .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#ionakbtmik .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#ionakbtmik .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#ionakbtmik .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#ionakbtmik .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ionakbtmik .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#ionakbtmik .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#ionakbtmik .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ionakbtmik .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#ionakbtmik .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#ionakbtmik .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ionakbtmik .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ionakbtmik .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#ionakbtmik .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#ionakbtmik .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ionakbtmik .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ionakbtmik .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-left: 4px;\n  padding-right: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ionakbtmik .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ionakbtmik .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ionakbtmik .gt_left {\n  text-align: left;\n}\n\n#ionakbtmik .gt_center {\n  text-align: center;\n}\n\n#ionakbtmik .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#ionakbtmik .gt_font_normal {\n  font-weight: normal;\n}\n\n#ionakbtmik .gt_font_bold {\n  font-weight: bold;\n}\n\n#ionakbtmik .gt_font_italic {\n  font-style: italic;\n}\n\n#ionakbtmik .gt_super {\n  font-size: 65%;\n}\n\n#ionakbtmik .gt_footnote_marks {\n  font-style: italic;\n  font-weight: normal;\n  font-size: 75%;\n  vertical-align: 0.4em;\n}\n\n#ionakbtmik .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#ionakbtmik .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#ionakbtmik .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#ionakbtmik .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#ionakbtmik .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#ionakbtmik .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\">\n  \n  <thead class=\"gt_col_headings\">\n    <tr>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\">Variable</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\">Mean</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\">SD</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\">IQR</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\">Min</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\">Max</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\">Skewness</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\">Kurtosis</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\">n</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\">n_Missing</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td class=\"gt_row gt_left\">height</td>\n<td class=\"gt_row gt_right\">154.59709</td>\n<td class=\"gt_row gt_right\">7.74</td>\n<td class=\"gt_row gt_right\">12.06</td>\n<td class=\"gt_row gt_right\">136.53</td>\n<td class=\"gt_row gt_right\">179.07</td>\n<td class=\"gt_row gt_right\">0.15</td>\n<td class=\"gt_row gt_right\">‚àí0.48</td>\n<td class=\"gt_row gt_right\">352.00</td>\n<td class=\"gt_row gt_right\">0.00</td></tr>\n    <tr><td class=\"gt_row gt_left\">weight</td>\n<td class=\"gt_row gt_right\">44.99049</td>\n<td class=\"gt_row gt_right\">6.46</td>\n<td class=\"gt_row gt_right\">9.19</td>\n<td class=\"gt_row gt_right\">31.07</td>\n<td class=\"gt_row gt_right\">62.99</td>\n<td class=\"gt_row gt_right\">0.13</td>\n<td class=\"gt_row gt_right\">‚àí0.51</td>\n<td class=\"gt_row gt_right\">352.00</td>\n<td class=\"gt_row gt_right\">0.00</td></tr>\n    <tr><td class=\"gt_row gt_left\">age</td>\n<td class=\"gt_row gt_right\">41.13849</td>\n<td class=\"gt_row gt_right\">15.97</td>\n<td class=\"gt_row gt_right\">23.00</td>\n<td class=\"gt_row gt_right\">18.00</td>\n<td class=\"gt_row gt_right\">88.00</td>\n<td class=\"gt_row gt_right\">0.67</td>\n<td class=\"gt_row gt_right\">‚àí0.21</td>\n<td class=\"gt_row gt_right\">352.00</td>\n<td class=\"gt_row gt_right\">0.00</td></tr>\n    <tr><td class=\"gt_row gt_left\">male</td>\n<td class=\"gt_row gt_right\">0.46875</td>\n<td class=\"gt_row gt_right\">0.50</td>\n<td class=\"gt_row gt_right\">1.00</td>\n<td class=\"gt_row gt_right\">0.00</td>\n<td class=\"gt_row gt_right\">1.00</td>\n<td class=\"gt_row gt_right\">0.13</td>\n<td class=\"gt_row gt_right\">‚àí2.00</td>\n<td class=\"gt_row gt_right\">352.00</td>\n<td class=\"gt_row gt_right\">0.00</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\n\n\n### Wir gehen apriori von normalverteilter Gr√∂√üe Der !Kung aus\n\n\n\n::: {.cell hash='gauss_cache/html/Kung-8_50e3ed42a17a5d1b50c021fa68a7605b'}\n::: {.cell-output-display}\n![](https://upload.wikimedia.org/wikipedia/commons/8/83/SVG_Human_Silhouette.svg){width=25%}\n:::\n:::\n\n\n\nOwn alterations andFile:SVG_Human_With_All_Organs.svg by Madhero88, CC BY-SA 3.0 <https://creativecommons.org/licenses/by-sa/3.0>, via Wikimedia Commons\n\n$$\\mu \\sim \\mathcal{N}(178, 20)$$\n\n\nWarum 178 cm? Kein besonderer Grund. Hier wollen wir den Effekt verschiedener Priori-Werte untersuchen.\nIn einer echten Untersuchung sollte man immer einen inhaltlichen Grund f√ºr einen Priori-Wert haben.\n*Oder* man w√§hlt \"schwach informative\" Prioris, wie das `{rstanarm}` tut:\nDamit l√§sst man kaum Vorab-Information in das Modell einflie√üen,\naber man verhindert extreme Prioris, die meistens unsinnig sind (so wie eine SD von 100 Metern in diesem Fall).\n\n\n\n\n\n::: {.cell hash='gauss_cache/html/Kung-9_f7cf36afa792cc87e79c3303f55850db'}\n\n:::\n\n\n\n\n### Unser Gauss-Modell der !Kung\n\nWir nehmen an, dass $\\mu$ und $h_i$ normalverteilt sind und $\\sigma$ exponentialverteilt (da notwendig positiv) ist:\n\n\n\nLikelihood:\n\n$h_i \\sim \\mathcal{N}(\\mu, \\sigma)$\n\nPrior f√ºr $\\mu$:\n\n$\\mu \\sim \\mathcal{N}(178, 20)$\n\nPrior f√ºr $\\sigma$:\n\n$\\sigma \\sim \\mathcal{E}(0, 0.1)$\n\n</br>\n</br>\n\n$95\\%KI( \\mu):$\n\n$178 \\pm 40$\n\n\nHier sind unsere Priori-Verteilungen visualisiert:\n\n\n\n::: {.cell hash='gauss_cache/html/Kung-10_96d8114bb3db27ca0f014b550c0e99b7'}\n::: {.cell-output-display}\n![](gauss_files/figure-html/Kung-10-1.png){width=672}\n:::\n:::\n\n\n\n\n\n## Priori gewichtet mit Likelihood ergibt Posteriori\n\n\nZu Erinnerung: Die Posteriori-Wahrscheinlichkeit ist das Ergebnis von Priori-Wahrscheinlichkeit und Likelihood.\n\n\n### Likelihood\n\nDie K√∂rpergr√∂√üen der einzelnen Personen $h_i$ sind normalverteilt mit Mittelwert $\\mu$ und Streuung $\\sigma$:\n\n$$h_i \\sim \\mathcal{N}(\\color{blue}{\\mu},\\color{green}{\\sigma})$$\n\n\n### Prioris\n\nMittelwert der Gr√∂√üe ist normalverteilt mit $\\mu=178$ und $\\sigma=20$:\n\n$$\\color{blue}{\\mu \\sim \\mathcal{N}(178, 20)}$$\n\nDie Streuung $\\sigma$ der Gr√∂√üen ist exponentialverteil mit $\\lambda = 0.1$.\n\n$$\\color{green}{\\sigma \\sim \\mathcal{E}(0.1)}$$\n\n## Zuf√§llige Motivationsseite\n\n\n\n::: {.cell hash='gauss_cache/html/Kung-18_d26185aefd0d549719fc2f35d2ca689d'}\n::: {.cell-output-display}\n![](https://raw.githubusercontent.com/sebastiansauer/QM2-Folien/main/img/pretty_good.gif)\n:::\n:::\n\n\n\n\n\n## Posteriori-Verteilung des Gr√∂√üen-Modells, `m41`\n\n\n\n\n::: {.cell hash='gauss_cache/html/Kung-4_7df48ca58ea6917ca05112939fa39489'}\n\n```{.r .cell-code}\nm41 <- stan_glm(height ~ 1, data = d2, refresh = 0)\nm41_post <- as_tibble(m41)\nnames(m41_post) <- c(\"mu\", \"sigma\")  # sch√∂nere Namen f√ºr die Spalten\n```\n:::\n\n\n\nDas Argument `refresh = 0` verhindert, dass die Dateils zum Ziehen der Stichproben am Bildschirm ausgegeben werden. Ich finde diese Ausgabe meist nicht informativ,\nso dass ich sie lieber unterdr√ºcke.\n\nF√ºr das Modell `m41` haben wir *keine* Prioris spezifiziert.\nWir greifen damit auf die Voreinstellung der Prioris von `rstanarm` zur√ºck.\nDas ist ok, aber wenn Sie Vorab-Wissen haben,\nsollten Sie das an `rstanarm` weitergeben, weil es ja schade w√§re,\nwenn Sie Wissen haben, das von Ihrem Modell nicht genutzt wird.\n\nPlotten wir mal die Posteriori-Verteilung von `m41`: \n\n\n::: {.cell hash='gauss_cache/html/echo- true_99f026da160088855822d0ccc97a1bea'}\n\n```{.r .cell-code}\nm41_post %>% \n  ggplot() +\n  aes(x = mu, y = sigma) %>% \n  geom_hex() +\n  scale_fill_viridis_c() \n```\n\n::: {.cell-output-display}\n![](gauss_files/figure-html/echo- true-1.png){width=672}\n:::\n:::\n\n\nDa das Modell zwei Parameter hat, k√∂nnen wir auch beide gleichzeitig plotten.\nWie man sieht, sind die beiden Parameter unkorreliert.\nIn anderen Modellen k√∂nnen die Parameter korreliert sein.\n\n\n\nHier noch eine andere Visualisierung:\n\n\n::: {.cell hash='gauss_cache/html/Kung-5-bis_7d8eb9f2ba59fbf3239100f8a9225907'}\n\n```{.r .cell-code}\np_m41_post <- \n  m41_post %>% \n  ggplot() +\n  aes(x = mu, y = sigma) +\n  geom_point(alpha = .1) \n\nggExtra::ggMarginal(p_m41_post, type = \"density\")\n```\n\n::: {.cell-output-display}\n![](gauss_files/figure-html/Kung-5-bis-1.png){width=672}\n:::\n:::\n\n\n\nNat√ºrlich k√∂nnen wir auch nur einen Parameter plotten:\n\n\n\n::: {.cell hash='gauss_cache/html/unnamed-chunk-1_50ea76d0d0ca412fd6a204a209802ab4'}\n\n```{.r .cell-code}\nm41_post %>% \n  ggplot(aes(x = mu)) + \n  geom_histogram()\n```\n\n::: {.cell-output-display}\n![](gauss_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n:::\n\n\n\n\n\n- Wir bekommen eine Wahrscheinlichkeitsverteilung f√ºr $\\mu$ und eine f√ºr $\\sigma$ (bzw. eine zweidimensionale Verteilung, f√ºr die $\\mu,\\sigma$-Paare).\n\n- Trotz des eher vagen Priors ist die Streuung Posteriori-Werte f√ºr $\\mu$ und $\\sigma$ klein: Die gro√üe Stichprobe hat die Priori-Werte √ºberstimmt.\n\n- Ziehen wir Stichproben aus der Posteriori-Verteilung, so k√∂nnen wir interessante Fragen stellen. \n\n\n\n\n### Hallo, Posteriori-Verteilung\n\n... wir h√§tten da mal ein paar Fragen an Sie. üïµ\n\n\n1. Mit welcher Wahrscheinlichkeit ist die mittlere !Kung-Person gr√∂√üer als 1,55m?\n2. Welche mittlere K√∂rpergr√∂√üe wird mit 95% Wahrscheinlichkeit nicht √ºberschritten, laut dem Modell?\n3. In welchem 90%-PI liegt $\\mu$ vermutlich?\n4. Mit welcher Unsicherheit ist die Sch√§tzung der mittleren K√∂rpergr√∂√üe behaftet?\n5. Was ist der mediane Sch√§tzwert der mittleren K√∂rpergr√∂√üe, sozusagen der \"Best Guess\"?\n\n\nAntworten folgen etwas weiter unten.\n\n\n\n\n\nAbschli√üend, eigentlich nur Spielerei, noch eine andere Visualisierung der Post-Verteilung von $\\mu$ und von $\\sigma$:\n\n\n::: {.cell fig.asp='1' hash='gauss_cache/html/Kung-22_01849c282e5fc56d19ebda3dee655668'}\n\n```{.r .cell-code}\nm41_post %>% \n  pivot_longer(mu:sigma) %>% \n  ggplot(aes(x = value)) + \n  geom_density(fill = \"grey33\") +\n  scale_y_continuous(NULL, breaks = NULL) +\n  xlab(NULL) +\n  theme(panel.grid = element_blank()) +\n  facet_wrap(~ name, scales = \"free\", \n             labeller = label_parsed,\n             nrow = 2)\n```\n\n::: {.cell-output-display}\n![](gauss_files/figure-html/Kung-22-1.png){width=672}\n:::\n:::\n\n\n\n\n\n### Posteriori-Stichproben mit `stan_glm()` berechnen \n\n- Mit `stan_glm()` k√∂nnen wir komfortabel die Posteriori-Verteilung berechnen. \n- Die Gittermethode wird nicht verwendet, aber die Ergebnisse sind - in bestimmten Situationen - √§hnlich.\n- Es werden aber auch viele Stichproben simuliert (sog. MCMC-Methode).\n- Gibt man keine Priori-Werte an, so greift die Funktion auf Standardwerte zur√ºck.\n\n\n\n::: {.cell hash='gauss_cache/html/Kung-23_71a8681a5d58b1fbf92ccb76d3dd1ade'}\n\n```{.r .cell-code}\nlibrary(rstanarm)  # Paket muss gestartet sein.\n\n# berechnet Post.-Vert.:\nstan_glm(\n  # modelldefinition:\n  AV ~ UV,\n  # Datensatz:\n  data = meine_daten\n)\n```\n:::\n\n\n\n\nModelldefinition:\n\n$h_i \\sim \\mathcal{N}(\\mu, \\sigma)$, Likelihood\n\n$\\mu \\sim \\mathcal{N}(155, 19)$, Prior Gr√∂√üenmittelwert\n\n$\\sigma \\sim \\mathcal{E}(0.13)$, Prior Streuung der Gr√∂√üen\n\n\n\n\n\n### Ausgabe von `stan_glm()`\n\n\n\n::: {.cell hash='gauss_cache/html/Kung-24_17c3abf544e3acf3e0b209c90f8f9fc8'}\n\n```{.r .cell-code}\nm41 <- stan_glm(height ~ 1, data = d2, refresh = 0)  # aus Paket rstanarm\n\nparameters(m41)  # aus Paket easystats\n```\n:::\n\n::: {.cell hash='gauss_cache/html/Kung-6_12de70b1c804c4c1216fb1e914815047'}\n::: {.cell-output-display}\nTable: Fixed effects\n\n|Parameter   | Median |           95% CI |   pd | % in ROPE |  Rhat |     ESS |                    Prior |\n|:-----------|:------:|:----------------:|:----:|:---------:|:-----:|:-------:|:------------------------:|\n|(Intercept) | 154.60 | (153.80, 155.42) | 100% |        0% | 1.000 | 2891.00 | Normal (154.60 +- 19.36) |\n:::\n:::\n\n\n\n\n\n## Wie tickt `stan_glm()`?\n\n\n\n\n::: {.cell hash='gauss_cache/html/Kung-7-bis_29d911202ac8b55e29b1148a0e88a261'}\n::: {.cell-output-display}\n![](https://mc-stan.org/rstanarm/reference/figures/stanlogo.png){width=10%}\n:::\n:::\n\n\n[Quelle](https://mc-stan.org/)\n\n- *Stan* ist eine Software zur Berechnung von Bayesmodellen; das Paket `rstanarm` stellt Stan f√ºr uns bereit.\n- `stan_glm()` ist f√ºr die Berechnung von Regressionsmodellen ausgelegt.\n- Will man nur die Verteilung einer Variablen (wie `heights`) sch√§tzen, so hat man man ... eine Regression ohne Pr√§diktor.\n- Eine Regression ohne Pr√§diktor schreibt man auf Errisch so: `y ~ 1`. Die `1` steht also f√ºr die nicht vorhandene UV; `y` meint die AV (`height`).\n- `MAD_SD` ist eine robuste Version der Streuung, mit inhaltlich gleicher Aussage\n- `(Intercept)` (Achsenabschnitt) gibt den Mittelwert an.\n\n\n\n[Dokumentation RstanArm](https://mc-stan.org/rstanarm/)\n\n\n\n### Stichproben aus der Posteriori-Verteilung ziehen\n\n\n\nHier die ersten paar Zeilen von `post_m41`:\n\n\n\n\n::: {.cell hash='gauss_cache/html/Kung-26_b551a7d2af245a3ea36a5f8c9363c90a'}\n\n```{.r .cell-code}\npost_m41 <- as_tibble(m41)\nhead(post_m41)\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n| (Intercept)|    sigma|\n|-----------:|--------:|\n|    154.8693| 7.958684|\n|    154.0783| 7.832770|\n|    154.4619| 7.773516|\n|    154.8380| 7.826417|\n|    154.4832| 7.762225|\n|    154.6501| 7.664231|\n\n</div>\n:::\n:::\n\n\n\n\nMit welcher Wahrscheinlichkeit ist $\\mu>155$? \n\n\n::: {.cell hash='gauss_cache/html/Kung-28_e04ee35338c0847d771a8fce889b84e5'}\n\n```{.r .cell-code}\nnames(post_m41) <- \n  c(\"mu\", \"sigma\")  # den Namen \"(Intercept)\" durch \"mu\" ersetzen, ist k√ºrzher\n\npost_m41 %>% \n  count(mu > 155) %>% \n  mutate(prop = n/sum(n))\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|mu > 155 |    n|    prop|\n|:--------|----:|-------:|\n|FALSE    | 3327| 0.83175|\n|TRUE     |  673| 0.16825|\n\n</div>\n:::\n:::\n\n\n\n### Antworten von der Posteriori-Verteilung\n\n\n\nWelche mittlere K√∂rpergr√∂√üe wird mit 95% Wahrscheinlichkeit nicht √ºberschritten, laut dem Modell `m41`?\n\n\n::: {.cell hash='gauss_cache/html/Kung-29_07d28d9817915bf028b8394057a3403c'}\n\n```{.r .cell-code}\npost_m41 %>% \n  summarise(q95 = quantile(mu, .95))\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|      q95|\n|--------:|\n| 155.2874|\n\n</div>\n:::\n:::\n\n\n\n\nIn welchem 90%-PI liegt $\\mu$ vermutlich?\n\n\n::: {.cell hash='gauss_cache/html/Kung-30_393983429803d815c9bd8ae6d40a4729'}\n\n```{.r .cell-code}\npost_m41 %>% \n  summarise(pi_90 = quantile(mu, c(0.05, 0.95)))\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|    pi_90|\n|--------:|\n| 153.8988|\n| 155.2874|\n\n</div>\n:::\n:::\n\n\n\nMit welcher Unsicherheit ist die Sch√§tzung der mittleren K√∂rpergr√∂√üe behaftet?\n\n\n\n\n::: {.cell hash='gauss_cache/html/unnamed-chunk-2_5313037b26ec30aa0aa976cfbae54316'}\n\n```{.r .cell-code}\nm41 %>% \n  parameters()\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|Parameter   |   Median|   CI|   CI_low|  CI_high| pd| ROPE_Percentage|     Rhat|      ESS|Prior_Distribution | Prior_Location| Prior_Scale|\n|:-----------|--------:|----:|--------:|--------:|--:|---------------:|--------:|--------:|:------------------|--------------:|-----------:|\n|(Intercept) | 154.5982| 0.95| 153.7981| 155.4165|  1|               0| 1.000277| 2890.841|normal             |       154.5971|    19.35583|\n\n</div>\n:::\n:::\n\n\n\n\n\nSeeing is believing:\n\n\n::: {.cell hash='gauss_cache/html/unnamed-chunk-3_2e67d6d009a5fd7c624db3972f178418'}\n\n```{.r .cell-code}\nm41 %>% \n  parameters() %>% \n  plot(show_intercept = TRUE)\n```\n\n::: {.cell-output-display}\n![](gauss_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n\nDas Modell ist sich recht sicher: die Ungewissheit der mittleren K√∂rpergr√∂√üe liegt bei nicht viel mehr als einem Zentimeter (95%-CI).\n\n\nWas ist der mediane Sch√§tzwert der mittleren K√∂rpergr√∂√üe, sozusagen der \"Best Guess\"?\n\n\n`parameters(m41)` hat uns die Antwort schon gegeben: Ca. 155 cm.\n\n\n\n\n\nüèãÔ∏è √Ñhnliche Fragen bleiben als √úbung f√ºr die Lesis ü§ì.\n\n\n\n### Standard-Prioriwerte bei `stan_glm()`\n\n\n::: {.cell hash='gauss_cache/html/Kung-8-bis_5240d013c8ef2c6d993b2319ee7f4c10'}\n\n```{.r .cell-code}\nprior_summary(m41)\n## Priors for model 'm41' \n## ------\n## Intercept (after predictors centered)\n##   Specified prior:\n##     ~ normal(location = 155, scale = 2.5)\n##   Adjusted prior:\n##     ~ normal(location = 155, scale = 19)\n## \n## Auxiliary (sigma)\n##   Specified prior:\n##     ~ exponential(rate = 1)\n##   Adjusted prior:\n##     ~ exponential(rate = 0.13)\n## ------\n## See help('prior_summary.stanreg') for more details\n```\n:::\n\n\n\n\n\n\n- `stan_glm()` verwendet (in der Voreinstellung) *schwach informative* Priori-Werte, die nur wenig Vorabwissen in das Modell geben.\n- Es werden daf√ºr die Stichproben-Daten als Priori-Daten verwendet.\n- Man sollte diese Standardwerte als Minimalvorschlag sehen. Kennt man sich im Sachgebiet aus, kann man meist bessere Prioris finden.\n- Die Voreinstellung hat keinen tiefen Hintergrund; andere Werte w√§ren auch denkbar.\n\n\n- `Intercept`: $\\mu$, der Mittelwert der Verteilung $Y$\n    - $\\mu \\sim \\mathcal{N}(\\bar{Y}, sd(Y)\\cdot 2.5)$\n    - als Streuung von $\\mu$ wird die 2.5-fache Streuung der Stichprobe (f√ºr $Y$) angenommen.\n\n- `Auxiliary (sigma)`: $\\sigma$, die Streuung der Verteilung $Y$\n    - $\\sigma \\sim \\mathcal{E}(\\lambda=1/sd(Y))$\n    - als \"Streuung\", d.h. $\\lambda$ von $h_i$ wird $\\frac{1}{sd(Y)}$ angenommen.\n    \n    \n   \n### Visualisierung verschiedener Exponentialverteilungen\n\nUm ein Gef√ºhl zu bekommen, wieviel Ungewissheit in Exponentialverteilugnen mit verschiedener Streuung liegt, sind hier mal ein paar Varianten dargestellt.\n\n\n::: {.cell hash='gauss_cache/html/Kung-9-bis_7a0a39980f2a7c33ef97638dde545359'}\n\n:::\n\n::: {.cell hash='gauss_cache/html/Kung-10-bis_0987c0e523c1fc603c749de1f649fe62'}\n\n:::\n\n::: {.cell hash='gauss_cache/html/Kung-11_08e148b332bc0b2cfb633cecfc5589df'}\n\n:::\n\n::: {.cell hash='gauss_cache/html/Kung-12-bis_a672e8ae0087386694d1e4796ea2b5eb'}\n\n:::\n\n::: {.cell hash='gauss_cache/html/Kung-13-bis_2c9db2e225b815a2db86e09243fb665d'}\n::: {.cell-output-display}\n![](gauss_files/figure-html/Kung-13-bis-1.png){width=672}\n:::\n:::\n\n\n\nEine sinnvolle Strategie ist, einen Prior so zu w√§hlen, dass man nicht √ºbergewiss ist,\nalso nicht zu sicher Dinge behauptet, die dann vielleicht doch passieren (also die Ungewissheit zu gering spezifiziert),\nandererseits sollte man extreme, unplausible Werte ausschle√üen.\n\n$\\lambda \\approx 0.1$ scheint eine sinnvolle Ungewissheit anzugeben.\n\n\n:::callout-important\nBei der Wahl der Prioris gibt es nicht die eine, richtige Wahl.\nDie beste Entscheidung ist auf transparente Art den Stand der Forschung einflie√üen zu lassen und eigene Entscheidungen zu begr√ºnden. H√§ufig sind mehrere Entscheidungen m√∂glich.\nM√∂chte man lieber vorsichtig sein, weil man wenig √ºber den Gegenstand wei√ü,\ndann k√∂nnte man z.B. auf die Voreinstellung von `rstanarm` vertrauen,\ndie \"schwachinformativ\" ist, also nur wenig Priori-Information  ind das Modell einflie√üen l√§sst.\n:::\n\n\n\n\n## Modell `m42`: unsere Priori-Werte \n\nIm Modell `m41` haben wir auf die Priori-Werte der Voreinstellung von `rstanarm` vertraut.\nJetzt lassen wir mal unsere eigenen Priori-Werte einflie√üen, im Modell `m42`.\n\n\n\n\n\n::: {.cell hash='gauss_cache/html/Kung-14-bis_b0b3e8714c72c66e4f0faf90cecdac74'}\n\n```{.r .cell-code}\nd2 <- \n  d2 %>% \n  mutate(height_c = height - mean(height))  # zentrieren\n```\n:::\n\n::: {.cell hash='gauss_cache/html/Kung-15-bis_74c4572c1fc67f68e3cbedda7c2128ea'}\n\n```{.r .cell-code}\nm42 <- \n  stan_glm(height ~ 1, \n           prior_intercept = normal(178, 20),  # mu\n           prior_aux = exponential(0.1),  # sigma\n           refresh = FALSE,  # bitte nicht so viel Ausgabe drucken\n           data = d2)\nparameters(m42)\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|Parameter   |   Median|   CI|   CI_low|  CI_high| pd| ROPE_Percentage|      Rhat|      ESS|Prior_Distribution | Prior_Location| Prior_Scale|\n|:-----------|--------:|----:|--------:|--------:|--:|---------------:|---------:|--------:|:------------------|--------------:|-----------:|\n|(Intercept) | 154.5993| 0.95| 153.8103| 155.4192|  1|               0| 0.9996511| 2829.642|normal             |            178|          20|\n\n</div>\n:::\n:::\n\n\n\nWir haben noch nicht alle Informationen kennengelernt, die hier ausgegeben werden.\nIm Zweifel: Einfach ignorieren. Wichtige F√§higkeit im Studium ü§ì.\n\n\n\n\n::: {.cell hash='gauss_cache/html/Kung-16-bis_1d364c0e6a1338f3e55de27eddd09ad4'}\n\n:::\n\n\n\n\n### Posteriori-Verteilung und Parameter plotten\n\n\n\n\n\n::: {.cell hash='gauss_cache/html/unnamed-chunk-4_52b8fafcdca088b77df4fb54e6fd07ee'}\n\n```{.r .cell-code}\nm42 %>% \n  as_tibble() %>% \n  ggplot(aes(x = `(Intercept)`)) +\n  geom_histogram()\n```\n\n::: {.cell-output-display}\n![](gauss_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n\nWie man sieht, sind sich die Post-Verteilungen von `m41` und `m42` ziemlich √§hnlich,\nkommen also zu dem gleichen Schluss, was die mittlere K√∂rpergr√∂√üe betrifft.\nDas ist ein Beispiel f√ºr eine Situation, wo eine ausreichend gro√üe Stichprobe die Wahl der Prioris (sofern nicht extrem) aussticht.\n\nEin Vergleich mehererer Priori-Werte w√§re auch n√ºtzlich, um ein skeptisches Publikum von der Wahl (bzw. der Indifferenz) der gew√§hlten Priori-Werte zu √ºberzeugen.\n\n\n\n## Fazit\n\n- Wir haben die Posteriori-Verteilung f√ºr ein Gauss-Modell  berechnet.\n- Dabei hatten wir ein einfaches Modell mit metrischer Zielvariablen, ohne Pr√§diktoren, betrachtet.\n- Die Zielvariable, K√∂rpergr√∂√üe (`height`), haben wir als normalverteilt mit den Parametern $\\mu$ und $\\sigma$ angenommen.\n- F√ºr $\\mu$ und $\\sigma$ haben wir jeweils keinen einzelnen (fixen) Wert angenommen, sondern eine Wahrscheinlichkeitsverteilung, der mit der Priori-Verteilung f√ºr $\\mu$ bzw. $\\sigma$ festgelegt ist.\n\n\n\n\nüß° Bleiben Sie dran!\n</br>\n\n\n::: {.cell hash='gauss_cache/html/Kung-33_4d3ac3a3c99e4e6360639f3cf0c7438c'}\n::: {.cell-output-display}\n![](https://github.com/sebastiansauer/QM2-Folien/raw/main/img/chicken_standard_deviation.jpg)\n:::\n:::\n\n\n\n\n\n\n\n\n\n\n\n## Wahl der Priori-Werte\n\n\nüèéÔ∏è Dieser Abschnitt ist eine VERTIEFUNG. üèé\n\n\n\n\n### Welche Beobachtungen sind auf Basis unseres Modells zu erwarten?\n\n\n\n\n\n::: {.cell hash='gauss_cache/html/prior-pred_70d59a4a65dc61efcdacb756f36c6262'}\n\n```{.r .cell-code}\nn <- 1e4\n\nsim <- tibble(sample_mu  = \n      rnorm(n, \n            mean = 178, \n            sd   = 20),\n    sample_sigma = \n      rexp(n, \n            rate = 0.1)) %>% \n  mutate(height  = \n      rnorm(n, \n            mean = sample_mu, \n            sd   = sample_sigma))\n\nheight_sim_sd <- \n  sd(sim$height) %>% round()\nheight_sim_mean <- \n  mean(sim$height) %>% round()\n```\n:::\n\n\n\nüí≠ Was denkt der Golem (`m41`) *apriori* von der Gr√∂√üe der !Kung?\n\nü¶æ Ziehen wir mal ein paar Stichproben auf Basis des Modells. Voil√†:\n\n\n\n::: {.cell hash='gauss_cache/html/Kung-12_7ae94bd5ab79e4c58bbf68c43688c26e'}\n\n```{.r .cell-code}\np3 <- \n  sim %>% \n  ggplot(aes(x = height)) +\n  geom_density(fill = \"grey33\") +\n  scale_x_continuous(breaks = c(0, 178-3*height_sim_sd, 178, 178+3*height_sim_sd)) +\n  scale_y_continuous(NULL, breaks = NULL) +\n  labs(title = \"height ~ dnorm(mu, sigma)\",\n       caption = \"X-Achse zeigt MW¬±3SD\",\n       x = \"Gr√∂√üe\") +\n  theme(panel.grid = element_blank()) \n\np3\n```\n\n::: {.cell-output-display}\n![](gauss_files/figure-html/Kung-12-1.png){width=672}\n:::\n:::\n\n\n\n\n\n\n[Quellcode](https://bookdown.org/content/4857/geocentric-models.html#a-gaussian-model-of-height)\n\n\n### Priori-Werte pr√ºfen mit der Priori-Pr√§diktiv-Verteilung\n\n- Die Priori-Pr√§diktiv-Verteilung (`sim`) simuliert Beobachtungen (nur) auf Basis der Priori-Annahmen: \n$h_i \\sim \\mathcal{N}(\\mu, \\sigma),$\n$\\mu \\sim \\mathcal{N}(178, 20),$\n$\\sigma \\sim \\mathcal{E}(0.1)$\n- So k√∂nnen wir pr√ºfen, ob die Priori-Werte vern√ºnftig sind.\n\n\nDie Priori-Pr√§diktiv-Verteilung zeigt, dass unsere Priori-Werte ziemlich vage sind, also einen zu breiten Bereich an Gr√∂√üenwerten zulassen:\n\n\n::: {.cell hash='gauss_cache/html/Kung-13_69c5e0ecaefd2de900e847c067065325'}\n\n```{.r .cell-code}\np3\n```\n\n::: {.cell-output-display}\n![](gauss_files/figure-html/Kung-13-1.png){width=672}\n:::\n:::\n\n\n\n\nAnteil $h_i > 200$:\n\n\n::: {.cell hash='gauss_cache/html/Kung-14_a854149db5cab363c8882fd2d71ee522'}\n\n```{.r .cell-code}\nanteil_gro√üer_kung <- \nsim %>% \n  count( height > 200) %>% \n  mutate(prop = n/sum(n))\nanteil_gro√üer_kung\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|height > 200 |    n|   prop|\n|:------------|----:|------:|\n|FALSE        | 8263| 0.8263|\n|TRUE         | 1737| 0.1737|\n\n</div>\n:::\n:::\n\n\n\nü§î Sehr gro√üe Buschleute? 17 Prozent sind gr√∂√üer als 2 Meter. Das ist diskutabel, muss aber nicht zwangsl√§ufig ein schlechter Prior sein.\n\n\n\n\n\n\n###  Vorhersagen der Priori-Werte\n\n\n\n::: {.cell hash='gauss_cache/html/Kung-15_242a52385589080b005e045ddaae32a5'}\n::: {.cell-output-display}\n![](gauss_files/figure-html/Kung-15-1.png){width=672}\n:::\n:::\n\n\n\n\n\n### Extrem vage Priori-Verteilung f√ºr die Streuung?\n\n\n$$\\sigma \\sim \\mathcal{E}(\\lambda=0.01)$$\n\n\n\n\n\n\n\n\n::: {.cell hash='gauss_cache/html/Kung-16_5dec1d389641cf0a82e811a29b9420a2'}\n\n```{.r .cell-code}\n# simulate\nset.seed(4)\n\nsim2 <-\n  tibble(sample_mu    = rnorm(n, mean = 178, sd = 100),\n         sample_sigma = rexp(n, rate = .01)) %>% \n  mutate(height = rnorm(n, mean = sample_mu, sd = sample_sigma))\n\n# compute the values we'll use to break on our x axis\nbreaks <-\n  c(mean(sim2$height) - 3 * sd(sim2$height), 0, mean(sim2$height), mean(sim2$height) + 3 * sd(sim2$height)) %>% \n    round(digits = 0)\n\n# this is just for aesthetics\ntext <-\n  tibble(height = 272 - 25,\n         y      = .0013,\n         label  = \"gr√∂√üter Mann\",\n         angle  = 90)\n\n# plot\np4 <-\n  sim2 %>% \n  ggplot(aes(x = height)) +\n  geom_density(fill = \"black\") +\n  geom_vline(xintercept = 0, color = \"grey92\") +\n  geom_vline(xintercept = 272, color = \"grey92\", linetype = 3) +\n  geom_text(data = text,\n            aes(y = y, label = label, angle = angle),\n            color = \"grey92\") +\n  scale_x_continuous(breaks = breaks, \n                     limits = c(-400, 700)) +\n  scale_y_continuous(NULL, breaks = NULL) +\n  labs(title = \"height ~ dnorm(mu, sigma)\\nmu ~ dnorm(178, 100)\\nsigma ~ E(0.01)\",\n       x = \"Gr√∂√üe\",\n       caption = \"X-Achse zeigt MW¬±3SD\") +\n  theme(panel.grid = element_blank()) \n\np4\n```\n\n::: {.cell-output-display}\n![](gauss_files/figure-html/Kung-16-1.png){width=672}\n:::\n:::\n\n\n\n\n\n\nDie Streuung der Gr√∂√üen ist weit:\n\n\n::: {.cell hash='gauss_cache/html/Kung-3_eedcd29dba0bd6f2b179eaa0cb9ea876'}\n\n```{.r .cell-code}\nd <- \n  tibble(x = seq(0,75, by =.01),\n         y = dexp(x, rate = .01))\n\nd %>% \n  ggplot(aes(x,y)) +\n  geom_line()\n```\n\n::: {.cell-output-display}\n![](gauss_files/figure-html/Kung-3-1.png){width=672}\n:::\n:::\n\n::: {.cell hash='gauss_cache/html/Kung-17_600c14e882136f5620768a5751de32c2'}\n\n:::\n\n\n\n\n\nü§î Das Modell geht apriori von ein paar Prozent Menschen mit *negativer* Gr√∂√üe aus. Ein Haufen Riesen üëπ werden auch erwartet. \n\nü§Ø   Vage (flache, informationslose, \"neutrale\", \"objektive\") Priori-Werte machen oft keinen Sinn, weil sie extreme, unplausible Werte zulassen.\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}