{"title":"Abschluss","markdown":{"headingText":"Abschluss","containsRefs":false,"markdown":"\n\n## Lernsteuerung\n\n### Lernziele\n\nNach Absolvieren des jeweiligen Kapitels sollen folgende Lernziele erreicht sein.\n\nSie k√∂nnen ... \n\n- erl√§utern, wie Sie eine typische, sozialwissenschaftliche Forschungsfrage (quantitativ) untersuchen\n- typische ‚ÄúLieblingsfehler‚Äù benennen und Wege aufzeigen, um die Fehler zu umgehen\n- zwischen den Grundkonzepten der Frequentististischen Statistik und der Bayes-Statistik √ºbersetzen\n- die Grundideen der Bayes-Statistik in eine Gesamtzusammenhang einordnen\n\n\n### Ben√∂tigte R-Pakete\n\nIn diesem Kapitel ben√∂tigen Sie folgende R-Pakete.\n\n```{r}\n#| message: false\nlibrary(tidyverse)\nlibrary(easystats)\nlibrary(rstanarm)\n```\n\n```{r libs-hidden}\n#| echo: false\nlibrary(dagitty)\n\ntheme_set(theme_modern())\n```\n\n\n\n\n\n## Lieblinglingsfehler\n\n\n\nLieblingsfehler im √úberblick ü§∑:\n\n\n1. Post-Pr√§d-Verteilung (PPV) und Post-Verteilung verwechseln\n2. Quantile und Verteilungsfunktion verwechseln\n3. Pr√§diktoren nicht zentrieren, wenn es einen Interaktionsterm gibt\n4. Interaktion falsch interpretieren\n5. Regressionskoeffizienten kausal interpretieren, wenn es keine kausale Fundierung gibt\n\n\n\n\n## Post-Pr√§d-Verteilung (PPV) und Post-Verteilung verwechseln ü§∑\n\nBerechnen wir das Standard-mtcars-Modell: `mpg ~ hp`. \n\n```{r m1, results = \"hide\", echo = TRUE}\nm1 <- stan_glm(mpg ~ hp, data = mtcars, refresh = 0)\n```\n\n\nDie *Post-Verteilung* zeigt Stichproben zu den Parameterwerten, s. @tbl-post-m1.\n\n```{r echo = TRUE}\n#| fig-cap: \"Postverteilung in Stichprobenform (m1)\"\n#| label: tbl-post-m1\npost_verteilung <- m1 %>% \n  as_tibble()\nhead(post_verteilung)\n```\n\nDiese Tabelle kann man hernehmen,\num Fragen zu Post-Verteilung zu beantworten.\nH√§ufig ist es aber bequemer, z.B. mit `parameters(m1)` Post-Intervalle und Punktsch√§tzer auszulesen.\n\n\n\nDie *Posterior-Pr√§diktiv-Verteilung (PPV)* zeigt die Vorhersagen, also keine Parameterwerte, sondern Beobachtungen.\n```{r echo=FALSE}\nppv <- posterior_predict(m1) %>% as_tibble()\n\nppv %>% \n  pivot_longer(everything()) %>% \n  slice_head(n=5)\n```\n\n\n\n\n\n\n## Quantile und Verteilungsfuntion verwechseln ü§∑\n\n\n\n### Quantil f√ºr $p$\n\nEin $p$-Quantil teilt eine Verteilung in zwei Teile, \nund zwar so, dass mind. $p$ kleiner oder gleich dem $p$-Quantil sind. s. @fig-quantil.\n```{r quantil-plot}\n#| echo: false\n#| fig-cap: \"50%-Quantil\"\n#| label: fig-quantil\nfuncShaded_low <- function(x, lower_bound) {\n    y = dnorm(x, mean = 0, sd = 1)\n    y[x < lower_bound] <- NA\n    return(y)\n}\n# source: https://stackoverflow.com/questions/48753007/using-stat-function-to-draw-partially-shaded-normal-curve-in-ggplot2\n\nfuncShaded_up <- function(x, upper_bound) {\n    y = dnorm(x, mean = 0, sd = 1)\n    y[x > upper_bound] <- NA\n    return(y)\n}\n\nggplot(tibble(x = -3:3)) +\n  aes(x) + \n  stat_function(fun = dnorm, n = 100) +\n  stat_function(fun = funcShaded_up, args = list(upper_bound = 0),\n                geom = \"area\", fill = \"grey\", alpha = .5) +\n  theme(axis.text.x = element_text(color = \"red\", size = 20)) +\n  scale_x_continuous(breaks = 0)\n```\n\nDas 50%-Quantil (.5-Quantil) betr√§gt $x=0$.\nMind ein Anteil $1-p$ ist gr√∂√üer oder gleich dem $p$-Quantil.\n\n\n\n### Verteilungsfunktion $F$\n\n$F(x)$ gibt die Wahrscheinlichkeit an der Stelle $x$ an, \ndass $X$ einen Wert kleiner oder gleich $x$ annimmt, s. @fig-F.\n\n```{r f-plot}\n#| echo: false\n#| label: fig-F\n#| fig-cap: \"Verteilungsfunktion F(x=0)=1/2\"\nggplot(tibble(x = -3:3)) +\n  aes(x) + \n  stat_function(fun = dnorm, n = 100) +\n  stat_function(fun = funcShaded_up, args = list(upper_bound = 0),\n                geom = \"area\", fill = \"red\", alpha = .5) +\n  scale_x_continuous(breaks = 0)\n```\n\n$F(0)=1/2$, die Wahrscheinlichkeit betr√§gt hier 50%, dass $x$ nicht gr√∂√üer ist als 0.\n\n\n\n## Interaktion falsch interpretieren ü§∑\n\n\nBerechnen wir ein einfaches Interaktionsmodell: `mpg ~ hp*vs`.\n\n:::callout-note\nZur Erinnerung: `mpg ~ hp*vs` ist synonym zu (aber k√ºrzer als) `mpg ~ hp + vs + hp:vs`.\n:::\n\n\n\n```{r m2, echo = TRUE, results= \"hide\"}\nm2 <- stan_glm(mpg ~ hp*vs, data = mtcars)  # mit Interaktionseffekt\n```\n\n\nModellkoeffizienten, s. @tbl-m2-params.\n\n```{r}\n#| eval: false\nparameters(m2)\n```\n\n```{r}\n#| echo: false\n#| label: m2-params\n#| fig-cap: \"Parameter von m2\"\nparameters(m2) %>% display()\n```\n\n@fig-m2-params zeigt die Visualisierung der Parameter von m2.\n\n```{r}\nplot(parameters(m2))\n```\n\n\n\n**Falsch üòà**\nDer Unterschied im Verbrauch zwischen den beiden Gruppen `vs=0` und `vs=1` betr√§gt ca. -0.11.\n\n\n\n\n**Richtig üëº**\nDer Unterschied im Verbrauch zwischen den beiden Gruppen `vs=0` und `vs=1` betr√§gt ca. -0.11 -- *wenn* `hp=0`.\n\n\n\nDa `hp=0` kein realistischer Wert ist, \nist das Modell schwer zu interpretieren.\nZentrierte Pr√§diktoren w√§ren hier eine sinnvolle L√∂sung.\n\n\n\n@gelman_regression_2021,Kap. 10, @mcelreath_statistical_2020, Kap. 8\n\n\n\n\n\n\n\n\n\n\n\n\n## Kochrezepte üç≤\n\n\n\n\n\n\n\n\n### Kochrezept: Forschungsfrage untersuchen\n\n*Theoretische Phase*\n1. Staunen √ºber ein Ph√§nomen, $y$, Kausalfrage finden\n2. Literatur w√§lzen, um m√∂gliche Ursachen $x$ von $y$ zu lernen\n3. Forschungsfrage, Hypothese pr√§zisieren\n4. Modell pr√§zisieren (DAG(s), Prioris)\n\n*Empirische Phase*\n\n5. Versuch planen\n6. Daten erheben\n\n*Analytische Phase*\n\n7. Daten aufbereiten\n8. Modell berechnen anhand eines oder mehrerer DAGs\n9. Modell pr√ºfen/kritisieren\n10. Forschungsfrage beantworten\n\n\n\nYeah! Fertig.\n\n\n\n### Parameter sch√§tzen vs. Hypothesen pr√ºfen\n\nQuantitative Studien haben oft einen von zwei (formalen) Zielen: Hypothesen testen oder Parameter sch√§tzen.\nBeispiel Hypothesenpr√ºfung: \"Frauen parken im Durchschnitt schneller ein als M√§nner\".\nBeispiel Parametersch√§tzung: \"Wie gro√ü ist der mittlere Unterschied in der Ausparkzeit zwischen Frauen und M√§nnern?\"\n\nJe ausgereifter ein Forschungsfeld, desto *k√ºhnere* Hypothesen lassen sich formulieren:\n    - stark ausgereift: \n      - Die n√§chste totale Sonnenfinsternis in Deutschland wird am 27.7.2082 um 14.47h stattfinden, [Quelle](https://www.solar-eclipse.info/de/eclipse/country/DE/)\n    - gering ausgereift: \n      - Die n√§chste Sonnenfinsternis wird in den n√§chsten 100 Jahren stattfinden.\n      - Lernen bringt mehr als Nicht-Lernen f√ºr den Klausurerfolg.\nK√ºhne Hypothesen sind w√ºnschenswert ü¶π \n\n\n\n\n### Formalisierung von Forschungsfragen\n\nDer Mittelwert in Gruppe A ist h√∂her als in Gruppe B (der Unterschied, $d$, im Mittelwert ist gr√∂√üer als Null):\n\n$$\\mu_1 > \\mu_2 \\Leftrightarrow \\mu_1 - \\mu_2 > 0 \\Leftrightarrow \\mu_d > 0$$\n\n\n\n\n\n\n\n\n## Kerngedanken Bayes\n\n\n### Zentraler Kennwert der Bayes-Statistik: Post-Verteilung\n\nBerechnen wir wieder ein einfaches^[langweiliges] Modell: `mpg ~ hp`.\n\n```{r m3, echo = TRUE, results ='hide'}\nm3 <- stan_glm(mpg ~ hp, data = mtcars)\n```\n\nUnd schauen wir uns die Post-Verteilung an, mit eingezeichnetem HDI, s. @fig-post-m3.\n\n```{r echo = FALSE}\n#| label: fig-post-m3\n#| fig-cap: \"Post-Verteilung (HDI) von m3\"\nplot(hdi(m3))\n```\n\n\n\n\nEin Zusammenfassen der Posterior-Verteilung (z.B. zu einem 95%-PI) ist m√∂glich und oft sinnvoll.\nVerschiedene Arten des Zusammenfassens der Post-Verteilung sind m√∂glich, z.B. zu Mittelwert oder SD oder einem einem HD-Intervall.\nAllerdings √ºbermittelt nur die gesamte Post-Verteilung alle Informationen.\nDaher empfiehlt es sich (oft), die Post-Verteilung zu visualisieren.\n\n\n\n\n\n### Posteriori als Produkt von Priori und Likelihood\n\n$$\\text{Posteriori} = \\frac{\\text{Likelihood} \\times \\text{Priori}}{\\text{Evidenz}}$$\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n## Beispiele f√ºr Pr√ºfungsaufgaben\n\n\n\n\n### Geben Sie den korrekten Begriff an!\n\n\n  üå¨üöôüôãÔ∏èüë®‚¨ÖÔ∏èHans üëß‚¨ÖÔ∏èAnna üë©‚¨ÖÔ∏èLise \n  \n  \n  \nPuh, wie erstelle ich f√ºr alle Studis ein anderes R√§tsel^[Fahr-Hier-Hans-Anna-Lise: Varianzanalyse]? \n\n\n:::callout-note\nIn einer Open-Book-Pr√ºfung bekommen alle Studentis eine eigene, jeweils andere Pr√ºfung.\nTeamarbeit bleibt nat√ºrlich trotzdem untersagt.\n:::\n\n\n\n### DAG mit doppelter Konfundierung\n\n\n\n\n```{r dag2}\n#| echo: false\ndag2_raw <-\n  'dag {\nA [pos=\"-2.200,-1.520\"]\nB [pos=\"1.400,-1.460\"]\nD [outcome,pos=\"1.400,1.621\"]\nE [exposure,pos=\"-2.200,1.597\"]\nZ [pos=\"-0.300,-0.082\"]\nA -> E\nA -> Z\nB -> D\nB -> Z\nE -> D\nZ -> D\nZ -> E\n}\n'\n\ndag2_raw %>% dagitty() %>% plot()\n```\n\n\n‚ùìGeben Sie die minimale Adjustierungsmenge (minimal adjustment set) an,\num den totalen (gesamten) Effekt von *E* auf *D* zu bestimmen!\n\n‚ùó Entweder ist die Menge {A,Z} zu adjustieren oder die Menge {B,Z}.\n\n\n\n### DAG mit vielen Variablen\n\n\n```{r dag3, fig.asp = .5}\n#| echo: false\ndag3_raw <-\n  'dag {\n1 [pos=\"-5.600,2.115\"]\n10 [pos=\"4.955,-4.447\"]\n11 [pos=\"7.152,-1.901\"]\n12 [pos=\"7.424,1.256\"]\n13 [pos=\"5.971,3.498\"]\n14 [pos=\"4.225,5.936\"]\n15 [pos=\"1.634,7.468\"]\n2 [pos=\"-7.120,-0.603\"]\n3 [pos=\"-7.138,-3.731\"]\n4 [pos=\"-5.395,-6.348\"]\n5 [pos=\"-2.468,-6.074\"]\n6 [pos=\"-2.179,-2.682\"]\n7 [pos=\"-1.049,-0.238\"]\n8 [pos=\"1.043,0.916\"]\n9 [pos=\"2.654,-2.614\"]\nD [outcome,pos=\"-1.510,6.789\"]\nE [exposure,pos=\"-3.728,5.092\"]\n1 -> E\n10 -> 9\n11 -> 10\n12 -> 11\n13 -> 12\n14 -> 13\n15 -> 14\n15 -> D\n2 -> 1\n3 -> 2\n4 -> 3\n5 -> 4\n6 -> 5\n7 -> 6\n7 -> E\n8 -> 7\n8 -> D\n9 -> 8\nE -> D\n}\n'\n\ndag3_raw %>% dagitty() %>% plot()\n```\n\nMinimale Adjustierungsmenge, um den Effekt von E auf D zu identifizieren: {7}, {8}.\n\n\n\n### Ein Kausalmodell der Schizophrenie, van Kampen (2014)\n\n*The SSQ model of schizophrenic prodromal unfolding revised:* \n\n*An analysis of its causal chains based on the language of directed graphs*\n\nD. van Kampen\n\nLesen Sie [hier den Abstract](https://www.cambridge.org/core/journals/european-psychiatry/article/abs/ssq-model-of-schizophrenic-prodromal-unfolding-revised-an-analysis-of-its-causal-chains-based-on-the-language-of-directed-graphs/F2E7BBFC1B392616DB894AFBFABE7818).\n\nFolgende Symptome der Schizophrenie wurden gemessen:\n\nSocial Anxiety (*SAN*), Active Isolation (*AIS*), Affective Flattening (*AFF*), Suspiciousness (*SUS*), Egocentrism (*EGC*), Living in a Fantasy World (*FTW*), Alienation (*ALN*), Apathy (*APA*), Hostility (*HOS*), Cognitive Derailment (*CDR*), Perceptual Aberrations (*PER*), and Delusional Thinking (*DET*)\n\n@van_kampen_ssq_2014\n\nUV: *SUS*, AV: *EGC*\n\n\nBerechnen Sie die minimale Adjustierungsmenge, \num den kausalen Effekt der UV auf die AV zu identifizieren!\n\n\n\n### DAG von van Kampen (2014) zu den Symptomen der Schizophrenie\n\n\n```{r dag-van-kampen, fig.asp=.5}\n#| echo: false\ndad_van_kampen_raw <-\n  'dag {\nAFF [pos=\"0.262,0.477\"]\nAIS [pos=\"0.123,0.736\"]\nALN [pos=\"0.438,0.506\"]\nAPA [pos=\"0.376,0.147\"]\nCDR [pos=\"0.628,0.332\"]\nDET [pos=\"0.920,0.561\"]\nEGC [outcome,pos=\"0.916,1.016\"]\nFTW [pos=\"0.667,0.639\"]\nHOS [pos=\"0.886,0.727\"]\nPER [pos=\"0.920,0.382\"]\nSAN [pos=\"0.031,0.371\"]\nSUS [exposure,pos=\"0.295,1.003\"]\nAFF -> ALN\nAFF -> APA\nAFF -> CDR\nAIS -> AFF\nAIS -> EGC\nAIS -> SUS\nALN -> APA\nALN -> DET\nALN -> FTW\nALN -> PER\nALN -> SUS\nCDR -> DET\nEGC -> HOS\nFTW -> DET\nFTW -> EGC\nPER -> DET\nSAN -> AFF\nSAN -> AIS\nSAN -> ALN\nSAN -> APA\nSAN -> CDR\nSUS -> EGC\nSUS -> FTW\nSUS -> HOS\n}\n'\n\ndad_van_kampen_raw %>% dagitty() %>% plot()\n```\n\n\nMinimales Adjustment-Set f√ºr den totalen Kausaleffekt: {AIS, ALN}\n\n\n\n\n\n### Modelle berechnen\n\n\nStellen Sie sich auf Aufgaben ein, in denen Sie Modellparameter berechnen sollen.\nOrientieren Sie sich an den Aufgaben und Inhalten des Unterrichts.\n\nPr√ºfungsfragen zu Modellen k√∂nnten z.B. sein:\n\n- Geben Sie den Punktsch√§tzer (Median) f√ºr den Pr√§diktor X im Modell Y an!\n- Geben Sie ein 89%-HDI f√ºr den Parameter X im Modell Y an!\n- Geben Sie R-Quadrat an.\n- Formulieren Sie ein Interaktionsmodell!\n- Welches Modell ist korrekt, um den kausalen Effekt zu modellieren?\n- Formulieren Sie ein Modell mit folgenden Prioris ...\n- Liegt der Effekt X noch im ROPE ?\n- Unterscheidet sich die Breite des CI von der Breite des HDI f√ºr den Pr√§diktor X im Modell Y?\n- Was ver√§ndert sich an den Parametern, wenn Sie die Pr√§diktoren zentrieren/z-standardisieren?\n- ...\n\n\n\n\n\n## Viel Erfolg bei der Pr√ºfung!\n\n\nü•≥üèÜ\n\n\n\n\n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"kable","error":false,"eval":true,"cache":null,"freeze":"auto","echo":true,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-yaml":false,"keep-source":false,"keep-hidden":false,"prefer-html":true,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":true,"code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","toc":true,"number-sections":true,"output-file":"abschluss.html"},"language":{},"metadata":{"lang":"de","fig-responsive":true,"quarto-version":"1.1.168","bibliography":["references.bib"],"editor":"source","knitr":{"opts_chunk":{"collapse":true,"R.options":{"knitr.graphics.auto_pdf":true}}},"theme":"cosmo"},"extensions":{"book":{"multiFile":true}}},"pdf":{"execute":{"fig-width":5.5,"fig-height":3.5,"fig-format":"pdf","fig-dpi":300,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":"auto","echo":true,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":true,"keep-yaml":false,"keep-source":false,"keep-hidden":false,"prefer-html":true,"output-divs":true,"output-ext":"pdf","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"pdf-engine":"xelatex","standalone":true,"variables":{"graphics":true,"tables":true},"default-image-extension":"pdf","to":"pdf","toc":true,"number-sections":true,"output-file":"abschluss.pdf"},"language":{},"metadata":{"block-headings":true,"lang":"de","bibliography":["references.bib"],"editor":"source","knitr":{"opts_chunk":{"collapse":true,"R.options":{"knitr.graphics.auto_pdf":true}}},"colorlinks":true,"papersize":"a4"},"extensions":{"book":{}}}}}