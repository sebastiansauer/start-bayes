{"title":"Verteilungen","markdown":{"headingText":"Verteilungen","containsRefs":false,"markdown":"\n\n\n\n## Lernsteuerung\n\n\n### Lernziele\n\nNach Absolvieren des jeweiligen Kapitels sollen folgende Lernziele erreicht sein.\n\nSie können ...\n\n\n- den Begriff der Zufallsvariablen erläutern\n- die Begriffe von Wahrscheinlichkeitsdichte und Verteilungsfunktion erläutern und anhand einfacher Beispiele ausrechnen\n- den Begriff einer Gleichverteilung erläutern und einfache Fallbeispiele ausrechnen\n- die Parameter einer Normalverteilung nennen und erläutern\n\n\n\n\n### Prüfungsrelevanter Stoff\n\n\nLesen Sie zusätzlich zum Stoff dieses Kapitels noch @bourier_2018, folgende Abschnitte:\n\n- Kap. 6.1 (Zum Begriff Zufallsvariable)\n- Kap. 6.3 (Stetige Zufallsvariablen)\n- Kap. 7.1.1 (Binomialverteilung)\n- Kap. 7.2.1 (Gleichverteilung) und 7.2.3 (Normalverteilung)\n\nLösen Sie auch die Übungsaufgaben dazu.\n\n\nWeitere Übungsaufgaben finden Sie im dazugehörigen Übungsbuch, @bourier_statistik-ubungen_2022.\n\n\n### Benötigte R-Pakete\n\n```{r}\n#| message: false\nlibrary(patchwork)\nlibrary(tidyverse)\n```\n\n\n```{r}\n#| include: false\nlibrary(gt)\nlibrary(patchwork)\nlibrary(faux)\nlibrary(openintro)\nlibrary(easystats)\n```\n\n\n\n```{r}\n#| include: false\ntheme_set(theme_modern())\n```\n\n\n\n### Zentrale Begriffe\n\n\n#### Eigenschaften von Zufallsvariablen\n\n- Zufallsvariable (random variable)\n- Diskret vs. stetig\n- Wahrscheinlichkeitsdichte (Dichte, (probability) density, f)\n- Wahrscheinlichkeitsfunktion (kumulierte Wahrscheinlichkeit, Wahrscheinlichkeitsmasse)\n\n\n#### Verteilungen\n\n- Gleichverteilung\n- Normalverteilung\n- Standardnormalverteilung\n\n### Begleitvideos\n\n\n- [Video 1 zum Thema Verteilungen](https://youtu.be/7GqIE4sKDs4)\n- [Video 2 zum Thema Verteilungen](https://youtu.be/HKWwondYsW8)\n\n\n\n\n## Verteilungen\n\n\n:::callout-important\nEine *Verteilung* zeigt, welche Ausprägungen eine Variable aufweist und wie häufig bzw. wahrscheinlich diese sind. \nEinfach gesprochen, veranschaulicht eine Balken- oder Histogramm eine Verteilung. Man unterscheidet Häufigkeitsverteilungen (s. Abb. @fig-mtcars-freq) von Wahrscheinlichkeitsverteilungen (Abb. @fig-uniform).\n:::\n\n\n\n\n\n### Häufigkeitsverteilung\n\n\n  \nDie Häufigkeitsverteilung eines *diskreten* Merkmals $X$ mit $k$ Ausprägungen zeigt, \nwie häufig die einzelnen Ausprägungen sind.\nSo hat die Variable *Zylinder* (in einem Datensatz) etwa die Ausprägungen 4,6 und 8.\n  \n  \n```{r Normalverteilung-1, echo = TRUE}\ndata(mtcars)\n  mtcars %>% \n    count(cyl)\n```\n  \n  \nAbb. @fig-mtcars-freq, links, visualisiert die Häufigkeitsverteilung von `cyl`.\n\n\n\n\n```{r}\n#| echo: false\n#| fig-cap: \"Häufigkeitsverteilung von `cyl` und `hp` (diskretisiert in 10 Körbe oder Gruppen)\"\n#| label: fig-mtcars-freq\np1 <- \n  mtcars %>% \n  ggplot(aes(x = cyl)) +\n  geom_bar()\n\n\np2 <- mtcars %>% \n  ggplot(aes(x = hp)) +\n  geom_histogram(bins=10)\n\nplots(p1, p2, n_rows = 1)\n```\n  \n\n\n\n \nEin *stetiges* Merkmal, wie `hp` (PS-Zahl), lässt sich durch Klassenbildung in ein diskretes umwandeln (diskretisieren), s. Abb. @fig-mtcars-freq, rechts.\n\n### Wahrscheinlichkeitsverteilung\n\nWahrscheinlichkeitsverteilungen dienen dazu, Ereignissen einer Zufallsvariable eine Wahrscheinlichkeit zuzuordnen.\n\n\nEine *diskrete* Wahrscheinlichkeitsverteilung der (diskreten) Zufallsvariablen $X$ ordnet jeder der $k$ Ausprägungen $X=x$ eine Wahrscheinlichkeit $p$ zu. So hat die Variable *Geschlecht eines Babies* die beiden Ausprägungen *Mädchen* und *Junge* mit den Wahrscheinlichkeiten $p_M = 51.2\\%$ bzw. $p_J = 48.8\\%$ [@gelman_regression_2021].\n\nBei *stetigen* Zufallsvarialben $X$ geht man von unendlich vielen Ausprägungen aus; die Wahrscheinlichkeit einer bestimmten Ausprägung ist (praktisch) Null: $p(X=x_j)=0, \\quad j=1,...,+\\infty$. \nSo ist die Wahrscheinlichkeit, dass eine Person exakt 166,66666666... cm groß ist, (praktisch) Null.\nMan gibt stattdessen die *Dichte* der Wahrscheinlichkeit an: Das ist die Wahrscheinlichkeit(smasse) pro  Einheit von $X$.\n\n\n\n\n\n## Gleichverteilung\n\n### Indifferenz als Grundlage\n\nEine Gleichverteilung nimmt an, dass jeder Wert im Ergebnisraum der zugehörigen Zufallsvariable *gleichwahrscheinlich* ist.\nWenn man keinen hinreichenden Grund hat, eine Realisation einer Zufallsvariablen für plausibler als einen anderen zu halten,\nist eine Gleichverteilung eine passende Verteilung.\nGleichverteilungen gibt es im diskreten und im stetigen Fall.\n\nAbb. @fig-uniform zeigt ein Beispiel für eine (stetige) Gleichverteilung.\n\n\n```{r Normalverteilung-4, fig.asp = 0.5}\n#| echo: false\n#| fig-cap: \n#|   - \"Gleichverteilung min=-1, max=1\"\n#|   - \"Gleichverteilung min=0, max=3\"\n#| label: fig-uniform\n#\n#source: https://dk81.github.io/dkmathstats_site/rmath-uniform-plots.html\n\nuniform_Plot <- function(a, b){\n  xvals <- data.frame(x = c(a, b)) #Range for x-values\n  \n  ggplot(data.frame(x = xvals), \n         aes(x = x)) + xlim(c(a, b)) + ylim(0, 1/(b - a)) +\n    stat_function(fun = dunif, args = list(min = a, max = b), \n                  geom = \"area\", \n                  fill = \"green\", alpha = 0.35) + \n    stat_function(fun = dunif, args = list(min = a, max = b)) +\n    labs(x = \"X\", y = \"Dichte\")  +\n    geom_vline(xintercept = a, linetype = \"dashed\", colour = \"red\") +\n    geom_vline(xintercept = b, linetype = \"dashed\", colour = \"red\")\n  \n}\n\nuniform_Plot(-1, 1)\n#uniform_Plot(0, 3)\n```\n\n\n\n\nBei $X=0$ hat eine Einheit von $X$ die Wahrscheinlichkeitsmasse von 50%.\n\n\nDefinierendes Kennzeichen einer Gleichverteilung ist die *konstante Dichte*.\n\n\n\n### Simulation\n\n\nMöchte man die Verteilungsfunktion einer stetigen Zufallsvariablen berechnen,\nkann das ganz schön kompliziert werden, schließlich muss man Integrale lösen.\nAber es gibt einen Trick, wie man die Sache stark vereinfachen kann: \nman simuliert die Verteilung. Was bedeutet das?\n\n\nAngenommen, die Wartezeit auf einen Bus ist gleichverteilt (engl. *uniform distribution*); \nder Bus kommt regelmäßig und püunktlich alle 10 Minuten. \nDie minimale Wartezeit beträgt also 0 Minuten und die maximale 10 Minuten.\nNennen wir die zugehörige Zufallsvariable $X$, das ist schön kurz.\n\nDann schreibt man auch:\n\n$$X \\sim Unif(0,10).$$\n\n\n\nJa, das sieht fancy aus, aber wo ist der versprochene Trick zum Vereinfachen?\nKommt gleich, Moment.\n\nEine Frage könnte nun lauten, wie groß ist die Wahrscheinlichkeit, dass man zwischen 3 und 5 Minuten auf den Bus warten muss?\n\n\nDer Trick ist, dass wir Integralrechnung gegen stumpfes Zählen eintauschen.\n\nComputer (und damit R) haben eingebaut Funktionen, die eine beliebige Zufallszahl ziehen können,\nzum Beispiel gleichverteilt\n\nAuf Errisch heißt das Zauberwort `runif()`:\n\n```{r}\n#| eval: false\nrunif(n = 1, min = 0, max = 10)\n```\n\n\n```{r}\n#| echo: false\nset.seed(42)\nrunif(n = 1, min = 0, max = 10)\n```\n\nAuf Deutsch heißt das: \"Hey R, ich hätte gerne eine (daher `n = 1`) Zufallszahl *r* wie *random*,\ndie gleichverteilt ist (*uniform*) mit `min = 0` und `max = 10`.\n\n(Zu) anschaulich gesprochen: R hat den Bus kommen lassen und es hat gut 9.1 Minuten gedauert,\nbis er da war.\n\nAchtung, jetzt kommt's: Jetzt lassen wir R mal $10^5$ (`1e5` auf Computersprech) Busse vorfahren. \nR soll jedes Mal notieren, wie lange man auf den Bus warten musste.^[Machen Sie das mal ohne Computer, wenn Sie ein Wochenende Langeweile haben.]\n\n\n```{r}\n#| eval: false\nx_simu <- runif(n = 1e5, min = 0, max = 10)\n```\n\n\n```{r}\n#| echo: false\nn <- 1e5\nset.seed(42)\nx_simu <- runif(n = n, min = 0, max = 10)  # gibt Vektor zurück\n\nx_simu_df <-\n  tibble(id = 1:n,\n         x = x_simu)\n```\n\n\nSchauen wir uns die Verteilung an, @fig-simu-gleichvert.\n\n```{r}\n#| label: fig-simu-gleichvert\n#| fig-cap: \"Simulation einer gleichverteiluten Zufallsvariablen\"\nggplot(x_simu_df) +\n  aes(x = x_simu) +\n  geom_histogram(bins = 50)\n```\n\nOkay, unsere Verteilung sieht nicht *exakt* gleichverteilt, aber einigermaßen. \nGut genug für unsere Zwecke!\n\nSo, und jetzt kommt das Ernten.\nWir können jetzt nämlich einfach zählen (`count()`), um die Antwort auf unsere Frage (der Wartezeit 3-5 Min.) zu erhalten.\n\n\n```{r}\nx_simu_df %>% \n  count(Schnittmenge = x > 3 & x < 5)\n```\n\n\nDas Zeichen `&` ist das logische UND, also die Schnittmenge der zwei Mengen $A := \\{x|x>3\\}$ und $B := \\{x|x<5\\}$, \nalso $A \\cap B$.\n\nWie man sieht, fallen ca. 20% der Stichproben in den entsprechenden Bereich. \n\n\nDa viele Probleme, wenn sie komplexer werden, kaum noch analytisch (wie Integrieren) ausrechenbar sind,\ngreift man in der modernen (Analyse-)Welt oft lieber auf Simulationsverfahren zurück - Dank sei den schnellen Rechnern.\nFür uns Menschen ist damit die Aufgabe des Integrierens auf schnödes Zählen zurückgeführt.\n\n\n\n\n\n\n\n## Binomialverteilung {#sec-bin-distrib}\n\n:::callout-important\nDie Binomialverteilung dient zur Darstellung der Wahrscheinlichkeit der Ergebnisse eines wiederholten binomialen Zufallexperiments,\neines Zufallsexperiments mit *zwei* Ergebnissen also. Typisches Beispiel ist ein Münzwurf.\nBei jeder Wiederholung des Zufallexperiments bleibt die Wahrscheinlichkeit der Ergebnisse gleich: Die Münze verändert sich nicht durch die Würfe (Ziehen mit Zurücklegen). Außerdem hat ein bestimmtes Ergebnis im ersten Wurf keinen Einfluss auf die Wahrscheinlichkeit eines bestimmten Ergebnisses im zweiten Wurf, etc. \n:::\n\n\n\n\n### Veranschaulichung\n\nStellen wir uns eine Kistchen^[In den Lehrbüchern häufig als Urne bezeichnet, was den bösen Spott von \"Friedhofstatistik\" nach sich zog.] mit 5 Losen vor, darunter 2 *T*reffer (Gewinn) und 3 *N*ieten, s. Abb. @fig-urne.\nDer Versuch läuft so ab: Wir ziehen ein Los, schauen ob es ein Treffer ist oder nicht, legen es zurück und ziehen erneut.\n\n\n\n```{r echo = FALSE}\n#| fig-cap: Ein Kästchen mit 5 Losen, darunter 2 Treffer und 3 Nieten.\n#| label: fig-urne\n#| fig-asp: 0.5\nd <- \n  tibble(id = 1:5,\n         event = c(\"T\", \"T\", \"N\", \"N\", \"N\"))\n\n\nggplot(d) +\n  aes(x = id) +\n  theme_minimal() +\n  annotate(\"rect\", xmin = 0, xmax = 6, ymin = 0, ymax = 2, fill = \"grey80\", alpha = .8) +\n  geom_point(size = 10, y = 1, aes(color = event) )+\n  geom_text(aes(label = event), y = 1) +\n  theme(axis.text = element_blank()) +\n  labs(x = \"\", fill = \"\")\n```\n\n\n\n\n\n:::callout-important\n\nUm die Wahrscheinlichkeitsverteilung einer binomialverteilte Zufallsvariable ausrechnen zu können, muss man zwei Dinge wissen: Erstens die Anzahl der Züge, $n$ (Stichprobengröße) und zweitens die Trefferwahrscheinlichkeit, $p$. \n\n:::\n\n\nWie groß ist die Wahrscheinlichkeit von $A^{\\prime}$, d.h. bei $n=4$ Zügen $x=2$ Treffer zu erzielen, gegeben dass die Trefferwahrscheinlichkeit bei $p=2/4$ liegt?\n\nWir könnten jetzt ein Baumdiagramm zeichnen und pro Pfad die Wahrscheinlichkeit ausrechnen  (Multiplikationssatz), s. @fig-3muenzen.\nDie Summe der Wahrscheinlichkeiten der Pfade ist dann die gesuchte Wahrscheinlichkeit, $W$ (Additionssatz).\nDas ist einfach, dauert aber.\n\nIn diesem Fall ist die Wahrscheinlichkeit eines (günstigen) Pfades, $A$:\n\n$P(A) = P(T)^2 \\cdot P(N)^2 = \\left( \\frac{2}{5} \\right)^2 \\cdot \\left( \\frac{3}{5} \\right) ^2$.\n\n```{r}\np_a = (2/5)^2 * (3/5)^2\np_a\n```\n\nEtwas mühevolles Zählen der Pfade würde uns zeigen, dass es $k=6$ Pfade gibt, die alle die gleiche Wahrscheinlichkeit, $P(A)$, aufweisen.\n\nDamit beträgt die Wahrscheinlichkeit des gesuchten Ereignisses $A^{\\prime}$ (2 Treffer bei 4 Zügen):\n\n$P(A^{\\prime}) = 6 \\cdot P(A)$.\n\n```{r}\np_a_strich = 6 * p_a\np_a_strich\n```\n\n\nMithilfe der Formel der Binomialverteilung lässt sich das Ergebnis, die Wahrscheinlichkeit von $A^{\\prime}$  schneller ausrechnen. Einfach gesprochen sieht sie so aus:\n\n\n\n$$P(A^{\\prime}) = k \\cdot P(A)$$\nDabei steht $k$ für die Anzahl der günstigen Pfade und $P(A)$ für die Wahrscheinlichkeit eines günstigen Pfades (d.h. 2 Treffer und 2 Nieten) und alle Pfade haben die gleiche Wahrscheinlichkeit. \n\nDie Anzahl der Pfade kann man mit dem *Binomialkoeffizient* ausrechnen, den man so darstellt:\n\n$\\tbinom{n}{k}$\n\nLies: \"Wähle aus $n$ möglichen Ereignissen (Pfade im Baum) $k$ günstige Ereignisse (günstige Pfade).\n\nAuf Errisch geht das so:\n\n```{r}\nchoose(4,2)\n```\n\n\n\n\n\n\n### Rechnen mit R\n\n\nDie Binomialverteilung ist in R eingebaut; man kann sich leicht entsprechende Wahrscheinlichkeiten ausrechnen lassen.\n\nDie Wahrscheinlichkeit, bei 4 Zügen 2 Treffer zu erzielen mit $p=2/5$ unter der Annahme einer Binomialverteilung lässt sich so mit R berechnen:\n\n```{r}\ndbinom(x = 2, size = 4, prob = 2/5)\n```\n\n\n\n::: {#exm-binom}\n\n## Pumpstation-Beispiel zur Binomialverteilung\n\nIn einer Pumpstation arbeiten 7 Motoren, die wir als identisch annehmen. Mit einer Wahrscheinlichkeit von 5% fällt ein Motor aus und ist für den Rest des Tages nicht einsatzbereit. Der Betrieb kann aufrecht erhalten werden, solange mindestens 5 Motoren arbeiten. Wie groß ist die Wahrscheinlichkeit, dass die Pumpstation aus dem Betrieb fällt?\n\n$P(X=k)$ (oder kurz: $P(k)$) gibt die Wahrscheinlichkeit (Wahrscheinlichkeitsfunktion) an für das Ereignis, dass *k* Motoren arbeiten.\n\nLassen wir R mal $P(X=5)$ ausrechnen.\n\n\n```{r}\ndbinom(x = 5, size = 7, prob = .95)\n```\n\n\nEs gilt also $P(X=5) \\approx .04$. Die Wahrscheinlichkeit, dass (nur) 5 Motoren laufen an einem beliebigen Tag ist relativ gering^[wobei \"gering\" subjektiv ist, die Betreiberfirma findet diese Wahrscheinlichkeit, dass 2 Pumpen ausfallen, wohl viel zu hoch.]. \n\n\n`dbinom()` steht für die Wahrscheinlichkeits*d*ichte (im diskreten Fall, also hier, Wahrscheinlichkeitsfunktion genannt) und `binom` für die Binomialverteilung. `x` gibt die Anzahl der Treffer an (das gesuchte Ereignis, hier 5 Motoren arbeiten); `size` gibt die Stichprobengröße an (hier 7 Motoren).\n\nDamit gilt:\n\n$P(X\\ge 5) = P(X=5) + P(X=6) + P(X=7)$\n\n```{r}\np_5 <- dbinom(x = 5, size = 7, prob = .95)\np_6 <- dbinom(x = 6, size = 7, prob = .95)\np_7 <- dbinom(x = 7, size = 7, prob = .95)\n\np_mind_5 <- p_5 + p_6 + p_7\n\np_mind_5\n```\n\nDie Wahrscheinlichkeit, dass mind. 5 Motoren arbeiten beträgt also `r round(p_mind_5, 4)`.\n\n\nDas Komplement zu diesem Ereignis ist, dass *nicht* mind. 5 Motoren arbeiten, also höchstens 4 und es daher zu einem Ausfall kommt.\n\nNatürlich gilt $P(\\bar{X}) = 1- P(X)$.\n\n```{r}\np_weniger_als_4 <- 1 - p_mind_5\np_weniger_als_4\n```\n\n\nAlternativ kann man mit der Verteilungsfunktion rechnen: $P(X \\le 4)$.\n\n\n\n\nIn R kann man dafür die Funktion `pbinom()` nutzen (p für (kumulierte) Wahrscheinlichkeit).\n\n```{r}\npbinom(q = 4, size = 7, prob = .95)\n```\n\n`q = 4` steht für $X \\le 4$, also für höchstens 4 Treffer (arbeitende Motoren); `size = 7` meint die Stichprobengröße, hier 7 Motoren.\n\n:::\n\n\n:::callout-important\n\nDie Funktion, die die Wahrscheinlichkeit dafür angibt, dass die diskrete Zufallsvariable $X$ eine Realisation annimmt, die kleiner oder gleich (höchstens) einem Wert $X=x$ ist, heißt *Verteilungsfunktion*.\n\n$F(X=x) = P(X \\le x)$\n\n:::\n\n\n\n### Simulieren\n\n\nDie Binomialverteilung lässt sich gut als \"Münzwurf-Verteilung\" auffassen.\n\nWerfen wir eine Münze und sehen wir, was passiert.\n\n\n```{r}\nsample(x = c(0, 1), size = 1)\n```\n\n\nMit `sample()` ziehen wir eine Stichprobe aus dem Ereignisraum `x`, hier 0 und 1. \nDabei vereinbaren wir (willkürlich), dass 0 für \"Kopf\" steht und 1 für \"Zahl\".\n`size = 1` bedeutet, wir werfen die Münze ein Mal (d.h. Stichprobengröße *size* ist 1).\n\nOkay, noch an Bord? Dann werfen wir die Münze 10 Mal:\n\n\n```{r}\nsample(x = c(0, 1), size = 10, replace = TRUE)\n```\n\n`replace = TRUE` heißt, wir legen die Münze wieder zurück auf den Tisch, wenn wir sie geworfen haben.\nOder anders ausgedrückt: *Ziehen mit Zurücklegen*.\n\n\n\nR, mach dich bereit, wirf die Münze 1000 ($n=10^3$ oder `1e3`) Mal^[R meckert nicht bei langweiligen Aufgaben.]:\n\n\n```{r}\nn <- 1e3\n\nmuenze_oft <- \n  sample(x = c(0, 1), size = n, replace = TRUE) \n\n\nmuenze_oft %>% \n  sum()\n```\n\n\nMit `sum()` nach dem Pfeifensymbol `%>%` haben wir aus dem Vektor `muenze_oft`, der aus der ersten Zeile resultiert,\ndie Summe ausgerechnet. \n\nJetzt wissen wir, wie oft die Münze \"Zahl\" gezeigt hat, nämlich `r sum(muenze_oft)` Mal.\n\n\n\n::: callout-note\nWenn Sie einen Zufallsversuch wiederholen, muss nicht jedes Mal das gleiche Ergebnis resultieren. Entsprechend wird bei wiederholten Ausführung der Funktion `sample()` nicht immer das gleiche Ergebnis resultieren. Wundern Sie sich also nicht, wenn bei Ihrem Computer eine ähnliche, aber nicht gleiche, Zahl herauskommt.\n:::\n\n\nVisualisieren wir mal unsere Münzwürfe. Dazu erstellen wir zuerst eine geeignete Tabelle, @tbl-muenz.\n\n\n```{r}\nmuenz_tab <-\n  tibble(\n    id = 1:n,\n    x = muenze_oft,\n    x_cumsum = cumsum(x) / id  # gibt Anteil von \"Zahl\" wieder\n  )\n```\n\n\n```{r}\n#| echo: false\n#| label: tbl-muenz\n#| tbl-cap: \"Die kumulierte Summe beim Münzwurf (nur die ersten paar Zeilen)\"\nhead(muenz_tab)\n```\n\n\nUnd hier der Anteil von \"Zahl\" im Verlauf unserer Münzwürfe, s. @fig-lln.\n\n\n```{r}\n#| label: fig-lln\n#| fig-cap: \"Das Gesetz der großen Zahl am Beispiel der Stabilisierung des Trefferanteils beim wiederholten Münzwurf\"\nmuenz_tab %>% \n  slice_head(n = 1e3) %>% \n  ggplot() +\n  aes(x = id, y = x_cumsum) +\n  geom_line()\n```\n\n\nGrob gesagt scheint sich ein Münzwurf nach, naja, vielleicht 500 Würfen \"einigermaßen\" zu stabilisieren.^[Was \"einigermaßen\" bedeuten soll, ist kein statistischer Begriff, sondern einer, der im echten Leben von den Menschen beantwortet werden muss, die eine Entscheidung zu treffen haben.]\n\n\n\n::: callout-important\nDas Gesetz der großen Zahl\n\nZieht man (zufällig) immer mehr Werte aus einer Verteilung (mit endlichem Mittelwert), nähert sich der Mittelwert der Stichprobe immer mehr mit dem Mittelwert (oft als Erwartungswert bezeichnet) der Verteilung an \n:::\n\n\n\n```{r lln, out.width = \"100%\", fig.align=\"center\", fig.asp = .5}\n#| eval: false\n#| echo: false\nsource(paste0(here::here(),\"/R-Code/img15.R\"))\n```\n\n\n\n<!-- 3b1b hat ein [nettes Video zu diesem Thema](https://youtu.be/8idr1WZ1A7Q), das sich als Vertiefung eignet. -->\n\n\n\n\n## Normalverteilung\n\n\nNormalverteilungen haben eine charakteristische Glockenform.\nNormalverteilungen können sich unterscheiden   Mittelwert $\\mu$ und ihrer Streuung, $\\sigma$.\nDiese beiden Größen (\"Parameter\") determinieren den Graphen einer bestimmten Normalverteilungsfunktion, s. @fig-norms.\nSind diese beiden Parameter bekannt, so ist die Dichte jedes beliebigen Datenpunkts (aus dieser Normalverteilung) bestimmt.\n\n::: {def-parameter}\n\n## Parameter\n\nEin Parameter (einer Verteilung) legt die \"Varianten\" einer Verteilung fest. Durch die Wahl der Parameterwerte nimmt eine Verteilung eine genaue Form an.\n\n:::\n\n![Beispiele von Normalverteilungen mit verschiedenen Mittelwerten und Streuungen, Quelle: Wikipedia](img/normals.png){#fig-norms width=50% fig-align=\"center\"}\n\n\nBeispiel: Wie groß sind Studentis ([Quelle des Datensatzes](https://rdrr.io/cran/openintro/man/speed_gender_height.html))? \n\nDas Quantil von z.B. 25% zeigt die Körpergröße der 25% kleinsten Studentis an, analog für 50%, 75%:\n\n```{r QM2-Thema3-Teil1-5, echo = FALSE}\ndata(speed_gender_height)\n\nheight_summary <- \n  speed_gender_height %>% \n  drop_na(height) %>% \n  mutate(height = height * 2.54) %>% \n  summarise(q25 = quantile(height, prob = .25),\n            q50 = quantile(height, prob = .5),\n            q75 = quantile(height, prob = .75))\n\nheight_summary %>% \n  gt()\n```\n\n@fig-quantiles zeigt eine Visualisierung der Quantile.\n\n```{r QM2-Thema3-Teil1-6}\n#| echo: false\n#| results: hold\n#| fig-width: 12\n#| fig-asp: 0.618\n#| fig-cap: \"Quantile verschieden visualisiert\"\n#| label: fig-quantiles\n\nspeed_gender_height <-\n  speed_gender_height %>% \n  mutate(height_cm = height * 2.54)\n\np1 <- \n  speed_gender_height %>% \n  ggplot() +\n  aes(x = 1, y = height_cm) +\n  geom_boxplot() +\n  labs(x = \"\",\n       y = \"Größe in cm\",\n       title = \"Die Box zeigt das 25%-, 50%- und 75%-Quantil\")\n\nheight_summary_long <- \n  height_summary %>% \n  pivot_longer(everything(),\n               names_to = \"q\",\n               values_to = \"height_cm\")\n\np2 <- \n  speed_gender_height %>% \n  ggplot() +\n  aes(x = height_cm) +\n  geom_histogram() +\n  geom_vline(data = height_summary_long,\n             aes(xintercept = height_cm)) +\n  geom_text(data = height_summary_long,\n             aes(x = height_cm+1,\n                 y = 0,\n                 label = paste0(q, \": \",height_cm)),\n             angle = 90,\n            hjust = 0,\n            color = \"white\"\n             ) +\n  labs(title = \"Die vertikalen Striche zeigen die Quantile\",\n       y = \"Häufigkeit\")\n\nplots(p1, p2)\n```\n\n\n::: callout-note\nDas 25%-Quantil nennt man *1. Quartil*, das 50%-Quantil auch *2. Quartil*, das 75%-Quantil das *3. Quartil*, und das 100%-Quantil (Maximalwert) das *4. Quartil*.\n:::\n\n\n\n\n\n\n\n\n### Normal auf dem Fußballfeld\n\nSie und 100 Ihrer besten Freunde stehen auf der Mittellinie eines Fußballfelds. Auf Kommando werfen alle jeweils eine Münze; bei Kopf geht man einen Schritt nach links, bei Zahl nach rechts. Das wird 16 Mal wiederholt. Wie wird die Verteilung der Positionen wohl aussehen?\n\n\n```{r Normalverteilung-6, fig.asp = .45, fig.width=7}\n#| echo: false\nsource(paste0(here::here(),\"/R-Code/img13.R\"))\n```\n\n[@mcelreath_statistical_2020]\n\n\n\n\n\n\n\n### Normal durch Addieren\n\nDie Summe vieler (gleich starker) Zufallswerte (aus der gleichen Verteilung) erzeugt eine Normalverteilung; egal aus welcher Verteilung die Zufallswerte kommen (Zentraler Grenzwertsatz), vgl. @fig-fussball.\n\n\n```{r Normalverteilung-7, out.width=\"100%\", fig.asp = 0.5, fig.align=\"center\", fig.width=7}\n#| echo: false\n#| fig-cap: \"Entstehen einer Normalverteilung durch Addition vieler unabhgängiger Ereignisse\"\n#| label: fig-fussball\nsource(paste0(here::here(),\"/R-Code/img14.R\"))\n```\n\n\n\nNicht verwechseln:\n\n\n```{r Normalverteilung-8, echo = FALSE, out.width=\"30%\", fig.align='center'}\nknitr::include_graphics(\"img/ch33910f1.jpg\")\n```\n\n\n\n\n\n\n### Normalverteilung vs. randlastige Verteilungen\n\n\n```{r Normalverteilung-9, fig.asp=0.5}\n#| echo: false\nggplot(data = data.frame(x = c(-3, 3)), aes(x)) +\n  stat_function(fun = dnorm, n = 101, args = list(mean = 0, sd = 1), color = \"blue\") +\n  labs(y = \"Dichte\", x = \"Merkmal, X\") +\n  stat_function(fun = dt, n = 101, args = list(df = 1, ncp =0), color = \"red\") +\n  labs(caption = \"Blau: Normalverteilung\\nRot: randlastige Verteilung (t-Verteilung mit df=1)\")\n```\n\n\nBei randlastigen Verteilungen (\"fat tails\") kommen Extremereignisse viel häufiger vor als bei Normalverteilungen. Deshalb ist es wichtig sein, zu wissen, ob eine Normalverteilung oder eine randlastige Verteilung vorliegt. Viele statistische Methoden sind nicht zuverlässig bei (stark) randlastigen Methoden.\n\n\n\n\n### Beispiele für Normal- und randlastige Verteilungen\n\n\n\nNormal verteilt:\n\n- Größe \n- Münzwürfe\n- Gewicht\n- IQ\n- Blutdruck\n- Ausschuss einer Maschine\n\n\nRandlastig verteilt:\n\n- Vermögen\n- Verkaufte Bücher\n- Ruhm\n- Aktienkurse\n- Erdbeben\n- Pandemien\n- Kriege\n- Erfolg auf Tinder\n- Meteroritengröße\n- Stadtgrößen\n\n\n\n### Formel der Normalverteilung\n\nVereinfacht ausgedrückt lässt die Normalverteilung $\\mathcal{N}$ durch Exponenzieren einer Quadratfunktion beschreiben:\n\n$$\\mathcal{N} \\propto e^{-x^2}$$\n\nmit $e=2.71...$, der Eulerschen Zahl.^[Das Zeichen $y \\propto x$ bedeutet \"x ist proportional zu y\", also $y = mx$.]\n\n\n\n\n\n```{r norm, eval = FALSE, echo = TRUE}\n#| fig-asp: 0.5\nd <-\n  tibble(\n    x = seq(-3, 3, \n            length.out = 100),\n    y = exp(-x^2)\n  )\n\nd %>% \n  ggplot() +\n  aes(x = x, y = y) +\n  geom_line()\n```\n\n\n\n```{r Normalverteilung-10, echo = FALSE, ref.label = \"norm\"}\n```\n\n\nEine Normalverteilung mit $\\mu=0$ und $\\sigma=1$ nennt man auch *Standardnormalverteilung* und \nman schreibt:\n\n\n$$IQ \\sim \\mathcal{N}(0,1)$$\n\nDie Normalverteilung wird auch *[Gauss](https://de.wikipedia.org/wiki/Carl_Friedrich_Gau%C3%9F)-Verteilung* oder *Glockenkurve* genannt.\n\n\n\n\n\n### Simulation einer Normalverteilung\n\n\nR hat eine Funktion eingebaut zur Erzeugung von Zufallszahlen (Zufallszahlengenerator), z.B. normalverteilte.\nMan übergibt dieser Funktion den gewünschten Mittelwert und die gewünschte Streuung und die Funktion zieht dann zufällig Werte aus dieser Verteilung.\n\nDiesen Zufallszahlengenerator kann man mit einem Duschkopf vergleichen, s. @fig-shower.\nAn diesem Duschkopf kann man einen Schwenker einstellen, der den Duschkopf\nausrichtet, also steuert, ob die Wassertropfen weit in die eine oder die andere\nRichtugn fallen.\nZweitens hat unser Duschkopf noch einen Streuregler,\nder den Wasserstrahl entweder eng bündelt^[Massagedusche, behauptet der Hersteller] oder weit auseinanderfächert. Im ersten Fall fällt der Wasserstrahl eng und schmal aus. Im zweiten Fall fällt der Wasserstrahl breit aus.\n\n![Zufallszahlengenerator als Duschkopf](img/shower-data.png){#fig-shower width=\"50%\"}\n\n[Quelle](https://jkkweb.sitehost.iu.edu/KruschkeFreqAndBayesAppTutorial.html#data_are_described_by_mathematical_models): John Kruschke.\n\n\n\nEine Zufallszahl (*r*andom number), die *norm*alverteilt ist, mit $\\mu=0$ und $\\sigma=1$ kann man in R so erzeugen:\n\n\n```{r}\nrnorm(n = 1, mean = 0, sd = 1)\n```\n\n\n\nEin Fallbeispiel: Der Inhalt einer Tüte mit Zucker, $X$, sei normalverteilt mit $\\mu = 10002$ g und $\\sigma=1.5$ g. Aus vertragsrechtlichen Gründen darf das Füllgewicht von 1000g nicht unterschritten werden, sonst drohen Konventionalstrafen.\n\nWie groß ist die Wahrscheinlichkeit, dass 1000g unterschritten werden?\n\n\nSimulieren wir uns 1e4 Zuckertüten!\n\n```{r}\nn <- 1e4\nd <- \n  tibble(\n    id = 1:n,\n    x = rnorm(n = n, mean = 1002, sd = 1.5)\n  )\n\nhead(d)\n```\n\n\nZählen wir, viele der Zuckertüten ein Gewicht von weniger als 1000g aufweisen:\n\n\n```{r}\nd %>% \n  count(x < 1000)\n```\n\n\nEin ziemlich^[\"Ziemlich\" ist natürlich subjektiv; je nach Situation kann es zu viel oder nicht zu viel sein.] kleiner Anteil. Rechnen wir uns noch die Anteile (*prop*ortion) aus:\n\n```{r}\nd %>% \n  count(x < 1000) %>% \n  mutate(prop = n/1e4)\n```\n\n\n\n\n\n\n\n### IQ-Verteilung\n\nDie Verteilung der Zufallsvariablen IQ ist normalverteilt mit einem Mittelwert von 100 und einer Streuung von 15, s. @fig-norm-100-15:\n\n$IQ \\sim \\mathcal{N}(100,15)$\n\n- Wie schlau muss man sein, um zu den unteren 75%, 50%, 25%, 5%, 1% zu gehören?\n- Anders gesagt: Welcher IQ-Wert wird von 75%, 50%, ... der Leute nicht überschritten?\n\n\n![Visualisierung der theoretischen IQ-Verteilung](img/norm-100-15.png){#fig-norm-100-15 width=\"50%\"}\n\n[Quelle:](https://jkkweb.sitehost.iu.edu/KruschkeFreqAndBayesAppTutorial.html#data_are_described_by_mathematical_models): John Kruschke.\n\n\nZiehen wir zufällig $1e4$ Stichproben aus $\\mathcal{N}(100,15)$ und berechnen die Quantile:\n\n```{r echo = TRUE}\nd <-\n  tibble(\n  iq = rnorm(n = 1e4, \n             mean = 100, \n             sd = 15))\n\nprobs <- c(0.75,.5,.25,.05,.01)\n\nd_summary <- d %>% \n  summarise(p = probs,\n            q = quantile(iq, probs))\n```\n\n\n\n```{r}\n#| echo: false\nd_summary %>% \n  gt() %>% \n  fmt_number(p, decimals = 2) %>% \n  fmt_number(q, decimals = 0)\n```\n\nDas *Quantil* $q$ zur kumulierten Wahrscheinlichkeit $p=75$ ist 110, etc. \n\n\n\n\n\n\nUmgekehrt können wir uns auch fragen: Gegeben einer Realisation der Zufallsvariablen (z.B. IQ), was ist die zugehörige Wahrscheinlichkeit (Wert der Verteilungsfunktion?)\n\n\n- Welcher Anteil der Fläche unter der Kurve $p$ gehört zu den IQ-Werten 75, 100, 115, 130?\n- Anders gesagt: Welcher Anteil der Wahrscheinlichkeitsmasse der Verteilung liegt unter IQ=75, IQ=100, etc.?\n\n\nZiehen wir Stichproben aus $\\mathcal{N}(100,15)$:\n\n```{r echo = TRUE, eval = FALSE}\nd <-\n  tibble(\n    iq = rnorm(1e4, \n               mean = 100, \n               sd = 15)) %>% \n  mutate(iq = round(iq))\n\nqs <- c(75,100,115,130)\n\nd %>% \n  count(p_100 = iq < 100) %>% \n  mutate(prop = n / sum(n)) \n```\n\n\n\n```{r echo = FALSE, eval = TRUE}\nd <-\n  tibble(\n    iq = rnorm(1e4, \n               mean = 100, \n               sd = 15)) %>% \n  mutate(iq = round(iq))\n\nqs <- c(75,100,115,130)\n\nd %>% \n  count(p_100 = iq < 100) %>% \n  mutate(prop = n / sum(n)) %>% \n  gt() %>% \n  fmt_number(columns = 3)\n```\n\nAnstelle von `iq < 100` kann man `iq < 115` einsetzen, etc.\n \n```{r eval= FALSE}\n#| echo: false\nd %>% \n  mutate(prop = percent_rank(iq)) %>% \n  filter(iq %in% qs) %>% \n  distinct(iq, .keep_all = TRUE)\n```\n\nDie *Verteilungsfunktion* (der Anteil der Wahrscheinlichkeitsmasse), `p`, für IQ-Werte nicht größer als 100,  $IQ\\le100$, ist 50%, etc. \n\n\n\n### Quantile der Normalverteilung \n\n\n\n\n\n- *Quantile* teilen eine Verteilung so ein, dass ein Anteil $p$ kleiner oder gleich und der andere Teil $1-p$ größer  dem Quantil $q$ ist.\n    - *Beispiel*: \"50%-Quantil = 100\" meint, dass 50% der Elemente der Verteilung einen Wert kleiner oder gleich als 100 haben.\n    \n- Die *Verteilungsfunktion F* (für einen Wert $x$) gibt die Wahrscheinlichkeit an, dass die zugehörige Zufallsvariable $X$ einen Wert höchstens so groß wie $x$ annimmt. Sie zeigt also die kumulierte Wahrscheinlichkeit $[-\\infty, q)$.\n    - *Beispiel*: \"F(100) = 50%\" meint: Die Wahrscheinlichkeit für eine Ausprägung von höchstens als 100 beträgt 50%.\n\n\nSchauen wir uns die Quartile der Normalverteilung einmal näher an.\nWir gehen von einer Normalverteilung aus, wie sie zur Beschreibung von Intelligenz (IQ) verwendet wird, s. @fig-nv-quants.\n\n\n```{r }\n#| echo: false\n#| label: fig-nv-quants\n#| fig-cap: Quantile der Normalverteiltung\n\n  \n\np1 <- \n  ggplot(NULL, aes(c(60,145))) +\n  geom_area(stat = \"function\", fun = dnorm, fill = \"grey\", args = list(mean=100,sd = 15), xlim= c(60, 100)) +\n  geom_line(stat = \"function\", fun = dnorm, args = list(mean=100,sd = 15)) +\n  labs(x = \"X\", y = \"Dichte\",\n       title = \"50%-Quantil: 100; Verteilungsfunktion von 100:50%\") +\n  scale_y_continuous(breaks = NULL)\n\np2 <-\n    ggplot(NULL, aes(c(60,145))) +\n  geom_area(stat = \"function\", fun = dnorm, fill = \"grey\", args = list(mean=100,sd = 15), xlim= c(60, 125)) +\n  geom_line(stat = \"function\", fun = dnorm, args = list(mean=100,sd = 15)) +\n  labs(x = \"X\", y = \"Dichte\",\n       title = \"95%-Quantil: 125; Verteilungsfunktion von 125:95%\") +\n  scale_y_continuous(breaks = NULL)\n\n\nplots(p1, p2)\n```\n\n$$IQ \\sim \\mathcal{N}(100, 15)$$\nMit R kann man sich die beiden Größen komfortabel berechnen lassen:\n\n```{r echo = TRUE, eval = FALSE}\nqnorm(.50, mean = 100, sd = 15)  # 50%-Quantil\npnorm(100, mean = 100, sd = 15)  # Verteilungsfunktion für IQ=100\n```\n\n\nBetrachten wir einige wichtigen Quantile, s. @fig-nv-quants2.\n\n```{r}\n#| echo: false\nq_p50 <-\n  ggplot(NULL, aes(c(60,145))) +\n  geom_area(stat = \"function\", fun = dnorm, fill = \"grey\", args = list(mean=100,sd = 15), xlim= c(60, 100)) +\n  geom_line(stat = \"function\", fun = dnorm, args = list(mean=100,sd = 15)) +\n  labs(x = \"IQ\", y = \"Dichte\",\n       title = \"50%-Quantil: 100\") +\n  scale_y_continuous(breaks = NULL)\n```\n\n\n```{r}\n#| echo: false\nq_inv <- .25\nq_p <- qnorm(q_inv, mean = 100, sd= 15)\np_q <- pnorm(q_p, mean = 100, sd= 15)\n\nq_p25 <-\n  ggplot(NULL, aes(c(60,145))) +\n  geom_area(stat = \"function\", fun = dnorm, fill = \"grey\", args = list(mean=100,sd = 15), xlim= c(60, q_p)) +\n  geom_line(stat = \"function\", fun = dnorm, args = list(mean=100,sd = 15)) +\n  labs(x = \"IQ\", y = \"Dichte\",\n       title = paste0(q_inv,\"-Quantil: \",round(q_p)),\n       caption = \"MW-0.68sd\") +\n  scale_y_continuous(breaks = NULL)\n```\n\n\n```{r}\n#| echo: false\nq_inv <- .95\nq_p <- qnorm(q_inv, mean = 100, sd= 15)\n\nq_p95 <-\n  ggplot(NULL, aes(c(60,145))) +\n  geom_area(stat = \"function\", fun = dnorm, fill = \"grey\", args = list(mean=100,sd = 15), xlim= c(60, q_p)) +\n  geom_line(stat = \"function\", fun = dnorm, args = list(mean=100,sd = 15)) +\n  labs(x = \"IQ\", y = \"Dichte\",\n       title = paste0(q_inv,\"-Quantil: \",round(q_p)),\n       caption = \"MW+1.64sd\") +\n  scale_y_continuous(breaks = NULL)\n```\n\n\n\n```{r}\n#| echo: false\nq_inv <- .975\nq_p <- qnorm(q_inv, mean = 100, sd= 15)\n#pnorm(115, mean= 100, sd = 15)\n\nq_p975 <-\n  ggplot(NULL, aes(c(60,145))) +\n  geom_area(stat = \"function\", fun = dnorm, fill = \"grey\", args = list(mean=100,sd = 15), xlim= c(60, q_p)) +\n  geom_line(stat = \"function\", fun = dnorm, args = list(mean=100,sd = 15)) +\n  labs(x = \"IQ\", y = \"Dichte\",\n       title = paste0(q_inv,\"-Quantil: \",round(q_p)),\n       caption = \"MW+2SD\") +\n  scale_y_continuous(breaks = NULL)\n```\n\n\n\n\n\n```{r}\n#| echo: false\nq_inv <- .84\nq_p <- qnorm(q_inv, mean = 100, sd= 15)\n#pnorm(115, mean= 100, sd = 15)\n\nq_p84 <-\n  ggplot(NULL, aes(c(60,145))) +\n  geom_area(stat = \"function\", fun = dnorm, fill = \"grey\", args = list(mean=100,sd = 15), xlim= c(60, q_p)) +\n  geom_line(stat = \"function\", fun = dnorm, args = list(mean=100,sd = 15)) +\n  labs(x = \"IQ\", y = \"Dichte\",\n       title = paste0(q_inv,\"-Quantil: \",round(q_p)),\n       caption = \"MW+1sd\") +\n  scale_y_continuous(breaks = NULL)\n```\n\n```{r}\n#| echo: false\nq_inv <- .69\nq_p <- qnorm(q_inv, mean = 100, sd= 15)  # halbe SD\n#pnorm(107.5, mean= 100, sd = 15)\n\nq_p69 <-\n  ggplot(NULL, aes(c(60,145))) +\n  geom_area(stat = \"function\", fun = dnorm, fill = \"grey\", args = list(mean=100,sd = 15), xlim= c(60, q_p)) +\n  geom_line(stat = \"function\", fun = dnorm, args = list(mean=100,sd = 15)) +\n  labs(x = \"IQ\", y = \"Dichte\",\n       title = paste0(q_inv,\"-Quantil: \",round(q_p)),\n       caption = \"MW+0.5sd\") +\n  scale_y_continuous(breaks = NULL)\n```\n\n\n\n```{r fig-nv-quants2}\n#| echo: false\n#| label: fig-nv-quants2\n#| fig-width: 10\n#| fig-cap: Verschiedene Quantil der Normalverteilung\n\n(q_p50 + q_p25 + q_p69) / (q_p95 + q_p975 + q_p84)\n```\n\n\n### Standardnormalverteilung\n\n\n```{r Normalverteilung-3}\n#| echo: false\nggplot(data = data.frame(x = c(-3, 3)), aes(x)) +\n  stat_function(fun = dnorm, n = 101, args = list(mean = 0, sd = 1)) +\n  labs(y = \"Dichte\", x = \"Merkmal, X\") +\n  ggtitle(\"Normalverteilung mit Mittelwert 0 und SD 1\")\n```\n\nBei $X=0$:\n\n- hat eine Einheit von $X$ die Wahrscheinlichkeitsmasse von 40% (Wahrscheinlichkeitsdichte)\n- sind 50% der Wahrscheinlichkeitsmasse (Fläche unter der Kurve) kleiner als dieser Wert (Verteilungsfunktion).\n\nIn Summe liegen 100% der Wahrscheinlichkeitsmasse unter der Kurve.\n\n\n### Normalverteilung als konservative Wahl\n\nDem Mathematiker [Carl Friedrich Gauss](https://de.wikipedia.org/wiki/Carl_Friedrich_Gau%C3%9F) (s. @fig-gauss) wird die Ehre zuerkannt,\ndie Normalverteilung eingeführt zu haben.\n\n```{r Normalverteilung-1-bis, echo = FALSE }\n#| fig-align: \"center\"\n#| label: fig-gauss\n#| fig-cap: \"Zehn-Mark-Geldschein mit Gauss und Normalverteilung\"\nknitr::include_graphics(\"img/10_Deutsche_Mark_-_detail.png\")\n```\n\nQuelle: Uni Greifswald, Public domain, via Wikimedia Commons\n\n\n::: callout-note\n*Ontologische Begründung*\n\n- Wirken viele, gleichstarke Einflüsse additiv zusammen, entsteht eine Normalverteilung  [@mcelreath_statistical_2020], Kap. 4.1.4.\n\n*Epistemologische Begründung*\n\n- Wenn wir nur wissen, dass eine Variable über einen endlichen Mittelwert und eine endliche Varianz verfügt und wir keine weiteren Annahmen treffen bzw. über kein weiteres Vorwissen verfügen, dann ist die Normalverteilung die plausibelste Verteilung (maximale Entropie) [@mcelreath_statistical_2020], Kap. 7 und 10.\n:::\n\n\n<!-- ### Zweidimensionale Normalverteilung, unkorreliert -->\n\n\n<!-- ```{r Normalverteilung-11, out.width=\"70%\", fig.align=\"center\"} -->\n<!-- #| echo: false -->\n<!-- knitr::include_graphics(\"https://github.com/sebastiansauer/QM2-Folien/raw/main/img/mult-norm.png\") -->\n<!-- ``` -->\n\n\n<!-- [Quelle](https://tex.stackexchange.com/questions/31708/draw-a-bivariate-normal-distribution-in-tikz) -->\n\n<!-- [Vgl. auch dieses Diagramm](http://ballistipedia.com/index.php?title=File:Bivariate.png)] -->\n\n\n\n\n<!-- ### 2D-Normalverteilung mit R, unkorreliert -->\n\n<!-- $r(X,Y) = 0$ -->\n\n\n\n\n<!-- ```{r norm-plot1} -->\n<!-- #| echo: false -->\n<!-- #| eval: false -->\n<!-- #| fig-asp: 1 -->\n<!-- #| out-width: \"50%\" -->\n<!-- d1 <-  -->\n<!--   tibble(  -->\n<!--     x=rnorm(1e4),  -->\n<!--     y=rnorm(1e4) -->\n<!--   ) -->\n\n<!-- ggplot(d1) + -->\n<!--   aes(x, y) + -->\n<!--   geom_hex()  -->\n\n<!-- ggplot(d1) + -->\n<!--   aes(x, y) + -->\n<!--   geom_density2d() -->\n<!-- ``` -->\n\n<!-- [[ggplot-Referenz](https://ggplot2.tidyverse.org/reference/geom_density_2d.html), [Quellcode](https://www.r-graph-gallery.com/2d-density-plot-with-ggplot2.html)] -->\n\n<!-- Mit `scale_fill_continuous(type = \"viridis\")`kann man die Farbpalette der Füllfarbe ändern. Nicht so wichtig. -->\n\n\n<!-- ```{r Normalverteilung-2-bis} -->\n<!-- #| echo: false -->\n<!-- #| eval: true -->\n<!-- #| fig-asp: 1 -->\n<!-- #| out-width: \"50%\" -->\n<!-- d1 <-  -->\n<!--   tibble(  -->\n<!--     x=rnorm(1e4),  -->\n<!--     y=rnorm(1e4) -->\n<!--   ) -->\n\n<!-- ggplot(d1) + -->\n<!--   aes(x, y) + -->\n<!--   geom_hex() + -->\n<!--   scale_fill_viridis_c() + -->\n<!--   theme(legend.position = \"bottom\") -->\n\n<!-- ggplot(d1) + -->\n<!--   aes(x, y) + -->\n<!--   geom_density2d() -->\n<!-- ``` -->\n\n\n\n<!-- ### 2D-Normalverteilung mit R, korreliert, r=0.7 -->\n\n\n\n<!-- Die ersten paar Zeilen der Daten: -->\n\n<!-- ```{r Normalverteilung-3-bis, echo = FALSE} -->\n<!-- d2 <- rnorm_multi( -->\n<!--   n = 1e4, -->\n<!--   mu = c(0,0), -->\n<!--   sd = c(1, 1), -->\n<!--   r = (0.7) -->\n<!-- ) -->\n<!-- ``` -->\n\n<!-- ```{r Normalverteilung-4-bis} -->\n<!-- #| echo: false -->\n<!-- d2 %>%  -->\n<!--   head(n=3) %>%  -->\n<!--   gt() %>%  -->\n<!--   fmt_number(columns = everything()) -->\n<!-- ``` -->\n\n<!-- Berechnen wir die Korrelation `r`: -->\n\n<!-- ```{r Normalverteilung-5-bis, echo = TRUE, eval = FALSE} -->\n<!-- d2 %>%  -->\n<!--   summarise( -->\n<!--     r = cor(X1,X2), -->\n<!--     n = n() -->\n<!--   ) -->\n<!-- ``` -->\n\n<!-- ```{r Normalverteilung-6-bis} -->\n<!-- #| echo: false -->\n<!-- d2 %>%  -->\n<!--   summarise( -->\n<!--     r = cor(X1,X2), -->\n<!--     n = n() -->\n<!--   ) %>%  -->\n<!--   gt() %>%  -->\n<!--   fmt_number(columns = everything()) -->\n<!-- ``` -->\n\n\n\n\n<!-- ```{r Normalverteilung-7-bis} -->\n<!-- #| echo: false -->\n<!-- ggplot(d2) + -->\n<!--   aes(X1, X2) + -->\n<!--   geom_hex() + -->\n<!--   scale_fill_viridis_c() + -->\n<!--   theme(legend.position = \"bottom\") -->\n\n<!-- ggplot(d2) + -->\n<!--   aes(X1, X2) + -->\n<!--   geom_density2d() -->\n<!-- ``` -->\n\n\n\n\n\n\n\n\n\n## Aufgaben\n\n\nZusätzlich zu den Aufgaben im Buch:\n\n\n- [Lose-Nieten-Binomial-Grid](https://datenwerk.netlify.app/posts/lose-nieten-binomial-grid/lose-nieten-binomial-grid)\n- [Bsp-Binomial](https://datenwerk.netlify.app/posts/bsp-binomial/bsp-binomial)\n\n\n\n\n\n\n## ---\n\n\n\n![](img/outro-04.jpg){width=100%}\n\n\n\n\n","srcMarkdownNoYaml":""},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"kable","error":false,"eval":true,"cache":true,"freeze":"auto","echo":true,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":true,"output-divs":true,"output-ext":"html","fig-align":"center","fig-pos":null,"fig-env":null,"code-fold":true,"code-overflow":"scroll","code-link":true,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true,"format-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","toc":true,"number-sections":true,"output-file":"Verteilungen.html"},"language":{"toc-title-document":"Inhaltsverzeichnis","toc-title-website":"Auf dieser Seite","related-formats-title":"Andere Formate","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Quelle","section-title-abstract":"Zusammenfassung","section-title-appendices":"Anhang","section-title-footnotes":"Fußnoten","section-title-references":"Literatur","section-title-reuse":"Wiederverwendung","section-title-copyright":"Urheberrechte","section-title-citation":"Zitat","appendix-attribution-cite-as":"Bitte zitieren Sie diese Arbeit als:","appendix-attribution-bibtex":"Mit BibTeX zitieren:","title-block-author-single":"Autor:in","title-block-author-plural":"Autor:innen","title-block-affiliation-single":"Zugehörigkeit","title-block-affiliation-plural":"Zugehörigkeiten","title-block-published":"Veröffentlichungsdatum","title-block-modified":"Geändert","callout-tip-title":"Tipp","callout-note-title":"Hinweis","callout-warning-title":"Warnung","callout-important-title":"Wichtig","callout-caution-title":"Vorsicht","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Gesamten Code zeigen","code-tools-hide-all-code":"Gesamten Code verbergen","code-tools-view-source":"Quellcode anzeigen","code-tools-source-code":"Quellcode","code-line":"Zeile","code-lines":"Zeilen","copy-button-tooltip":"In die Zwischenablage kopieren","copy-button-tooltip-success":"Kopiert","repo-action-links-edit":"Seite editieren","repo-action-links-source":"Quellcode anzeigen","repo-action-links-issue":"Problem melden","back-to-top":"Zurück nach oben","search-no-results-text":"Keine Treffer","search-matching-documents-text":"Treffer","search-copy-link-title":"Link in die Suche kopieren","search-hide-matches-text":"Zusätzliche Treffer verbergen","search-more-match-text":"weitere Treffer in diesem Dokument","search-more-matches-text":"weitere Treffer in diesem Dokument","search-clear-button-title":"Zurücksetzen","search-detached-cancel-button-title":"Abbrechen","search-submit-button-title":"Abschicken","search":"Suchen","toggle-sidebar":"Seitenleiste umschalten","toggle-dark-mode":"Dunkelmodus umschalten","toggle-reader-mode":"Lesemodus umschalten","toggle-navigation":"Navigation umschalten","crossref-fig-title":"Abbildung","crossref-tbl-title":"Tabelle","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Korollar","crossref-prp-title":"Aussage","crossref-cnj-title":"Annahme","crossref-def-title":"Definition","crossref-exm-title":"Beispiel","crossref-exr-title":"Übungsaufgabe","crossref-ch-prefix":"Kapitel","crossref-apx-prefix":"Anhang","crossref-sec-prefix":"Kapitel","crossref-eq-prefix":"Gleichung","crossref-lof-title":"Abbildungsverzeichnis","crossref-lot-title":"Tabellenverzeichnis","crossref-lol-title":"Listingverzeichnis","environment-proof-title":"Beweis","environment-remark-title":"Anmerkung","environment-solution-title":"Lösung","listing-page-order-by":"Sortieren nach","listing-page-order-by-default":"Voreinstellung","listing-page-order-by-date-asc":"Datum (aufsteigend)","listing-page-order-by-date-desc":"Neueste","listing-page-order-by-number-desc":"Absteigend","listing-page-order-by-number-asc":"Aufsteigend","listing-page-field-date":"Datum","listing-page-field-title":"Titel","listing-page-field-description":"Beschreibung","listing-page-field-author":"Autor:in","listing-page-field-filename":"Dateiname","listing-page-field-filemodified":"Geändert","listing-page-field-subtitle":"Untertitel","listing-page-field-readingtime":"Lesezeit","listing-page-field-categories":"Kategorien","listing-page-minutes-compact":"{0} min","listing-page-category-all":"alle","listing-page-no-matches":"Keine Treffer"},"metadata":{"lang":"de","fig-responsive":true,"quarto-version":"1.3.247","bibliography":["references.bib"],"editor":"source","knitr":{"opts_knit":{"verbose":true,"fig-align":"center"},"opts_chunk":{"collapse":true,"R.options":{"knitr.graphics.auto_pdf":true}}},"theme":"cosmo"},"extensions":{"book":{"multiFile":true}}}}}