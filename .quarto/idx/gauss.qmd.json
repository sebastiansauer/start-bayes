{"title":"Gauss-Modelle","markdown":{"yaml":{"output":"html_document","editor_options":{"chunk_output_type":"console"}},"headingText":"Gauss-Modelle","containsRefs":false,"markdown":"\n\n\n![Bayes:Start!](img/Golem_hex.png){width=10%}\n\n\n\n\n## Software\n\nF√ºr dieses Thema ben√∂tigen Sie einige R-Pakete, die Sie wie folgt installieren k√∂nnen:\n\n```{r install-libs, eval = FALSE, echo=TRUE}\npakete <- c(\"tidyverse\", \"rstanarm\", \"easystats\")\n\ninstall.packages(pakete)\n```\n\nF√ºr `rstanarm` wird [weitere Software](https://github.com/stan-dev/rstan/wiki/RStan-Getting-Started) ben√∂tigt.\n\n:::callout-note\nSoftware, und das sind R-Pakete, m√ºssen Sie nur einmalig installieren. Aber bei jedem\nStart von R bzw. RStudio m√ºssen Sie die (ben√∂tigten!) Pakete starten.\n:::\n\n\n```{r load-libs-hidden}\n#| include: false\nlibrary(gt)\nlibrary(patchwork)\nlibrary(figpatch)\nlibrary(ggExtra)\n```\n\n```{r load-libs-non-hidden}\nlibrary(tidyverse)\nlibrary(rstanarm)\nlibrary(easystats)\n```\n\n\n## Wie gro√ü sind die !Kung San?\n\nDieser Abschnitt basiert auf @mcelreath_statistical_2020, Kap. 4.3.\n\n### !Kung San \n\n\n\n```{r Kung-1 }\n#| echo: false\nknitr::include_graphics(\"https://upload.wikimedia.org/wikipedia/commons/b/b5/Wandering_hunters_%28Masarwa_bushmen%29%2C_North_Kalahari_Desert.jpg\")\n```\n\n\n\n\n\n[Quelle](https://upload.wikimedia.org/wikipedia/commons/b/b5/Wandering_hunters_%28Masarwa_bushmen%29%2C_North_Kalahari_Desert.jpg) Internet Archive Book Images, No restrictions, via Wikimedia Commons]\n\n\n\n```{r Kung-2 }\n#| echo: false\nknitr::include_graphics(\"https://upload.wikimedia.org/wikipedia/commons/thumb/2/21/KhoisanLanguagesModernDistribution.png/1024px-KhoisanLanguagesModernDistribution.png\")\n```\n\n\nBy Andrewwik.0 - Own work, CC BY-SA 4.0, [Quelle](https://commons.wikimedia.org/w/index.php?curid=79801340)]\n\n\n\n### !Kung Data\n\n\n\n[Datenquelle](https://raw.githubusercontent.com/sebastiansauer/2021-wise/main/Data/Howell1a.csv)\n\n\n```{r Post-Regression-3}\nKung_path <-  \n  \"https://raw.githubusercontent.com/sebastiansauer/Lehre/main/data/Howell1a.csv\"  \n\nd <- read_csv(Kung_path)  \n\nhead(d)\n```\n\n\nWir interessieren uns f√ºr die Gr√∂√üe der erwachsenen !Kung:\n```{r Kung-5}\nd2 <- d %>% \n  filter(age >= 18)\n```\n\n\n$N=`r nrow(d2)`$.\n\n```{r Kung-7, echo = TRUE, eval = FALSE}\n#| eval: false\ndescribe_distribution(d2)\n```\n\n\n\n```{r Kung-7a, eval = TRUE}\n#| echo: false\ndescribe_distribution(d2) %>% \n  gt() %>% \n  fmt_number(columns = c(3:last_col()))\n```\n\n\n\n### Wir gehen apriori von normalverteilter Gr√∂√üe Der !Kung aus\n\n\n```{r Kung-8, echo = FALSE, out.width=\"50%\" }\n#| out-width: \"25%\"\n#| echo: false\nknitr::include_graphics(\"https://upload.wikimedia.org/wikipedia/commons/8/83/SVG_Human_Silhouette.svg\")\n```\n\n\nOwn alterations andFile:SVG_Human_With_All_Organs.svg by Madhero88, CC BY-SA 3.0 <https://creativecommons.org/licenses/by-sa/3.0>, via Wikimedia Commons\n\n$$\\mu \\sim \\mathcal{N}(178, 20)$$\n\n\nWarum 178 cm? Kein besonderer Grund. Hier wollen wir den Effekt verschiedener Priori-Werte untersuchen.\nIn einer echten Untersuchung sollte man immer einen inhaltlichen Grund f√ºr einen Priori-Wert haben.\n*Oder* man w√§hlt \"schwach informative\" Prioris, wie das `{rstanarm}` tut:\nDamit l√§sst man kaum Vorab-Information in das Modell einflie√üen,\naber man verhindert extreme Prioris, die meistens unsinnig sind (so wie eine SD von 100 Metern in diesem Fall).\n\n\n\n\n```{r Kung-9, out.width=\"70%\"}\n#| echo: false\np1 <-\n  tibble(x = seq(from = 100, to = 250, by = .1)) %>% \n  \n  ggplot(aes(x = x, y = dnorm(x, mean = 178, sd = 20))) +\n  geom_line() +\n  scale_x_continuous(breaks = seq(from = 100, to = 250, by = 75)) +\n  labs(title = \"mu ~ dnorm(178, 20)\",\n       y = \"\") +\n  scale_y_continuous(breaks = NULL)\n\np2 <-\n  tibble(x = seq(0, 50, by = .01)) %>%\n  ggplot(aes(x = x, y = dexp(x, rate = .1))) +\n  geom_line() +\n  scale_x_continuous() +\n  scale_y_continuous(NULL, breaks = NULL) +\n  ggtitle(\"sigma ~ dexp(0.1)\")\n```\n\n\n\n### Unser Gauss-Modell der !Kung\n\nWir nehmen an, dass $\\mu$ und $h_i$ normalverteilt sind und $\\sigma$ exponentialverteilt (da notwendig positiv) ist:\n\n\n\nLikelihood:\n\n$h_i \\sim \\mathcal{N}(\\mu, \\sigma)$\n\nPrior f√ºr $\\mu$:\n\n$\\mu \\sim \\mathcal{N}(178, 20)$\n\nPrior f√ºr $\\sigma$:\n\n$\\sigma \\sim \\mathcal{E}(0, 0.1)$\n\n</br>\n</br>\n\n$95\\%KI( \\mu):$\n\n$178 \\pm 40$\n\n\nHier sind unsere Priori-Verteilungen visualisiert:\n\n\n```{r Kung-10}\n#| echo: false\np1 + p2\n```\n\n\n\n\n## Priori gewichtet mit Likelihood ergibt Posteriori\n\n\nZu Erinnerung: Die Posteriori-Wahrscheinlichkeit ist das Ergebnis von Priori-Wahrscheinlichkeit und Likelihood.\n\n\n### Likelihood\n\nDie K√∂rpergr√∂√üen der einzelnen Personen $h_i$ sind normalverteilt mit Mittelwert $\\mu$ und Streuung $\\sigma$:\n\n$$h_i \\sim \\mathcal{N}(\\color{blue}{\\mu},\\color{green}{\\sigma})$$\n\n\n### Prioris\n\nMittelwert der Gr√∂√üe ist normalverteilt mit $\\mu=178$ und $\\sigma=20$:\n\n$$\\color{blue}{\\mu \\sim \\mathcal{N}(178, 20)}$$\n\nDie Streuung $\\sigma$ der Gr√∂√üen ist exponentialverteil mit $\\lambda = 0.1$.\n\n$$\\color{green}{\\sigma \\sim \\mathcal{E}(0.1)}$$\n\n## Zuf√§llige Motivationsseite\n\n\n```{r Kung-18, echo = FALSE }\n#| echo: false\nknitr::include_graphics(\"https://raw.githubusercontent.com/sebastiansauer/QM2-Folien/main/img/pretty_good.gif\")\n```\n\n\n\n\n## Posteriori-Verteilung des Gr√∂√üen-Modells, `m41`\n\n\n\n```{r Kung-4, message=FALSE, results=\"hide\"}\nm41 <- stan_glm(height ~ 1, data = d2, refresh = 0)\nm41_post <- as_tibble(m41)\nnames(m41_post) <- c(\"mu\", \"sigma\")  # sch√∂nere Namen f√ºr die Spalten\n```\n\n\nDas Argument `refresh = 0` verhindert, dass die Dateils zum Ziehen der Stichproben am Bildschirm ausgegeben werden. Ich finde diese Ausgabe meist nicht informativ,\nso dass ich sie lieber unterdr√ºcke.\n\nF√ºr das Modell `m41` haben wir *keine* Prioris spezifiziert.\nWir greifen damit auf die Voreinstellung der Prioris von `rstanarm` zur√ºck.\nDas ist ok, aber wenn Sie Vorab-Wissen haben,\nsollten Sie das an `rstanarm` weitergeben, weil es ja schade w√§re,\nwenn Sie Wissen haben, das von Ihrem Modell nicht genutzt wird.\n\nPlotten wir mal die Posteriori-Verteilung von `m41`: \n\n```{r post-m41-plot}\n#|  echo: true\nm41_post %>% \n  ggplot() +\n  aes(x = mu, y = sigma) %>% \n  geom_hex() +\n  scale_fill_viridis_c() \n```\n\nDa das Modell zwei Parameter hat, k√∂nnen wir auch beide gleichzeitig plotten.\nWie man sieht, sind die beiden Parameter unkorreliert.\nIn anderen Modellen k√∂nnen die Parameter korreliert sein.\n\n\n\nHier noch eine andere Visualisierung:\n\n```{r Kung-5-bis}\np_m41_post <- \n  m41_post %>% \n  ggplot() +\n  aes(x = mu, y = sigma) +\n  geom_point(alpha = .1) \n\nggExtra::ggMarginal(p_m41_post, type = \"density\")\n```\n\n\nNat√ºrlich k√∂nnen wir auch nur einen Parameter plotten:\n\n\n```{r}\nm41_post %>% \n  ggplot(aes(x = mu)) + \n  geom_histogram()\n```\n\n\n\n\n- Wir bekommen eine Wahrscheinlichkeitsverteilung f√ºr $\\mu$ und eine f√ºr $\\sigma$ (bzw. eine zweidimensionale Verteilung, f√ºr die $\\mu,\\sigma$-Paare).\n\n- Trotz des eher vagen Priors ist die Streuung Posteriori-Werte f√ºr $\\mu$ und $\\sigma$ klein: Die gro√üe Stichprobe hat die Priori-Werte √ºberstimmt.\n\n- Ziehen wir Stichproben aus der Posteriori-Verteilung, so k√∂nnen wir interessante Fragen stellen. \n\n\n\n\n### Hallo, Posteriori-Verteilung\n\n... wir h√§tten da mal ein paar Fragen an Sie. üïµ\n\n\n1. Mit welcher Wahrscheinlichkeit ist die mittlere !Kung-Person gr√∂√üer als 1,55m?\n2. Welche mittlere K√∂rpergr√∂√üe wird mit 95% Wahrscheinlichkeit nicht √ºberschritten, laut dem Modell?\n3. In welchem 90%-PI liegt $\\mu$ vermutlich?\n4. Mit welcher Unsicherheit ist die Sch√§tzung der mittleren K√∂rpergr√∂√üe behaftet?\n5. Was ist der mediane Sch√§tzwert der mittleren K√∂rpergr√∂√üe, sozusagen der \"Best Guess\"?\n\n\nAntworten folgen etwas weiter unten.\n\n\n\n\n\nAbschli√üend, eigentlich nur Spielerei, noch eine andere Visualisierung der Post-Verteilung von $\\mu$ und von $\\sigma$:\n\n```{r Kung-22, fig.asp = 1}\nm41_post %>% \n  pivot_longer(mu:sigma) %>% \n  ggplot(aes(x = value)) + \n  geom_density(fill = \"grey33\") +\n  scale_y_continuous(NULL, breaks = NULL) +\n  xlab(NULL) +\n  theme(panel.grid = element_blank()) +\n  facet_wrap(~ name, scales = \"free\", \n             labeller = label_parsed,\n             nrow = 2)\n```\n\n\n\n\n### Posteriori-Stichproben mit `stan_glm()` berechnen \n\n- Mit `stan_glm()` k√∂nnen wir komfortabel die Posteriori-Verteilung berechnen. \n- Die Gittermethode wird nicht verwendet, aber die Ergebnisse sind - in bestimmten Situationen - √§hnlich.\n- Es werden aber auch viele Stichproben simuliert (sog. MCMC-Methode).\n- Gibt man keine Priori-Werte an, so greift die Funktion auf Standardwerte zur√ºck.\n\n\n```{r Kung-23, echo = TRUE, eval = FALSE}\n#| eval: false\nlibrary(rstanarm)  # Paket muss gestartet sein.\n\n# berechnet Post.-Vert.:\nstan_glm(\n  # modelldefinition:\n  AV ~ UV,\n  # Datensatz:\n  data = meine_daten\n)\n```\n\n\n\nModelldefinition:\n\n$h_i \\sim \\mathcal{N}(\\mu, \\sigma)$, Likelihood\n\n$\\mu \\sim \\mathcal{N}(155, 19)$, Prior Gr√∂√üenmittelwert\n\n$\\sigma \\sim \\mathcal{E}(0.13)$, Prior Streuung der Gr√∂√üen\n\n\n\n\n\n### Ausgabe von `stan_glm()`\n\n\n```{r Kung-24, echo = TRUE, results=\"hide\"}\nm41 <- stan_glm(height ~ 1, data = d2, refresh = 0)  # aus Paket rstanarm\n\nparameters(m41)  # aus Paket easystats\n```\n\n\n\n\n```{r Kung-6}\n#| echo: false\nparameters(m41) %>% display()\n```\n\n\n\n\n## Wie tickt `stan_glm()`?\n\n\n\n```{r Kung-7-bis}\n#| echo: false\n#| out-width: \"10%\"\nknitr::include_graphics(\"https://mc-stan.org/rstanarm/reference/figures/stanlogo.png\")\n```\n\n[Quelle](https://mc-stan.org/)\n\n- *Stan* ist eine Software zur Berechnung von Bayesmodellen; das Paket `rstanarm` stellt Stan f√ºr uns bereit.\n- `stan_glm()` ist f√ºr die Berechnung von Regressionsmodellen ausgelegt.\n- Will man nur die Verteilung einer Variablen (wie `heights`) sch√§tzen, so hat man man ... eine Regression ohne Pr√§diktor.\n- Eine Regression ohne Pr√§diktor schreibt man auf Errisch so: `y ~ 1`. Die `1` steht also f√ºr die nicht vorhandene UV; `y` meint die AV (`height`).\n- `MAD_SD` ist eine robuste Version der Streuung, mit inhaltlich gleicher Aussage\n- `(Intercept)` (Achsenabschnitt) gibt den Mittelwert an.\n\n\n\n[Dokumentation RstanArm](https://mc-stan.org/rstanarm/)\n\n\n\n### Stichproben aus der Posteriori-Verteilung ziehen\n\n\n\nHier die ersten paar Zeilen von `post_m41`:\n\n\n\n```{r Kung-26}\npost_m41 <- as_tibble(m41)\nhead(post_m41)\n```\n\n\n\nMit welcher Wahrscheinlichkeit ist $\\mu>155$? \n\n```{r Kung-28, echo = TRUE}\nnames(post_m41) <- \n  c(\"mu\", \"sigma\")  # den Namen \"(Intercept)\" durch \"mu\" ersetzen, ist k√ºrzher\n\npost_m41 %>% \n  count(mu > 155) %>% \n  mutate(prop = n/sum(n))\n```\n\n\n### Antworten von der Posteriori-Verteilung\n\n\n\nWelche mittlere K√∂rpergr√∂√üe wird mit 95% Wahrscheinlichkeit nicht √ºberschritten, laut dem Modell `m41`?\n\n```{r Kung-29, echo = TRUE}\npost_m41 %>% \n  summarise(q95 = quantile(mu, .95))\n```\n\n\n\nIn welchem 90%-PI liegt $\\mu$ vermutlich?\n\n```{r Kung-30, echo = TRUE}\npost_m41 %>% \n  summarise(pi_90 = quantile(mu, c(0.05, 0.95)))\n```\n\n\nMit welcher Unsicherheit ist die Sch√§tzung der mittleren K√∂rpergr√∂√üe behaftet?\n\n\n\n```{r}\nm41 %>% \n  parameters()\n```\n\n\n\n\nSeeing is believing:\n\n```{r}\nm41 %>% \n  parameters() %>% \n  plot(show_intercept = TRUE)\n```\n\n\nDas Modell ist sich recht sicher: die Ungewissheit der mittleren K√∂rpergr√∂√üe liegt bei nicht viel mehr als einem Zentimeter (95%-CI).\n\n\nWas ist der mediane Sch√§tzwert der mittleren K√∂rpergr√∂√üe, sozusagen der \"Best Guess\"?\n\n\n`parameters(m41)` hat uns die Antwort schon gegeben: Ca. 155 cm.\n\n\n\n\n\nüèãÔ∏è √Ñhnliche Fragen bleiben als √úbung f√ºr die Lesis ü§ì.\n\n\n\n### Standard-Prioriwerte bei `stan_glm()`\n\n```{r Kung-8-bis, echo = TRUE}\nprior_summary(m41)\n```\n\n\n\n\n\n- `stan_glm()` verwendet (in der Voreinstellung) *schwach informative* Priori-Werte, die nur wenig Vorabwissen in das Modell geben.\n- Es werden daf√ºr die Stichproben-Daten als Priori-Daten verwendet.\n- Man sollte diese Standardwerte als Minimalvorschlag sehen. Kennt man sich im Sachgebiet aus, kann man meist bessere Prioris finden.\n- Die Voreinstellung hat keinen tiefen Hintergrund; andere Werte w√§ren auch denkbar.\n\n\n- `Intercept`: $\\mu$, der Mittelwert der Verteilung $Y$\n    - $\\mu \\sim \\mathcal{N}(\\bar{Y}, sd(Y)\\cdot 2.5)$\n    - als Streuung von $\\mu$ wird die 2.5-fache Streuung der Stichprobe (f√ºr $Y$) angenommen.\n\n- `Auxiliary (sigma)`: $\\sigma$, die Streuung der Verteilung $Y$\n    - $\\sigma \\sim \\mathcal{E}(\\lambda=1/sd(Y))$\n    - als \"Streuung\", d.h. $\\lambda$ von $h_i$ wird $\\frac{1}{sd(Y)}$ angenommen.\n    \n    \n   \n### Visualisierung verschiedener Exponentialverteilungen\n\nUm ein Gef√ºhl zu bekommen, wieviel Ungewissheit in Exponentialverteilugnen mit verschiedener Streuung liegt, sind hier mal ein paar Varianten dargestellt.\n\n```{r Kung-9-bis}\n#| echo: false\n\nr <- 2\np_r2 <- \nggplot(NULL, aes(c(0,50))) +\n  geom_area(stat = \"function\", fun = dexp, fill = \"grey\", args = list(rate = r))  +\n  labs(title = paste0(\"Exp(\",r,\")\"),\n       x = \"sigma\")\n```\n\n\n\n```{r Kung-10-bis}\n#| echo: false\n\nr <- 1\np_r1 <- \nggplot(NULL, aes(c(0,50))) +\n  geom_area(stat = \"function\", fun = dexp, fill = \"grey\", args = list(rate = r))  +\n  labs(title = paste0(\"Exp(\",r,\")\"),\n       x = \"sigma\")\n```\n\n\n\n```{r Kung-11}\n#| echo: false\n\nr <- 1/8\np_r1_8 <- \nggplot(NULL, aes(c(0,50))) +\n  geom_area(stat = \"function\", fun = dexp, fill = \"grey\", args = list(rate = r))  +\n  labs(title = paste0(\"Exp(\",r,\")\"),\n       x = \"sigma\")\n```\n\n\n```{r Kung-12-bis}\n#| echo: false\n\nr <- 1/25\np_r1_25 <- \nggplot(NULL, aes(c(0,50))) +\n  geom_area(stat = \"function\", fun = dexp, fill = \"grey\", args = list(rate = r))  +\n  labs(title = paste0(\"Exp(\",r,\")\"),\n       x = \"sigma\")\n```\n\n\n```{r Kung-13-bis}\n#| echo: false\n(p_r1_25 + p_r1_8) / (p_r1 + p_r2)\n```\n\n\nEine sinnvolle Strategie ist, einen Prior so zu w√§hlen, dass man nicht √ºbergewiss ist,\nalso nicht zu sicher Dinge behauptet, die dann vielleicht doch passieren (also die Ungewissheit zu gering spezifiziert),\nandererseits sollte man extreme, unplausible Werte ausschle√üen.\n\n$\\lambda \\approx 0.1$ scheint eine sinnvolle Ungewissheit anzugeben.\n\n\n:::callout-important\nBei der Wahl der Prioris gibt es nicht die eine, richtige Wahl.\nDie beste Entscheidung ist auf transparente Art den Stand der Forschung einflie√üen zu lassen und eigene Entscheidungen zu begr√ºnden. H√§ufig sind mehrere Entscheidungen m√∂glich.\nM√∂chte man lieber vorsichtig sein, weil man wenig √ºber den Gegenstand wei√ü,\ndann k√∂nnte man z.B. auf die Voreinstellung von `rstanarm` vertrauen,\ndie \"schwachinformativ\" ist, also nur wenig Priori-Information  ind das Modell einflie√üen l√§sst.\n:::\n\n\n\n\n## Modell `m42`: unsere Priori-Werte \n\nIm Modell `m41` haben wir auf die Priori-Werte der Voreinstellung von `rstanarm` vertraut.\nJetzt lassen wir mal unsere eigenen Priori-Werte einflie√üen, im Modell `m42`.\n\n\n\n\n```{r Kung-14-bis}\nd2 <- \n  d2 %>% \n  mutate(height_c = height - mean(height))  # zentrieren\n```\n\n\n```{r Kung-15-bis, echo = TRUE}\nm42 <- \n  stan_glm(height ~ 1, \n           prior_intercept = normal(178, 20),  # mu\n           prior_aux = exponential(0.1),  # sigma\n           refresh = FALSE,  # bitte nicht so viel Ausgabe drucken\n           data = d2)\nparameters(m42)\n```\n\n\nWir haben noch nicht alle Informationen kennengelernt, die hier ausgegeben werden.\nIm Zweifel: Einfach ignorieren. Wichtige F√§higkeit im Studium ü§ì.\n\n\n\n```{r Kung-16-bis, eval = FALSE}\n#| echo: false\nwrite_rds(m42, \"objects/m42.rds\")\n```\n\n\n\n### Posteriori-Verteilung und Parameter plotten\n\n\n\n\n```{r}\nm42 %>% \n  as_tibble() %>% \n  ggplot(aes(x = `(Intercept)`)) +\n  geom_histogram()\n```\n\n\nWie man sieht, sind sich die Post-Verteilungen von `m41` und `m42` ziemlich √§hnlich,\nkommen also zu dem gleichen Schluss, was die mittlere K√∂rpergr√∂√üe betrifft.\nDas ist ein Beispiel f√ºr eine Situation, wo eine ausreichend gro√üe Stichprobe die Wahl der Prioris (sofern nicht extrem) aussticht.\n\nEin Vergleich mehererer Priori-Werte w√§re auch n√ºtzlich, um ein skeptisches Publikum von der Wahl (bzw. der Indifferenz) der gew√§hlten Priori-Werte zu √ºberzeugen.\n\n\n\n## Fazit\n\n- Wir haben die Posteriori-Verteilung f√ºr ein Gauss-Modell  berechnet.\n- Dabei hatten wir ein einfaches Modell mit metrischer Zielvariablen, ohne Pr√§diktoren, betrachtet.\n- Die Zielvariable, K√∂rpergr√∂√üe (`height`), haben wir als normalverteilt mit den Parametern $\\mu$ und $\\sigma$ angenommen.\n- F√ºr $\\mu$ und $\\sigma$ haben wir jeweils keinen einzelnen (fixen) Wert angenommen, sondern eine Wahrscheinlichkeitsverteilung, der mit der Priori-Verteilung f√ºr $\\mu$ bzw. $\\sigma$ festgelegt ist.\n\n\n\n\nüß° Bleiben Sie dran!\n</br>\n\n```{r Kung-33, echo = FALSE }\n#| echo: false\nknitr::include_graphics(\"https://github.com/sebastiansauer/QM2-Folien/raw/main/img/chicken_standard_deviation.jpg\")\n```\n\n\n\n\n\n\n\n\n\n\n## Wahl der Priori-Werte\n\n\nüèéÔ∏è Dieser Abschnitt ist eine VERTIEFUNG. üèé\n\n\n\n\n### Welche Beobachtungen sind auf Basis unseres Modells zu erwarten?\n\n\n\n\n```{r prior-pred, echo = TRUE}\nn <- 1e4\n\nsim <- tibble(sample_mu  = \n      rnorm(n, \n            mean = 178, \n            sd   = 20),\n    sample_sigma = \n      rexp(n, \n            rate = 0.1)) %>% \n  mutate(height  = \n      rnorm(n, \n            mean = sample_mu, \n            sd   = sample_sigma))\n\nheight_sim_sd <- \n  sd(sim$height) %>% round()\nheight_sim_mean <- \n  mean(sim$height) %>% round()\n\n```\n\n\nüí≠ Was denkt der Golem (`m41`) *apriori* von der Gr√∂√üe der !Kung?\n\nü¶æ Ziehen wir mal ein paar Stichproben auf Basis des Modells. Voil√†:\n\n\n```{r Kung-12}\np3 <- \n  sim %>% \n  ggplot(aes(x = height)) +\n  geom_density(fill = \"grey33\") +\n  scale_x_continuous(breaks = c(0, 178-3*height_sim_sd, 178, 178+3*height_sim_sd)) +\n  scale_y_continuous(NULL, breaks = NULL) +\n  labs(title = \"height ~ dnorm(mu, sigma)\",\n       caption = \"X-Achse zeigt MW¬±3SD\",\n       x = \"Gr√∂√üe\") +\n  theme(panel.grid = element_blank()) \n\np3\n```\n\n\n\n\n\n[Quellcode](https://bookdown.org/content/4857/geocentric-models.html#a-gaussian-model-of-height)\n\n\n### Priori-Werte pr√ºfen mit der Priori-Pr√§diktiv-Verteilung\n\n- Die Priori-Pr√§diktiv-Verteilung (`sim`) simuliert Beobachtungen (nur) auf Basis der Priori-Annahmen: \n$h_i \\sim \\mathcal{N}(\\mu, \\sigma),$\n$\\mu \\sim \\mathcal{N}(178, 20),$\n$\\sigma \\sim \\mathcal{E}(0.1)$\n- So k√∂nnen wir pr√ºfen, ob die Priori-Werte vern√ºnftig sind.\n\n\nDie Priori-Pr√§diktiv-Verteilung zeigt, dass unsere Priori-Werte ziemlich vage sind, also einen zu breiten Bereich an Gr√∂√üenwerten zulassen:\n\n```{r Kung-13}\np3\n```\n\n\n\nAnteil $h_i > 200$:\n\n```{r Kung-14, echo = TRUE}\nanteil_gro√üer_kung <- \nsim %>% \n  count( height > 200) %>% \n  mutate(prop = n/sum(n))\nanteil_gro√üer_kung\n```\n\n\nü§î Sehr gro√üe Buschleute? `r round(anteil_gro√üer_kung$prop[2], 2)*100` Prozent sind gr√∂√üer als 2 Meter. Das ist diskutabel, muss aber nicht zwangsl√§ufig ein schlechter Prior sein.\n\n\n\n\n\n\n###  Vorhersagen der Priori-Werte\n\n\n```{r Kung-15}\n#| echo: false\nsw_path <- paste0(here::here(),\"/img/south_west_black_24dp2.png\")\nse_path <- paste0(here::here(),\"/img/south_east_black_24dp2.png\")\n\n\nsw <- fig(sw_path)\nse <- fig(se_path)\n\n\n\n(p1 + p2) / (se + sw) / (plot_spacer() + p3 + plot_spacer()) \n\n```\n\n\n\n\n### Extrem vage Priori-Verteilung f√ºr die Streuung?\n\n\n$$\\sigma \\sim \\mathcal{E}(\\lambda=0.01)$$\n\n\n\n\n\n\n\n```{r Kung-16}\n# simulate\nset.seed(4)\n\nsim2 <-\n  tibble(sample_mu    = rnorm(n, mean = 178, sd = 100),\n         sample_sigma = rexp(n, rate = .01)) %>% \n  mutate(height = rnorm(n, mean = sample_mu, sd = sample_sigma))\n\n# compute the values we'll use to break on our x axis\nbreaks <-\n  c(mean(sim2$height) - 3 * sd(sim2$height), 0, mean(sim2$height), mean(sim2$height) + 3 * sd(sim2$height)) %>% \n    round(digits = 0)\n\n# this is just for aesthetics\ntext <-\n  tibble(height = 272 - 25,\n         y      = .0013,\n         label  = \"gr√∂√üter Mann\",\n         angle  = 90)\n\n# plot\np4 <-\n  sim2 %>% \n  ggplot(aes(x = height)) +\n  geom_density(fill = \"black\") +\n  geom_vline(xintercept = 0, color = \"grey92\") +\n  geom_vline(xintercept = 272, color = \"grey92\", linetype = 3) +\n  geom_text(data = text,\n            aes(y = y, label = label, angle = angle),\n            color = \"grey92\") +\n  scale_x_continuous(breaks = breaks, \n                     limits = c(-400, 700)) +\n  scale_y_continuous(NULL, breaks = NULL) +\n  labs(title = \"height ~ dnorm(mu, sigma)\\nmu ~ dnorm(178, 100)\\nsigma ~ E(0.01)\",\n       x = \"Gr√∂√üe\",\n       caption = \"X-Achse zeigt MW¬±3SD\") +\n  theme(panel.grid = element_blank()) \n\np4\n```\n\n\n\n\n\nDie Streuung der Gr√∂√üen ist weit:\n\n```{r Kung-3}\nd <- \n  tibble(x = seq(0,75, by =.01),\n         y = dexp(x, rate = .01))\n\nd %>% \n  ggplot(aes(x,y)) +\n  geom_line()\n```\n\n\n```{r Kung-17, echo = FALSE, eval = FALSE}\nsim2 %>% \n  count(height < 0) %>% \n  mutate(prop = n()/n)\n```\n\n\n\n\nü§î Das Modell geht apriori von ein paar Prozent Menschen mit *negativer* Gr√∂√üe aus. Ein Haufen Riesen üëπ werden auch erwartet. \n\nü§Ø   Vage (flache, informationslose, \"neutrale\", \"objektive\") Priori-Werte machen oft keinen Sinn, weil sie extreme, unplausible Werte zulassen.\n\n\n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"kable","error":false,"eval":true,"cache":true,"freeze":false,"echo":true,"output":"html_document","warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-yaml":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":true,"code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","toc":true,"number-sections":true,"output-file":"gauss.html"},"language":{},"metadata":{"lang":"de","fig-responsive":true,"quarto-version":"1.0.36","bibliography":["references.bib"],"knitr":{"opts_chunk":{"collapse":true,"R.options":{"knitr.graphics.auto_pdf":true}}},"theme":"cosmo","editor_options":{"chunk_output_type":"console"}},"extensions":{"book":{"multiFile":true}}}}}