
# Wahrscheinlichkeit

```{r}
#| include: false
library(tidyverse)
library(easystats)
#library(lubridate)
library(gmp)  # function "isprime"
library(titanic)
library(knitr)
```




```{r r-setup}
#| echo: false
#| message: false
theme_set(theme_minimal())
#scale_color_okabeito()
scale_colour_discrete <- function(...) 
  scale_color_okabeito()
```


```{r define-plots-16}
#| echo: false
#| fig-width: 7

plot16a <-
  ggplot(data.frame(A = c(0, 1),
                    B = c(0, 1))) +
  aes(x = A, y = B) +
  annotate("rect", xmin = 0, xmax = 1, ymin = 0, ymax = .5,
           color = "#009E73FF", alpha = .7, fill = NA) +
  annotate("rect", xmin = 0, xmax = 1, ymin = 0.5, ymax = 1,
           color = NA, alpha = .5, fill = "#009E73FF") +
  annotate("rect", xmin = 0, xmax =0.5, ymin = 0, ymax = 1,
           color = "#56B4E9FF", alpha = .7, fill = NA) +
  annotate("rect", xmin = 0.5, xmax = 1, ymin = 0, ymax = 1,
           color = "#56B4E9FF", alpha = .5, fill = "#56B4E9FF") +
  scale_x_continuous(breaks = c(0.25, 0.75), labels = c("¬A", "A")) +
  scale_y_continuous(breaks = c(0.25, 0.75), labels = c("¬B", "B")) +
  theme_minimal()


plot16a1 <-
  ggplot(data.frame(A = c(0, 1),
                    B = c(0, 1))) +
  aes(x = A, y = B) +
  annotate("rect", xmin = 0, xmax = 1, ymin = 0, ymax = .5,
           color = "#009E73FF", alpha = .7, fill = NA) +
  annotate("rect", xmin = 0, xmax = 1, ymin = 0.5, ymax = 1,
           color = NA, alpha = .5, fill = "#009E73FF") +
  scale_x_continuous(breaks = c(0.25, 0.75), labels = c("¬A", "A")) +
  scale_y_continuous(breaks = c(0.25, 0.75), labels = c("¬B", "B")) +
  annotate("label", x = .5, y = .75, label = "Pr(B) = 50%")

plot16a2 <-
  ggplot(data.frame(A = c(0, 1),
                    B = c(0, 1))) +
  aes(x = A, y = B) +
  annotate("rect", xmin = 0, xmax =0.5, ymin = 0, ymax = 1,
           color = "#56B4E9FF", alpha = .7, fill = NA) +
  annotate("rect", xmin = 0.5, xmax = 1, ymin = 0, ymax = 1,
           color = "#56B4E9FF", alpha = .5, fill = "#56B4E9FF") +
  scale_x_continuous(breaks = c(0.25, 0.75), labels = c("¬A", "A")) +
  scale_y_continuous(breaks = c(0.25, 0.75), labels = c("¬B", "B")) +
  annotate("label", x = .75, y = .5, label = "Pr(A) = 50%") +
  theme_minimal()


plot16b <-
ggplot(data.frame(A = c(0, 1),
                  B = c(0, 1))) +
  aes(x = A, y = B) +
  annotate("rect", xmin = 0, xmax = 1, ymin = 0, ymax = .5,
           color = "#009E73FF", alpha = .7, fill = NA) +
  annotate("rect", xmin = 0, xmax = 1, ymin = 0.5, ymax = 1,
           color = NA, alpha = .5, fill = "#009E73FF") +
  annotate("rect", xmin = 0, xmax =0.5, ymin = 0, ymax = 1,
           color = "#56B4E9FF", alpha = .7, fill = NA) +
  annotate("rect", xmin = 0.5, xmax = 1, ymin = 0, ymax = 1,
           color = "#56B4E9FF", alpha = .5, fill = "#56B4E9FF") +
  annotate("rect", xmin = 0.5, xmax = 1, ymin = 0.5, ymax = 1,
           color = "#E69F00FF", alpha = .7, fill = NA) +
  scale_x_continuous(breaks = c(0.25, 0.75), labels = c("¬A", "A")) +
  scale_y_continuous(breaks = c(0.25, 0.75), labels = c("¬B", "B")) +
  annotate(geom = "label", x = .75, y = 0.75, label = "A,B") +
  theme_minimal()





plot16c <-
  ggplot(data.frame(A = c(0, 1),
                    B = c(0, 1))) +
  aes(x = A, y = B) +
  annotate("rect", xmin = 0, xmax = 1, ymin = 0, ymax = .5,
           color = "#009E73FF", alpha = .7, fill = NA) +
  annotate("rect", xmin = 0, xmax = 1, ymin = 0.5, ymax = 1,
           color = NA, alpha = .5, fill = "NA") +
  annotate("rect", xmin = 0, xmax =0.5, ymin = 0, ymax = 1,
           color = "#56B4E9FF", alpha = .7, fill = NA) +
  annotate("rect", xmin = 0.5, xmax = 1, ymin = 0, ymax = 1,
           color = "#56B4E9FF", alpha = .5, fill = "#56B4E9FF", linewidth = 2) +
  annotate("rect", xmin = 0.5, xmax = 1, ymin = 0.5, ymax = 1,
           color = "#E69F00FF", alpha = .3, fill = "#E69F00FF") +
  scale_x_continuous(breaks = c(0.25, 0.75), labels = c("¬A", "A")) +
  scale_y_continuous(breaks = c(0.25, 0.75), labels = c("¬B", "B")) +
  annotate(geom = "label", x = .75, y = 0.75, label = "B|A")


```

## Lernsteuerung


### Überblick

Dieses Kapitel hat die Wahrscheinlichkeitstheorie (synonym: Wahrscheinlichkeitsrechnung) bzw. das Konzept der Wahrscheinlichkeit zum Thema.^[Die Wahrscheinlichkeitstheorie bildet zusammen mit der Statistik das Fachgebiet der Stochastik.]
Es geht sozusagen um die Mathematik des Zufalls.



### Lernziele

Nach Absolvieren des jeweiligen Kapitels sollen folgende Lernziele erreicht sein.

Sie können ...


- die Grundbegriffe der Wahrscheinlichkeitsrechnung erläuternd definieren
- die drei Arten der direkten Ermittlung von Wahrscheinlichkeit erläutern
- typische Relationen (Operationen) von Ereignissen anhand von Beispielen veranschaulichen
- mit Wahrscheinlichkeiten rechnen



### Eigenstudium


:::{.callout-important}
Dieses Kapitel ist selbständig im Eigenstudium vorzubereiten vor dem Unterricht.
Lesen Sie dazu die angegebene Literatur.
Im Unterricht werden Fragen beantwortet und Aufgaben gemeinsam bearbeitet. Der Stoff wird aber nicht vorgestellt, sondern ist im Selbststudium vorab vorzubereiten.$\square$
:::


### Prüfungsrelevanter Stoff

Lesen Sie dazu @bourier_2018, Kap. 2-4. 
Weitere Übungsaufgaben finden Sie im dazugehörigen Übungsbuch, @bourier_statistik-ubungen_2022.

:::callout-note
In Ihrer [Hochschul-Bibliothek kann das Buch als Ebook verfügbar](https://fantp20.bib-bvb.de/TouchPoint/singleHit.do?methodToCall=showHit&curPos=3&identifier=2_SOLR_SERVER_1157422278) sein. Prüfen Sie, ob Ihr Dozent Ihnen weitere Hilfen im [geschützten Bereich (Moodle)](https://moodle.hs-ansbach.de/mod/resource/view.php?id=136047) eingestellt hat.$\square$
:::





### Zentrale Begriffe


#### Grundbegriffe

- Zufallsvorgang (Zufallsexperiment)
- Elementarereignis
- Ereignisraum
- Zufallsereignis (zufälliges Ereignis)
- Sicheres Ereignis
- Unmögliches Ereignis


#### Wahrscheinlichkeitsbegriffe

- Klassische Wahrscheinlichkeit (LaPlace'sche Wahrscheinlichkeit)
- Statistische (empirische) Wahrscheinlichkeitsermittlung
- Subjektive (Bayes) Wahrscheinlichkeitsermittlung


#### Wahrscheinlichkeitsrelationen

- Vereinigung von Ereignissen
- Schnitt(menge) von Ereignissen
- Komplementärereignis
- Vollständiges Ereignissystem
- Anforderungen an eine Definition von Wahrscheinlichkeit


#### Wahrscheinlichkeitsrechnung

- Allgemeiner Additionsssatz
- Disjunkte Ereignisse
- Additionssatz für disjunkte Ereignisse
- Bedingte Wahrscheinlichkeit
- (Stochastische) Unabhängigkeit
- Baumdiagramm für gemeinsame Wahrscheinlichkeit
- Allgemeiner Multiplikationssatz
- Multiplikationssatz für unabhängige Ereignisse
- Totale Wahrscheinlichkeit
- Satz von Bayes


### Begleitvideos


- [Video zum Thema Wahrscheinlichkeit](https://youtu.be/rR6NspapEyo)




<!-- ## Unterstützung: Wahrscheinlichkeit in Bildern -->

<!-- Wahrscheinlichkeit in Bildern: zur einfachen Erschließung des Materials, -->
<!-- ein Unterstützungsangebot. -->


<!-- Im Folgenden sind einige Schlüsselbegriffe und -regeln in (ver-)einfach(t)er Form schematisch bzw. visuell dargestellt mit dem Ziel, den Stoff einfacher zu erschließen. -->


## Grundbegriffe





:::{#exm-muenz}
Klassisches Beispiel für einen Zufallsvorgang ist das (einmalige oder mehrmalige) Werfen einer Münze.$\square$

Werfen Sie eine Münze!
Diese hier zum Beispiel:

![](img/1024px-Coin-155597.svg.png){width=10% fig-align="center"}

[Quelle: By OpenClipartVectors, CC0]( https://pixabay.com/pt/moeda-euro-europa-fran%C3%A7a-dinheiro-155597)

Wiederholen Sie den Versuch 10, nein, 100, nein 1000, nein: $10^6$ Mal.

Notieren Sie das Ergebnis.$\square$
:::


Oder probieren Sie die [App der Brown University](https://seeing-theory.brown.edu/basic-probability/index.html#section1).


:::{#def-zufall}
### Zufallsvorgang
Ein *Zufallsvorgang* oder *Zufallsexperiment* ist eine einigermaßen klar beschriebene Tätigkeit, deren Ergebnis nicht bekannt ist. Allerdings ist die Menge möglicher Ergebnisse sicher und die Wahrscheinlichkeit für die Ergebnisse kann quantifiziert werden.$\square$
:::


:::{#exr-zufall2}
Nennen Sie Beispiele für Zufallsvorgänge!\square^[Beispiele für Zufallsexperimente sind das Werfen einer Münze, das Ziehen einer Karte aus einem Kartenspiel, das Messen eines Umweltphänomens wie der Temperatur oder die Anzahl der Kunden, die einen Laden betreten. In jedem dieser Fälle sind die möglichen Ergebnisse nicht im Voraus bekannt und hängen von nicht komplett bekannten Faktoren ab.]
:::


:::callout-caution
Zufall heißt nicht, dass ein Vorgang keine Ursachen hätte. So gehorcht der Fall einer Münze komplett den Gesetzen der Gravitation. Würden wir diese Gesetze und die Ausgangsbedingungen (Luftdruck, Fallhöhe, Oberflächenbeschaffenheit, Gewichtsverteilungen, ...) exakt kennen, könnten wir theoretisch sehr genaue Vorhersagen machen. Der "Zufall" würde aus dem Münzwurf verschwinden. Man sollte "Zufall" also besser verstehen als "unbekannt".$\square$
::::


:::{#exr-würfel-geo}
[Mit dieser App](https://www.geogebra.org/m/cbqee8h7) können Sie Würfelwürfe simulieren und die Ausgänge dieses Zufallsexperiments beobachten.$\square$
:::



:::{#def-ereignisraum}
### Ereignisraum
Die möglichen Ergebnisse eines Zufallvorgangs fasst man als Menge mit dem Namen *Ereignisraum*[leider gibt es eine Fülle synonymer Namen: *Ereignisraum*, *Elementarereignisraum*, *Ergebnisraum* oder *Grundraum*] zusammen. Man verwendet den griechischen Buchstaben $\Omega$ für diese Menge.
Die Elemente $\omega$ (kleines Omega) von $\Omega$ nennt man *Ergebnisse*.$\square$
:::

:::{#exm-grundraum}
Beobachtet man beim Würfelwurf (s. @fig-wuerfel) die oben liegende Augenzahl, so ist 



$$\Omega = \{ 1,2,3,4,5,6 \} = \{⚀, ⚁, ⚂, ⚃, ⚄, ⚅\}$$

ein natürlicher Grundraum [@henze_stochastik_2019].$\square$
:::


:::: {.columns}

::: {.column width="50%"}
![Ein (sechsseitiger) Würfel](img/Dice_2005.jpg){width=33%}

[Bildquelle: CC BY-SA 3.0](https://commons.wikimedia.org/w/index.php?curid=474827)
:::

::: {.column width="50%"}
![Ein (sechsseitiger) Würfel, Bildquelle: Peter Steinberg, Wikipedia, CC-BY-](img/120px-Hexahedron-slowturn.gif){#fig-wuerfel}
:::

::::




:::{#def-ereignis}
### Ereignis
Jede Teilmenge^[$A$ ist eine Teilmenge von $B$, wenn alle Elemente von $A$ auch Teil von $B$ sind.] von $\Omega$ heißt *Ereignis*; $A \subseteq B$ .$\square$
:::



:::{#exm-ereignis}
Beim Mensch-ärger-dich-nicht Spielen habe ich eine 6 geworfen.^[Schon wieder.]
Das Nennen wir das Ereignis $A$: "Augenzahl 6 liegt oben".$\square$

$A= \{6\}$
:::


:::{#def-unm-sich}
### Unmögliches und sicheres Ereignis
Die leere Menge $\varnothing$ heißt das *umögliche*, der Grundraum $\Omega$ heißt das *sichere Ereignis*. $\square$
:::

:::{#exm-unm}
### Unmögliches Ereignis
Alois behauptet, er habe mit seinem Würfel eine 7 geworfen.
Schorsch ergänt, sein Würfel liege auf einer Ecke, so dass keine Augenzahl oben liegt.
Draco hat seinen Würfel runtergeschluckt.$\square$
:::


:::{#exm-sicher}
Nach dem der Würfel geworfen wurde, liegt eine Augenzahl zwischen 1 und 6 oben.$\square$
:::


:::{#def-elementarereignis}
### Elementarereignis

Jede einelementige Teilmenge $\{\omega\}$ von $\Omega$ heißt *Elementarereignis* (häufig mit $A$ bezeichnet).$\square$
:::


:::{#exm-elementarereignis}
### Elementarereignis

- Sie spielen Mensch-ärger-dich-nicht. Und brauchen dringend eine `6`. Sie würfeln. Das Ereignis $A = \{1\}$ tritt ein.^[Na toll.]

- Sie schreiben eine Statistik-Klausur. Irgendwie haben Sie das Gefühl, das Ergebnis ist eine Zufallsexperiment... Jedenfalls können nach Adam Riese zwei Dinge passieren: $\Omega= \{\text{bestehen, nicht bestehen}\}$.
Das erste der beiden Elementarereignisse tritt ein. Yeah!

- Sie führen eine Studie durch zur Wirksamkeit einer Lern-App. Es ist nicht klar, ob die App wirklich was bringt für den Lernerfolg. Vereinfacht gesprochen ist der Grundraum dieses Experiments: $\Omega = \{\text{schadet, bringt nichts, nützt}\}$.
Die Daten sprechen für das Ereignis $A = \{\text{bringt nichts}\}$.
:::




:::{#def-vollereignis}
### Vollständiges Ereignissystem
Wird der Grundraum $\Omega$ vollständig in paarweis disjunkte Ereignisse zerlegt, so bilden diese Ereignisse ein vollständiges Ereignissystem, s. @fig-vollereignis.$\square$
:::


![Zerlegung des Grundraums in ein vollständiges Ereignissystem](img/vollereignis.png){#fig-vollereignis width=50%}



:::{#exm-vollereig1}
Sei $\Omega$ der typische Ereignisraum des Würfelwurfs. Wir zerlegen den Grundraum in zwei Ereignisse, $A$ "gerade Zahlen", und $B$ "ungerade Zahlen". 
Damit haben wir ein vollständiges Ereignissystem erstellt.


\begin{align}
A = \{2,4,6\} \qquad \hfill \boxed{\color{gray}{1}\; \boxed{\color{black}{2}}\; \color{gray}{3}\; \boxed{\color{black}{4}}\; \color{gray}{5}\; \boxed{\color{black}{6}}\;} \\
B = \{1,3,5\} \qquad  \hfill \boxed{\boxed{\color{black}{1}}\; \color{gray}{2}\; \boxed{\color{black}{3}}\; \color{gray}{4}\; \boxed{\color{black}{5}}\; \color{gray}{6}\; } \\
\hline \\
\Omega = \{1,2,3,4,5,6\}  \qquad  \hfill \boxed{1\; 2\; 3\; 4\; 5\; 6 } 

\end{align}
:::


:::{#exm-vollereig2}
Sei $\Omega$ der typische Ereignisraum des Würfelwurfs. Wir zerlegen den Grundraum in zwei Ereignisse, $A$ "1,2,3", und $B$ "4,5,6". 
Damit haben wir ein vollständiges Ereignissystem erstellt.

\begin{align}
A = \{1,2,3\} \qquad \qquad \hfill  \boxed{\boxed{ \color{black}{1\; 2\; 3}}\; \color{gray}{4\; 5\; 6}} \\
B = \{4,5, 6\} \qquad \qquad  \hfill \boxed{\color{gray}{1 \; 2 \; 3}\; \boxed{\color{black}{4\; 5 \; 6}}} \\

\newline
\hline \\
\Omega = \{1,2,3,4,5,6\} \qquad \qquad \hfill  \boxed{1\; 2\; 3\; 4\; 5\;6}
\end{align}
:::


:::{#def-macht}
### Mächtigkeit
Die Anzahl der Elementarereignisse eines Ereignismraums nennt man die Mächtigkeit (des Ereignisraums).^[Die Menge aller Teilmengen einer Menge $A$ nennt man die *Potenzmenge* $\mathcal{P}(A)$, vgl. [hier](https://de.wikipedia.org/wiki/Datei:Hasse_diagram_of_powerset_of_3.svg).]$\square$
:::


Die Mächtigkeit von $\Omega$ bezeichnet man mit dem Symbol $|\Omega|$.

:::{#exm-macht}
Beim Wurf eines Würfels mit $\Omega=\{1,2,3,4,5,6\}$ gibt es 6 Elementarereignisse. Die Mächtigkeit ist also 6: $|\Omega|=6$.$\square$
:::

## Direkte Ermittlung von Wahrscheinlichkeiten

### Epistemologische Wahrscheinlichkeit


Vor uns liegt ein Würfel. Schlicht, ruhig, unbesonders.
Wir haben keinen Grund anzunehmen, dass eine seiner $n=6$ Seiten bevorzugt nach oben zu liegen kommt. 
Jedes der sechs Elementarereignisse ist uns gleich plausibel;
der Würfel erscheint uns fair.
In Ermangelung weiteres Wissens zu unserem Würfel gehen wir schlicht davon aus, dass jedes der $n$ Elementarereignis gleich wahrscheinlich ist.
Es gibt keinerlei Notwendigkeit, den Würfel in die Hand zu nehmen,
um zu einer Wahrscheinlichkeitsaussage auf diesem Weg zu kommen.
Natürlich *könnten* wir unsere Auffassung eines fairen Würfels testen,
aber auch ohne das Testen können wir eine stringente Aussage (basierend auf unserer Annahme der Indifferenz der $n$ Elementarereignisse) zur Wahrscheinlichkeit eines bestimmten (Elementar-)Ereignisses $A$ kommen [@briggs_uncertainty:_2016], s. @eq-briggs.


$$Pr(A) = 1/n= \frac{1}{|\Omega|}$$ {#eq-briggs}

:::{#exm-briggs}
Sei $A$ = "Der Würfel wird beim nächsten Wurf eine 6 zeigen."
Die Wahrscheinlichkeit für $A$ ist $1/6. \square$
:::


:::{#def-laplace}
Ein Zufallsexperiment, bei dem alle Elementarereignisse die selbe Wahrscheinlichkeit haben, nennt man man ein *Laplace-Experiment*.$\square$
:::

In Erweiterung von @eq-briggs können wir schreiben:

$$Pr(A)=\frac{\text{Anzahl Treffer}}{\text{Anzahl möglicher Ergebnisse}}$$

### Frequentistische Wahrscheinlichkeit

In Ermangelung einer Theorie zum Verhalten eines (uns) unbekannten Zufallsvorgangs und unter der Vermutung, dass die Elementarereignisse nicht gleichwahrscheinlich sind, bleibt uns ein einfacher (aber aufwändiger) Ausweg: Ausprobieren.

Angenommen, ein Statistik-Dozent, bekannt für seine Vorliebe zum Glücksspiel und scheinbar endlosen Glückssträhnen, er wirft andauernd eine 6, hat seinen Lieblingswürfel versehentlich liegen gelassen. Das ist *die* Gelegenheit!
Sie greifen sich den Würfel, und ... Ja, was jetzt?
Nach kurzer Überlegung kommen Sie zum Entschluss, den Würfel einen "Praxistest" zu unterziehen: Sie werfen ihn 1000 Mal (Puh!) und zählen den Anteil der `6`.
Falls der Würfel fair ist, müsste gelten $Pr(A=6)=1/6\approx .17$. Schauen wir mal!



```{r}
#| echo: false
n <- 1e3

set.seed(42)
wuerfel_oft <- 
  sample(x = 1:6, size = n, replace = TRUE) 


wuerfel_tab <-
  tibble(
    id = 1:n,
    x = wuerfel_oft,
    ist_6 = ifelse(x == 6, 1, 0),
    ist_6_cumsum = cumsum(ist_6) / id
  )

```


Und hier der Anteil von  `6` im Verlauf unserer Würfe, s. @fig-wuerfel.


```{r}
#| label: fig-wuerfel
#| fig-cap: "Das Gesetz der großen Zahl am Beispiel der Stabilisierung des Trefferanteils beim wiederholten Würfelwurf"
#| fig-asp: 0.5
#| echo: false

wuerfel_tab %>% 
  slice_head(n = 1e3) %>% 
  ggplot() +
  aes(x = id, y = ist_6_cumsum) +
  geom_hline(yintercept = 1/6, color = "grey80", size = 3) +
  geom_line()
```

Hm, leider ist auf den ersten Blick kein Anzeichen für Schummeln bzw. einen gezinkten Würfel zu finden (zumindest nicht zu Gunsten des Zwielichten Dozenten).



### Subjektive Wahrscheinlichkeit

Um subjektiv zu einer Wahrscheinlichkeit zu kommen, sagt man einfach seine Meinung.
Das hört sich natürlich total plump an. 
Und tatsächlich besteht die Gefahr, dass die so ermittelten Wahrscheinlichkeiten aus der Luft gegriffen, also haltlos, sind.

Allerdings kann diese Art von Wahrscheinlichkeitsermittlung auch sehr wertvoll sein.
In komplizierten Situation im echten Leben kommt man oft in die Situation, dass weder die epistemologische noch die frequentistische Variante verwendet werden kann.
Dann muss man auf Schätzungen, Vorwissen, Erfahrung, theoretischen Überlengungen etc. zurückgreifen.

## Indirekte Ermittlung von Wahrscheinlichkeiten

Die indirekte Ermittlung von Wahrscheinlichkeiten meint das Ableiten von Wahrscheinlichkeitsaussagen, wenn man schon etwas über die Wahrscheinlichkeiten des Grundraums weiß. 
Dazu greift man auf Rechenregeln der Stochastik zurück.
Das hört sich vielleicht wild an, ist aber oft ganz einfach.

:::{#exm-ind}
### Gezinkter Würfel
Ein gezinkter Würfel hat eine erhöhte Wahrscheinlichkeit für das Ereignis $A=$"6 liegt oben", und zwar gelte $Pr(A)=1/3$.
Was ist die Wahrscheinlichkeit, *keine*  `6` zu würfeln?$\square$^[Die Wahrscheinlichkeit, keine `6` zu würfeln, liegt bei $2/3$.]
:::

Für das Rechnen mit Wahrscheinlichkeiten ist es hilfreich, ein paar Werkzeuge zu kennen, die wir uns im Folgenden anschauen.


## Relationen von Ereignissen


### Überblick


Wir gehen von Grundraum $\Omega$ aus, mit dem Ereignis $A$ als Teilmenge: $A \subset B$.


Da wir Ereignisse als Mengen auffassen, verwenden wir im Folgenden die beiden Begriffe synonym.


Dabei nutzen wir u.a. Venn-Diagramme.
Venn-Diagramme eigenen sich, um typische Operationen (Relationen) auf Mengen zu visualisieren. Die folgenden Venn-Diagramme stammen von [Wikipedia (En)](https://en.wikipedia.org/wiki/Venn_diagram).

:::callout-note
### Wozu sind die Venn-Diagramme gut? Warum soll ich die lernen?
Venn-Diagramme zeigen Kreise und ihre überlappenden Teile;
daraus lassen sich Rückschlüsse auf Rechenregeln für Wahrscheinlichkeiten ableiten.
Viele Menschen tun sich leichter, Rechenregeln visuell aufzufassen als mit Formeln und Zahlen alleine. Aber entscheiden Sie selbst!$\square$
:::

[Die folgende App](https://www.geogebra.org/m/QZvCMSDs) versinnbildlicht das Rechnen mit Relationen von Ereignissen anhand von Venn-Diagrammen.


```{=html}
<iframe width="780" height="500" src="https://www.geogebra.org/m/QZvCMSDs" title="Mengenoperationen mit Venn-Diagrammen verbildlicht"></iframe>
```


### Vereinigung von Ereignissen

:::{#def-mengen-verein}
### Vereinigung von Ereignissen
Vereinigt man zwei Ereignisse $A$ und $B$, dann besteht das neue Ereignis $C$ genau aus den Elementarereignissen der vereinigten Ereignisse.
Man schreibt $C = A \cup B$, lies: "C ist A vereinigt mit B".$\square$
:::

@fig-cup zeigt ein Venn-Diagramm zur Verdeutlichung der Vereinigung von Ereignissen.

![$A \cup B$](img/Venn0111.svg.png){#fig-cup width=25%}

:::{#exm-mengen-verein}

Um einen (hohen!) Geldpreis zu gewinnen, muss bei ihrem nächsten Wurf mindestens eines der beiden Ereignisse $A$ oder $B$ eintreten.

\begin{aligned}
A = \{1,2\} \qquad \boxed{\boxed{1\; 2}\; \color{gray}{ 3\; 4\; 5\; 6}} \\
B = \{2,3\} \qquad  \boxed{1\; \boxed{2\; 3}\; \color{gray}{ 4\; 5\; 6}} \\
\newline
\hline \\
A \cup B = \{1,2,3\} \qquad \boxed{\boxed{1\; 2\; 3}\; \color{gray}{4\; 5\; 6}}
\end{aligned}
:::



Zur besseren Verbildlichung betrachten Sie mal diese
[Animation zur Vereinigung von Mengen](https://www.geogebra.org/m/GEZV4xXc#material/cmXR8fHN); [Quelle](Geogebra, J. Merschhemke).


In R heißt die Vereinigung von Mengen `union()`. Praktisch zum Ausprobieren:

```{r}
A <- c(1, 2)
B <- c(2, 3)

union(A, B)
```



### (Durch-)Schnitt von Ereignissen


:::{#def-mengen-schnitt}
### Schnittmenge von Ereignissen
Die Schnittmenge zweier Ereignisse $A$ und $B$ umfasst genau die Elementarereignisse, die Teil beider Ereignisse sind. Man schreibt: $A \cap B.$^[Synonym und kürzer: $AB$ anstelle von $A \cap B$.] Lies: "A geschnitten B". $\square$
:::

@fig-cap zeigt ein Sinnbild zur Schnittmenge zweier Ereignisse.



![$A \cap B$](img/Venn0001.svg.png){#fig-cap width=25%}


:::{#exm-mengen-schnitt}

Um einen (hohen!) Geldpreis zu gewinnen, muss bei ihrem nächsten Wurf sowohl das Ereignis $A$ = "gerade Augenzahl" als auch $B$ = "Augenzahl größer 4".


\begin{align}
& A = \{2,4,6\} \qquad \hfill \boxed{\color{gray}{1}\; \boxed{\color{black}{2}}\; \color{gray}{3}\; \boxed{\color{black}{4}}\; \color{gray}{5}\; \boxed{\color{black}{6}}\;} \\
& B = \{5,6\} \qquad \qquad \hfill  \boxed{ \color{gray}{1\; 2\; 3\; 4\;} \boxed{\color{black}{5\; 6}}} \\
\newline
\hline \\
& A \cap B = \{6\} \qquad \qquad \hfill  \boxed{\color{gray}{1\; 2\; 3\; 4\; 5\;} \color{black}{6}}
\end{align}
:::


```{r}
A <- c(2, 4, 6)
B <- c(5, 6)
intersect(A, B)
```



:::callout-note
#### Eselsbrücke zur Vereinigungs- und Schnittmenge

Das Zeichen für eine Vereinigung zweier Mengen kann man leicht mit dem Zeichen für einen Schnitt zweier Mengen leicht verwechseln; daher kommt eine Eselbrücke gelesen, s. @fig-esel.

![Eselsbrücke für Vereinigungs- und Schnittmenge](img/ven_cup_cap.jpeg){#fig-esel width=55%}
:::


### Komplementärereignis


:::{#def-menge-komplement}
### Komplementärereignis
Ein Ereignis $A$ ist genau dann ein Komplementärereignis zu $B$, wenn es genau die Elementarereignisse von $\Omega$ umfasst, die nicht Elementarereignis des anderen Ereignisses sind, s. @fig-neg.$\square$
:::


Man schreibt für das Komplementärereignis von $A$ oft $\bar{A}$ oder $\neg A$^[manchmal auch $A^C$; *C* wie *c*omplementary event]; lies "Nicht-A" oder "A-quer".


:::{#exm-mengen-komplement}

Beim normalen Würfelwurf sei $A$ das Ereignis "gerade Augenzahl"; 
das Komplementärereignis ist dann $\neg A$ "ungerade Augenzahl".


\begin{align}
A = \{2,4,6\} \qquad \hfill \boxed{\color{gray}{1}\; \boxed{\color{black}{2}}\; \color{gray}{3}\; \boxed{\color{black}{4}}\; \color{gray}{5}\; \boxed{\color{black}{6}}\;} \\
\hline \\
\neg A = \{1,3,5\} \qquad  \hfill \boxed{\boxed{\color{black}{1}}\; \color{gray}{2}\; \boxed{\color{black}{3}}\; \color{gray}{4}\; \boxed{\color{black}{5}}\; \color{gray}{6}\; } \\
\end{align}
:::


![$\bar{A}$](img/2560px-Venn1010.svg.png){#fig-neg width=25%}


### Logische Differenz

:::{#def-mengen-diff}
### Logische Differenz
Die logische Differenz der Ereignisse $A$ und $B$ ist das Ereignis, 
das genau aus den Elementarereignissen besteht von $A$ besteht, die nicht zugleich Elementarereignis von $B$ sind, s. @fig-setminus.$\square$
:::

Die logische Differenz von $A$ zu $B$ schreibt man häufig so: $A \setminus B$; lies "A minus B".


![$A \setminus B$](img/Venn0100.svg.png){#fig-setminus width=25%}

:::{#exm-mengen-setminus}

Sei $A$ die Menge "große Zahlen" mit $A = \{4,5,6 \}$.
Sei $B$ die Menge "gerade Zahlen".
Wir suchen die logische Differenz, $A \setminus B$.


\begin{align}
A = \{4,5, 6\} \qquad \hfill \boxed{4\; 5\; 6} \\
B = \{2,4,6\} \qquad  \hfill \boxed{2\; 4\; 6} \\
\hline \\
A \setminus B \qquad \hfill \boxed{5}
\end{align}
:::


In R gibt es die Funktion `setdiff()`, die eine Mengendifferenz ausgibt.

```{r}
A <- c(4, 5, 6)
B <- c(2, 4, 6)

setdiff(A, B)
```

🤯 Von der Menge $A$ die Menge $B$ abzuziehen, ist etwas anderes, als von $B$ die Menge $A$ abzuziehen:

```{r}
setdiff(B, A)
```

:::callout-caution
$A \setminus B \ne B \setminus A$.
:::


### Disjunkte Ereignisse




Seien $A= \{1,2,3\}; B= \{4,5,6\}$.

$A$ und $B$ sind disjunkt^[engl. disjoint]: ihre Schnittmenge ist leer: $A \cap B = \emptyset$,
s. @fig-disjunkt




![Zwei disjunkte Ereignisse, dargestellt noch überlappungsfreie Kreise](img/2880px-Disjunkte_Mengen.svg.png){#fig-disjunkt width="25%" fig-align="center"}





[Quelle: rither.de](http://www.rither.de/a/mathematik/stochastik/mengentheorie-und-venn-diagramme/)


::: {#exm-disjunkt1}
- Das Ereignis $A$ "Gerade Augenzahl beim Würfelwurf", $A={2,4,6}$ und das Ereignis $B$ "Ungerade Augenzahl beim Würfelwurf", $B={1,3,5}$ sind disjunkt.

- Die Ereignisse "normaler Wochentag" und "Wochenende" sind disjunkt.$\square$
:::

### Vertiefung


[Animation zu Mengenoperationen](https://seeing-theory.brown.edu/compound-probability/index.html)


## Anforderungen an Wahrscheinlichkeiten {#seq-kolmogorov}

Wir richten eine Reihe von Forderungen an eine Definition von bzw. an das Rechnen mit Wahrscheinlichkeiten, die direkt plausibel erscheinen:^[Ein Herr Kolmogorov hat das mal aufgeschrieben.]

1. *Nichtnegativität*: Die Wahrscheinlichkeit eines Ereignisses kann nicht negativ sein.
2. *Normierung*: Das sichere Ereignis hat die Wahrscheinlichkeit 1 bzw. 100%: $Pr(\Omega)=1$; das unmögliche Ereignis hat die Wahrscheinlichkeit 0: $Pr(\emptyset)=0$.
3. *Additivität*. Sind $A$ und $B$ disjunkt, dann ist die Wahrscheinlichkeit von $A\cup B$ die Summe der beiden Einzelwahrscheinlichkeiten von $A$ und $B$.


## Rechnen mit Wahrscheinlichkeiten

### Additionssatz 

Der Additionssatz wird verwendet, wenn wir an der Wahrscheinlichkeit interessiert sind, dass *mindestens eines der Ereignisse* eintritt.

#### Disjunkte Ereignisse

Gegeben sei $\Omega = {1,2,3,4,5,6}$. Als Sinnbild: $\boxed{1\; 2\; 3\; 4\; 5\; 6}$.

Gesucht sei die Wahrscheinlichkeit des Ereignis $A=\{1,2\}$.


$\boxed{\boxed{1\; 2}\; \color{gray}{ 3\; 4\; 5\; 6}}$

$P(1 \cup 2) = \frac{1}{6} + \frac{1}{6} = \frac{2}{6}$


:::{#exm-sonntag}
Was ist die Wahrscheinlichkeit, an einem Samstag oder Sonntag geboren zu sein?
Unter der (etwas vereinfachten) Annahme, dass alle Jahre zu gleichen Teilen aus allen Wochentagen bestehen, ist die Antwort $Pr(A)=1/7 + 1/7 = 2/7$.$\square$
:::



#### Allgemein (disjunkt oder nicht disjunkt)


Bei der Addition der Wahrscheinlichkeiten für $A$ und $B$ wird der Schnitt $A\cap B$ doppelt erfasst.^[sofern sie nicht disjunkt sind, aber wenn sie diskunkt sind, so ist der Schnitt gleich Null und wir machen auch dann nichts falsch] Er muss daher noch abgezogen werden.


:::{#def-additionssatz}
### Allgemeiner Additionssatz
Die Wahrscheinlichkeit, dass mindestens eines der beiden Ereignisse $A$ und $B$ eintritt, ist gleich der Summe ihrer Wahrscheinlichkeiten minus ihrer gemeinsamen Wahrscheinlichkeit, s. @eq-add.

$$P(A \cup B) = P(A) + P(B) - P(A\cap B) \square$${#eq-add}
:::


<!-- ::: {#fig-sets2 layout-ncol=2} -->

<!-- ![$A \cup B$](img/Venn0111.svg.png){width=20%}{#fig-sets2-a} -->




<!-- ![$A \cap B$](img/Venn0001.svg.png){width=20%}{#fig-sets2-b} -->



<!-- Die Schnittmenge muss beim Vereinigen abgezogen werden, -->
<!-- damit sie nicht doppelt gezählt wird. -->


<!-- ::: -->



:::{#exm-klausur-bed-wskt}
### Lernen und Klausur bestehen

In einem angewandten Psychologie-Studiengang sind die Studis verdonnert, zwei Statistik-Module ($S1, S2$) zu belegen.
Die meisten bestehen ($B$), einige leider nicht ($N$), s. tbl-klausur2.

Ereignis $A$ ist "Klausur Statistik 1" mit den Ergebnissen "bestanden" und "nicht bestanden". 
Ereignis $B$ ist analog für "Klausur Statistik 2".

Wir suchen die Wahrscheinlichkeit, mindestens eine der beiden Klausuren zu bestehen: $Pr(S_1B \cup S_2B)$.
Nennen wir das Ereignise $A$.



```{r}
#| echo: false
#| label: tbl-klausur2
#| tbl-cap: "Daten von 100 Studis; L: Lerner, B: Bestanden, N: Negation/Nicht"
d <- tribble(
  ~ ., ~ S1_B, ~ S1_NB, ~ Summe,
  "S2_B", 85, 9, 94,
  "S2_NB", 5, 1, 6,
  "Summe", 90, 10, 100
)

kable(d)
```


\begin{aligned}
Pr(A) &= Pr(S_1B \cup S_2B) \\
&= Pr(S1_B) + Pr(S_2B) - Pr(S_1B \cap S_2B)  \\
&= (90 + 94 - 85) / 100 = 99 / 100\\
\end{aligned}

Die Wahrscheinlichkeit, mindestens eine der beiden Klausuren zu bestehen liegt bei 99%.
Umgekehrt liegt die Wahrscheinlichkeit, keine der beiden Klausuren zu bestehen, liegt bei $Pr(\neg A) = 1- Pr(A) = 0.01 = 1\%$; ein Sachverhalt, der sich auch mit einem kurzen Blick in die Datentabelle erkennen lässt.$\square$
:::





### Bedingte Wahrscheinlichkeit

:::{#def-pr-cond}
### Bedingte Wahrscheinlichkeit
Die Bedingte Wahrscheinlichkeit ist die Wahrscheinlichkeit, dass $A$ eintritt, *gegeben dass* $B$ schon eingetreten ist. $\square$
:::

Man schreibt: $Pr(A|B).$ Lies: "A gegeben B" oder "A wenn B".









:::{#exr-victorpowell}
Schauen Sie sich mal diese [Wahnsinnsanimation von Victor Powell an](https://setosa.io/conditional/) zu bedingten Wahrscheinlichkeiten. 
Hammer!
:::


#### Schema


@fig-schema-p illustriert *gemeinsame Wahrscheinlichkeit*, $P(A \cap B)$, und *bedingte Wahrscheinlichkeit*, $P(A|B)$.


```{r bed-w-schema}
#| echo: false
#| fig-cap: Illustration von gemeinsamer und bedingter Wahrscheinlichkeit
#| label: fig-schema-p
plots(plot16a1, plot16a2, plot16c)
```


:::{#exm-bed-p}
### Bedingte Wahrscheinlichkeit
Sei $A$ "Schönes Wetter" und $B$ "Klausur steht an".
Dann meint $Pr(A|B)$ die Wahrscheinlichkeit, dass das Wetter schön ist, wenn gerade eine Klausur ansteht.$square$
:::


:::{#exm-papst}
### Von Päpsten und Männern

Man(n) beachte, dass die Wahrscheinlichkeit, Papst $P$ zu sein, wenn man Mann $M$ ist *etwas anderes* ist, als die Wahrscheinlichkeit, Mann zu sein, wenn man Papst ist:
$Pr(P|M) \ne Pr(M|P)$. Das hört sich erst verwirrend an, aber wenn man darüber nachdenkt, wird es sehr plausibel.$\square$
:::


:::{#exm-kalt-regen}
### Kalt und Regen
Die Wahrscheinlichkeit, dass es kalt ist, wenn es regnet, ist gleich der Wahrscheinlichkeit, dass es gleichzeitig kalt ist und regnet geteilt durch die Wahrscheinlichkeit, dass es regnet.$\square$
:::


:::{#exm-hirn-grütze}
Gustav Groß-Gütz verkauft eine Tinktur^[genauer besehen sieht sie eher aus wie eine Grütze oder ein Brei], die schlau machen soll, "Gützi Gehirn Grütze".^[Sie schmeckt scheußlich.]
Gustav trinkt die Grütze und sagt schlaue Dinge.
Was schließen wir daraus?
Sei $H$ (wie *H*ypothese) "Gützis Grütze macht schlau"; sei $D$ (wie *D*aten) die Beobachtung, dass Gustav schlaue Dinge gesagt hat.
Ohne exakte Zahlen zu suchen, wie hoch ist wohl $Pr(D|H)$? In Worten: "Wie wahrscheinlich ist es, schlaue Dinge gesagt zu haben, wenn die Grütze wirklich schlau macht?".
Vermutlich ist diese Wahrscheinlichkeit sehr hoch.
Aber wie hoch ist wohl $Pr(H|D)$? In Worten: "Wie wahrscheinlich ist es, dass die Grütze wirklich schlau macht, gegeben, dass wir gesehen hat, dass jemand etwas schlaues gesagt hat, nachdem er besagte Grütze getrunken hat?"
Skeptische Geister werden der Meinung sein, $Pr(H|D)$ ist gering.
Das Beispiel zeigt u.a. $Pr(H|D) \ne Pr(D|H).\square$
:::




Das Berechnen einer bedingten Wahrscheinlichkeit, $Pr(A|B)$, ist vergleichbar zum Filtern einer Tabelle:

```{r}
#| echo: false
d <- 
  tibble::tribble(
      ~id, ~A, ~B,
      "1", 0L, 0L,
      "2", 0L, 1L,
      "3", 1L, 0L,
      "4", 1L, 1L,
  "SUMME", 2L, 2L
  )

knitr::kable(d)

```

Es ergeben sich folgende Wahrscheinlichkeiten:

$P(A) = 2/4$

$P(B) = 2/4$

$P(A \cap B) = 1/4$

$P(A|B) = 1/2$


#### Rechenregel

Die Wahrscheinlichkeit für $A$, wenn $B$ schon eingetreten ist, berechnet sich so, s. @eq-pr-cond.

$$Pr(A|B) = \frac{Pr(A \cap B)}{Pr(B)}$${#eq-pr-cond}




:::{#exm-klausur-bed-wskt}
### Lernen und Klausur bestehen


Sie bereiten sich gerade auf die Klausur bei Prof. Süß vor.
Das heißt: Sie überlegen, ob Sie sich auf die Klausur vorbereiten sollten.
Vielleicht lohnt es sich ja gar nicht? Vielleicht ist die Wahrscheinlichkeit zu bestehen, wenn man nicht gelernt hat, sehr groß?
Aber da Sie nun mal auf Fakten stehen, haben Sie sich nach einiger Recherche folgende Zahlen besorgen können, s. @tbl-klausur-lernen.
In der Tabelle sind die Daten von 100 Studis ausgewiesen.
Ein Teil hat sich vorbereitet, ordentlich gelernt, nenen wir sie die "*L*erner.
Ein anderer Teil hat nicht gelernt, $NL$ bzw. $\neg L$. Ein Teil hat bestanden, $B$, ein Teil nicht $NB$ oder $\neg B$.

Wir suchen die Wahrscheinlichkeit, zu bestehen, wenn man nicht gelernt hat: $Pr(B |\neg L)$.



```{r}
#| echo: false
#| label: tbl-klausur-lernen
#| tbl-cap: "Daten von 100 Studis; L: Lerner, B: Bestanden, N: Negation/Nicht"
d <- tribble(
  ~ ., ~ L, ~ NL, ~ Summe,
  "B", 80, 1, 81,
  "NB", 5, 14, 19,
  "Summe", 85, 15, 100
)

kable(d)
```


\begin{aligned}
Pr(B |\neg L) &= \frac{Pr(B \cap \neg L)}{Pr(\neg L)} \\
&=\frac{1/100}{15/100} = 1/15 \\
\end{aligned}

Die Wahrscheinlichkeit, zu bestehen, wenn man nicht gelernt hat, liegt bei 1 von 15,
also ca. 7%.$\square$
:::




### Stochastische (Un-)Abhängigkeit

Stochastische Unabhängigkeit ist ein Spezialfall von Abhängigkeit: Es gibt sehr viele Ausprägungen für Abhängigkeit, aber nur eine für Unabhängigkeit.
Können wir Unabhängigkeit nachweisen, haben wir also eine starke Aussage getätigt.


:::{#def-indep}
### Stochastische Unabhängigkeit
Zwei Ereignisse sind (stochastisch) unabhängig voneinander, wenn die Wahrscheinlichkeit von $A$ nicht davon abhängt, ob $B$ der Fall ist, s. @eq-indep.
Dann gilt:^[Exakte Gleichheit ist in dieser Welt empirisch schwer zu finden. Daher kann man vereinbaren, dass Unabhängigkeit erfüllt ist, wenn die Gleichheit "einigermaßen" oder "ziemlich" gilt, die Gleichheit gewissermaßen "praktisch bedeutsam" ist.]

 

$$P(A|B) = P(A) = P(A|\neg B). \square$${#eq-indep}
:::


:::{#exm-indep1}
### Augenfarbe und Statistikliebe
Ich vermute, dass die Ereignisse $A$, "Augenfarbe ist blau", und $B$, "Ich liebe Statistik", voneinander unabhängig sind.$\square$^[Wer Daten dazu hat oder eine Theorie, der melde sich bitte bei mir.]
:::





```{r}
#| echo: false
data("titanic_train")


plottitanic1 <-
titanic_train %>%
  select(Pclass, Survived) %>%
  mutate(Survived = factor(Survived)) %>%
  ggplot(aes(x = Pclass)) +
  geom_bar(aes(fill = Survived), position = "fill") +
  theme(legend.position = "bottom")  +
  scale_fill_okabeito()


plottitanic2 <-
titanic_train %>%
  select(Survived, Embarked) %>%
  filter(Embarked %in% c("C", "Q", "S")) %>%
  mutate(Survived = factor(Survived)) %>%
  ggplot(aes(x = Embarked)) +
  geom_bar(aes(fill = Survived), position = "fill") +
  theme(legend.position = "bottom") +
  scale_fill_okabeito()





plottitanic3 <-
  titanic_train %>%
  select(Survived, Age) %>%
  mutate(Age_prime = isprime(Age),
         Age_prime = factor(Age_prime)) %>%
  mutate(Survived = factor(Survived)) %>%
  ggplot(aes(x = Age_prime)) +
  geom_bar(aes(fill = Survived), position = "fill") +
  theme(legend.position = "bottom") +
  scale_x_discrete(breaks = c(0, 2),
                     labels = c("Nicht Prim", "Prim")) +
  scale_fill_okabeito()

# plottitanic3

```



:::{#exm-titanic}
### Überleben auf der Titanic
*Abhängig*, s. @fig-abh, links: Überleben auf der Titanic ist offenbar *abhängig* von der Passagierklasse.
Auf der anderen Seite: Das Ereignis *Überleben* auf der Titanic ist *un*abhängig vom Ereignis *Alter ist eine Primzahl*, s. @fig-abh, rechts.$\square$
:::





```{r QM2-Thema1-WasistInferenz-31, out.width="100%"}
#| fig-cap: "Abhängigkeit und Unabhängigkeit zweier Ereignisse"
#| label: fig-abh
#| echo: false
plots(plottitanic1, plottitanic3,
      n_rows = 1,
      title = c("Abhängigkeit zweier Ereignisse", "Un-Abhängigkeit zweier Ereignisse"))
```








Zur Ab- bzw. Un-Abhängigkeit zweier Variablen, an Beispielen illustriert.




:::{#exm-covid}

## Zusammenhang von Covidsterblichkeit und Impfquote


Sind die Ereignisse *Tod durch Covid*  bzw. *Impfquote* ($A$) und *Land*^[hier mit den zwei Ausprägungen *DEU* und *USA*] ($B$) voneinander abhängig ( @fig-covid1)?

```{r covid1}
#| message: false
#| echo: false
#| cache: true
#| fig-cap: Impfquote und Sterblichkeit sind voneinander abhängig (bezogen auf Covid, auf Basis vorliegender Daten)
#| label: fig-covid1


# source: https://ourworldindata.org/covid-vaccinations
# access date: 2021-09-24
# licence: https://ourworldindata.org/covid-vaccinations#licence



dfile <- "data/owid-covid-data.csv"



d <- read_csv(dfile)

d2<-
  d %>%
  filter(iso_code %in% c("DEU", "USA")) %>%
  mutate(date = as_date(date)) %>%
  rename(Land = iso_code) %>%
  select(date,
         Land,
         #total_deaths,
         #new_deaths,
         people_fully_vaccinated_per_hundred,
         total_deaths_per_million,
         #new_vaccinations,
         total_vaccinations) %>%
  filter(date == "2021-09-23") %>%
  group_by(Land)


# d2 %>%
#   ungroup() %>%
#   count(people_fully_vaccinated_per_hundred)

plot_covid1 <-
  d2 %>%
  ggplot(aes(x = Land,
             y = people_fully_vaccinated_per_hundred)) +
  geom_col() +
  labs(title = "Anteil komplett geimpfter Personen",
       subtitle = "2021-09-23")




plot_covid2 <-
  d2 %>%
  ggplot(aes(x = Land,
             y = total_deaths_per_million)) +
  geom_col()+
  labs(title = "Corona-Tote pro Million",
       subtitle = "2021-09-23")


plots(plot_covid1, plot_covid2)
```

Ja, da in beiden Diagrammen gilt: $P(A|B) \ne Pr(A) \ne Pr(A|\neg B)$.$\square$^[
Daten von [Our World in Data](https://ourworldindata.org/covid-deaths).]


:::








### Multiplikationssatz

Gegeben seien die Ereignisse $A$ und $B$. Der Multiplikationssatz wird verwendet, wenn wir an der Wahrscheinlichkeit interessiert sind, dass *beide Ereignisse* $A$ und $B$ eintreten.


#### Unabhängige Ereignisse


:::{#exm-indep2}
Wir führen das Zufallsexperiment "Wurf einer fairen Münze" zwei Mal aus (@fig-zweimuenzen).
Wie groß ist die Wahrscheinlichkeit, 2 Mal *K*opf zu werfen?$\square$
:::


![Wir werfen zwei faire Münzen](img/muenz1.png){#fig-zweimuenzen width="50%"}

 @fig-zweimuenzen zeigt ein *Baumdiagramm*. 
Jeder *Kasten* (Knoten) zeigt ein *Ergebnis.* 
Die Pfeile (Kanten) symbolisieren die Abfolge des Experiments: Vom "Start" (schwarzer Kreis) 
führen zwei mögliche Ergebniss ab, jeweils mit Wahrscheinlichkeit 1/2.
Die untersten Knoten nennt man auch *Blätter* (Endknoten), sie zeigen das Endresultat des (in diesem Fall) zweifachen Münzwurfs.
Der Weg vom Start zu einem bestimmten Blatt nennt man *Pfad*. 
Die Anzahl der Pfade entspricht der Anzahl der Blätter.
In diesen Diagramm gibt es vier Pfade (und Blätter).

Den Wurf der ersten Münze nennen wir in gewohnter Manier $A$; den Wurf der zweiten Münze $B$.


Die Wahrscheinlichkeiten der resultierenden Ereignisse finden sich in @tbl-muenz2.


```{r}
#| echo: false
#| label: tbl-muenz2
#| tbl-cap: Wahrscheinlichkeiten der Ereignisse im zweimaligen Münzwurf
tibble::tribble(
  ~Ereignis,               ~Pr,
       "0K", "1/2 * 1/2 = 1/4",
       "1K", "1/4 + 1/4 = 1/2",
       "2K", "1/2 * 1/2 = 1/4"
  ) %>% kable()
```


Sei $K_1$ das Ereignis, mit der 1. Münze Kopf zu werfen; sei $K_2$ das Ereignis, mit der 2. Münze Kopf zu werfen-

Wir suchen $Pr(K_1 \cap K_2)$. Aufgrund der stochastischen Unabhängigkeit der beiden Ereignisse gilt: $Pr(K_1 \cap K_2) = Pr(K_1) \cdot Pr(K_2)$.

```{r}
Pr_K1K2 <- 1/2 * 1/2
Pr_K1K2
```


:::{#def-multsatz}
### Multiplikationssatz für unabhängige Ereignisse
Die Wahrscheinlichkeit, dass zwei unabhängige Ereignisse $A$ und $B$ *gemeinsam* eintreten, ist gleich dem Produkt ihrer jeweiligen Wahrscheinlichkeiten, s. @eq-multtheorem.

$Pr(A \cap B) = Pr(AB) = Pr(A) \cdot Pr(B) = Pr(B\cap A) = Pr(B) \cdot Pr(A).\square${#eq-multtheorem}
:::


Mit [dieser App](https://www.geogebra.org/m/gzxz57ak) können Sie das Baumdiagramm für den zweifachen Münzwurf näher erkunden.

```{=html}
<iframe width="780" height="500" src="https://www.geogebra.org/m/gzxz57ak" title="Baumdiagramm zum zweifachen Münzwurf"></iframe>
```




Wir führen das Zufallsexperiment "Wurf einer fairen Münze" drei Mal aus (@fig-dreimuenzen).

![Wir werfen drei faire Münzen](img/muenz2.png){#fig-dreimuenzen}


Beim Wurf von "fairen" Münzen gehen wir davon aus, dass Kenntnis des Ergebnis des 1. Wurfes unsere Einschätzung des Ergebnis des 2. Wurfes nicht verändert etc.
Anders gesagt: Wir gehen von (stochastischer) Unabhängigkeit aus.


Für z.B. das Ereignis $A=\{ZZZ\}$ gilt: $Pr(A) = 1/2 \cdot 1/2 \cdot 1/2 = (1/2)^3$.
Da jeder Endknoten (jedes Blatt) gleichwahrscheinlich ist, ist die Wahrscheinlichkeit jeweils gleich.

Allgemeiner gilt: Für ein Zufallsexpriment, das aus $k$ Wiederholungen besteht und in jeder Wiederholung die Wahrscheinlichkeit $Pr(X)=p$ ist,
so ist die Wahrscheinlichkeit für einen Endkonten $Pr(X^k)=p^k$.





```{r QM2-Thema1-WasistInferenz-27}
#| echo: false
#| tbl-cap: "Ausgewählte Wahrscheinlichkeiten von Ereignissen im dreifachen Münzwurf"
#| label: tbl-baum3
tibble::tribble(
  ~Ereignis,                     ~Pr,
       "0K", "1/2 * 1/2 * 1/2 = 1/8",
       "1K", "1/8 + 1/8 + 1/8 = 3/8",
       "2K",          "3 * 1/8 = 3/8",
       "3K", "1/2 * 1/2 * 1/2 = 1/8"
  ) 
```


Da die Endknoten disjunkte Elementarereignisse sind, kann man ihre Wahrscheinlichkeit addieren, um zu anderen (zusammengesetzten) Ereignissen zu kommen, vgl. @tbl-baum3.


@fig-unabh-e versinnbildlicht zwei unabhängige Ereignisse, $A$ und $B$,
wobei die Wahrscheinlichkeit gleich ist $Pr(A)=Pr(B)=.5$.
Man sieht, dass die Wahrscheinlichkeit von $A$ bzw. von $B$ jeweils die Hälfte der Fläche ausmacht. 
Die Schnittmenge der Fläche von $A$ und $B$ entspricht einem Viertel der Fläche: $Pr(AB) = Pr(A) \cdot Pr(B) = 50\% \cdot 50\% = 25\%.$
In diesem Fall sind $A$ und $B$ unabhängig.

```{r plot-unabh-ereignisse}
#| echo: false
#| fig-cap: Unabhängige Ereignisse visualisiert
#| label: fig-unabh-e
plots(plot16a1, plot16a2, plot16c)
```


@fig-unabh-e zeigt weiterhin, dass gilt: $P(A\cap B) = P(A) \cdot P(B) = P(B) \cdot P(A)$.

:::{#exm-kaltregen}
### Kalt und Regen

Von @mcelreath_statistical_2020 stammt diese Verdeutlichung der gemeinsamen Wahrscheinlichkeit:

Was ist die Wahrscheinlichkeit für *kalt ❄ und Regen ⛈️*?

Die Wahrscheinlichkeit für kalt und Regen ist die Wahrscheinlichkeit von *Regen* ⛈, wenn's *kalt* ❄ ist mal die Wahrscheinlichkeit von *Kälte* ❄.

Ebenfalls gilt:

Die Wahrscheinlichkeit für kalt und Regen ist die Wahrscheinlichkeit von *Kälte* ❄, wenn's *regnet* ⛈️ mal die Wahrscheinlichkeit von *Regen* ⛈️.

Das Gesagte als Emoji-Gleichung:

$P(❄️ \text{ und } ⛈️) = P(⛈️ |❄️ ) \cdot P(❄️) =  P(❄️ |⛈️ ) \cdot P(⛈️) = P(⛈ \text{ und }   ❄️)$
Man kann also die "Gleichung drehen".^[Da $P(A\cap B)=Pr(B \cap A)$]$\square$
:::


:::{#def-kettenregel}
### Kettenregel
Allgemein gesagt, spricht man von der *Kettenregel* der Wahrscheinlichkeitsrechnung, s. @eq-kette.

$P(A\cap B) = P(A) \cdot P(B|A) = P(B) \cdot P(A|B)\square${#eq-kette}

In Worten: Die Wahrscheinlichkeit von $A$ gegeben $B$ ist gleich der Wahrscheinlichkeit von $A$ mal der Wahrscheinlichkeit von $B$ gegeben $A$.
:::




#### Abhängige Ereignisse



Ein Baumdiagramm bietet sich zur Visualisierung abhängiger Ereignisse an, s.  @fig-baum-abh. Für unabhängige Ereignisse übrigens auch.


:::{#exm-urne1}
In einer Urne befinden sich fünf Kugeln, von denen vier rot sind und eine blau ist.

wie groß ist die Wahrscheinlichkeit, dass bei zwei Ziehungen ohne Zurücklegen (*ZOZ*) *zwei rote Kugeln* gezogen werden [@bourier_2018], S. 47.


Hier ist unsere Urne:

$$\boxed{\color{red}{R, R, R, R}, \color{blue}B}$$

Und jetzt ziehen wir. Hier ist das Baumdiagramm, s.  @fig-baum-abh.


```{mermaid}
%%| fig-cap: "Baumdiagramm für ein ein zweistufiges Zufallsereignis, wobei der 2. Zug (Stufe) abhängig ist vom 1. Zug."
%%| label: fig-baum-abh
flowchart LR
  A[Start] -->|4/5|B[1. Zug: R]
  A -->|1/5|C[1. Zug: B]
  B -->|3/4|D[2. Zug: R]
  B -->|1/4|E[2. Zug: B]
  D --- H[Fazit: RR:  12/20]
  E --- I[Fazit: RB: 4/20]
  C -->|4/4|F[2. Zug: R]
  C -->|0/4|G[2. Zug: B]
  F --- J[Fazit: BR: 4/20]
  G --- K[Fazit: BB: 0/20]
```



Es gilt also: $P(A\cap B) = P(A) \cdot P(B|A) \square$.
:::



:::{#exm-bertie-botts}
### Bertie Botts Bohnen jeder Geschmacksrichtung

>   Sei bloß vorsichtig mit denen. Wenn sie sagen jede Geschmacksrichtung, dann meinen sie es auch - Du kriegst zwar alle gewöhnlichen wie Schokolade und Pfefferminz und Erdbeere, aber auch Spinat und Leber und Kutteln. George meint, er habe mal eine mit Popelgeschmack gehabt.“

— Ron Weasley zu Harry Potter^[Quelle: https://harrypotter.fandom.com/de/wiki/Bertie_Botts_Bohnen_jeder_Geschmacksrichtung]

In einem Beutel liegen $n=20$ *Bertie Botts Bohnen jeder Geschmacksrichtung*.
Uns wurde verraten, dass fast alle gut schmecken, also z.B. nach Schokolade, Pfefferminz oder Marmelade. Leider gibt es aber auch $x=3$ furchtbar scheußliche Bohnen (Ohrenschmalz-Geschmacksrichtung oder Schlimmeres).
Sie haben sich nun bereit erklärt, $k=3$ Bohnen zu ziehen. Und zu essen, und zwar direkt und sofort!
Also, jetzt heißt es tapfer sein. Ziehen und runter damit!

Wie groß ist die Wahrscheinlichkeit, *genau eine* scheußliche Bohne zu erwischen?

Nutzen Sie [diese App](https://www.geogebra.org/m/j545R3Fu), um das auszuprobieren.
Sie müssen in der App noch die Zahl der Bohnen ($n$) und die Zahl der scheußlichen Bohnen ($x$) einstellen.$\square$
:::


:::{exr-baum3}
### Baumdiagramm sucht Problem

Überlegen Sie sich eine Problemstellung (Aufgabenstellung), die mit [folgender Baumdiagramm-App](
https://www.geogebra.org/m/WVKur4yM) gelöst werden kann.$\square$
:::

```{=html}
<iframe width="780" height="500" src="https://www.geogebra.org/m/WVKur4yM" title="Baumdiagramm sucht Problem"></iframe>
```









### Totale Wahrscheinlichkeit




@fig-tot-wskt zeigt das Baumdiagramm für die Aufgabe @bourier_2018, S. 56.

```{mermaid}
%%| fig-cap: Totale Wahrscheinlichkeit
%%| label: fig-tot-wskt
flowchart LR
  A[Start] -->|0.6|B[A1]
  A -->|0.1|C[A2]
  A -->|0.3|D[A3]
  B -->|0.05|E[B]
  B -.->|0.95|F[Nicht-B]
  C -->|0.02|G[B]
  C -.->|0.98|H[Nicht-B]
  D -->|0.04|I[B]
  D -.->|0.96|J[Nicht-B]
```



Gesucht ist die Wahrscheinlichkeit $P(B)$; $A$ ist ein vollständiges Ereignissystem.


Dazu addieren wir die Wahrscheinlichkeiten der relevanten Äste.
Jeder Ast stellt wiederum das gemeinsame Auftreten der Ereignisse $A_i$ und $B$ dar.

```{r}
W_Ast1 <- 0.6 * 0.05  # Wahrscheinlichkeit für Ast 1
W_Ast2 <- 0.1 * 0.02  # ... Ast 2
W_Ast3 <- 0.3 * 0.04  # ... Ast 3
W_total <- W_Ast1 + W_Ast2 + W_Ast3  # totale W.
W_total
```

Die *totale Wahrscheinlichkeit* beträgt in diesem Beispiel also $P(B) = 4.4\%$.^[Einfacher als das Rechnen mit Wahrscheinlichkeiten ist es in solchen Fällen, wenn man anstelle von Wahrscheinlichkeiten absolute Häufigkeiten zum Rechnen verwendet.]

:::{#def-totwskt}
### Totale Wahrscheinlichkeit
Bilden die Ereignisse $A_1, A_2, ..., A_n$ ein vollständiges Ereignissystem und ist $B$ ein beliebiges Ereignis dann gilt $Pr(B) = \sum_{i=1}^n Pr(A_i) \cdot Pr(B|A_i).\square$
:::

::: {exm-totwskt1}
In @fig-tot-wskt gilt $Pr(B) = 0.6 \cdot 0.05 + 0.1 \cdot 0.02 + 0.3 \cdot  0.04 = 0.03 + 0.002 + 0.012 = 0.04.\square$
:::





:::{#exm-bertie-botts2}
### Bertie Botts Bohnen jeder Geschmacksrichtung, Teil 2

Es ist die gleich Aufgabe wie @exm-bertie-botts, aber jetzt lautet die Frage: 
Wie groß ist die Wahrscheinlichkeit, *mindestens eine* scheußliche Bohne zu erwischen?$\square$
:::


## Bayes' Theorem

### Wozu wird Bayes in der Praxis genutzt?


In der Praxis nutzt man Bayes häufig, wenn man Daten zu einer Wirkung $W$ hat,
und auf die Ursache $U$ zurückschließen möchte, sinngemäß:

$$W \quad \underrightarrow{Bayes} \quad U$$

Dann kann man @eq-bayes1 so schreiben, s. @eq-bayes2:

$$P(U|W) = \frac{ P(U) \cdot P(W|U) }{P(W)}$${#eq-bayes2}

Eine ähnliche Situation, die in der Praxis häufig ist,
dass man Daten $D$ hat und auf die Wahrscheinlichkeit einer Hypothese $H$ schließen möchte, s. @eq-bayes3.

$$D \quad \underrightarrow{Bayes} \quad H$$


$$P(H|D) = \frac{ P(H) \cdot P(D|H) }{P(D)}$${#eq-bayes3}

@eq-bayes3 fragt nach $P(H|D)$:

>    Was ist die Wahrscheinlichkeit der Hypothese H, jetzt wo wir die Daten haben (und ein Modell?)

Und antwortet so (@eq-bayes3):

>    Diese Wahrscheinlichkeit entspricht der Grundrate (Apriori-Wahrscheinlichkeit) der Hypothese mal der Plausibilität (Likelihood) der Daten unter Annahme (gegeben) der Hypothese. Aus Standardisierungsgründen dividiert man noch die totale Wahrscheinlichkeit der Daten über alle Hypothesen.



### Bayes als Baum

Gesucht sei $P(A_1|B)$.

Für Bayes' Formel^[synonym: Satz von Bayes] setzt man die Wahrscheinlichkeit des  *günstigen* Ast zur Wahrscheinlichkeit aller relevanten Äste, $P(B)$.

:::{#exm-bayes1}
### Maschine produziert Ausschuss

Die drei Maschinen $M_1, M_2, M_3$ produzieren den gleichen Artikel. Ihr jeweiliger Anteil, an der Produktion liegt bei 60%, 10% bzw. 30%. 
Die jeweilige Ausschussquote liegt bei 5, 2, bzw. 4%, s. @fig-tot-wskt2.
*Aufgabe*: Wie groß ist die Wahrscheinlichkeit, dass ein defektes Teil von Maschine 1 produziert wurde?\square$
:::



Der günstige (gesuchte) Ast ist hier schwarz gedruckt, die übrigen Äste gestrichelt, s. @fig-tot-wskt2. $A_i$ zeigt das Ereignis, dass der Artikel von Maschine $i$ produziert wurde. $B$ ist das Ereignis "Artikel ist Ausschuss".

```{mermaid}
%%| fig-cap: Günstige Pfade
%%| label: fig-tot-wskt2
flowchart LR
  A[Start] -->|0.6|B[A1]
  A -.->|0.1|C[A2]
  A -.->|0.3|D[A3]
  B --->|0.05|E[B]
  B -.->|0.95|F[Nicht-B]
  C -.->|0.02|G[B]
  C -.->|0.98|H[Nicht-B]
  D -.->|0.04|I[B]
  D -.->|0.96|J[Nicht-B]
```


$$P(A|B) = \frac{P(A1 \cap B)}{P(B)} = \frac{0.6 \cdot 0.05}{0.03 + 0.002 + 0.012} = \frac{0.03}{0.044} \approx 0.68$$


$P(A|B)$ beträgt also ca. 68%.

Zur Erinnerung: $P(B)$ ist die totale Wahrscheinlichkeit.




### Bayes als bedingte Wahrscheinlichkeit


Bayes' Theorem ist auch nur eine normale bedingte Wahrscheinlichkeit:


$P(A|B) = \frac{\overbrace{ P(A\cap B)}^\text{umformen}}{P(B)}$

$P(A| B)$ kann man  umformen, s. @eq-bayes1:

$$P(A|B) =\frac{P(A\cap B)}{P(B)} = \frac{P(B|A) \cdot P(A)}{P(B)}$$ {#eq-bayes1}

Man kann sich Bayes' Theorem  auch wie folgt herleiten:



$P(A\cap B) = P(B \cap A) = P(A) \cdot P(B|A) = P(B) \cdot P(A|B)$

Dann lösen wir nach P$(A|B)$ auf:


$P(A|B) = \frac{P(A) \cdot P(B|A)}{P(B)}$



### Zusammengesetzte Hypothesen

Das ist vielleicht ein bisschen fancy,
aber man kann Bayes' Theorem auch nutzen, um die Wahrscheinlichkeit einer *zusammengesetzten Hypothese* zu berechnen: $H = H_1 \cap H_2$. 
Ein Beispiel wäre: "Was ist die Wahrscheinlichkeit, dass es Regen ($R$) *und* Blitzeis ($B$) gibt, wenn es kalt ($K$) ist?".

Das sieht dann so aus, @eq-bayes4:

$$
\begin{aligned}
P(R \cap B |K) &= \frac{ P(R \cap B) \cdot P(K|R \cap B) }{P(D)} \\
&= \frac{ P(R ) \cdot P(B) \cdot P(K|R \cap B) }{P(D)}
\end{aligned}
$${#eq-bayes4}


Hier haben wir $P(R \cap B)$  aufgelöst in $P(R) \cdot P(B)$,
das ist nur zulässig, wenn $R$ und $B$ unabhängig sind.



## Vertiefung



Bei @henze_stochastik_2019 findet sich eine anspruchsvollere Einführung in das Rechnen mit Wahrscheinlichkeit; dieses Kapitel behandelt ein Teil des Stoffes  der Kapitel 2 und 3 von @henze_stochastik_2019.

Mit [dieser App, die ein zweistufiges Baumdiagramm zeigt](https://www.geogebra.org/m/n4xrk4x5), können Sie das Verhalten von verschiedenen Arten von Wahrscheinlichkeiten weiter untersuchen.

[Diese App lässt dich herausfinden, ob man wirklich krank ist, wenn der Arzt es bheauptet.](https://www.geogebra.org/m/tkdfxa8f)

Das [Video zu Bayes von 3b1b](https://youtu.be/HZGCoVF3YvM) verdeutlicht das Vorgehen der Bayes-Methode auf einfache und anschauliche Weise.


## Aufgaben

Bearbeiten Sie die Aufgabe in der angegeben Literatur.


1. [Additionssatz1](https://datenwerk.netlify.app/posts/additionssatz1/additionssatz1)
2. [Nerd-gelockert](https://datenwerk.netlify.app/posts/nerd-gelockert/nerd-gelockert) 
3. [Urne1](https://datenwerk.netlify.app/posts/urne1/urne1) 
3. [Urne2](https://datenwerk.netlify.app/posts/urne2/urne2)
3. [k-coins-k-hits](https://datenwerk.netlify.app/posts/k-coins-k-hits/k-coins-k-hits)
3. [Klausur-raten](https://datenwerk.netlify.app/posts/klausur-raten/klausur-raten) 
5. [sicherheit](https://datenwerk.netlify.app/posts/sicherheit/sicherheit)
4. [sicherheit2](https://datenwerk.netlify.app/posts/sicherheit2/sicherheit2)
6. [Klausuren-bestehen](https://datenwerk.netlify.app/posts/klausuren-bestehen/klausuren-bestehen)

3. [Gem-Wskt1](https://datenwerk.netlify.app/posts/gem-wskt1/gem-wskt1)
3. [Gem-Wskt2](https://datenwerk.netlify.app/posts/gem-wskt2/gem-wskt2)
3. [Gem-Wskt3](https://datenwerk.netlify.app/posts/gem-wskt3/gem-wskt3)
3. [wuerfel05](https://datenwerk.netlify.app/posts/wuerfel05/wuerfel05)
3. [wuerfel06](https://datenwerk.netlify.app/posts/wuerfel06/wuerfel06)

3. [Bed-Wskt1](https://datenwerk.netlify.app/posts/bed-wskt1/bed-wskt1)
3. [Bed-Wskt2](https://datenwerk.netlify.app/posts/bed-wskt2/bed-wskt2)
3. [Bed-Wskt3](https://datenwerk.netlify.app/posts/bed-wskt3/bed-wskt3)

3. [mtcars-abhaengig](https://datenwerk.netlify.app/posts/mtcars-abhaengig/mtcars-abhaengig.html)
3. [mtcars-abhaengig-var2](https://datenwerk.netlify.app/posts/mtcars-abhaengig_var2/mtcars-abhaengig_var2)
3. [mtcars-abhaengig_var3a](https://datenwerk.netlify.app/posts/mtcars-abhaengig_var3a/mtcars-abhaengig_var3a)

3. [voll-normal](https://datenwerk.netlify.app/posts/voll-normal/voll-normal.html)
3. [corona-blutgruppe](https://datenwerk.netlify.app/posts/corona-blutgruppe/corona-blutgruppe.html)


3. [totale-Wskt1](https://datenwerk.netlify.app/posts/totale-wskt1/totale-wskt1)
3. [Krebs1](https://datenwerk.netlify.app/posts/krebs1/krebs1)
3. [Bayes-Theorem1](https://datenwerk.netlify.app/posts/bayes-theorem1/bayes-theorem1) 
 




## ---



![](img/outro-03.jpg){width=100%}






