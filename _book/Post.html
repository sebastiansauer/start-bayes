<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="de" xml:lang="de"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.280">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Start:Bayes! - 6&nbsp; Die Post befragen</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./ppv.html" rel="next">
<link href="./Globusversuch.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "Keine Treffer",
    "search-matching-documents-text": "Treffer",
    "search-copy-link-title": "Link in die Suche kopieren",
    "search-hide-matches-text": "Zusätzliche Treffer verbergen",
    "search-more-match-text": "weitere Treffer in diesem Dokument",
    "search-more-matches-text": "weitere Treffer in diesem Dokument",
    "search-clear-button-title": "Zurücksetzen",
    "search-detached-cancel-button-title": "Abbrechen",
    "search-submit-button-title": "Abschicken"
  }
}</script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }"><div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">
<span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Die Post befragen</span>
</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Start:Bayes!</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Hinweise</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Pruefung.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Prüfung</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Inferenz.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Inferenz</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Wskt.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Wahrscheinlichkeit</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Verteilungen.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Verteilungen</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Globusversuch.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Globusversuch</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Post.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Die Post befragen</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ppv.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Vorhersage-Verteilung</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./gauss.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Gauss-Modelle</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lineare-modelle.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Lineare Modelle</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./metrische-AV.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Forschungsfragen mit metrischer AV</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./kausal.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Kausalinferenz</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./abschluss.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Abschluss</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
</div>
</nav><!-- margin-sidebar --><div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Inhaltsverzeichnis</h2>
   
  <ul>
<li>
<a href="#lernsteuerung" id="toc-lernsteuerung" class="nav-link active" data-scroll-target="#lernsteuerung"><span class="toc-section-number">6.1</span>  Lernsteuerung</a>
  <ul class="collapse">
<li><a href="#lernziele" id="toc-lernziele" class="nav-link" data-scroll-target="#lernziele"><span class="toc-section-number">6.1.1</span>  Lernziele</a></li>
  <li><a href="#ben%C3%B6tigte-r-pakete" id="toc-benötigte-r-pakete" class="nav-link" data-scroll-target="#ben%C3%B6tigte-r-pakete"><span class="toc-section-number">6.1.2</span>  Benötigte R-Pakete</a></li>
  <li><a href="#begleitvideos" id="toc-begleitvideos" class="nav-link" data-scroll-target="#begleitvideos"><span class="toc-section-number">6.1.3</span>  Begleitvideos</a></li>
  </ul>
</li>
  <li>
<a href="#mit-stichproben-die-post-verteilung-zusammenfassen" id="toc-mit-stichproben-die-post-verteilung-zusammenfassen" class="nav-link" data-scroll-target="#mit-stichproben-die-post-verteilung-zusammenfassen"><span class="toc-section-number">6.2</span>  Mit Stichproben die Post-Verteilung zusammenfassen</a>
  <ul class="collapse">
<li><a href="#zur-erinnerung-gitterwerte-in-r-berechnen" id="toc-zur-erinnerung-gitterwerte-in-r-berechnen" class="nav-link" data-scroll-target="#zur-erinnerung-gitterwerte-in-r-berechnen"><span class="toc-section-number">6.2.1</span>  Zur Erinnerung: Gitterwerte in R berechnen</a></li>
  <li><a href="#beispiele-f%C3%BCr-fragen-an-die-post-verteilung" id="toc-beispiele-für-fragen-an-die-post-verteilung" class="nav-link" data-scroll-target="#beispiele-f%C3%BCr-fragen-an-die-post-verteilung"><span class="toc-section-number">6.2.2</span>  Beispiele für Fragen an die Post-Verteilung</a></li>
  <li><a href="#bayes-box-f%C3%BCr-komplexe-modelle" id="toc-bayes-box-für-komplexe-modelle" class="nav-link" data-scroll-target="#bayes-box-f%C3%BCr-komplexe-modelle"><span class="toc-section-number">6.2.3</span>  Bayes-Box für komplexe Modelle</a></li>
  <li><a href="#wir-arbeiten-jetzt-mit-h%C3%A4ufigkeit-nicht-mit-wahrscheinlichkeit" id="toc-wir-arbeiten-jetzt-mit-häufigkeit-nicht-mit-wahrscheinlichkeit" class="nav-link" data-scroll-target="#wir-arbeiten-jetzt-mit-h%C3%A4ufigkeit-nicht-mit-wahrscheinlichkeit"><span class="toc-section-number">6.2.4</span>  Wir arbeiten jetzt mit Häufigkeit, nicht mit Wahrscheinlichkeit</a></li>
  <li><a href="#h%C3%A4ufigkeiten-sind-einfacher-als-wahrscheinlichkeiten" id="toc-häufigkeiten-sind-einfacher-als-wahrscheinlichkeiten" class="nav-link" data-scroll-target="#h%C3%A4ufigkeiten-sind-einfacher-als-wahrscheinlichkeiten"><span class="toc-section-number">6.2.5</span>  Häufigkeiten sind einfacher als Wahrscheinlichkeiten</a></li>
  <li><a href="#visualisierung-der-stichprobendaten-mit-k100-gitterwerten" id="toc-visualisierung-der-stichprobendaten-mit-k100-gitterwerten" class="nav-link" data-scroll-target="#visualisierung-der-stichprobendaten-mit-k100-gitterwerten"><span class="toc-section-number">6.2.6</span>  Visualisierung der Stichprobendaten mit <span class="math inline">\(k=100\)</span> Gitterwerten</a></li>
  </ul>
</li>
  <li>
<a href="#die-post-verteilung-befragen" id="toc-die-post-verteilung-befragen" class="nav-link" data-scroll-target="#die-post-verteilung-befragen"><span class="toc-section-number">6.3</span>  Die Post-Verteilung befragen</a>
  <ul class="collapse">
<li><a href="#fragen-nach-wahrscheinlichkeiten" id="toc-fragen-nach-wahrscheinlichkeiten" class="nav-link" data-scroll-target="#fragen-nach-wahrscheinlichkeiten"><span class="toc-section-number">6.3.1</span>  Fragen nach Wahrscheinlichkeiten</a></li>
  <li><a href="#fragen-nach-parameterwerten" id="toc-fragen-nach-parameterwerten" class="nav-link" data-scroll-target="#fragen-nach-parameterwerten"><span class="toc-section-number">6.3.2</span>  Fragen nach Parameterwerten</a></li>
  <li><a href="#zur-erinnerung-quantile" id="toc-zur-erinnerung-quantile" class="nav-link" data-scroll-target="#zur-erinnerung-quantile"><span class="toc-section-number">6.3.3</span>  Zur Erinnerung: Quantile</a></li>
  <li><a href="#den-quantilen-unter-die-motorhaube-geschaut" id="toc-den-quantilen-unter-die-motorhaube-geschaut" class="nav-link" data-scroll-target="#den-quantilen-unter-die-motorhaube-geschaut"><span class="toc-section-number">6.3.4</span>  Den Quantilen unter die Motorhaube geschaut</a></li>
  <li><a href="#visualisierung-der-intervalle" id="toc-visualisierung-der-intervalle" class="nav-link" data-scroll-target="#visualisierung-der-intervalle"><span class="toc-section-number">6.3.5</span>  Visualisierung der Intervalle</a></li>
  </ul>
</li>
  <li>
<a href="#schiefe-posteriori-verteilungen-sind-m%C3%B6glich" id="toc-schiefe-posteriori-verteilungen-sind-möglich" class="nav-link" data-scroll-target="#schiefe-posteriori-verteilungen-sind-m%C3%B6glich"><span class="toc-section-number">6.4</span>  Schiefe Posteriori-Verteilungen sind möglich</a>
  <ul class="collapse">
<li><a href="#perzentil-intervall" id="toc-perzentil-intervall" class="nav-link" data-scroll-target="#perzentil-intervall"><span class="toc-section-number">6.4.1</span>  50%-Perzentil-Intervall</a></li>
  <li><a href="#intervall-h%C3%B6chster-dichte" id="toc-intervall-höchster-dichte" class="nav-link" data-scroll-target="#intervall-h%C3%B6chster-dichte"><span class="toc-section-number">6.4.2</span>  50%-Intervall höchster Dichte</a></li>
  </ul>
</li>
  <li>
<a href="#fazit" id="toc-fazit" class="nav-link" data-scroll-target="#fazit"><span class="toc-section-number">6.5</span>  Fazit</a>
  <ul class="collapse">
<li><a href="#intervalle-h%C3%B6chster-dichte-vs.-perzentilintervalle" id="toc-intervalle-höchster-dichte-vs.-perzentilintervalle" class="nav-link" data-scroll-target="#intervalle-h%C3%B6chster-dichte-vs.-perzentilintervalle"><span class="toc-section-number">6.5.1</span>  Intervalle höchster Dichte vs.&nbsp;Perzentilintervalle</a></li>
  <li><a href="#zusammenfassung" id="toc-zusammenfassung" class="nav-link" data-scroll-target="#zusammenfassung"><span class="toc-section-number">6.5.2</span>  Zusammenfassung</a></li>
  </ul>
</li>
  <li><a href="#aufgaben" id="toc-aufgaben" class="nav-link" data-scroll-target="#aufgaben"><span class="toc-section-number">6.6</span>  Aufgaben</a></li>
  <li><a href="#section" id="toc-section" class="nav-link" data-scroll-target="#section"><span class="toc-section-number">6.7</span>  —</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title d-none d-lg-block">
<span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Die Post befragen</span>
</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="img/Golem_hex.png" class="img-fluid figure-img" style="width:5.0%"></p>
<p></p><figcaption class="figure-caption">Bayes:Start!</figcaption><p></p>
</figure>
</div>
<section id="lernsteuerung" class="level2" data-number="6.1"><h2 data-number="6.1" class="anchored" data-anchor-id="lernsteuerung">
<span class="header-section-number">6.1</span> Lernsteuerung</h2>
<section id="lernziele" class="level3" data-number="6.1.1"><h3 data-number="6.1.1" class="anchored" data-anchor-id="lernziele">
<span class="header-section-number">6.1.1</span> Lernziele</h3>
<p>Nach Absolvieren des jeweiligen Kapitels sollen folgende Lernziele erreicht sein.</p>
<p>Sie können …</p>
<ul>
<li>die Post-Verteilung anhand einer Stichprobenverteilung auslesen</li>
<li>Fragen nach Wahrscheinlichkeitsanteilen der Post-Verteilung anhand der Stichprobenverteilung beantworten</li>
<li>Fragen nach Quantilen anhand der Stichprobenverteilung beantworten</li>
</ul></section><section id="benötigte-r-pakete" class="level3" data-number="6.1.2"><h3 data-number="6.1.2" class="anchored" data-anchor-id="benötigte-r-pakete">
<span class="header-section-number">6.1.2</span> Benötigte R-Pakete</h3>
<div class="cell">

</div>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="begleitvideos" class="level3" data-number="6.1.3"><h3 data-number="6.1.3" class="anchored" data-anchor-id="begleitvideos">
<span class="header-section-number">6.1.3</span> Begleitvideos</h3>
<ul>
<li><a href=""></a></li>
</ul></section></section><section id="mit-stichproben-die-post-verteilung-zusammenfassen" class="level2" data-number="6.2"><h2 data-number="6.2" class="anchored" data-anchor-id="mit-stichproben-die-post-verteilung-zusammenfassen">
<span class="header-section-number">6.2</span> Mit Stichproben die Post-Verteilung zusammenfassen</h2>
<section id="zur-erinnerung-gitterwerte-in-r-berechnen" class="level3" data-number="6.2.1"><h3 data-number="6.2.1" class="anchored" data-anchor-id="zur-erinnerung-gitterwerte-in-r-berechnen">
<span class="header-section-number">6.2.1</span> Zur Erinnerung: Gitterwerte in R berechnen</h3>
<p>Berechnen wir mit der Gittermethode (“Bayes-Box”) die Postverteilung für den Globusversuch.</p>
<p>Die Gittermethode ist ein Weg, die Posteriori-Verteilung zu berechnen. Die Posteriori-Verteilung birgt viele nützliche Informationen.</p>
<p>Modell: <span class="math inline">\(W=6\)</span> Wasser, <span class="math inline">\(N=9\)</span> Würfen und <span class="math inline">\(k=10\)</span> Gitterwerten, also mit 10 Wasseranteilswerten zwischen 0 und 1.</p>
<p>Abb. <a href="#fig-post1">Abbildung&nbsp;<span>6.1</span></a> zeigt die resultierende Post-Verteilung.</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span><span class="va">n_success</span> <span class="op">&lt;-</span> <span class="fl">6</span></span>
<span><span class="va">n_trials</span>  <span class="op">&lt;-</span> <span class="fl">9</span></span>
<span></span>
<span><span class="va">d</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>p_grid <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0</span>, to <span class="op">=</span> <span class="fl">1</span>, length.out <span class="op">=</span> <span class="va">n</span><span class="op">)</span>,</span>
<span>         prior  <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>likelihood <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">dbinom</a></span><span class="op">(</span><span class="va">n_success</span>, </span>
<span>                             size <span class="op">=</span> <span class="va">n_trials</span>, </span>
<span>                             prob <span class="op">=</span> <span class="va">p_grid</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>unstand_post <span class="op">=</span> <span class="op">(</span><span class="va">likelihood</span> <span class="op">*</span> <span class="va">prior</span><span class="op">)</span>,</span>
<span>         post <span class="op">=</span> <span class="va">unstand_post</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">unstand_post</span><span class="op">)</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Voilà, die Post-Verteilung als Tabelle, auch “Bayes-Box” (oder Bayes-Gitter) genannt: s. <a href="#tbl-post1">Tabelle&nbsp;<span>6.1</span></a>.</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-post1" class="anchored">

<div id="secofvzyni" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

:where(#secofvzyni) .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

:where(#secofvzyni) .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

:where(#secofvzyni) .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

:where(#secofvzyni) .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

:where(#secofvzyni) .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

:where(#secofvzyni) .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#secofvzyni) .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

:where(#secofvzyni) .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

:where(#secofvzyni) .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

:where(#secofvzyni) .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

:where(#secofvzyni) .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

:where(#secofvzyni) .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

:where(#secofvzyni) .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

:where(#secofvzyni) .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

:where(#secofvzyni) .gt_from_md > :first-child {
  margin-top: 0;
}

:where(#secofvzyni) .gt_from_md > :last-child {
  margin-bottom: 0;
}

:where(#secofvzyni) .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

:where(#secofvzyni) .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#secofvzyni) .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

:where(#secofvzyni) .gt_row_group_first td {
  border-top-width: 2px;
}

:where(#secofvzyni) .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#secofvzyni) .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

:where(#secofvzyni) .gt_first_summary_row.thick {
  border-top-width: 2px;
}

:where(#secofvzyni) .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#secofvzyni) .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#secofvzyni) .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

:where(#secofvzyni) .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

:where(#secofvzyni) .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#secofvzyni) .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

:where(#secofvzyni) .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#secofvzyni) .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

:where(#secofvzyni) .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#secofvzyni) .gt_left {
  text-align: left;
}

:where(#secofvzyni) .gt_center {
  text-align: center;
}

:where(#secofvzyni) .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

:where(#secofvzyni) .gt_font_normal {
  font-weight: normal;
}

:where(#secofvzyni) .gt_font_bold {
  font-weight: bold;
}

:where(#secofvzyni) .gt_font_italic {
  font-style: italic;
}

:where(#secofvzyni) .gt_super {
  font-size: 65%;
}

:where(#secofvzyni) .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

:where(#secofvzyni) .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

:where(#secofvzyni) .gt_indent_1 {
  text-indent: 5px;
}

:where(#secofvzyni) .gt_indent_2 {
  text-indent: 10px;
}

:where(#secofvzyni) .gt_indent_3 {
  text-indent: 15px;
}

:where(#secofvzyni) .gt_indent_4 {
  text-indent: 20px;
}

:where(#secofvzyni) .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
<caption>Tabelle&nbsp;6.1:  Postverteilung mit der Gittermethode berechnet </caption>
  
  <thead class="gt_col_headings"><tr>
<th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="p_grid">p_grid</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="prior">prior</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="likelihood">likelihood</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="unstand_post">unstand_post</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="post">post</th>
    </tr></thead>
<tbody class="gt_table_body">
<tr>
<td headers="p_grid" class="gt_row gt_right">0.00</td>
<td headers="prior" class="gt_row gt_right">1</td>
<td headers="likelihood" class="gt_row gt_right">0.00</td>
<td headers="unstand_post" class="gt_row gt_right">0.00</td>
<td headers="post" class="gt_row gt_right">0.00</td>
</tr>
<tr>
<td headers="p_grid" class="gt_row gt_right">0.11</td>
<td headers="prior" class="gt_row gt_right">1</td>
<td headers="likelihood" class="gt_row gt_right">0.00</td>
<td headers="unstand_post" class="gt_row gt_right">0.00</td>
<td headers="post" class="gt_row gt_right">0.00</td>
</tr>
<tr>
<td headers="p_grid" class="gt_row gt_right">0.22</td>
<td headers="prior" class="gt_row gt_right">1</td>
<td headers="likelihood" class="gt_row gt_right">0.00</td>
<td headers="unstand_post" class="gt_row gt_right">0.00</td>
<td headers="post" class="gt_row gt_right">0.01</td>
</tr>
<tr>
<td headers="p_grid" class="gt_row gt_right">0.33</td>
<td headers="prior" class="gt_row gt_right">1</td>
<td headers="likelihood" class="gt_row gt_right">0.03</td>
<td headers="unstand_post" class="gt_row gt_right">0.03</td>
<td headers="post" class="gt_row gt_right">0.04</td>
</tr>
<tr>
<td headers="p_grid" class="gt_row gt_right">0.44</td>
<td headers="prior" class="gt_row gt_right">1</td>
<td headers="likelihood" class="gt_row gt_right">0.11</td>
<td headers="unstand_post" class="gt_row gt_right">0.11</td>
<td headers="post" class="gt_row gt_right">0.12</td>
</tr>
<tr>
<td headers="p_grid" class="gt_row gt_right">0.56</td>
<td headers="prior" class="gt_row gt_right">1</td>
<td headers="likelihood" class="gt_row gt_right">0.22</td>
<td headers="unstand_post" class="gt_row gt_right">0.22</td>
<td headers="post" class="gt_row gt_right">0.24</td>
</tr>
<tr>
<td headers="p_grid" class="gt_row gt_right">0.67</td>
<td headers="prior" class="gt_row gt_right">1</td>
<td headers="likelihood" class="gt_row gt_right">0.27</td>
<td headers="unstand_post" class="gt_row gt_right">0.27</td>
<td headers="post" class="gt_row gt_right">0.30</td>
</tr>
<tr>
<td headers="p_grid" class="gt_row gt_right">0.78</td>
<td headers="prior" class="gt_row gt_right">1</td>
<td headers="likelihood" class="gt_row gt_right">0.20</td>
<td headers="unstand_post" class="gt_row gt_right">0.20</td>
<td headers="post" class="gt_row gt_right">0.23</td>
</tr>
<tr>
<td headers="p_grid" class="gt_row gt_right">0.89</td>
<td headers="prior" class="gt_row gt_right">1</td>
<td headers="likelihood" class="gt_row gt_right">0.06</td>
<td headers="unstand_post" class="gt_row gt_right">0.06</td>
<td headers="post" class="gt_row gt_right">0.06</td>
</tr>
<tr>
<td headers="p_grid" class="gt_row gt_right">1.00</td>
<td headers="prior" class="gt_row gt_right">1</td>
<td headers="likelihood" class="gt_row gt_right">0.00</td>
<td headers="unstand_post" class="gt_row gt_right">0.00</td>
<td headers="post" class="gt_row gt_right">0.00</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="fig-post1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="Post_files/figure-html/fig-post1-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Abbildung&nbsp;6.1: Die Postverteilung für W=6, N=9, k=10</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="cell">

</div>
<p>Viele nützliche Fragen (und Antworten) leiten sich ab aus Abb. <a href="#fig-post1">Abbildung&nbsp;<span>6.1</span></a>.</p>
</section><section id="beispiele-für-fragen-an-die-post-verteilung" class="level3" data-number="6.2.2"><h3 data-number="6.2.2" class="anchored" data-anchor-id="beispiele-für-fragen-an-die-post-verteilung">
<span class="header-section-number">6.2.2</span> Beispiele für Fragen an die Post-Verteilung</h3>
<ul>
<li>Mit welcher Wahrscheinlichkeit liegt der Parameter unter einem bestimmten Wert?</li>
<li>Mit welcher Wahrscheinlichkeit liegt der Parameter zwischen zwei bestimmten Werten?</li>
<li>Mit 5% Wahrscheinlichkeit liegt der Parameterwert nicht unter welchem Wert?</li>
<li>Welcher Parameterwert hat die höchste Wahrscheinlichkeit?</li>
<li>Wie ungewiss ist das Modell über die Parameterwerte?</li>
</ul>
<p>Solche Fragen kann man in zwei Gruppen aufteilen:</p>
<ol type="1">
<li>Fragen zu Parametern</li>
<li>Fragen zu Wahrscheinlichkeiten</li>
</ol></section><section id="bayes-box-für-komplexe-modelle" class="level3" data-number="6.2.3"><h3 data-number="6.2.3" class="anchored" data-anchor-id="bayes-box-für-komplexe-modelle">
<span class="header-section-number">6.2.3</span> Bayes-Box für komplexe Modelle</h3>
<p>Bisher, für einfache Fragestellungen hat unsere Bayes-Box, das heißt die Gittermethode bestens funktioniert: einfach, robust, formschön<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>. Allerdings: Funktioniert sie auch bei komplexeren Modellen? Schließlich wollen wir ja auch irgendwann Regressionsmodelle berechnen. Angenommen, wir haben ein Regressionsmodell mit 1 Prädiktor, dann haben wir folgende drei Größen<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> zu schätzen: <span class="math inline">\(\beta_0, \beta_1, \sigma\)</span>. Hört sich gar nicht so viel an. Aber Moment, wir müssten dann z.B. die Frage beantworten, wie wahrscheinlich die Daten aposteriori sind, wenn z.B. <span class="math inline">\(\beta_0 = -3.14\)</span> und <span class="math inline">\(\beta_1 = 2.71\)</span> und <span class="math inline">\(\sigma = 0.70\)</span>. Demnach müssen wir alle Ausprägungen (“Gitterwerte”) der Variablen multiplizieren. Puh, das wird eine große Zahl. Wenn wir für die drei Größen jeweils 10 Ausprägungen annehmen, was wenig ist, kämen wir <span class="math inline">\(10\cdot10\cdot10= 1000=10^3\)</span> Kombinationen. Bei 100 Ausprägungen wären es schon <span class="math inline">\(100^3=10^6\)</span> Kombinationen. Das wäre doch eine recht lange Tabelle.</p>
<p>Bei einer multiplen Regression mit sagen wir 10 Prädiktoren mit jeweils 100 Ausprägungen rechnet das arme R bis zum jüngsten Tag: $10^{100}. Nein, das können wir R nicht zumuten. Wir brauchen eine andere Lösung!</p>
</section><section id="wir-arbeiten-jetzt-mit-häufigkeit-nicht-mit-wahrscheinlichkeit" class="level3" data-number="6.2.4"><h3 data-number="6.2.4" class="anchored" data-anchor-id="wir-arbeiten-jetzt-mit-häufigkeit-nicht-mit-wahrscheinlichkeit">
<span class="header-section-number">6.2.4</span> Wir arbeiten jetzt mit Häufigkeit, nicht mit Wahrscheinlichkeit</h3>
<p>Kurz gesagt: Komplexere Bayes-Modelle können nicht mehr “einfach mal eben” ausgerechnet werden; die Mathematik wird so umfangreich bzw. zu komplex.</p>
<p>Glücklicherweiße gibt es einen Trick, der die Sache nicht nur rechnerisch, sondern auch konzeptionell viel einfacher macht.</p>
<p>Dieser Trick lautet: Wir arbeiten nicht mehr mit Wahrscheinlichkeiten, sondern mit <em>Häufigkeiten.</em></p>
<p>Praktischerweise werden wir in Kürze einen R-Golem kennenlernen, der das für uns erledigt. Dieser Golem liefert uns Stichproben aus der Post-Verteilung zurück.</p>
<p>Lernen wir jetzt also, wie man mit solchen Stichproben umgeht.</p>
<div class="callout-important callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Wichtig
</div>
</div>
<div class="callout-body-container callout-body">
<p>Die Post-Verteilung in Stichprobenform ist viel einfach zu handhaben als das direkte Arbeiten mit Wahrscheinlichkeiten. Daher sind viele R-Funktionen für Bayes auf Stichproben eingestellt.</p>
</div>
</div>
<p>Die Grid-Methode ist bei größeren Datensätzen (oder größeren Modellen) zu rechenintensiv. In der Praxis werden daher andere, schnellere Verfahren verwendet, sog. Monte-Carlo-Markov-Ketten (MCMC). Wie diese Verfahren funktionieren sind aber nicht mehr Gegenstand dieses Kurses. Wir wenden Sie einfach an, freuen uns und lassen es damit gut sein<span class="citation" data-cites="mcelreath_statistical_2020">(Eine gute Einführung in die Hintergründe findet sich bei <a href="references.html#ref-mcelreath_statistical_2020" role="doc-biblioref">McElreath 2020</a>.)</span></p>
</section><section id="häufigkeiten-sind-einfacher-als-wahrscheinlichkeiten" class="level3" data-number="6.2.5"><h3 data-number="6.2.5" class="anchored" data-anchor-id="häufigkeiten-sind-einfacher-als-wahrscheinlichkeiten">
<span class="header-section-number">6.2.5</span> Häufigkeiten sind einfacher als Wahrscheinlichkeiten</h3>
<p>Wie gesagt, typische R-Werkzeuge (“R-Golems”) liefern uns die Post-Verteilung in Stichprobenform zurück.</p>
<p>Bevor wir uns aber mit diesen R-Werkzeugen beschäftigen, sollten wir uns vertraut machen mit einer Post-Verteilung in Stichprobenform.</p>
<p>Erstellen wir uns also einen Tabelle mit Stichprobendaten aus der Posteriori-Verteilung (Tabelle <code>d</code>), s. <a href="#lst-post-sample">Listing&nbsp;<span>6.1</span></a>.</p>
<div id="lst-post-sample" class="listing">
<p>Listing&nbsp;6.1: Wir stellen eine Tabelle mit Stichproben aus der Post-Verteilung</p>
<div class="sourceCode" id="lst-post-sample" data-lst-cap="Wir stellen eine Tabelle mit Stichproben aus der Post-Verteilung"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">samples</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">d</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>  <span class="co"># nimmt die Tabelle mit Posteriori-Daten,</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_sample</a></span><span class="op">(</span>  <span class="co"># Ziehe daraus eine Stichprobe,</span></span>
<span>    n <span class="op">=</span> <span class="fl">1e4</span>,  <span class="co"># mit insgesamt n=10000 Zeilen,</span></span>
<span>    weight_by <span class="op">=</span> <span class="va">post</span>,  <span class="co"># Gewichte nach Post-Wskt.,</span></span>
<span>    replace <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>  <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>  <span class="co"># Ziehe mit Zurücklegen</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">p_grid</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">

</div>
<p>Die Wahrscheinlichkeit, einen bestimmten Parameterwert (d.h. aus der Spalte <code>p_grid</code>) aus Tabelle <code>d</code> zu ziehen, ist proportional zur Posteriori-Wahrscheinlichkeit (<code>post</code>) dieses Werts. Ziehen mit Zurücklegen hält die Wahrscheinlichkeiten während des Ziehens konstant. Das Argument <code>weight_by</code> legt die Wahrscheinlichkeit fest, mit der eine Zeile gezogen wird.</p>
<p>Wir begnügen uns mit der Spalte mit den Wasseranteilswerten (Parameterwerten), <code>p_grid</code>, die anderen Spalten brauchen wir nicht.</p>
<p>Das Ergebnis, Tabelle <code>samples</code>, die aus Stichproben aus der Post-Verteilung besteht, ist (in Auszügen) in <a href="#tbl-postsample1">Tabelle&nbsp;<span>6.2</span></a> dargestellt.</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-postsample1" class="anchored">

<div id="hclnnksqfb" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

:where(#hclnnksqfb) .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

:where(#hclnnksqfb) .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

:where(#hclnnksqfb) .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

:where(#hclnnksqfb) .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

:where(#hclnnksqfb) .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

:where(#hclnnksqfb) .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#hclnnksqfb) .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

:where(#hclnnksqfb) .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

:where(#hclnnksqfb) .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

:where(#hclnnksqfb) .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

:where(#hclnnksqfb) .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

:where(#hclnnksqfb) .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

:where(#hclnnksqfb) .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

:where(#hclnnksqfb) .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

:where(#hclnnksqfb) .gt_from_md > :first-child {
  margin-top: 0;
}

:where(#hclnnksqfb) .gt_from_md > :last-child {
  margin-bottom: 0;
}

:where(#hclnnksqfb) .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

:where(#hclnnksqfb) .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#hclnnksqfb) .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

:where(#hclnnksqfb) .gt_row_group_first td {
  border-top-width: 2px;
}

:where(#hclnnksqfb) .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#hclnnksqfb) .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

:where(#hclnnksqfb) .gt_first_summary_row.thick {
  border-top-width: 2px;
}

:where(#hclnnksqfb) .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#hclnnksqfb) .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#hclnnksqfb) .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

:where(#hclnnksqfb) .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

:where(#hclnnksqfb) .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#hclnnksqfb) .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

:where(#hclnnksqfb) .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#hclnnksqfb) .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

:where(#hclnnksqfb) .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#hclnnksqfb) .gt_left {
  text-align: left;
}

:where(#hclnnksqfb) .gt_center {
  text-align: center;
}

:where(#hclnnksqfb) .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

:where(#hclnnksqfb) .gt_font_normal {
  font-weight: normal;
}

:where(#hclnnksqfb) .gt_font_bold {
  font-weight: bold;
}

:where(#hclnnksqfb) .gt_font_italic {
  font-style: italic;
}

:where(#hclnnksqfb) .gt_super {
  font-size: 65%;
}

:where(#hclnnksqfb) .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

:where(#hclnnksqfb) .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

:where(#hclnnksqfb) .gt_indent_1 {
  text-indent: 5px;
}

:where(#hclnnksqfb) .gt_indent_2 {
  text-indent: 10px;
}

:where(#hclnnksqfb) .gt_indent_3 {
  text-indent: 15px;
}

:where(#hclnnksqfb) .gt_indent_4 {
  text-indent: 20px;
}

:where(#hclnnksqfb) .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
<caption>Tabelle&nbsp;6.2:  Die ersten Zeilen der Stichproben aus der Post-Verteilung </caption>
  
  <thead class="gt_col_headings"><tr>
<th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="p_grid">p_grid</th>
    </tr></thead>
<tbody class="gt_table_body">
<tr><td headers="p_grid" class="gt_row gt_right">0.667</td></tr>
<tr><td headers="p_grid" class="gt_row gt_right">0.667</td></tr>
<tr><td headers="p_grid" class="gt_row gt_right">0.667</td></tr>
<tr><td headers="p_grid" class="gt_row gt_right">0.667</td></tr>
<tr><td headers="p_grid" class="gt_row gt_right">0.778</td></tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<p>Wenn Sie jetzt denken: “Warum machen wir das jetzt? Brauchen wir doch gar nicht!” - Dann haben Sie Recht. Künftig werden wir aber, wenn wir mit komplexeren Modellen zu tun haben, nur noch mit Post-Verteilungen auf Stichprobenbasis arbeiten, weil es damit viel einfacher ist.</p>
<p>Hier erstmal die ersten 100 gesampelten Gitterwerte (<code>p_grid</code>):</p>
<div class="cell">
<pre><code>##   [1] 0.67 0.67 0.67 0.67 0.78 0.44 0.56 0.67 0.44 0.78 0.33 0.56 0.67 0.33 0.78
##  [16] 0.89 0.67 0.44 0.78 0.78 0.67 0.89 0.78 0.78 0.67 0.56 0.56 0.44 0.44 0.67
##  [31] 0.22 0.67 0.44 0.78 0.67 0.44 0.56 0.78 0.67 0.78 0.67 0.44 0.44 0.78 0.67
##  [46] 0.67 0.67 0.44 0.89 0.56 0.67 0.78 0.33 0.44 0.67 0.78 0.56 0.78 0.67 0.67
##  [61] 0.56 0.56 0.78 0.44 0.78 0.67 0.56 0.33 0.44 0.44 0.78 0.56 0.78 0.67 0.56
##  [76] 0.33 0.33 0.78 0.56 0.44 0.22 0.78 0.56 0.44 0.44 0.44 0.67 0.56 0.56 0.56
##  [91] 0.67 0.67 0.67 0.78 0.33 0.44 0.67 0.22 0.67 0.67</code></pre>
</div>
<p>Wie sieht diese Tabelle wohl als Histogramm<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a> aus?</p>
<p>So sieht die Post-Verteilung auf Basis von Stichproben dann aus, s. <a href="#fig-samples1">Abbildung&nbsp;<span>6.2</span></a>.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-samples1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="Post_files/figure-html/fig-samples1-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Abbildung&nbsp;6.2: Stichprobenverteilung auf Basis von Stichproben</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Aus <a href="#fig-samples1">Abbildung&nbsp;<span>6.2</span></a> können wir einfach auslesen, wie wahrscheinlich gewisse Parameterwerte sind. So sehen wir, dass das Modell Parameterwerte (Wasseranteil, <span class="math inline">\(\pi\)</span>) zwischen ca. 50% und 70% für am wahrscheinlichsten hält. Aber auch kleine Anteile wie 25% sind nicht auszuschließen (auf Basis der Daten und der Modellannahmen).</p>
<p>Vergleichen Sie <a href="#fig-samples1">Abbildung&nbsp;<span>6.2</span></a> mit <a href="Globusversuch.html#fig-gitter">Abbildung&nbsp;<span>5.11</span></a>: beide sind sehr ähnlich! Das Stichprobenziehen (<a href="#fig-samples1">Abbildung&nbsp;<span>6.2</span></a>) nähert sich recht gut an die exakte Berechnung an (<a href="Globusversuch.html#fig-gitter">Abbildung&nbsp;<span>5.11</span></a>).</p>
</section><section id="visualisierung-der-stichprobendaten-mit-k100-gitterwerten" class="level3" data-number="6.2.6"><h3 data-number="6.2.6" class="anchored" data-anchor-id="visualisierung-der-stichprobendaten-mit-k100-gitterwerten">
<span class="header-section-number">6.2.6</span> Visualisierung der Stichprobendaten mit <span class="math inline">\(k=100\)</span> Gitterwerten</h3>
<p><span class="math inline">\(k=10\)</span> Gitterwerte ist ein grobes Raster. Drehen wir mal die Auflösung auf <span class="math inline">\(k=100\)</span> Gitterwerte (Ausprägungen) nach oben.</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">n_success</span> <span class="op">&lt;-</span> <span class="fl">6</span></span>
<span><span class="va">n_trials</span>  <span class="op">&lt;-</span> <span class="fl">9</span></span>
<span></span>
<span><span class="va">d_k100</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>p_grid <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0</span>, </span>
<span>                      to <span class="op">=</span> <span class="fl">1</span>, </span>
<span>                      length.out <span class="op">=</span> <span class="va">k</span><span class="op">)</span>,  <span class="co"># 100 Gitterwerte</span></span>
<span>         prior  <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>likelihood <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">dbinom</a></span><span class="op">(</span><span class="va">n_success</span>, </span>
<span>                             size <span class="op">=</span> <span class="va">n_trials</span>, </span>
<span>                             prob <span class="op">=</span> <span class="va">p_grid</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>unstand_post <span class="op">=</span> <span class="op">(</span><span class="va">likelihood</span> <span class="op">*</span> <span class="va">prior</span><span class="op">)</span>,</span>
<span>         post <span class="op">=</span> <span class="va">unstand_post</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">unstand_post</span><span class="op">)</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><span class="math inline">\(d_k100\)</span> ist eine Bayes-Box mit <span class="math inline">\(W=6, N=9, k=100\)</span>.</p>
<p>Und daraus ziehen wir uns <span class="math inline">\(n=1000\)</span> Stichproben:</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">samples_k100</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">d_k100</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>  <span class="co"># nimmt die Tabelle mit Posteriori-Daten,</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_sample</a></span><span class="op">(</span>  <span class="co"># Ziehe daraus eine Stichprobe,</span></span>
<span>    n <span class="op">=</span> <span class="fl">1000</span>,  <span class="co"># mit insgesamt n=1000 Elementen,</span></span>
<span>    weight_by <span class="op">=</span> <span class="va">post</span>,  <span class="co"># Gewichte nach Spalte mit Post-Wskt.,</span></span>
<span>    replace <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>  <span class="co"># Ziehe mit Zurücklegen</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><a href="#fig-post100">Abbildung&nbsp;<span>6.3</span></a> zeigt sowohl die exakte Post-Verteilung als auch die Post-Verteilung auf Basis von Stichproben. Im mittleren Teildiagramm sind die Stichproben einzeln als Kreis dargestellt. Im rechten Teildiagramm sind die gleichen Daten als Dichtediagramm dargestellt. In allen Fällen erkennt man gut die zentrale Tendenz: ein Wasseranteil von 70% scheint der “typische” Wert des Modells zu sein. Außerdem erkennt man, dass das Modell durchaus einige Streuung in der Schätzung des Wasseranteils bereithält. Das Modell ist sich nicht sehr sicher, könnte man sagen.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-post100" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="Post_files/figure-html/fig-post100-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Abbildung&nbsp;6.3: Post-Verteilung mit 100 Gitterwerten, exakt vs.&nbsp;auf Basis von Stichproben</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Die Stichprobendaten nähern sich der “echten” Posteriori-Verteilung an: Die Stichproben-Post-Verteilung hat jetzt “glattere” Ränder.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Hinweis
</div>
</div>
<div class="callout-body-container callout-body">
<p>Mehr Stichproben und mehr Gitterwerte glätten die Verteilung.</p>
</div>
</div>
<p>Jetzt noch mal mit mehr Stichproben: <span class="math inline">\(n=10^6\)</span> Stichproben bei <span class="math inline">\(k=100\)</span> Gitterwerten aus der Posteriori-Verteilung, s. <a href="#fig-post-dk100">Abbildung&nbsp;<span>6.4</span></a>.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-post-dk100" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="Post_files/figure-html/fig-post-dk100-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Abbildung&nbsp;6.4: Post-Verteilung mit vielen Stichproben und vielen Parameterwerten (Gitterwerten): schön ‘glatt’. Mittelwert (MW), Modus und Median (Md) liegen eng nebeneinander, da die Verteilung recht symmetrisch ist.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section></section><section id="die-post-verteilung-befragen" class="level2" data-number="6.3"><h2 data-number="6.3" class="anchored" data-anchor-id="die-post-verteilung-befragen">
<span class="header-section-number">6.3</span> Die Post-Verteilung befragen</h2>
<p>So, jetzt befragen wir die Post-Verteilung.</p>
<div class="callout-important callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Wichtig
</div>
</div>
<div class="callout-body-container callout-body">
<p>Die Post-Verteilung ist das zentrale Ergebnis einer Bayes-Analyse. Wir können viele nützliche Fragen an sie stellen.</p>
</div>
</div>
<p>Es gibt zwei Arten von Fragen:</p>
<ol type="1">
<li>nach Wahrscheinlichkeiten (p)</li>
<li>nach Parameterwerten (Quantilen, q)</li>
</ol>
<p>Der Unterschied zwischen beiden Arten von Fragen ist in <a href="#fig-p-vs-q">Abbildung&nbsp;<span>6.5</span></a> illustriert.</p>
<div id="fig-p-vs-q" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="img/p-vs-q.png" class="img-fluid figure-img" style="width:50.0%"></p>
<p></p><figcaption class="figure-caption">Abbildung&nbsp;6.5: Fragen nach p vs.&nbsp;Fragen nach q</figcaption><p></p>
</figure>
</div>
<p>Im linken Teildiagramm von <a href="#fig-p-vs-q">Abbildung&nbsp;<span>6.5</span></a> fragen wir: “Wie wahrscheinlich ist ein Wasseranteil von höchstens 80%?”. Im rechten Teildiagramm fragen wir: “Welcher Wasseranteil wird mit einer Wahrscheinlichkeit von 78% nicht überschritten?”.</p>
<section id="fragen-nach-wahrscheinlichkeiten" class="level3" data-number="6.3.1"><h3 data-number="6.3.1" class="anchored" data-anchor-id="fragen-nach-wahrscheinlichkeiten">
<span class="header-section-number">6.3.1</span> Fragen nach Wahrscheinlichkeiten</h3>
<p>Sagen wir, dass sei unsere Forschungsfrage: <em>Wie groß ist die Wahrscheinlichkeit, dass der Wasseranteil unter 50% liegt?</em></p>
<p>Um diese Frage zu beantworten, zählen wir einfach, wie viele Stichproben die Bedingung erfüllen:</p>
<p>und und summieren die Wahrscheinlichkeiten dieser Stichproben:</p>
<p>Wir zählen (<code>count</code>) also die Stichproben, die sich für einen Wasseranteil (<code>p_grid</code>) von weniger als 50% aussprechen:</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">samples</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="va">p_grid</span> <span class="op">&lt;</span> <span class="fl">.5</span><span class="op">)</span> </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped">
<thead><tr class="header">
<th style="text-align: left;">p_grid &lt; 0.5</th>
<th style="text-align: right;">n</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">8342</td>
</tr>
<tr class="even">
<td style="text-align: left;">TRUE</td>
<td style="text-align: right;">1658</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Da wir insgesamt 10000 (1e4) Stichproben gezogen haben, können wir noch durch diese Zahl teilen, um einen Anteil zu bekommen. Dieser Anteil ist die Antwort auf die Forschungsfrage: Wie Wahrscheinlichkeit (laut Modell) für einen Wasseranteil kleiner als 50%.^[Der Befehl <code>count</code> macht Folgendes: Er gruppiert die Stichprobe nach dem Prüfkriterium, Wasseranteil höchstens 50%. Dann zählt er in jeder der beiden Teiltabelle die Zeilen und liefert diese zwei Zahlen dann zurück. Man könnte also auch in etwa schreiben:</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">d</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">p_grid</span> <span class="op">&lt;</span> <span class="fl">.5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>sum <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">post</span><span class="op">)</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped">
<thead><tr class="header">
<th style="text-align: right;">sum</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: right;">0.16653</td>
</tr></tbody>
</table>
</div>
</div>
</div>
<p>Einfach wie 🍰 essen.</p>
<div id="exm-param2" class="theorem example">
<p><span class="theorem-title"><strong>Beispiel 6.1 (Wasseranteil zwischen 50 und 75%?) </strong></span>Noch eine Forschungsfrage: <em>Mit welcher Wahrscheinlichkeit liegt der Parameter (Wasseranteil) zwischen 0.5 und 0.75?</em></p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">samples</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="va">p_grid</span> <span class="op">&gt;</span> <span class="fl">.5</span> <span class="op">&amp;</span> <span class="va">p_grid</span> <span class="op">&lt;</span> <span class="fl">.75</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped">
<thead><tr class="header">
<th style="text-align: left;">p_grid &gt; 0.5 &amp; p_grid &lt; 0.75</th>
<th style="text-align: right;">n</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">4538</td>
</tr>
<tr class="even">
<td style="text-align: left;">TRUE</td>
<td style="text-align: right;">5462</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">samples</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="va">p_grid</span> <span class="op">&gt;</span> <span class="fl">.5</span> <span class="op">&amp;</span> <span class="va">p_grid</span> <span class="op">&lt;</span> <span class="fl">.75</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>Anteil <span class="op">=</span> <span class="va">n</span> <span class="op">/</span> <span class="fl">1e4</span>,</span>
<span>            Prozent <span class="op">=</span> <span class="fl">100</span> <span class="op">*</span> <span class="va">n</span> <span class="op">/</span> <span class="fl">1e4</span><span class="op">)</span>  <span class="co"># In Prozent</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped">
<thead><tr class="header">
<th style="text-align: right;">Anteil</th>
<th style="text-align: right;">Prozent</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.4538</td>
<td style="text-align: right;">45.38</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.5462</td>
<td style="text-align: right;">54.62</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Anteile von <code><a href="https://dplyr.tidyverse.org/reference/count.html">count()</a></code> könnte man, wenn man möchte, auch <code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a></code> verwenden:</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">samples</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">p_grid</span> <span class="op">&gt;</span> <span class="fl">.5</span> <span class="op">&amp;</span> <span class="va">p_grid</span> <span class="op">&lt;</span> <span class="fl">.75</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>sum     <span class="op">=</span>       <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span> <span class="op">/</span> <span class="fl">1e4</span>,</span>
<span>            anteil <span class="op">=</span> <span class="fl">100</span> <span class="op">*</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span> <span class="op">/</span> <span class="fl">1e4</span><span class="op">)</span>  <span class="co"># In Prozent</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped">
<thead><tr class="header">
<th style="text-align: right;">sum</th>
<th style="text-align: right;">anteil</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: right;">0.5462</td>
<td style="text-align: right;">54.62</td>
</tr></tbody>
</table>
</div>
</div>
</div>
</div>
<div id="exm-param3" class="theorem example">
<p><span class="theorem-title"><strong>Beispiel 6.2 (Wasseranteil zwischen 90 und 100%?) </strong></span>Noch ein Beispiel für eine Forschungsfrage: Mit welcher Wahrscheinlichkeit liegt der Parameter zwischen 0.9 und 1?</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">samples</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="va">p_grid</span> <span class="op">&gt;=</span> <span class="fl">.9</span> <span class="op">&amp;</span> <span class="va">p_grid</span> <span class="op">&lt;=</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>prop <span class="op">=</span> <span class="fl">100</span> <span class="op">*</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span> <span class="op">/</span> <span class="fl">1e4</span><span class="op">)</span>  <span class="co"># prop wie "proportion", Anteil</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped">
<thead><tr class="header">
<th style="text-align: right;">prop</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: right;">0.01</td>
</tr></tbody>
</table>
</div>
</div>
</div>
<p>Laut unserem Modell ist es also sehr unwahrscheinlich, dass der Wasseranteil der Erde mind. 90% beträgt.</p>
</div>
<p>Wir können auch fragen, welcher Parameterwert am wahrscheinlichsten ist; dieser Wert entspricht dem “Gipfel” des Berges, s. <a href="#fig-post-dk100">Abbildung&nbsp;<span>6.4</span></a>.</p>
<p>Für unsere Stichproben-Postverteilung, <code>samples</code>, s. <a href="#fig-samples1">Abbildung&nbsp;<span>6.2</span></a>, lässt sich der Modus so berechnen:</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">map_estimate</span><span class="op">(</span><span class="va">samples</span><span class="op">$</span><span class="va">p_grid</span><span class="op">)</span>  </span>
<span><span class="co">## MAP Estimate: 0.67</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dabei steht <code>map</code> für <a href="https://easystats.github.io/bayestestR/reference/map_estimate.html">Maximum Aposteriori</a>, also das Maximum der Post-Verteilung.</p>
<p>Bei der Gelegenheit könnten wir folgende, ähnliche Fragen stellen:</p>
<ul>
<li>Was ist der mittlere Schätzwert (Mittelwert) zum Wasseranteil laut Post-Verteilung?</li>
<li>Was ist der mediane Schätzwert (Median)?</li>
</ul>
<p>Auf Errisch:</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">samples</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">p_grid</span><span class="op">)</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">p_grid</span><span class="op">)</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped">
<thead><tr class="header">
<th style="text-align: right;">mean(p_grid)</th>
<th style="text-align: right;">median(p_grid)</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: right;">0.6356667</td>
<td style="text-align: right;">0.6666667</td>
</tr></tbody>
</table>
</div>
</div>
</div>
</section><section id="fragen-nach-parameterwerten" class="level3" data-number="6.3.2"><h3 data-number="6.3.2" class="anchored" data-anchor-id="fragen-nach-parameterwerten">
<span class="header-section-number">6.3.2</span> Fragen nach Parameterwerten</h3>
<div class="callout-important callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Wichtig
</div>
</div>
<div class="callout-body-container callout-body">
<p>Schätzbereiche von Parameterwerten nennt man auch <em>Konfidenz- oder Vertrauensintervall</em><a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>.</p>
</div>
</div>
<p>Welcher Parameterwert wird mit 90% Wahrscheinlichkeit nicht überschritten, laut unserem Modell? (Gesucht sind also die unteren 90% der Posteriori-Wahrscheinlichkeit) Wir möchten also ziemlich sicher, was die Obergrenze an Wasser auf diesem Planeten ist<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a>.</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">samples</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>quantil90 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">p_grid</span>, p <span class="op">=</span> <span class="fl">.9</span><span class="op">)</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped">
<thead><tr class="header">
<th style="text-align: right;">quantil90</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: right;">0.7777778</td>
</tr></tbody>
</table>
</div>
</div>
</div>
<p>Laut unserem Modell können wir zu 90% sicher sein, dass der Wasseranteil kleiner ist als ca. 78%.</p>
<p>Es hilft vielleicht, sich die Post-Verteilung noch einmal vor Augen zu führen, s. <a href="#fig-post99">Abbildung&nbsp;<span>6.6</span></a>.</p>
<div class="cell" data-fig.asp="0.5">
<details><summary>Code</summary><div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">samples</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">p_grid</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-post99" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="Post_files/figure-html/fig-post99-1.png" class="img-fluid figure-img" style="width:50.0%"></p>
<p></p><figcaption class="figure-caption">Abbildung&nbsp;6.6: Die Post-Verteilung im Globusversuch</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Was ist das <em>mittlere</em> Intervall, das mit 90% Wahrscheinlichkeit den Parameterwert enthält, laut dem Modell?</p>
<p>Dafür “schneiden” wir links und rechts die 5% der Stichproben mit den extremsten Werten ab und schauen, bei welchen Parameterwerten wir als Grenzwerte landen:</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">samples</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span></span>
<span>    quant_05 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">p_grid</span>, <span class="fl">0.05</span><span class="op">)</span>,</span>
<span>    quant_95 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">p_grid</span>, <span class="fl">0.95</span><span class="op">)</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped">
<thead><tr class="header">
<th style="text-align: right;">quant_05</th>
<th style="text-align: right;">quant_95</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: right;">0.4444444</td>
<td style="text-align: right;">0.8888889</td>
</tr></tbody>
</table>
</div>
</div>
</div>
<p>Solche Fragen lassen sich also mit Hilfe von <em>Quantilen</em> beantworten.</p>
</section><section id="zur-erinnerung-quantile" class="level3" data-number="6.3.3"><h3 data-number="6.3.3" class="anchored" data-anchor-id="zur-erinnerung-quantile">
<span class="header-section-number">6.3.3</span> Zur Erinnerung: Quantile</h3>
<p>Beispiel: Wie groß sind die Studentis (<a href="https://rdrr.io/cran/openintro/man/speed_gender_height.html">Quelle des Datensatzes</a>)?</p>
<p>Das Quantil von z.B. 25% zeigt die Körpergröße der 25% kleinsten Studentis an, analog für 50%, 75%, in Inches<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a>:</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">speed_gender_height</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"https://raw.githubusercontent.com/rpruim/OpenIntro/master/data/speed_gender_height.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">height_summary</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">speed_gender_height</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>height_cm <span class="op">=</span> <span class="va">height</span><span class="op">*</span><span class="fl">2.54</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span>height_inch <span class="op">=</span> <span class="va">height</span>, <span class="va">height_cm</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"Einheit"</span>, values_to <span class="op">=</span> <span class="st">"Messwert"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">Einheit</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>q25 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">Messwert</span>, prob <span class="op">=</span> <span class="fl">.25</span><span class="op">)</span>,</span>
<span>            q50 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">Messwert</span>, prob <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span>,</span>
<span>            q75 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">Messwert</span>, prob <span class="op">=</span> <span class="fl">.75</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">height_summary</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped">
<thead><tr class="header">
<th style="text-align: left;">Einheit</th>
<th style="text-align: right;">q25</th>
<th style="text-align: right;">q50</th>
<th style="text-align: right;">q75</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">height_cm</td>
<td style="text-align: right;">160.02</td>
<td style="text-align: right;">167.64</td>
<td style="text-align: right;">175.26</td>
</tr>
<tr class="even">
<td style="text-align: left;">height_inch</td>
<td style="text-align: right;">63.00</td>
<td style="text-align: right;">66.00</td>
<td style="text-align: right;">69.00</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Das 25%-Quantil nennt man auch 1. Quartil; das 50%-Quantil (Median) auch 2. Quartil und das 75%-Quantil auch 3. Quartil.</p>
<p><a href="#fig-stud-height">Abbildung&nbsp;<span>6.7</span></a> visualisiert die Quantile und die Häufigkeitsverteilung.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-stud-height" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="Post_files/figure-html/fig-stud-height-1.png" class="img-fluid figure-img" width="960"></p>
<p></p><figcaption class="figure-caption">Abbildung&nbsp;6.7: Größenverteilung von 1325 amerikanischen Studentis</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section><section id="den-quantilen-unter-die-motorhaube-geschaut" class="level3" data-number="6.3.4"><h3 data-number="6.3.4" class="anchored" data-anchor-id="den-quantilen-unter-die-motorhaube-geschaut">
<span class="header-section-number">6.3.4</span> Den Quantilen unter die Motorhaube geschaut</h3>
<p>Den R-Befehl <code><a href="https://rdrr.io/r/stats/quantile.html">quantile()</a></code> kann man sich, wenn man will, einfach nachbauen und entmystifizieren.</p>
<p>Angenommen, wir wollen wissen, welcher Wasseranteil mit 90% Wahrscheinlichkeit nicht überschritten wird. Das können wir mit im Datensatz <code>samples</code> so erreichen.</p>
<ol type="1">
<li>Sortiere die Stichproben aufsteigend.</li>
<li>Schneide die oberen 10% (von 10000) ab (entferne sie).</li>
<li>Schaue, was der größte verbleibende Wert ist.</li>
</ol>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">samples</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">p_grid</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>   <span class="co"># sortiere</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_head</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">9000</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>  <span class="co"># nur die ersten 90000</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>p90 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">p_grid</span><span class="op">)</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped">
<thead><tr class="header">
<th style="text-align: right;">p90</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: right;">0.7777778</td>
</tr></tbody>
</table>
</div>
</div>
</div>
<p>Das (annähernd) gleiche Ergebnis liefert <code><a href="https://rdrr.io/r/stats/quantile.html">quantile()</a></code>:</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">samples</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>q90 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">p_grid</span>, <span class="fl">.9</span><span class="op">)</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped">
<thead><tr class="header">
<th style="text-align: right;">q90</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: right;">0.7777778</td>
</tr></tbody>
</table>
</div>
</div>
</div>
</section><section id="visualisierung-der-intervalle" class="level3" data-number="6.3.5"><h3 data-number="6.3.5" class="anchored" data-anchor-id="visualisierung-der-intervalle">
<span class="header-section-number">6.3.5</span> Visualisierung der Intervalle</h3>
<p>Intervalle (Bereiche), die die “abzuschneidende” Wahrscheinlichkeitsmasse hälftig auf die beiden Ränder aufteilen, nennen wir <em>Perzentilintervalle</em> oder <em>Equal-Tails-Intervalle</em> (ETI), s. Abb. <a href="#fig-eti">Abbildung&nbsp;<span>6.8</span></a>, rechtes Teildiagramm.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-eti" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="Post_files/figure-html/fig-eti-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Abbildung&nbsp;6.8: Perzintilintervalle</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section></section><section id="schiefe-posteriori-verteilungen-sind-möglich" class="level2" data-number="6.4"><h2 data-number="6.4" class="anchored" data-anchor-id="schiefe-posteriori-verteilungen-sind-möglich">
<span class="header-section-number">6.4</span> Schiefe Posteriori-Verteilungen sind möglich</h2>
<p>Noch einmal zum Globusversuch: Gehen wir von 3 Würfen mit 3 Treffern aus; auf welche Wasseranteile (Parameterwerte) werden wir jetzt schließen?</p>
<p>Vermutlich ziemlich hohe.</p>
<p>Erstellen wir uns dazu mal eine Post-Verteilung (3 Treffer, 3 Würfe):</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">d_33</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>p_grid <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>, by <span class="op">=</span><span class="fl">.01</span><span class="op">)</span>,</span>
<span>         prior <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>likelihood <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">dbinom</a></span><span class="op">(</span><span class="fl">3</span>, size <span class="op">=</span> <span class="fl">3</span>, prob <span class="op">=</span> <span class="va">p_grid</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>unstand_post <span class="op">=</span> <span class="va">likelihood</span> <span class="op">*</span> <span class="va">prior</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>post_33  <span class="op">=</span> <span class="va">unstand_post</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">unstand_post</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">samples_33</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">d_33</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_sample</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1e4</span>, </span>
<span>                 weight_by <span class="op">=</span> <span class="va">post_33</span>, </span>
<span>                 replace <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>So sehen die ersten paar Zeilen der Post-Verteilung, <code>samples_33</code>, aus.</p>
<div class="cell">
<div class="cell-output-display">

<div id="jwuoulpctp" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

:where(#jwuoulpctp) .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

:where(#jwuoulpctp) .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

:where(#jwuoulpctp) .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

:where(#jwuoulpctp) .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

:where(#jwuoulpctp) .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

:where(#jwuoulpctp) .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#jwuoulpctp) .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

:where(#jwuoulpctp) .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

:where(#jwuoulpctp) .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

:where(#jwuoulpctp) .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

:where(#jwuoulpctp) .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

:where(#jwuoulpctp) .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

:where(#jwuoulpctp) .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

:where(#jwuoulpctp) .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

:where(#jwuoulpctp) .gt_from_md > :first-child {
  margin-top: 0;
}

:where(#jwuoulpctp) .gt_from_md > :last-child {
  margin-bottom: 0;
}

:where(#jwuoulpctp) .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

:where(#jwuoulpctp) .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#jwuoulpctp) .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

:where(#jwuoulpctp) .gt_row_group_first td {
  border-top-width: 2px;
}

:where(#jwuoulpctp) .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#jwuoulpctp) .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

:where(#jwuoulpctp) .gt_first_summary_row.thick {
  border-top-width: 2px;
}

:where(#jwuoulpctp) .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#jwuoulpctp) .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#jwuoulpctp) .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

:where(#jwuoulpctp) .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

:where(#jwuoulpctp) .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#jwuoulpctp) .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

:where(#jwuoulpctp) .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#jwuoulpctp) .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

:where(#jwuoulpctp) .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#jwuoulpctp) .gt_left {
  text-align: left;
}

:where(#jwuoulpctp) .gt_center {
  text-align: center;
}

:where(#jwuoulpctp) .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

:where(#jwuoulpctp) .gt_font_normal {
  font-weight: normal;
}

:where(#jwuoulpctp) .gt_font_bold {
  font-weight: bold;
}

:where(#jwuoulpctp) .gt_font_italic {
  font-style: italic;
}

:where(#jwuoulpctp) .gt_super {
  font-size: 65%;
}

:where(#jwuoulpctp) .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

:where(#jwuoulpctp) .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

:where(#jwuoulpctp) .gt_indent_1 {
  text-indent: 5px;
}

:where(#jwuoulpctp) .gt_indent_2 {
  text-indent: 10px;
}

:where(#jwuoulpctp) .gt_indent_3 {
  text-indent: 15px;
}

:where(#jwuoulpctp) .gt_indent_4 {
  text-indent: 20px;
}

:where(#jwuoulpctp) .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
<thead class="gt_col_headings"><tr>
<th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="p_grid">p_grid</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="prior">prior</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="likelihood">likelihood</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="unstand_post">unstand_post</th>
    </tr></thead>
<tbody class="gt_table_body">
<tr>
<td headers="p_grid" class="gt_row gt_right">0.74</td>
<td headers="prior" class="gt_row gt_right">1</td>
<td headers="likelihood" class="gt_row gt_right">0.41</td>
<td headers="unstand_post" class="gt_row gt_right">0.41</td>
</tr>
<tr>
<td headers="p_grid" class="gt_row gt_right">0.76</td>
<td headers="prior" class="gt_row gt_right">1</td>
<td headers="likelihood" class="gt_row gt_right">0.44</td>
<td headers="unstand_post" class="gt_row gt_right">0.44</td>
</tr>
<tr>
<td headers="p_grid" class="gt_row gt_right">0.90</td>
<td headers="prior" class="gt_row gt_right">1</td>
<td headers="likelihood" class="gt_row gt_right">0.73</td>
<td headers="unstand_post" class="gt_row gt_right">0.73</td>
</tr>
<tr>
<td headers="p_grid" class="gt_row gt_right">0.85</td>
<td headers="prior" class="gt_row gt_right">1</td>
<td headers="likelihood" class="gt_row gt_right">0.61</td>
<td headers="unstand_post" class="gt_row gt_right">0.61</td>
</tr>
<tr>
<td headers="p_grid" class="gt_row gt_right">0.73</td>
<td headers="prior" class="gt_row gt_right">1</td>
<td headers="likelihood" class="gt_row gt_right">0.39</td>
<td headers="unstand_post" class="gt_row gt_right">0.39</td>
</tr>
<tr>
<td headers="p_grid" class="gt_row gt_right">0.63</td>
<td headers="prior" class="gt_row gt_right">1</td>
<td headers="likelihood" class="gt_row gt_right">0.25</td>
<td headers="unstand_post" class="gt_row gt_right">0.25</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Mit dieser “schiefen” Post-Verteilung können wir gut die Auswirkungen auf das Perzentil- und das Höchste-Dichte-Intervall anschauen.</p>
<section id="perzentil-intervall" class="level3" data-number="6.4.1"><h3 data-number="6.4.1" class="anchored" data-anchor-id="perzentil-intervall">
<span class="header-section-number">6.4.1</span> 50%-Perzentil-Intervall</h3>
<p>Hier z.B. ein 50%-Perzentilintervall, s. Abb. <a href="#fig-schief">Abbildung&nbsp;<span>6.9</span></a>.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-schief" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="Post_files/figure-html/fig-schief-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Abbildung&nbsp;6.9: Schiefe Intervalle</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Die Grenzwerte dieses ETI (oder jedes beliebig breiten) kann man sich z.B. so ausgeben lassen:</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/easystats/">easystats</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">samples_33</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">p_grid</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">eti</span><span class="op">(</span>ci <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped">
<thead><tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: right;">CI</th>
<th style="text-align: right;">CI_low</th>
<th style="text-align: right;">CI_high</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: left;">p_grid</td>
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">0.71</td>
<td style="text-align: right;">0.93</td>
</tr></tbody>
</table>
</div>
</div>
</div>
<p>Der wahrscheinlichste Parameterwert (1) ist <em>nicht</em> im Intervall enthalten. Das ist ein Nachteil der ETI.</p>
</section><section id="intervall-höchster-dichte" class="level3" data-number="6.4.2"><h3 data-number="6.4.2" class="anchored" data-anchor-id="intervall-höchster-dichte">
<span class="header-section-number">6.4.2</span> 50%-Intervall höchster Dichte</h3>
<p>Intervalle höchster Dichte (Highest density Intervals, HDI oder HDPI) sind definiert als die <em>schmälsten</em> Intervalle, die den gesuchten Parameter enthalten.</p>
<p>Der wahrscheinlichste Parameterwert (1) <em>ist</em> im Intervall enthalten, was Sinn macht. Bei einem HDI sind die abgeschnitten Ränder nicht mehr gleich groß, im Sinne von enthalten nicht (zwangsläufig) die gleiche Wahrscheinlichkeitsmasse.</p>
<p>Je symmetrischer die Verteilung, desto näher liegen die Punktschätzer aneinander (und umgekehrt), s. Abb. <a href="#fig-post-pointestimates">Abbildung&nbsp;<span>6.10</span></a>.</p>
<div class="cell" data-fig.asp="0.5">
<div class="cell-output-display">
<div id="fig-post-pointestimates" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="Post_files/figure-html/fig-post-pointestimates-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Abbildung&nbsp;6.10: Visualisierung der Punktschätzer bei einer schiefen Post-Verteilung</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>So kann man sich die Grenzwerte eines 50%-HDI ausgeben lassen, s. <a href="#tbl-samples-hdi">Tabelle&nbsp;<span>6.3</span></a>.</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">samples</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">p_grid</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">hdi</span><span class="op">(</span>ci <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span>  <span class="co"># aus dem Paket `{easystats}`</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="kable-table">
<div id="tbl-samples-hdi" class="anchored">
<table class="table table-sm table-striped">
<caption>Tabelle&nbsp;6.3: 50%-HDI für unser Globusmodell</caption>
<thead><tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: right;">CI</th>
<th style="text-align: right;">CI_low</th>
<th style="text-align: right;">CI_high</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: left;">p_grid</td>
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">0.6666667</td>
<td style="text-align: right;">0.7777778</td>
</tr></tbody>
</table>
</div>
</div>
</div>
</div>
<p>Das Modell ist sich also zu 50% sicher, dass der gesuchte Parameter (der Wasseranteil der Erdoberfläche) sich im von ca. .67 bis .78 befindet (auf Basis eines HDI).</p>
</section></section><section id="fazit" class="level2" data-number="6.5"><h2 data-number="6.5" class="anchored" data-anchor-id="fazit">
<span class="header-section-number">6.5</span> Fazit</h2>
<section id="intervalle-höchster-dichte-vs.-perzentilintervalle" class="level3" data-number="6.5.1"><h3 data-number="6.5.1" class="anchored" data-anchor-id="intervalle-höchster-dichte-vs.-perzentilintervalle">
<span class="header-section-number">6.5.1</span> Intervalle höchster Dichte vs.&nbsp;Perzentilintervalle</h3>
<ul>
<li>Bei symmetrischer Posteriori-Verteilung sind beide Intervalle ähnlich</li>
<li>Perzentilintervalle sind verbreiteter</li>
<li>
<em>Intervalle höchster Dichte</em> (Highest Density Interval, HDI) sind bei schiefen Post-Verteilungen zu bevorzugen</li>
<li>Intervalle höchster Dichte sind die <em>schmalsten</em> Intervalle für eine gegebene Wahrscheinlichkeitsmasse</li>
</ul></section><section id="zusammenfassung" class="level3" data-number="6.5.2"><h3 data-number="6.5.2" class="anchored" data-anchor-id="zusammenfassung">
<span class="header-section-number">6.5.2</span> Zusammenfassung</h3>
<p>Fassen wir zentrale Punkte an einem Beispiel zusammen.</p>
<p>Im Globusversuch, Datendatz <code>samples</code>, s. <a href="#lst-post-sample">Listing&nbsp;<span>6.1</span></a>. Sagen wir, wir haben 6 Treffer bei 9 Würfen erzielt.</p>
<p>Lageparmameter: Welchen mittleren Wasseranteil muss man annehmen?</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">samples</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span></span>
<span>    mean   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">p_grid</span><span class="op">)</span>,</span>
<span>    median <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">p_grid</span><span class="op">)</span><span class="op">)</span>  </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped">
<thead><tr class="header">
<th style="text-align: right;">mean</th>
<th style="text-align: right;">median</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: right;">0.6356667</td>
<td style="text-align: right;">0.6666667</td>
</tr></tbody>
</table>
</div>
</div>
</div>
<p>Streuungsparameter: Wie unsicher sind wir in der Schätzung des Wasseranteils?</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">samples</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span></span>
<span>    p_sd   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">p_grid</span><span class="op">)</span>,</span>
<span>    p_iqr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/IQR.html">IQR</a></span><span class="op">(</span><span class="va">p_grid</span><span class="op">)</span>,</span>
<span>    p_mad <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/mad.html">mad</a></span><span class="op">(</span><span class="va">p_grid</span><span class="op">)</span><span class="op">)</span>  </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped">
<thead><tr class="header">
<th style="text-align: right;">p_sd</th>
<th style="text-align: right;">p_iqr</th>
<th style="text-align: right;">p_mad</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: right;">0.139705</td>
<td style="text-align: right;">0.2222222</td>
<td style="text-align: right;">0.1647333</td>
</tr></tbody>
</table>
</div>
</div>
</div>
<p>Anstelle der Streuungsparameter ist es aber üblicher, ein HDI oder PI anzugeben.</p>
<div class="callout-important callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Wichtig
</div>
</div>
<div class="callout-body-container callout-body">
<p>Alles Wasser oder was? Im Beispiel dieses Kapitels haben wir unser gefragt, was wohl der Wasseranteil auf dem Planeten Erde ist. Halten Sie sich klar vor Augen: Der Wasseranteil ist ein Beispiel für einen <em>Parameter</em>, einer unbekannten Größes eines Modells.</p>
</div>
</div>
</section></section><section id="aufgaben" class="level2" data-number="6.6"><h2 data-number="6.6" class="anchored" data-anchor-id="aufgaben">
<span class="header-section-number">6.6</span> Aufgaben</h2>
<ol type="1">
<li><a href="https://datenwerk.netlify.app/posts/iq01/iq01.html">iq01</a></li>
<li><a href="https://datenwerk.netlify.app/posts/iq02/iq02.html">iq02</a></li>
<li><a href="https://datenwerk.netlify.app/posts/iq03/iq03.html">iq03</a></li>
<li><a href="https://datenwerk.netlify.app/posts/iq04/iq04.html">iq04</a></li>
<li><a href="https://datenwerk.netlify.app/posts/iq05/iq05.html">iq05</a></li>
<li><a href="https://datenwerk.netlify.app/posts/iq06/iq06.html">iq06</a></li>
<li><a href="https://datenwerk.netlify.app/posts/iq07/iq07.html">iq07</a></li>
<li><a href="https://datenwerk.netlify.app/posts/iq08/iq08.html">iq08</a></li>
<li><a href="https://datenwerk.netlify.app/posts/iq10/iq10.html">iq10</a></li>
<li><a href="https://datenwerk.netlify.app/posts/fattails01/fattails01.html">fattails1</a></li>
<li><a href="https://datenwerk.netlify.app/posts/fattails02/fattails02.html">fattails2</a></li>
<li><a href="https://datenwerk.netlify.app/posts/rethink3e1-7/rethink3e1-7">ReThink3e1-7</a></li>
</ol></section><section id="section" class="level2" data-number="6.7"><h2 data-number="6.7" class="anchored" data-anchor-id="section">
<span class="header-section-number">6.7</span> —</h2>
<p><img src="img/outro-06.jpg" class="img-fluid" style="width:100.0%"></p>


<div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography" style="display: none">
<div id="ref-mcelreath_statistical_2020" class="csl-entry" role="doc-biblioentry">
McElreath, Richard. 2020. <em>Statistical rethinking: a Bayesian course with examples in R and Stan</em>. 2. Aufl. <span>CRC</span> texts in statistical science. Boca Raton: Taylor; Francis, <span>CRC</span> Press.
</div>
</div>
</section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><hr>
<ol>
<li id="fn1"><p>naja, nicht unbedingt formschön, aber mir fiel kein dritter Vorzug ein.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Modellparameter genannt<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>hier als Balkendiagramm, kommt fast aufs selbe raus, sieht aber etwas schöner aus in diesem Fall, da er nur wenige Balken sind<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>Tatsächlich gibt es eine Vielzahl an Begriffen, die in der Literatur nicht immer konsistent verwendet werden, etwa Kompatibilitätsintervall, Ungewissheitsintervall, Passungsbereich.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>Vielleicht damit es genug Berge zum Schifahren gibt.<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>1 Inch entspricht 2.54cm<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Kopiert");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Kopiert");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./Globusversuch.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Globusversuch</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./ppv.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Vorhersage-Verteilung</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>