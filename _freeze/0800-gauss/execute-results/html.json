{
  "hash": "d04032823282c0efa513ab5fecb2b4c1",
  "result": {
    "engine": "knitr",
    "markdown": "\n# Gauss-Modelle\n\n\n![Bayes:Start!](img/Golem_hex.png){width=10%}\n\n\n## Lernsteuerung\n\n\n### Position im Modulverlauf\n\n@fig-modulverlauf gibt einen √úberblick zum aktuellen Standort im Modulverlauf.\n\n\n\n### Lernziele\n\nNach Absolvieren des jeweiligen Kapitels sollen folgende Lernziele erreicht sein.\n\nSie k√∂nnen ‚Ä¶\n\n- ein Gau√ümodell spezifizieren und in R berechnen\n- an Beispielen verdeutlichen, wie sich eine vage bzw. eine informationsreiche Priori-Verteilung auf die Posteriori-Verteilung auswirkt\n\n\n\n### Begleitliteratur\n\nDer Stoff dieses Kapitels orientiert sich an @mcelreath2020, Kap. 4.1 bis 4.3. \n\n\n\n### Vorbereitung im Eigenstudium\n\n- [Statistik1, Kap. \"Modellg√ºte\"](https://statistik1.netlify.app/060-modellguete)\n- [Statistik1, Kap. \"Punktmodelle 2\"](https://statistik1.netlify.app/070-zusammenhaenge)\n- [Statistik1, Abschnitt \"Normalverteilung\"](https://statistik1.netlify.app/040-verbildlichen#normalverteilung)\n\n\n\n\n\n### Ben√∂tigte R-Pakete\n\n\n\n\n\n\nF√ºr `rstanarm` wird ggf. [weitere Software](https://github.com/stan-dev/rstan/wiki/RStan-Getting-Started) ben√∂tigt.\n\n:::callout-note\nSoftware, und das sind R-Pakete, m√ºssen Sie nur einmalig installieren. \nAber bei jedem\nStart von R bzw. RStudio m√ºssen Sie die (ben√∂tigten!) Pakete starten.\n:::\n\n\n\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(tidyverse)  # Datenjudo\nlibrary(rstanarm)  # Bayes-Modelle berechnen\nlibrary(easystats)  # Statistik-Komfort\nlibrary(DataExplorer)  # Daten verbildlichen\nlibrary(ggpubr)  # Daten verbildlichen\nlibrary(hexbin)  # stat_bin_hex ggplot2\n```\n:::\n\n\n\n\n\n\n::: callout-important\nAb diesem Kapitel ben√∂tigen Sie das R-Paket `rstanarm`. $\\square$\n:::\n\n\n### Ben√∂tigte Daten\n\n\n\nWir ben√∂tigen den Datensatz *!Kung*. \nQuelle der Daten ist @mcelreath2020 mit Bezug auf Howell.\n\n\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nKung_path <-  \n  \"https://raw.githubusercontent.com/sebastiansauer/Lehre/main/data/Howell1a.csv\"  \n\nd <- read.csv(Kung_path) \n\nhead(d)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"height\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"weight\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"age\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"male\"],\"name\":[4],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"151.765\",\"2\":\"47.82561\",\"3\":\"63\",\"4\":\"1\",\"_rn_\":\"1\"},{\"1\":\"139.700\",\"2\":\"36.48581\",\"3\":\"63\",\"4\":\"0\",\"_rn_\":\"2\"},{\"1\":\"136.525\",\"2\":\"31.86484\",\"3\":\"65\",\"4\":\"0\",\"_rn_\":\"3\"},{\"1\":\"156.845\",\"2\":\"53.04191\",\"3\":\"41\",\"4\":\"1\",\"_rn_\":\"4\"},{\"1\":\"145.415\",\"2\":\"41.27687\",\"3\":\"51\",\"4\":\"0\",\"_rn_\":\"5\"},{\"1\":\"163.830\",\"2\":\"62.99259\",\"3\":\"35\",\"4\":\"1\",\"_rn_\":\"6\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[5],\"max\":[5]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\n\n\n\n[Datenquelle](https://raw.githubusercontent.com/sebastiansauer/2021-wise/main/Data/Howell1a.csv)\n\n\n\n\n\n\n{{< downloadthis data/Howell1a.csv  dname=\"Howell1a\" >}}\n\n\n\n\n\n\n\n\n\n\n### Einstieg\n\n\n:::{#exm-gauss}\n### Was war noch mal eine Normalverteilung?\nIn diesem Kapitel ben√∂tigen Sie ein gutes Verst√§ndnis der Normalverteilung (die auch als Gauss-Verteilung bezeichnet wird). \nFassen Sie daher die wesentlichen Aspekte der Normalverteilung (soweit im Unterricht behandelt) zusammen! $\\square$\n:::\n\n:::{#exm-post-gauss}\n### Was war noch mal eine Posteriori-Verteilung?\nIn diesem Kapitel befragen wir die Post-Verteilung f√ºr ein normalverteilte Zufallsvariable, \nn√§mlich die K√∂rpergr√∂√üe der !Kung San. \nWas war noch mal eine Post-Verteilung und wozu ist sie gut? $\\square$\n:::\n\n\n\n## Wie gro√ü sind die !Kung San?\n\nDieser Abschnitt basiert slee auf @mcelreath2020, Kap. 4.3.\n\n### !Kung San \n\nIn diesem Abschnitt untersuchen wir eine Forschungsfrage \nin Zusammenhang mit dem Volk der !Kung, s. @fig-kungs.\n\n>   The «ÉKung are one of the San peoples who live mostly on the western edge of the Kalahari desert, Ovamboland (northern Namibia and southern Angola), and Botswana.The names «ÉKung («ÉXun) and Ju are variant words for 'people', preferred by different «ÉKung groups. This band level society used traditional methods of hunting and gathering for subsistence up until the 1970s. Today, the great majority of «ÉKung people live in the villages of Bantu pastoralists and European ranchers.\n\n[Quelle](https://en.wikipedia.org/wiki/%C7%83Kung_people)\n\n\n\n:::{#fig-kungs layout-ncol=2}\n\n![Kung People](img/kung.jpg){#fig-kung1}\n\n![Verbreitung der Kung-Sprachen](img/kung-lang.png){#fig-kung2}\n\nDie !Kung im s√ºdlichen Afrika\n:::\n\n\n\n[Quelle](https://upload.wikimedia.org/wikipedia/commons/b/b5/Wandering_hunters_%28Masarwa_bushmen%29%2C_North_Kalahari_Desert.jpg) \n\n\n [Quelle: By Andrewwik.0 - Own work, CC BY-SA 4.0,](https://commons.wikimedia.org/w/index.php?curid=79801340)\n\n\n\n\nWir interessieren uns f√ºr die Gr√∂√üe der erwachsenen !Kung,\nalso filtern wir die Daten entsprechend und speichern die neue Tabelle als `d2`.\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nd2 <- d %>% \n  filter(age >= 18)\n\nnrow(d2)\n## [1] 352\n```\n:::\n\n\n\n\n\n\n$N=352$.\n\nLassen wir uns einige typische deskriptive Statistiken zum Datensatz ausgeben.\n`{easystats`} macht das tats√§chlich recht easy, s. @tbl-kung.\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndescribe_distribution(d2)\n```\n:::\n\n::: {#tbl-kung .cell layout-align=\"center\" tbl-cap='Statistiken der metrischen Variablen im Kung-Datensatz'}\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"ktvuqqbixm\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#ktvuqqbixm table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#ktvuqqbixm thead, #ktvuqqbixm tbody, #ktvuqqbixm tfoot, #ktvuqqbixm tr, #ktvuqqbixm td, #ktvuqqbixm th {\n  border-style: none;\n}\n\n#ktvuqqbixm p {\n  margin: 0;\n  padding: 0;\n}\n\n#ktvuqqbixm .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#ktvuqqbixm .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#ktvuqqbixm .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#ktvuqqbixm .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#ktvuqqbixm .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ktvuqqbixm .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ktvuqqbixm .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ktvuqqbixm .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#ktvuqqbixm .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#ktvuqqbixm .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#ktvuqqbixm .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#ktvuqqbixm .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#ktvuqqbixm .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#ktvuqqbixm .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#ktvuqqbixm .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#ktvuqqbixm .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#ktvuqqbixm .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#ktvuqqbixm .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#ktvuqqbixm .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ktvuqqbixm .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#ktvuqqbixm .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#ktvuqqbixm .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#ktvuqqbixm .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ktvuqqbixm .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#ktvuqqbixm .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#ktvuqqbixm .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ktvuqqbixm .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ktvuqqbixm .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#ktvuqqbixm .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ktvuqqbixm .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#ktvuqqbixm .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ktvuqqbixm .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ktvuqqbixm .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ktvuqqbixm .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ktvuqqbixm .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ktvuqqbixm .gt_left {\n  text-align: left;\n}\n\n#ktvuqqbixm .gt_center {\n  text-align: center;\n}\n\n#ktvuqqbixm .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#ktvuqqbixm .gt_font_normal {\n  font-weight: normal;\n}\n\n#ktvuqqbixm .gt_font_bold {\n  font-weight: bold;\n}\n\n#ktvuqqbixm .gt_font_italic {\n  font-style: italic;\n}\n\n#ktvuqqbixm .gt_super {\n  font-size: 65%;\n}\n\n#ktvuqqbixm .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#ktvuqqbixm .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#ktvuqqbixm .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#ktvuqqbixm .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#ktvuqqbixm .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#ktvuqqbixm .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#ktvuqqbixm .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#ktvuqqbixm .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#ktvuqqbixm div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Variable\">Variable</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Mean\">Mean</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"SD\">SD</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"IQR\">IQR</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Min\">Min</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Max\">Max</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Skewness\">Skewness</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Kurtosis\">Kurtosis</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"n\">n</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"n_Missing\">n_Missing</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"Variable\" class=\"gt_row gt_left\">height</td>\n<td headers=\"Mean\" class=\"gt_row gt_right\">154.60</td>\n<td headers=\"SD\" class=\"gt_row gt_right\">7.74</td>\n<td headers=\"IQR\" class=\"gt_row gt_right\">12.06</td>\n<td headers=\"Min\" class=\"gt_row gt_right\">136.53</td>\n<td headers=\"Max\" class=\"gt_row gt_right\">179.07</td>\n<td headers=\"Skewness\" class=\"gt_row gt_right\">0.15</td>\n<td headers=\"Kurtosis\" class=\"gt_row gt_right\">‚àí0.48</td>\n<td headers=\"n\" class=\"gt_row gt_right\">352.00</td>\n<td headers=\"n_Missing\" class=\"gt_row gt_right\">0</td></tr>\n    <tr><td headers=\"Variable\" class=\"gt_row gt_left\">weight</td>\n<td headers=\"Mean\" class=\"gt_row gt_right\">44.99</td>\n<td headers=\"SD\" class=\"gt_row gt_right\">6.46</td>\n<td headers=\"IQR\" class=\"gt_row gt_right\">9.19</td>\n<td headers=\"Min\" class=\"gt_row gt_right\">31.07</td>\n<td headers=\"Max\" class=\"gt_row gt_right\">62.99</td>\n<td headers=\"Skewness\" class=\"gt_row gt_right\">0.13</td>\n<td headers=\"Kurtosis\" class=\"gt_row gt_right\">‚àí0.51</td>\n<td headers=\"n\" class=\"gt_row gt_right\">352.00</td>\n<td headers=\"n_Missing\" class=\"gt_row gt_right\">0</td></tr>\n    <tr><td headers=\"Variable\" class=\"gt_row gt_left\">age</td>\n<td headers=\"Mean\" class=\"gt_row gt_right\">41.14</td>\n<td headers=\"SD\" class=\"gt_row gt_right\">15.97</td>\n<td headers=\"IQR\" class=\"gt_row gt_right\">23.00</td>\n<td headers=\"Min\" class=\"gt_row gt_right\">18.00</td>\n<td headers=\"Max\" class=\"gt_row gt_right\">88.00</td>\n<td headers=\"Skewness\" class=\"gt_row gt_right\">0.67</td>\n<td headers=\"Kurtosis\" class=\"gt_row gt_right\">‚àí0.21</td>\n<td headers=\"n\" class=\"gt_row gt_right\">352.00</td>\n<td headers=\"n_Missing\" class=\"gt_row gt_right\">0</td></tr>\n    <tr><td headers=\"Variable\" class=\"gt_row gt_left\">male</td>\n<td headers=\"Mean\" class=\"gt_row gt_right\">0.47</td>\n<td headers=\"SD\" class=\"gt_row gt_right\">0.50</td>\n<td headers=\"IQR\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"Min\" class=\"gt_row gt_right\">0.00</td>\n<td headers=\"Max\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"Skewness\" class=\"gt_row gt_right\">0.13</td>\n<td headers=\"Kurtosis\" class=\"gt_row gt_right\">‚àí2.00</td>\n<td headers=\"n\" class=\"gt_row gt_right\">352.00</td>\n<td headers=\"n_Missing\" class=\"gt_row gt_right\">0</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n\n\n\nDie Verteilungen lassen sich mit `plot_density` (aus `{DataExplorer}`), s. @fig-kung-dens.\n\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nplot_density(d2)\n```\n\n::: {.cell-output-display}\n![Verteilungen der Variablen im Kung-Datensatz. Gr√∂√üe und Gewicht sind recht symmetrisch; Alter ist rechtsschief.](0800-gauss_files/figure-html/fig-kung-dens-1.png){#fig-kung-dens fig-align='center' width=75%}\n:::\n:::\n\n\n\n\n\n\n\n\n### Wir gehen apriori von normalverteilter Gr√∂√üe Der !Kung aus\n\n*Forschungsfrage:* Wie gro√ü sind die erwachsenen !Kung im *Durchschnitt*?\n\n\nWir interessieren uns also f√ºr den Mittelwert der K√∂rpergr√∂√üe (erwachsener Kung beider Geschlechter), $\\mu$.\n\n\n\n![Mensch, [Wikimedia Commons](https://creativecommons.org/licenses/by-sa/3.0)^[Bildquelle: Own alterations andFile:SVG_Human_With_All_Organs.svg by Madhero88, CC BY-SA, 3.0]](img/human.png){width=5%}\n\n\n\n\n\nWir sind uns √ºber diesen Mittelwert nicht sicher^[Darum machen wir hier ja die ganz Show!], \nund unsere Ungewissheit quantifizieren wir anhand einer Normalverteilung mit Mittelwert von 178 cm und Streuung von 20 cm:\n\n$$\\mu \\sim \\mathcal{N}(178, 20)$$ {#eq-kung}\n\n@eq-kung definiert ein Modell: Unsere Vorstellung der mittleren (\"typischen\") K√∂rpergr√∂√üe der erwachsenen !Kung.\n\nWarum 178 cm? Kein besonderer Grund. Hier wollen wir den Effekt verschiedener Priori-Werte untersuchen.^[Der Autor des zugrundeliegenden Fachbuchs, Richard McElreath gibt 178cm als seine K√∂rpergr√∂√üe an.]\nIn einer echten Untersuchung sollte man einen inhaltlichen Grund f√ºr einen Priori-Wert haben.\n*Oder* man w√§hlt \"schwach informative\" Prioris, wie das `{rstanarm}` tut:\nDamit l√§sst man kaum Vorab-Information in das Modell einflie√üen,\naber man verhindert extreme Prioris, \ndie meistens unsinnig sind (so wie eine SD von 100 Metern bei der K√∂rpergr√∂√üe).\n\n\n:::callout-note\nWir haben zwar vorab nicht viel Wissen, aber auch nicht gar keines: \nEine Gleichverteilung der K√∂rpergr√∂√üen kommt nicht in Frage und ein vages Wissen zum Mittelwert haben wir auch. \nDar√ºber hinaus ist eine Normalverteilung nicht unplausibel.\n:::\n\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n\n\n\n\n\n\n## Die Exponentialverteilung\n\n### Die Apfel-f√§llt-nicht-weit-vom-Stamm-Verteilung\n\nDarf ich vorstellen ...\n\n\nBevor wir unser Kung-Modell spezifizieren k√∂nnen,\nsollten wir noch √ºberlegen, welches Vorab-Wissen wir zur Streuung um den Mittelwert herum haben.\nDa wir uns nicht 100% sicher zur gesuchten Gr√∂√üe sind,\nm√ºssen wir angeben, wie gro√ü die Streuung um den Mittelwert sein soll.\nHier werden wir eingestehen, dass wir uns auch nicht 100% sicher sind,\nwie gro√ü die Streuung exakt ist.\nAlso geben wir eine Verteilung f√ºr die Streuung an.\n\nEtwas Wissen √ºber diese Verteilung haben wir:\n\n- Eine Streuung muss positiv sein (es gibt keine negative Streuung).\n- Eine Gleichverteilung der Streuung ist vielleicht m√∂glich, aber nicht sehr plausibel.\n- Wenn wir der Meinung sind, der Mittelwert betrage \"ungef√§hr 178 cm\", so halten wir  180 cm als K√∂rpergr√∂√üe einer erwachsenen Person f√ºr plausibel, aber 18000 cm f√ºr (praktisch) unm√∂glich und schon 200 cm f√ºr recht unplausibel. \nAlso: Je gr√∂√üer die die Abweichung vom Mittelwert, desto unplausibler der Wert der K√∂rpergr√∂√üe.\n\nDiese Anforderungen^[\"Desiderata\"] spiegeln sich in @fig-exp wider;\ndie eine  *Exponentialverteilung* zeigt (mit dem Parameter $\\lambda=1$),\nEine Exponentialverteilung erf√ºllt unsere W√ºnsche ziemlich gut.\nAu√üerdem zeigt die Abbildung verschiedene Quantile, wie das 95%-Quantil,\ndas bei 3 liegt;\n95% der Werte dieser Verteilung sind also nicht gr√∂√üer als 3.\n\n\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![Die Exponentialverteilung mit einigen ihrer Quantilen](0800-gauss_files/figure-html/fig-exp-1.png){#fig-exp fig-align='center' width=75%}\n:::\n:::\n\n\n\n\n\n\nF√ºr eine exponentialverteilte Variable $X$ schreibt man auch:\n\n\n$$X \\sim \\operatorname{Exp}(1)$$\n\n\nEine Verteilung dieser Form nennt man *Exponentialverteilung*.\n\n\n\n\n1. Eine *Exp*onentialverteilung ist nur f√ºr positive Werte, $x>0$, definiert.\n2. Steigt X um eine *Einheit*, so √§ndert sich Y um einen *konstanten Faktor*.\n3. Sie hat nur einen Parameter, genannt *Rate* oder $\\lambda$ (\"lambda\").\n4. $\\frac{1}{\\lambda}$  gibt gleichzeitig Mittelwert und Streuung (\"Gestrecktheit\") der Verteilung an.\n5. Je gr√∂√üer die Rate $\\lambda$, desto *kleiner* die Streuung und der Mittelwert der Verteilung (und umgekehrt: Je gr√∂√üer  $1/\\lambda$, desto *gr√∂√üer* die Streuung und der Mittelwert der Verteilung.)\n\n\n\nOhne auf die mathematischen Eigenschaften im Detail einzugehen,\nhalten wir fest, dass der Graph dieser Funktion gut zu unseren Pl√§nen passt.\n\n\n\n### Visualisierung verschiedener Exponentialverteilungen\n\nSchauen wir uns einige Beispiele von Exponentialverteilungen an.\nUnterschiede in Exponentialverteilungen sind rein auf Unterschiede in $\\lambda$ (lambda) zur√ºckzuf√ºhren, s. @fig-exps.\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n\n\n\n\n::::{#fig-exps}\n\n::: {.panel-tabset}\n\n\n\n### lambda = 2\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](0800-gauss_files/figure-html/unnamed-chunk-2-1.png){fig-align='center' width=75%}\n:::\n:::\n\n\n\n\n\n\n### lambda = 1\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](0800-gauss_files/figure-html/unnamed-chunk-3-1.png){fig-align='center' width=75%}\n:::\n:::\n\n\n\n\n\n### lambda = 1/2\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](0800-gauss_files/figure-html/unnamed-chunk-4-1.png){fig-align='center' width=75%}\n:::\n:::\n\n\n\n\n\n\n### lambda = 1/4\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](0800-gauss_files/figure-html/unnamed-chunk-5-1.png){fig-align='center' width=75%}\n:::\n:::\n\n\n\n\n\n\n\n### lambda = 1/8\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](0800-gauss_files/figure-html/unnamed-chunk-6-1.png){fig-align='center' width=75%}\n:::\n:::\n\n\n\n\n\n:::\n::::\n\n\n<!-- ```{r Kung-9-bis} -->\n<!-- #| echo: false -->\n<!-- #| fig-asp: 0.8 -->\n<!-- #| label: fig-exps -->\n<!-- #| fig-cap: Beispiele von Expnentialverteilungen mit unterschiedlichem lambda  -->\n<!-- #| fig-width: 9 -->\n\n<!-- p_r1 <- gg_exp(r = 1) + labs(subtitle = \"lambda = 1\") -->\n\n<!-- p_r2 <-  gg_exp(r = 1/2)  + labs(subtitle = \"lambda = 1/2\") -->\n\n<!-- p_r1_8 <- gg_exp(r = 1/4) + labs(subtitle = \"lambda = 1/4\") -->\n\n<!-- p_r1_25 <- gg_exp(r = 1/8) + labs(subtitle = \"lambda = 1/8\") -->\n\n\n<!-- plots(p_r1_25, p_r1_8, p_r2, p_r1) -->\n<!-- ``` -->\n\n\n\n\nWie wir in @fig-exps sehen, k√∂nnte eine Exponentialverteilung mit $\\lambda=1/8$ grob passen f√ºr unser !Kung-Beispiel:\nBei einer Exponentialverteilung mit Rate $\\lambda=1/8$ ist der Median bei ca. 5.5 cm, also einer Streuung  ($\\sigma$, typischen Abweichung vom Mittelwert) von 5.5 cm.\nDer Median ist der \"mittlere Wert\" der Verteilung, also der Wert, \nbei dem 50% der Werte kleiner und 50% der Werte gr√∂√üer sind.\nInsofern eignet sich der Median gut als Sch√§tzer f√ºr einen \"typischen\" Wert der Verteilung.\n\n\n\n:::callout-note\nDie \"richtigen\" Priori-Verteilung zu finden, bzw. die richtigen Parameter f√ºr die Priori-Verteilung zu w√§hlen, ist nicht m√∂glich, denn es gibt nicht *die* eine, richtige Priori-Verteilung.\nEine \"gut passende\" Verteilung zu finden, ist nicht immer einfach.\nGut beraten ist man mit der Regel, im Zweifel lieber eine liberale Verteilung zu w√§hlen,\ndie einen breiteren Raum an m√∂glichen Werten zul√§sst. \nAllerdings sollte man nicht das Baby mit dem Wasser auskippen und extreme Werte, wie mehrere Meter K√∂rpergr√∂√üe Streuung, erlauben.\n:::\n\nMan kann sich die Quantile der Exponentialverteilung mit `qexp()` ausgeben lassen,\nwobei mit man `p` den Wert der Verteilungsfunktion angibt,\nf√ºr den man das Quantil haben m√∂chte. (;it `pexp()` kann man sich analaog die die Verteilungsfunktion ausgeben lassen.) Mit `rate` wird $\\lambda$ (lambda) bezeichnet.^[Es gibt auch [Online-Apps, die diese Werte ausgeben](https://homepage.divms.uiowa.edu/~mbognar/applets/exp-like.html.]\n\nDieser Aufruf zum Beispiel, `qexp(p = .5, rate = 1/8)`,\ngibt uns das 50%-Quantil einer Exponentialverteilung mit Rate ($\\lambda$) 1/8 zur√ºck, ca. 5.5: \nMit einer Wahrscheinlichkeit von 50% wird ein Wert von 5.5 nicht √ºberschritten bei dieser Verteilung.\n\nDie Grenzen der inneren 95% dieser Verteilung kann man sich auch ausgeben.\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nqexp(p = c(0.025, .975), rate = 1/8)\n## [1]  0.2025425 29.5110356\n```\n:::\n\n\n\n\n\nDiese Grenzen scheinen hinreichend weit, das wir noch von den Daten √ºberrascht werden k√∂nnen, aber schmal genug, um unsinnige Werte auszuschlie√üen.\nEin guter Start! Weiter geht's!\n\n\n\n\n\n## Unser Gauss-Modell der !Kung\n\nüì∫ [Teil 1](https://youtu.be/cYHArln1DkM)\n\n\n### Modelldefinition\n\nWir nehmen an, dass $\\mu$ und $h_i$ normalverteilt sind und $\\sigma$ exponentialverteilt (da notwendig positiv) ist:\n\n\n\nLikelihood: $h_i \\sim \\mathcal{N}(\\mu, \\sigma)$\n\nPrior f√ºr den Parameter $\\mu$: $\\mu \\sim \\mathcal{N}(178, 20)$\n\nPrior f√ºr den Parameter $\\sigma$: $\\sigma \\sim \\mathcal{E}(0, 0.1)$\n\nDaher: $95\\%KI( \\mu): 178 \\pm 40$\n\n\nIn @fig-kung-model1 sind unsere Priori-Verteilungen visualisiert.\n\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![Unser (erstes) Kung-Modell (m41)](0800-gauss_files/figure-html/fig-kung-model1-1.png){#fig-kung-model1 fig-align='center' width=75%}\n:::\n:::\n\n\n\n\n\n\n:::callout-note\nDieses Modell hat zwei Parameter, $\\mu$ und $\\sigma$. $\\square$\n:::\n\n\n\n\n### Priori gewichtet mit Likelihood ergibt Posteriori\n\n\nZu Erinnerung: Die Posteriori-Wahrscheinlichkeit ist das Ergebnis von Priori-Wahrscheinlichkeit und Likelihood.\n\n\n\n\nDie *K√∂rpergr√∂√üen der einzelnen Personen* $h_i$ nehmen wir als normalverteilt an mit Mittelwert $\\mu$ und Streuung $\\sigma$:\n\n$$h_i \\sim \\mathcal{N}(\\color{blue}{\\mu},\\color{green}{\\sigma})   \\qquad{\\text{Likelihood}}$$\n\n\n### Prioris der Parameter\n\nDer Mittelwert der K√∂rpergr√∂√üe sei *normalverteilt* mit $\\mu=178$ und $\\sigma=20$:\n\n$$\\color{blue}{\\mu \\sim \\mathcal{N}(178, 20)} \\qquad{\\text{Prior}}$$\n\n\nDie Streuung $\\sigma$ der Gr√∂√üen sei *exponentialverteil* mit $\\lambda = 1/8$.\n\n$$\\color{green}{\\sigma \\sim \\mathcal{E}(1/8)} \\qquad{\\text{Prior}}$$\n\n### `m41`: fertig!\n\nJetzt haben wir unser Modell (`m41`) definiert!\n\n\nWeil es so sch√∂n ist, schreiben/zeichnen wir es hier noch einmal auf, @eq-mod-kung1, @fig-mod-kung1.\n\n\n:::: {.columns}\n\n::: {.column width=\"60%\"}\n\n\n$$\n\\begin{aligned}\nh_i &\\sim \\mathcal{N}(\\mu, \\sigma) & \\text{Likelihood}  \\\\\n\\mu &\\sim \\mathcal{N}(178, 20) & \\text{Prior} \\\\\n\\sigma &\\sim \\mathcal{E}(1/8) & \\text{Prior}\n\\end{aligned}\n$${#eq-mod-kung1}\n:::\n\n::: {.column width=\"40%\"}\n![Modellschema f√ºr das Modell `m41`](img/modell-kung1.png){#fig-mod-kung1}\n:::\n\n::::\n\n\n\n\n\n\n\nZur Berechnung von `m41` nutzen wir jetzt dieses Mal aber *nicht* die Gittermethode (Bayes-Box),\nsondern lassen R die Arbeit verrichten.\n\nDa gibt es einen neuen Golem, ziemlich kr√§ftig der Bursche,\nder soll die Arbeit f√ºr uns tun.\nDer Golem h√∂rt auf den Namen `rstanarm`^[Hey, *ich* habe ihn diesen Namen nicht gegeben.].\n\n\n\n\n::: {.content-visible when-format=\"html\"}\n\n## Zuf√§llige Motivationsabschnitt\n\n\n![Gut gemacht!](img/pretty_good.gif){width=50%}\n\n\n:::\n\n\n## Posteriori-Verteilung des Gr√∂√üen-Modells, `m41`\n\n\nOkay, Golem, an die Arbeit!\nBerechne uns das Kung-Modell!\nNennen wir das Modell `m41`^[*m* wie Modell und 4, weil das Modell in Kapitel 4 von @mcelreath2020 in √§hnlicher Form berichtet wird, und 1 weil es unsere erste Variante dieses Modells ist.].\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nm41 <- stan_glm(height ~ 1, data = d2, refresh = 0)  # <1>\nm41_post <- as_tibble(m41)    # <2>\nnames(m41_post) <- c(\"mu\", \"sigma\")  # <3>  \n```\n:::\n\n\n\n\n1. Bayes-Regressionsmodell berechnen\n2. Modellergebnis in Tabelle umwandeln\n3.  Sch√∂nere Namen f√ºr die Spalten geben\n\nDas Argument `refresh = 0` ist nur eine Nebensache, aber es ist praktisch, da es verhindert, dass die Details zum Ziehen der Stichproben am Bildschirm ausgegeben werden.\nIch finde diese Ausgabe meist nicht informativ,\nso dass ich sie lieber unterdr√ºcke.\n`stan_glm`^[aus dem R-Paket `rstanam`, das zuvor installiert und gestartet sein muss, bevor Sie den Befehl nutzen k√∂nnen] ist eine Funktion, mit der man Regressionsmodelle berechnen kann.\nNun haben wir in diesem Fall kein \"richtiges\" Regressionsmodell.\nMan k√∂nnte sagen, wir haben eine AV (K√∂rpergr√∂√üe), aber keine UV (keine Pr√§diktoren).\nGl√ºcklicherweise k√∂nnen wir auch solche \"armen\" Regressionsmodelle formulieren:\n`av ~ 1` bzw. in unserem Beispiel `height ~ 1` bedeutet,\ndass man nur die Verteilung der AV berechnen m√∂chte, \naber keine Pr√§diktoren hat (das soll die  `1` symbolisieren).\nF√ºr das Modell `m41` haben wir *keine* Prioris spezifiziert.\nWir greifen damit auf die *Voreinstellung* (defaults) der Prioris von `rstanarm` zur√ºck.\nDas ist ok, aber wenn Sie Vorab-Wissen haben,\nsollten Sie das an `rstanarm` weitergeben, weil es ja schade w√§re,\nwenn Sie Wissen haben, das von Ihrem Modell nicht genutzt wird.\n\nPlotten wir mal die gemeinsame Posteriori-Verteilung von `m41`, s. @fig-m42-post-joint\n\n::: {.panel-tabset}\n\n### Fliesendiagramm\n\nGemeinsame Post-Verteilung von Mittelwert und Streuung\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nm41_post %>% \n  ggplot() +\n  aes(x = mu, y = sigma) %>% \n  geom_hex() +\n  scale_fill_viridis_c() \n```\n\n::: {.cell-output-display}\n![Die gemeinsame Post-Verteilung von Mittelwert und Streuung von m42](0800-gauss_files/figure-html/fig-m42-post-joint-1.png){#fig-m42-post-joint fig-align='center' width=75%}\n:::\n:::\n\n\n\n\n\nDa das Modell *zwei* Parameter hat, k√∂nnen wir auch beide gleichzeitig plotten.\nWie man sieht, sind die beiden Parameter unkorreliert.\nIn anderen Modellen k√∂nnen die Parameter korreliert sein.\n\n@fig-m42-post-joint erlaubt uns, f√ºr *jede Kombination von Mittelwert und Streuung* zu fragen,\nwie wahrscheinlich diese bestimmte Kombination ist.\n\n\n\n\n\n### Streudiagramm\n\nHier sind noch zwei andere Visualisierungen der Post-Verteilung von `m42`, s. @fig-m42-post-anders1.\n\n\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![Die Postverteilung in unterschiedlicher Darstellung](0800-gauss_files/figure-html/fig-m42-post-anders1-1.png){#fig-m42-post-anders1 fig-align='center' width=75%}\n:::\n:::\n\n\n\n\n\n\n### Histogramm\n\nUnd hier kommt die Post-Verteilung nur des Mittelwerts.\n\nNat√ºrlich k√∂nnen wir auch nur von einem einzelnen Parameter (z.B.  Mittelwert) die Verteilung untersuchen, s. @fig-m42-post-anders2.\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![Die Post-Verteilung von mu in m42; ein Balkendiagramm bietet sich an.](0800-gauss_files/figure-html/fig-m42-post-anders2-1.png){#fig-m42-post-anders2 fig-align='center' width=75%}\n:::\n:::\n\n\n\n\n\n\n:::\n\n\n\nFassen wir die Ergebnisse dieses Modells zusammen:\n\n\n- Wir bekommen eine Wahrscheinlichkeitsverteilung f√ºr $\\mu$ und eine f√ºr $\\sigma$ (bzw. eine zweidimensionale Verteilung, f√ºr die $\\mu,\\sigma$-Paare).\n\n- Trotz des eher vagen Priors ist die Streuung Posteriori-Werte f√ºr $\\mu$ und $\\sigma$ klein: Die gro√üe Stichprobe hat die Priori-Werte √ºberstimmt.\n\n- Ziehen wir Stichproben aus der Posteriori-Verteilung, so k√∂nnen wir interessante Fragen stellen. \n\n\n\n\n### Hallo, Posteriori-Verteilung\n\n... wir h√§tten da mal ein paar Fragen an Sie. üïµ\n\n\n1. Mit welcher Wahrscheinlichkeit ist die *mittlere* !Kung-Person gr√∂√üer als 1,55m?\n2. Welche mittlere K√∂rpergr√∂√üe wird mit 95% Wahrscheinlichkeit nicht √ºberschritten, laut dem Modell?\n3. In welchem 90%-PI liegt $\\mu$ vermutlich?\n4. Mit welcher Unsicherheit ist die Sch√§tzung der mittleren K√∂rpergr√∂√üe behaftet?\n5. Was ist der mediane Sch√§tzwert der mittleren K√∂rpergr√∂√üe, sozusagen der \"Best Guess\"?\n\n\nAntworten folgen etwas weiter unten.\n\n\n\n\n\nAbschlie√üend, eigentlich nur Spielerei, noch eine andere Visualisierung der Post-Verteilung von $\\mu$ und von $\\sigma$, @fig-kung3.\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![Die beiden Randverteilungen der Post-Verteilungen, d.h. die Verteilungen f√ºr mu und f√ºr sigma](0800-gauss_files/figure-html/fig-kung3-1.png){#fig-kung3 fig-align='center' width=75%}\n:::\n:::\n\n\n\n\n\n\n\n\n### Posteriori-Stichproben mit `stan_glm()` berechnen \n\nMit `stan_glm()` k√∂nnen wir komfortabel die Posteriori-Verteilung berechnen. \nDie Gittermethode wird nicht verwendet, aber die Ergebnisse sind - in bestimmten Situationen - √§hnlich.\nEs werden aber auch viele Stichproben simuliert (sog. MCMC-Methode).\nGibt man keine Priori-Werte an, so greift die Funktion auf Standardwerte zur√ºck.\n\n\nGrob gesagt berechnen wir die Post-Verteilung mit `stan_glm` so: `stan_glm(AV ~ UV, data = meine_daten)`.\n\n\n\n\nModelldefinition:\n\n$h_i \\sim \\mathcal{N}(\\mu, \\sigma)$, Likelihood\n\n$\\mu \\sim \\mathcal{N}(155, 19)$, Prior zum Gr√∂√üenmittelwert (von Stan √ºbernommen)\n\n$\\sigma \\sim \\mathcal{E}(0.125)$, Prior zur Streuung der Gr√∂√üen  (von Stan √ºbernommen)\n\n\n\n\n\n### Ausgabe von `stan_glm()`\n\nWir k√∂nnen, wie wir es oben getan haben, uns die Stichproben der Post-Verteilung ausgeben lassen, und diese z.B. plotten.\n\nWir k√∂nnen es aber auch komfortabler haben ... \nMit dem Befehl `parameters` kann man sich die gesch√§tzten Parameterwerte einfach ausgeben lassen (s. @fig-m42-post-joint).\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nm41 <- stan_glm(height ~ 1, data = d2, refresh = 0)  # aus Paket rstanarm\n\nparameters(m41)  # aus Paket `easystats`\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n\n\n|Parameter   | Median |           95% CI |   pd |  Rhat |     ESS |                    Prior |\n|:-----------|:------:|:----------------:|:----:|:-----:|:-------:|:------------------------:|\n|(Intercept) | 154.60 | (153.77, 155.40) | 100% | 1.000 | 2856.00 | Normal (154.60 +- 19.36) |\n\n\n:::\n:::\n\n\n\n\n\n\nDas Wesentliche: Unser Golem sch√§tzt den Gr√∂√üenmittelwert der Kung auf ca. 155cm bzw. auf einen Bereich von etwa 153.77 bis 155.4 sch√§tzt.\nInformativ ist vielleicht noch, dass wir den `Prior` erfahren, der im Modell verwendet wurde. \nDazu sp√§ter mehr.\n\n:::callout-note\nIn dieser Ausgabe sind ein paar Angaben, die wir nicht verstehen, wie `pd`, `Rhat` und `ESS`. Kein Problem: Einfach ignorieren ü§ì \nWer N√§heres wissen will, findet [hier](https://easystats.github.io/easystats/) einen Anfang. Au√üerdem sei an @mcelreath2020 und @gelman2021 verwiesen. $\\square$\n:::\n\n## Wie tickt `stan_glm()`?\n\n<!-- <hr> -->\n\n<!-- <div style = \"float:right; width:25%;\"> -->\n<!-- <img src=\"img/stanlogo.png\" alt=\"HERE\">   -->\n<!-- </div>   -->\n\n\n:::: {.columns}\n\n::: {.column width=\"20%\"}\n![](img/stanlogo.png){width=50%}\n[Quelle](https://mc-stan.org/)\n:::\n\n::: {.column width=\"80%\"}\n\n\nHier ein paar Kerninfos zu `stan_glm`: \n\n- *Stan* ist eine Software zur Berechnung von Bayesmodellen; das Paket `rstanarm` stellt Stan f√ºr uns bereit.\n- `stan_glm()` ist f√ºr die Berechnung von Regressionsmodellen ausgelegt.\n- Will man nur die Verteilung einer Variablen (wie `heights`) sch√§tzen, so hat man man ... eine Regression ohne Pr√§diktor.\n- Eine Regression ohne Pr√§diktor schreibt man auf Errisch so: `y ~ 1`. Die `1` steht also f√ºr die nicht vorhandene UV; `y` meint die AV (`height`).\n- `(Intercept)` (Achsenabschnitt) gibt den Mittelwert an.\n\n:::\n\n::::\n\n\n\n\n\nMehr findet sich in der [Dokumentation von RstanArm](https://mc-stan.org/rstanarm/).\n\n\n### Sch√§tzwerte zu den Modellparameter\n\nDie Parameter eines Modells sind die Gr√∂√üen, f√ºr die wir eine Priori-Verteilung annehmen.\nAu√üerdem w√§hlen wir einen einen Likelihood-Funktion, so dass wir die Likelihood berechnen k√∂nnen.\nAuf dieser Basis sch√§tzen wir dann die Post-Verteilung.\nIch sage *sch√§tzen*, um hervorzuheben, dass wir die wahren Werte nicht kennen,\nsondern nur eine Vermutung haben, \nunsere Ungewissheit vorab also (wie immer) in der Priori-Verteilung festnageln\nund unsere Ungewissheit nach Kenntnis der Daten in der Posteriori-Verteilung quantifizieren.\nWie gerade gesehen,\nlassen sich die Modellparameter (bzw. genauer gesagt deren Sch√§tzungen) einfach mit `parameters(modellname)` auslesen.\n\n\n\n\n### Stichproben aus der Posteriori-Verteilung ziehen\n\nWie wir es vom Globusversuch gewohnt sind,\nk√∂nnen wir aber auch Stichproben aus der Post-Verteilung ziehen.\n\nHier die ersten paar Zeilen von `post_m41`:\n\n\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\npost_m41 <- as_tibble(m41)\nhead(post_m41)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"(Intercept)\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"sigma\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"154.3767\",\"2\":\"7.704989\"},{\"1\":\"154.3562\",\"2\":\"7.427082\"},{\"1\":\"154.6512\",\"2\":\"7.961065\"},{\"1\":\"154.3064\",\"2\":\"7.745723\"},{\"1\":\"154.7918\",\"2\":\"7.561019\"},{\"1\":\"154.7372\",\"2\":\"7.568778\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[5],\"max\":[5]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\n\n\nIn einer Regression ohne Pr√§diktoren entspricht der Achsenabschnitt dem Mittelwert der AV,\ndaher gibt uns die Spalte `(Intercept)` Aufschluss √ºber unsere Sch√§tzwerte zu $\\mu$ (der K√∂rpergr√∂√üe).\n\n\n:::{#exr-kung1}\n\n## Mit welcher Wahrscheinlichkeit ist $\\mu>155$? \n\n\n::: {.callout-tip appearance=\"minimal\" collapse=\"true\"}\n\n### L√∂sung\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n\nnames(post_m41) <- \n  c(\"mu\", \"sigma\")  # den Namen \"(Intercept)\" durch \"mu\" ersetzen, ist pr√§gnanter\n\npost_m41 %>% \n  count(mu > 155) %>% \n  mutate(prop = n/sum(n))\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"mu > 155\"],\"name\":[1],\"type\":[\"lgl\"],\"align\":[\"right\"]},{\"label\":[\"n\"],\"name\":[2],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"prop\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"FALSE\",\"2\":\"3333\",\"3\":\"0.83325\"},{\"1\":\"TRUE\",\"2\":\"667\",\"3\":\"0.16675\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[5],\"max\":[5]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\n\n\nDie Wahrscheinlichkeit ist nicht hoch, aber nicht auszuschlie√üen,\ndass die Kung im Schnitt gr√∂√üer als 155 cm sind.\nWahrscheinlicher ist jedoch, dass sie kleiner als 155 cm sind. $\\square$\n:::\n\n:::\n\n:::{#exr-kung2}\n\n## Mit welcher Wahrscheinlichkeit ist $\\mu>165$? \n\n::: {.callout-tip appearance=\"minimal\" collapse=\"true\"}\n\n### L√∂sung\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nnames(post_m41) <- \n  c(\"mu\", \"sigma\")  # den Namen \"(Intercept)\" durch \"mu\" ersetzen, ist pr√§gnanter\n\npost_m41 %>% \n  count(mu > 165) %>% \n  mutate(prop = n/sum(n))\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"mu > 165\"],\"name\":[1],\"type\":[\"lgl\"],\"align\":[\"right\"]},{\"label\":[\"n\"],\"name\":[2],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"prop\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"FALSE\",\"2\":\"4000\",\"3\":\"1\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[5],\"max\":[5]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\n\n\nOh, diese Hypothese k√∂nnen wir mit an Sicherheit grenzender Wahrscheinlichkeit ausschlie√üen.\nAber Achtung: Das war eine Kleine-Welt-Aussage! \nDie Wahrscheinlichkeit, die Hypothese $\\mu > 165$ auszuschlie√üen ist *nur* dann hoch,\nwenn das Modell gilt!\nWenn also der Golem keinen Mist gebaut hat. \nUnd sind wir mal ehrlich, der Golem tut, was sein:e Herr:in und Meister:in ihm befiehlt.\nLetztlich liegt es an uns, den Golem auf Spur zu kriegen.\n\n:::\n:::\n\n\n:::{#exm-kung3}\n\n## Welche mittlere K√∂rpergr√∂√üe wird mit 95% Wahrscheinlichkeit nicht √ºberschritten, laut dem Modell `m41`?\n\n::: {.callout-tip appearance=\"minimal\" collapse=\"true\"}\n### L√∂sung\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\npost_m41 %>% \n  summarise(q95 = quantile(mu, .95))\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"q95\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"155.2755\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[5],\"max\":[5]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\n\n\n:::\n:::\n\n\n:::{#exr-kung4}\n\n## In welchem 90%-PI liegt $\\mu$ vermutlich?\n\n::: {.callout-tip appearance=\"minimal\" collapse=\"true\"}\n### L√∂sung\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\npost_m41 %>% \n  eti()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"Parameter\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"CI\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"CI_low\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"CI_high\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"mu\",\"2\":\"0.95\",\"3\":\"153.770498\",\"4\":\"155.403232\"},{\"1\":\"sigma\",\"2\":\"0.95\",\"3\":\"7.215348\",\"4\":\"8.367543\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[5],\"max\":[5]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\n\n\n\nEin ETI ist synonym zu PI.\n\n:::\n:::\n\n\n\n:::{#exr-kung5}\n\n## Mit welcher Unsicherheit ist die Sch√§tzung der mittleren K√∂rpergr√∂√üe behaftet?\n\n\n\n::: {.callout-tip appearance=\"minimal\" collapse=\"true\"}\n### L√∂sung\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nm41 %>% \n  parameters()\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n\n\n|Parameter   | Median |           95% CI |   pd |  Rhat |     ESS |                    Prior |\n|:-----------|:------:|:----------------:|:----:|:-----:|:-------:|:------------------------:|\n|(Intercept) | 154.60 | (153.77, 155.40) | 100% | 1.000 | 2856.00 | Normal (154.60 +- 19.36) |\n\n\n:::\n:::\n\n\n\n\n\n\n\nSeeing is believing, s. @fig-m41-params-intercept.\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nm41 %>% \n  parameters() %>% \n  plot(show_intercept = TRUE)\n```\n\n::: {.cell-output-display}\n![Parameter von m41, nur einer: der Intercept](0800-gauss_files/figure-html/fig-m41-params-intercept-1.png){#fig-m41-params-intercept fig-align='center' width=75%}\n:::\n:::\n\n\n\n\n\n\nDas Modell ist sich recht sicher: die Ungewissheit der mittleren K√∂rpergr√∂√üe liegt bei nicht viel mehr als einem Zentimeter (95%-CI).\n\n:::\n:::\n\n\n:::{#exr-kung6}\n\n\n## Was ist der mediane Sch√§tzwert der mittleren K√∂rpergr√∂√üe, sozusagen der \"Best Guess\"?\n\n::: {.callout-tip appearance=\"minimal\" collapse=\"true\"}\n### L√∂sung\n\n`parameters(m41)` hat uns die Antwort schon gegeben: Ca. 155 cm.\n\n:::\n:::\n\n\n\nüèãÔ∏è √Ñhnliche Fragen bleiben als √úbung f√ºr die Lesis. ü§ì\n\n\n\n### Standard-Prioriwerte bei `stan_glm()`\n\n`stan_glm()` nimmt f√ºr uns Priori-Wert an.\nWelche das sind, kann man sich so anzeigen lassen:\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nprior_summary(m41)\n## Priors for model 'm41' \n## ------\n## Intercept (after predictors centered)\n##   Specified prior:\n##     ~ normal(location = 155, scale = 2.5)\n##   Adjusted prior:\n##     ~ normal(location = 155, scale = 19)\n## \n## Auxiliary (sigma)\n##   Specified prior:\n##     ~ exponential(rate = 1)\n##   Adjusted prior:\n##     ~ exponential(rate = 0.13)\n## ------\n## See help('prior_summary.stanreg') for more details\n```\n:::\n\n\n\n\n\n\n\n\n\n`stan_glm()` verwendet (in der Voreinstellung) *schwach informative* Priori-Werte, die nur wenig Vorabwissen in das Modell geben.\nEs werden daf√ºr die Stichproben-Daten als Priori-Daten verwendet: \nMittelwerte und Streuungen der AV werden als Grundlage f√ºr die Priori-Verteilungen herangezogen.\nStrenggenommen ist das nicht \"pures Bayes\",\nweil die Priori-Werte ja *vorab*, \nalso vor Kenntnis der Daten bestimmt werden sollen.\nBitte reichen Sie Ihre Beschwerden bei Andrew Gelman ein.\n\nMan sollte diese Standardwerte als Minimalvorschlag sehen. \nKennt man sich im Sachgebiet aus, kann man meist bessere Prioris finden.\nDie Voreinstellung ist nicht zwingend; andere Werte w√§ren auch denkbar.\n\n\n::: callout-note\n\n### Standardwerte von `stan_glm`\n\n- `Intercept`: $\\mu$, der Mittelwert der Verteilung $Y$\n    - $\\mu \\sim \\mathcal{N}(\\bar{Y}, sd(Y)\\cdot 2.5)$\n    - als Streuung von $\\mu$ wird die 2.5-fache Streuung der Stichprobe (f√ºr $Y$) angenommen.\n\n- `Auxiliary (sigma)`: $\\sigma$, die Streuung der Verteilung $Y$\n    - $\\sigma \\sim \\mathcal{E}(\\lambda=1/sd(Y))$\n    - als \"Streuung\", d.h. $\\lambda$ von $h_i$ wird $\\frac{1}{sd(Y)}$ angenommen. $\\square$\n\n:::\n    \n    \n\n\n\nEine sinnvolle Strategie ist, einen Prior so zu w√§hlen, dass man nicht √ºbergewiss ist,\nalso nicht zu sicher Dinge behauptet, \ndie dann vielleicht doch passieren (also die Ungewissheit zu gering spezifiziert),\nandererseits sollte man extreme, unplausible Werte ausschlie√üen.\n\n\n\n\n:::callout-important\nBei der Wahl der Prioris gibt es nicht die eine, richtige Wahl.\nDie beste Entscheidung ist auf transparente Art den Stand der Forschung einflie√üen zu lassen und eigene Entscheidungen zu begr√ºnden. \nH√§ufig sind mehrere Entscheidungen m√∂glich.\nM√∂chte man lieber vorsichtig sein, weil man wenig √ºber den Gegenstand wei√ü,\ndann k√∂nnte man z.B. auf die Voreinstellung von `rstanarm` vertrauen,\ndie \"schwachinformativ\" ist, \nalso nur wenig Priori-Information  in das Modell einflie√üen l√§sst.\n:::\n\n\n\n### Wenn es schnell gehen muss\n\n\n`stan_glm()` ist deutlich langsamer als z.B. der befreundete Golem `lm()`.\nDer Grund f√ºr Stans Langsamkeit ist, dass er viele Stichproben zieht,\nalso viel zu z√§hlen hat.\nAu√üerdem wiederholt er das Stichprobenziehen (im Standard) 4 Mal,\ndamit sein Meister pr√ºfen kann, ob er (Stan) die Arbeit auch immer richtig gemacht hat.\nDie Idee dabei ist, wenn alle vier Durchf√ºhrungen (auch \"Ketten\" engl., chains) genannt,\nzum etwa gleichen Ergebnis kommen, dann wird schon alles mit rechten Dingen\nzugegangen sein. Weichen die Ergebnisse der 4 Ketten voneinander ab,\nso ist Stan ein Fehler unterlaufen, oder, irgendetwas ist \"dumm gelaufen\".\nAn dieser Stelle schauen wir uns die Ketten nicht n√§her an,\naber es sei notiert, dass man die Anzahl der Ketten mit dem Argument `chains` steuern kann.\nM√∂chte man, dass Stan sich beeilt, so kann man `chains = 1` setzen,\ndas spart Zeit.\n\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nm41a <- stan_glm(height ~ 1, \n                 data = d2, \n                 chains = 1,  # nur 1 Kette, anstelle von 4 im Default, spart Zeit\n                 refresh = 0) \n\nparameters(m41a)  \n```\n:::\n\n\n\n\n\n\n\n## Modell `m42`: unsere Priori-Werte \n\n\n\nüì∫ [Teil 2](https://youtu.be/qIuu-4qRT_0)\n\n\nIm Modell `m41` haben wir auf die Priori-Werte der Voreinstellung von `rstanarm` vertraut.\nJetzt lassen wir mal unsere eigenen Priori-Werte einflie√üen, in unserem zweiten Kung-Modell, `m42`.\n\n\n\n\n\n### m42\n\nDann lassen wir `stan_glm()` (Stan) unser zweites Modell berechnen.^[Hey Stan, los, an die Arbeit!]\nDieses Mal geben wir die Priori-Werte explizit an, @tbl-m42-params.\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nm42 <- \n  stan_glm(height ~ 1, \n           prior_intercept = normal(178, 20),  # mu\n           prior_aux = exponential(0.125),  # sigma\n           refresh = FALSE,  # bitte nicht so viel Ausgabe drucken\n           data = d2)\nparameters(m42)\n```\n:::\n\n::: {#tbl-m42-params .cell layout-align=\"center\" tbl-cap='Parameter von m42 mit eigenen Prioriwerten'}\n::: {.cell-output-display}\n\n\n|Parameter   | Median |           95% CI |   pd |  Rhat |     ESS |              Prior |\n|:-----------|:------:|:----------------:|:----:|:-----:|:-------:|:------------------:|\n|(Intercept) | 154.62 | (153.83, 155.42) | 100% | 1.000 | 2482.00 | Normal (178 +- 20) |\n\n\n:::\n:::\n\n\n\n\n\n\n\n\nWir haben noch nicht alle Informationen kennengelernt, die in @tbl-m42-params ausgegeben werden.\nIm Zweifel: Einfach ignorieren. Wichtige F√§higkeit im Studium. ü§ì\n\n\n:::callout-important\nVergleichen Sie die Parameterwerte von `m41` und `m42`! Was f√§llt Ihnen auf? Nichts?\nGut! Tats√§chlich liefern beide Modelle sehr √§hnliche Parameterwerte.\nDie Prioriwerte waren nicht so wichtig, weil wir genug Daten haben.\nHat man einigerma√üen viele Daten, so fallen Prioriwerte nicht mehr ins Gewicht,\nzumindest wenn sie moderat gew√§hlt waren.\n:::\n\n\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n\n\n\n\n\n\n### Posteriori-Verteilung und Parameter plotten\n\nLeider liefert der Stan-Golem leider keinen braven Tibble (Tabelle) zur√ºck.\n\n>    üë®‚Äçüè´ B√∂ser Golem!\n\n>    ü§ñ Beim n√§chsten Mal strenge ich mich mehr an!\n\nDaher m√ºssen wir die Ausgabe des Stan-Golemns erst in eine sch√∂ne Tabelle umwandeln:\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nm42_tibble <-\n  as_tibble(m42)\n\nhead(m42_tibble)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"(Intercept)\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"sigma\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"154.7817\",\"2\":\"7.421249\"},{\"1\":\"154.8657\",\"2\":\"7.463295\"},{\"1\":\"154.7635\",\"2\":\"7.708576\"},{\"1\":\"154.6183\",\"2\":\"7.666550\"},{\"1\":\"154.4833\",\"2\":\"7.463518\"},{\"1\":\"154.8365\",\"2\":\"7.800804\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[5],\"max\":[5]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\n\n\n\nAu√üerdem ist der Name der ersten Spalte eigentlich unzul√§ssig, da Spaltennamen in R nicht mit Sonderzeichen anfangen d√ºrfen (sondern mit Buchstaben). Daher m√ºssen wir den Namen mit \"Samthandschuhen\" anpacken.\nAuf Errisch sind das die Backticks, die wir um den Namen rumwickeln m√ºssen, s. die folgende Syntax.\n\n::: {.panel-tabset}\n\n### Mit `{ggpubr}`\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nm42_tibble |> \n  gghistogram(x = \"`(Intercept)`\")  # Aus dem Paket \"ggpubr\"\n```\n\n::: {.cell-output-display}\n![](0800-gauss_files/figure-html/unnamed-chunk-13-1.png){fig-align='center' width=75%}\n:::\n:::\n\n\n\n\n\n### Mit `{ggplot}`\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nm42_tibble |> \n  ggplot(aes(x = `(Intercept)`)) +  # Aus dem Paket `ggplot2`\n  geom_histogram()\n```\n\n::: {.cell-output-display}\n![](0800-gauss_files/figure-html/unnamed-chunk-14-1.png){fig-align='center' width=75%}\n:::\n:::\n\n\n\n\n\n:::\n\nAls Ausblick: Ein Vergleich mehrerer Priori-Werte w√§re auch n√ºtzlich, um ein skeptisches Publikum von der Wahl (bzw. der Indifferenz) der gew√§hlten Priori-Werte zu √ºberzeugen.\n\n\n\n## Fazit\n\n### Zusammenfassung\n\nWir haben die Posteriori-Verteilung f√ºr ein Gauss-Modell  berechnet.\nDabei hatten wir ein einfaches Modell mit metrischer Zielvariablen, ohne Pr√§diktoren, betrachtet.\nDie Zielvariable, K√∂rpergr√∂√üe (`height`), haben wir als normalverteilt mit den Parametern $\\mu$ und $\\sigma$ angenommen.\nF√ºr $\\mu$ und $\\sigma$ haben wir jeweils keinen einzelnen (fixen) Wert angenommen, sondern eine Wahrscheinlichkeitsverteilung, der mit der Priori-Verteilung f√ºr $\\mu$ bzw. $\\sigma$ festgelegt ist.\n\n\n\n### Botschaft von einem Statistiker\n\n\n\n![üß° Bleiben Sie dran!](img/chicken_standard_deviation.jpg)\n\n\n\n\n\n:::callout-important\nKontinuierliches Lernen ist der Schl√ºssel zum Erfolg.\n:::\n\n\n\n\n\n## Vertiefung: Wahl der Priori-Werte\n\n\nüèéÔ∏è Dieser Abschnitt ist eine VERTIEFUNG und nicht pr√ºfungsrelevant. üèé\n\n\n\n\n### Welche Beobachtungen sind auf Basis unseres Modells zu erwarten?\n\n\n\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nn <- 1e4\n\nsim <- tibble(sample_mu  = \n      rnorm(n, \n            mean = 178, \n            sd   = 20),\n    sample_sigma = \n      rexp(n, \n            rate = 0.1)) %>% \n  mutate(height  = \n      rnorm(n, \n            mean = sample_mu, \n            sd   = sample_sigma))\n\nheight_sim_sd <- \n  sd(sim$height) %>% round()\nheight_sim_mean <- \n  mean(sim$height) %>% round()\n```\n:::\n\n\n\n\n\n\nüí≠ Was denkt der Golem (`m41`) *apriori* von der Gr√∂√üe der !Kung?\n\nü¶æ Ziehen wir mal ein paar Stichproben auf Basis des Modells. Voil√†:\n\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\np3 <- \n  sim %>% \n  ggplot(aes(x = height)) +\n  geom_density(fill = \"grey33\") +\n  scale_x_continuous(breaks = c(0, 178-3*height_sim_sd, 178, 178+3*height_sim_sd)) +\n  scale_y_continuous(NULL, breaks = NULL) +\n  labs(title = \"height ~ dnorm(mu, sigma)\",\n       caption = \"X-Achse zeigt MW¬±3SD\",\n       x = \"Gr√∂√üe\") +\n  theme(panel.grid = element_blank()) \n\np3\n```\n\n::: {.cell-output-display}\n![](0800-gauss_files/figure-html/Kung-12-1.png){fig-align='center' width=75%}\n:::\n:::\n\n\n\n\n\n\n\n\n\n[Quellcode](https://bookdown.org/content/4857/geocentric-models.html#a-gaussian-model-of-height)\n\n\n### Priori-Werte pr√ºfen mit der Priori-Pr√§diktiv-Verteilung\n\n- Die Priori-Pr√§diktiv-Verteilung (`sim`) simuliert Beobachtungen (nur) auf Basis der Priori-Annahmen: \n$h_i \\sim \\mathcal{N}(\\mu, \\sigma),$\n$\\mu \\sim \\mathcal{N}(178, 20),$\n$\\sigma \\sim \\mathcal{E}(0.1)$\n- So k√∂nnen wir pr√ºfen, ob die Priori-Werte vern√ºnftig sind.\n\n\nDie Priori-Pr√§diktiv-Verteilung zeigt, dass unsere Priori-Werte ziemlich vage sind, also einen zu breiten Bereich an Gr√∂√üenwerten zulassen:\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\np3\n```\n\n::: {.cell-output-display}\n![](0800-gauss_files/figure-html/Kung-13-1.png){fig-align='center' width=75%}\n:::\n:::\n\n\n\n\n\n\n\nAnteil $h_i > 200$:\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nanteil_gro√üer_kung <- \nsim %>% \n  count( height > 200) %>% \n  mutate(prop = n/sum(n))\nanteil_gro√üer_kung\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"height > 200\"],\"name\":[1],\"type\":[\"lgl\"],\"align\":[\"right\"]},{\"label\":[\"n\"],\"name\":[2],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"prop\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"FALSE\",\"2\":\"8336\",\"3\":\"0.8336\"},{\"1\":\"TRUE\",\"2\":\"1664\",\"3\":\"0.1664\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[5],\"max\":[5]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\n\n\n\nü§î Sehr gro√üe Buschleute? 17 Prozent sind gr√∂√üer als 2 Meter. Das ist diskutabel, muss aber nicht zwangsl√§ufig ein schlechter Prior sein.\n\n\n\n\n\n\n###  Vorhersagen der Priori-Werte\n\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](0800-gauss_files/figure-html/Kung-15-1.png){fig-align='center' width=75%}\n:::\n:::\n\n\n\n\n\n\n\n\n### Extrem vage Priori-Verteilung f√ºr die Streuung?\n\n\n$$\\sigma \\sim \\mathcal{E}(\\lambda=0.01)$$\n\n\n\n\n\n\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](0800-gauss_files/figure-html/Kung-16-1.png){fig-align='center' width=75%}\n:::\n:::\n\n\n\n\n\n\n\n\n\nDie Streuung der Gr√∂√üen ist weit:\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nd <- \n  tibble(x = seq(0,75, by =.01),\n         y = dexp(x, rate = .01))\n\nd %>% \n  ggplot(aes(x,y)) +\n  geom_line()\n```\n\n::: {.cell-output-display}\n![](0800-gauss_files/figure-html/Kung-3-1.png){fig-align='center' width=75%}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n\n\n\n\n\n\n\nü§î Das Modell geht apriori von ein paar Prozent Menschen mit *negativer* Gr√∂√üe aus. Ein Haufen Riesen üëπ werden auch erwartet. \n\nü§Ø   Vage (flache, informationslose, \"neutrale\", \"objektive\") Priori-Werte machen oft keinen Sinn, weil sie extreme, unplausible Werte zulassen.\n\n\n\n\n\n\n\n\n## Aufgaben\n\n### Papier-und-Bleistift-Aufgaben\n\n\n\n\n<!-- 3. [ReThink4e3](https://datenwerk.netlify.app/posts/ReThink4e3/ReThink4e3.html) -->\n\n6. [exp-tab](https://datenwerk.netlify.app/posts/exp-tab/)\n8. [exp-tab2](https://datenwerk.netlify.app/posts/exp-tab2/)\n9. [norms-sd](https://datenwerk.netlify.app/posts/norms-sd/)\n10. [small-wide-normal](https://datenwerk.netlify.app/posts/small-wide-normal/)\n11. [exp1](https://datenwerk.netlify.app/posts/exp1/)\n12. [distros](https://datenwerk.netlify.app/posts/distros/)\n3. [mtcars-post_paper](https://datenwerk.netlify.app/posts/mtcars-post_paper/)\n1. [groesse03](https://datenwerk.netlify.app/posts/groesse03/)\n2. [pupil-size2](https://datenwerk.netlify.app/posts/pupil-size2/)\n7. [groesse04](https://datenwerk.netlify.app/posts/groesse04/)\n2. [ReThink4e2](https://datenwerk.netlify.app/posts/ReThink4e2/ReThink4e2.html)\n1. [Priorwahl1](https://datenwerk.netlify.app/posts/Priorwahl1/Priorwahl1.html)\n\n\n### Aufgaben, f√ºr die man einen Computer ben√∂tigt\n\n\n\n1. [stan_glm01](https://datenwerk.netlify.app/posts/stan_glm01/stan_glm01.html)\n2. [ReThink4e1](https://datenwerk.netlify.app/posts/rethink4e1/rethink4e1)\n2. [ReThink4e3](https://datenwerk.netlify.app/posts/rethink4e3/rethink4e3)\n2. [Kung-height](https://datenwerk.netlify.app/posts/kung-height/kung-height)\n2. [Pupil-size](https://datenwerk.netlify.app/posts/pupil-size/pupil-size)\n2. [IQ-Studentis](https://datenwerk.netlify.app/posts/iq-studentis/iq-studentis)\n2. [Priori-Streuung](https://datenwerk.netlify.app/posts/priori-streuung/priori-streuung)\n\n\n\n\n## ---\n\n\n\n![](img/outro-08.jpg){width=100%}\n\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}