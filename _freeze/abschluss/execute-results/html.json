{
  "hash": "1f82cf7dd87600f9e36ccd6370663822",
  "result": {
    "markdown": "# Abschluss\n\n\n\n\nIn diesem Kapitel ben√∂tigen Sie folgende R-Pakete.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(easystats)\nlibrary(rstanarm)\n```\n:::\n\n::: {.cell}\n\n:::\n\n\n\n\n\n\n## Lieblinglingsfehler\n\n\n\nLieblingsfehler im √úberblick ü§∑:\n\n\n1. Post-Pr√§d-Verteilung (PPV) und Post-Verteilung verwechseln\n2. Quantile und Verteilungsfunktion verwechseln\n3. Pr√§diktoren nicht zentrieren, wenn es einen Interaktionsterm gibt\n4. Interaktion falsch interpretieren\n5.Regressionskoeffizienten kausal interpretieren, wenn es keine kausale Fundierung gibt\n\n\n\n\n## Post-Pr√§d-Verteilung (PPV) und Post-Verteilung verwechseln ü§∑\n\nBerechen wir das Standard-mtcars-Modell: `mpg ~ hp`. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nm1 <- stan_glm(mpg ~ hp, data = mtcars, refresh = 0)\n```\n:::\n\n\n\nDie Post-Verteilung zeigt Stichproben zu den Parameterwerten.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npost_verteilung <- m1 %>% \n  as_tibble()\nhead(post_verteilung)\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n| (Intercept)|         hp|    sigma|\n|-----------:|----------:|--------:|\n|    32.23965| -0.0858610| 3.190100|\n|    30.42495| -0.0739561| 3.448840|\n|    30.81011| -0.0776089| 3.542574|\n|    31.75643| -0.0808977| 4.449954|\n|    29.89830| -0.0683603| 3.492739|\n|    30.29930| -0.0728139| 4.158625|\n\n</div>\n:::\n:::\n\n\n\n\n\nDie Posterior-Pr√§diktiv-Verteilung (PPV) zeigt die Vorhersagen, also keine Parameterwerte, sondern Beobachtungen.\n\n::: {.cell}\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|name              |    value|\n|:-----------------|--------:|\n|Mazda RX4         | 24.36893|\n|Mazda RX4 Wag     | 18.95305|\n|Datsun 710        | 21.05073|\n|Hornet 4 Drive    | 19.24040|\n|Hornet Sportabout | 17.45379|\n\n</div>\n:::\n:::\n\n\n\n\n\n\n\n## Quantile und Verteilungsfuntion verwechseln ü§∑\n\n\n\n### Quantil f√ºr $p$\n\nEin $p$-Quantil teilt eine Verteilung in zwei Teile, \nund zwar so, dass mind. $p$ kleiner oder gleich dem $p$-Quantil sind.\n\n::: {.cell}\n::: {.cell-output-display}\n![](abschluss_files/figure-html/quantil-plot-1.png){width=672}\n:::\n:::\n\n\nDas 50%-Quantil (.5-Quantil) betr√§gt $x=0$.\nMind ein Anteil $1-p$ ist gr√∂√üer oder gleich dem $p$-Quantil.\n\n\n\n### Verteilungsfunktion $F$\n\n$F(x)$ gibt die Wahrscheinlichkeit an der Stelle $x$ an, \ndass $X$ einen Wert kleiner oder gleich $x$ annimmt.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](abschluss_files/figure-html/f-plot-1.png){width=672}\n:::\n:::\n\n\n$F(0)=1/2$, die Wahrscheinlichkeit betr√§gt hier 50%, dass $x$ nicht gr√∂√üer ist als 0.\n\n\n\n## Interaktion falsch interpretieren ü§∑\n\n\nBerechnen wir ein einfaches Interaktionsmodell: `mpg ~ hp*vs`.\n\n\n:::callout-note\nZur Erinnerung: `mpg ~ hp*vs` ist synonym zu (aber k√ºrzer als) `mpg ~ hp + vs + hp:vs`.\n:::\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm2 <- stan_glm(mpg ~ hp*vs, data = mtcars)  # mit Interaktionseffekt\n```\n:::\n\n\n\nModellkoeffizienten:\n\n::: {.cell}\n\n```{.r .cell-code}\nparameters(m2)\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|Parameter   |     Median|   CI|     CI_low|    CI_high|      pd|     Rhat|      ESS|Prior_Distribution | Prior_Location| Prior_Scale|\n|:-----------|----------:|----:|----------:|----------:|-------:|--------:|--------:|:------------------|--------------:|-----------:|\n|(Intercept) | 24.6550333| 0.95| 19.3314983| 30.2289402| 1.00000| 1.000240| 2327.693|normal             |       20.09062|  15.0673701|\n|hp          | -0.0426648| 0.95| -0.0705010| -0.0152695| 0.99825| 1.000829| 2293.725|normal             |        0.00000|   0.2197599|\n|vs          | 14.0448675| 0.95|  4.0699742| 23.1444452| 0.99575| 1.000939| 1345.483|normal             |        0.00000|  29.8946190|\n|hp:vs       | -0.1129246| 0.95| -0.1958962| -0.0233375| 0.99250| 1.000824| 1465.646|normal             |        0.00000|   0.3094788|\n\n</div>\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(parameters(m2))\n```\n\n::: {.cell-output-display}\n![](abschluss_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n\n\n**Falsch üòà**\nDer Unterschied im Verbrauch zwischen den beiden Gruppen `vs=0` und `vs=1` betr√§gt ca. -0.11.\n\n\n\n\n**Richtig üëº**\nDer Unterschied im Verbrauch zwischen den beiden Gruppen `vs=0` und `vs=1` betr√§gt ca. -0.11 -- *wenn* `hp=0`.\n\n\n\nDa `hp=0` kein realistischer Wert ist, \nist das Modell schwer zu interpretieren.\nZentrierte Pr√§diktoren w√§ren hier eine sinnvolle L√∂sung.\n\n\n\n@gelman_regression_2021,Kap. 10, @mcelreath_statistical_2020, Kap. 8\n\n\n\n\n\n\n\n\n\n\n\n\n## Kochrezepte üç≤\n\n\n\n\n\n\n\n\n### Kochrezept: Forschungsfrage untersuchen\n\n*Theoretische Phase*\n1. Staunen √ºber ein Ph√§nomen, $y$, Kausalfrage finden\n2. Literatur w√§lzen, um m√∂gliche Ursachen $x$ von $y$ zu lernen\n3. Forschungsfrage, Hypothese pr√§zisieren\n4. Modell pr√§zisieren (DAG(s), Prioris)\n\n*Empirische Phase*\n\n5. Versuch planen\n6. Daten erheben\n\n*Analytische Phase*\n\n7. Daten aufbereiten\n8. Modell berechnen anhand eines oder mehrerer DAGs\n9. Modell pr√ºfen/kritisieren\n10. Forschungsfrage beantworten\n\n\n\nYeah! Fertig.\n\n\n\n### Parameter sch√§tzen vs. Hypothesen pr√ºfen\n\nQuantitative Studien haben oft einen von zwei (formalen) Zielen: Hypothesen testen oder Parameter sch√§tzen.\nBeispiel Hypothesenpr√ºfung: \"Frauen parken im Durchschnitt schneller ein als M√§nner\".\nBeispiel Parametersch√§tzung: \"Wie gro√ü ist der mittlere Unterschied in der Ausparkzeit zwischen Frauen und M√§nnern?\"\n\nJe ausgereifter ein Forschungsfeld, desto *k√ºhnere* Hypothesen lassen sich formulieren:\n    - stark ausgereift: \n      - Die n√§chste totale Sonnenfinsternis in Deutschland wird am 27.7.2082 um 14.47h stattfinden, [Quelle](https://www.solar-eclipse.info/de/eclipse/country/DE/)\n    - gering ausgereift: \n      - Die n√§chste Sonnenfinsternis wird in den n√§chsten 100 Jahren stattfinden.\n      - Lernen bringt mehr als Nicht-Lernen f√ºr den Klausurerfolg.\nK√ºhne Hypothesen sind w√ºnschenswert ü¶π \n\n\n\n\n### Formalisierung von Forschungsfragen\n\nDer Mittelwert in Gruppe A ist h√∂her als in Gruppe B (der Unterschied, $d$, im Mittelwert ist gr√∂√üer als Null):\n\n$$\\mu_1 > \\mu_2 \\Leftrightarrow \\mu_1 - \\mu_2 > 0 \\Leftrightarrow \\mu_d > 0$$\n\n\n\n\n\n\n\n\n## Kerngedanken Bayes\n\n\n### Zentraler Kennwert der Bayes-Statistik: Post-Verteilung\n\nBerechnen wir wieder ein einfaches^[langweiliges] Modell: `mpg ~ hp`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm3 <- stan_glm(mpg ~ hp, data = mtcars)\n```\n:::\n\n\nUnd schauen wir uns die Post-Verteilung an, mit eingezeichnetem HDI:\n\n\n::: {.cell fig.asp='0.9'}\n::: {.cell-output-display}\n![](abschluss_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n\n\n\nEin Zusammenfassen der Posterior-Verteilung (z.B. zu einem 95%-PI) ist m√∂glich und oft sinnvoll.\nVerschiedene Arten des Zusammenfassens der Post-Verteilung sind m√∂glich, z.B. zu Mittelwert oder SD oder einem einem HD-Intervall.\nAllerdings √ºbermittelt nur die gesamte Post-Verteilung alle Informationen.\nDaher empfiehlt es sich (oft), die Post-Verteilung zu visualisieren.\n\n\n\n\n\n### Posteriori als Produkt von Priori und Likelihood\n\n$$\\text{Posteriori} = \\frac{\\text{Likelihood} \\times \\text{Priori}}{\\text{Evidenz}}$$\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n## Beispiele f√ºr Pr√ºfungsaufgaben\n\n\n\n\n### Geben Sie den korrekten Begriff an!\n\n\n  üå¨üöôüôãÔ∏èüë®‚¨ÖÔ∏èHans üëß‚¨ÖÔ∏èAnna üë©‚¨ÖÔ∏èLise \n  \n  \n  \nPuh, wie erstelle ich f√ºr alle Studis ein anderes R√§tsel^[Fahr-Hier-Hans-Anna-Lise: Varianzanalyse]? \n\n\n:::callout-note\nIn einer Open-Book-Pr√ºfung bekommen alle Studentis eine eigene, jeweils andere Pr√ºfung.\nTeamarbeit bleibt nat√ºrlich trotzdem untersagt.\n:::\n\n\n\n### DAG mit doppelter Konfundierung\n\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](abschluss_files/figure-html/dag2-1.png){width=672}\n:::\n:::\n\n\n\n‚ùìGeben Sie die minimale Adjustierungsmenge (minimal adjustment set) an,\num den totalen (gesamten) Effekt von *E* auf *D* zu bestimmen!\n\n‚ùó Entweder ist die Menge {A,Z} zu adjustieren oder die Menge {B,Z}.\n\n\n\n### DAG mit vielen Variablen\n\n\n\n::: {.cell fig.asp='0.5'}\n::: {.cell-output-display}\n![](abschluss_files/figure-html/dag3-1.png){width=672}\n:::\n:::\n\n\nMinimale Adjustierungsmenge, um den Effekt von E auf D zu identifizieren: {7}, {8}.\n\n\n\n### Ein Kausalmodell der Schizophrenie, van Kampen (2014)\n\n*The SSQ model of schizophrenic prodromal unfolding revised:* \n\n*An analysis of its causal chains based on the language of directed graphs*\n\nD. van Kampen\n\nLesen Sie [hier den Abstract](https://www.cambridge.org/core/journals/european-psychiatry/article/abs/ssq-model-of-schizophrenic-prodromal-unfolding-revised-an-analysis-of-its-causal-chains-based-on-the-language-of-directed-graphs/F2E7BBFC1B392616DB894AFBFABE7818).\n\nFolgende Symptome der Schizophrenie wurden gemessen:\n\nSocial Anxiety (*SAN*), Active Isolation (*AIS*), Affective Flattening (*AFF*), Suspiciousness (*SUS*), Egocentrism (*EGC*), Living in a Fantasy World (*FTW*), Alienation (*ALN*), Apathy (*APA*), Hostility (*HOS*), Cognitive Derailment (*CDR*), Perceptual Aberrations (*PER*), and Delusional Thinking (*DET*)\n\n@van_kampen_ssq_2014\n\nUV: *SUS*, AV: *EGC*\n\n\nBerechnen Sie die minimale Adjustierungsmenge, \num den kausalen Effekt der UV auf die AV zu identifizieren!\n\n\n\n### DAG von van Kampen (2014) zu den Symptomen der Schizophrenie\n\n\n\n::: {.cell fig.asp='0.5'}\n::: {.cell-output-display}\n![](abschluss_files/figure-html/dag-van-kampen-1.png){width=672}\n:::\n:::\n\n\n\nMinimales Adjustment-Set f√ºr den totalen Kausaleffekt: {AIS, ALN}\n\n\n\n\n\n### Modelle berechnen\n\n\nStellen Sie sich auf Aufgaben ein, in denen Sie Modellparameter berechnen sollen.\nOrientieren Sie sich an den Aufgaben und Inhalten des Unterrichts.\n\nPr√ºfungsfragen zu Modellen k√∂nnten z.B. sein:\n\n- Geben Sie den Punktsch√§tzer (Median) f√ºr den Pr√§diktor X im Modell Y an!\n- Geben Sie ein 89%-HDI f√ºr den Parameter X im Modell Y an!\n- Geben Sie R-Quadrat an.\n- Formulieren Sie ein Interaktionsmodell!\n- Welches Modell ist korrekt, um den kausalen Effekt zu modellieren?\n- Formulieren Sie ein Modell mit folgenden Prioris ...\n- Liegt der Effekt X noch im ROPE ?\n- Unterscheidet sich die Breite des CI von der Breite des HDI f√ºr den Pr√§diktor X im Modell Y?\n- Was ver√§ndert sich an den Parametern, wenn Sie die Pr√§diktoren zentrieren/z-standardisieren?\n- ...\n\n\n\n\n\n## Viel Erfolg bei der Pr√ºfung!\n\n\nü•≥üèÜ\n\n\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}