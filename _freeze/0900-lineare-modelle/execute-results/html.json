{
  "hash": "b983fc3813bc81743eef72e6f9dd2d94",
  "result": {
    "engine": "knitr",
    "markdown": "# Lineare Modelle\n\n\n## Lernsteuerung\n\n\n### Position im Modulverlauf\n\n@fig-modulverlauf gibt einen Überblick zum aktuellen Standort im Modulverlauf.\n\n\n### Lernziele\n\nNach Absolvieren des jeweiligen Kapitels sollen folgende Lernziele erreicht sein.\n\nSie können ...\n\n\n\n- die Post-Verteilung für einfache lineare Modelle in R berechnen\n- zentrale Informationen zu Modellparametern - wie Lage- oder Streuungsmaße und auch Schätzintervalle - aus der Post-Verteilung herauslesen\n- künftige, laut Modell zu erwartende Beobachtungen mit der PPV simulieren\n\n\n### Begleitliteratur\n\nDer Stoff dieses Kapitels orientiert sich an @mcelreath_statistical_2020, Kap. 4.4.\n\n\n\n\n\n### Vorbereitung im Eigenstudium\n\n- [Statistik1, Kap. \"Geradenmodelle 1\"](https://statistik1.netlify.app/080-regression1)\n\n\n\n\n### Benötigte R-Pakete\n\nIn diesem Kapitel benötigen Sie folgende R-Pakete.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(easystats)\nlibrary(rstanarm)  # Bayes-Golem\nlibrary(ggpubr)  # Datenvisualisierung\n```\n:::\n\n\n\n\n\nDa wir in diesem Kapitel immer mal wieder eine Funktion aus dem R-Paket `{easystats}` verwenden: [Hier](https://easystats.github.io/easystats/articles/list_of_functions.html) finden Sie eine Übersicht aller Funktionen des Pakets.^[Da es viele Funktionen sind, bietet es sich an mit *Strg-F* auf der Webseite nach Ihrem Lieblingsbefehl zu suchen.]\n\n\n### Benötigte Daten {#sec-data-lm}\n\nIn diesem Kapitel benötigen wir den Datensatz zu den !Kung-Leuten, `Howell1a`, @mcelreath_statistical_2020.\nSie können ihn [hier](https://raw.githubusercontent.com/sebastiansauer/Lehre/main/data/Howell1a.csv) herunterladen.\n\n\n{{< downloadthis data/Howell1a.csv dname = \"Howell1a.csv\" >}}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nKung_path <- \"https://raw.githubusercontent.com/sebastiansauer/Lehre/main/data/Howell1a.csv\"  # <1>\n\nd <- read.csv(Kung_path)   # <2>\n\nd2 <- d %>% filter(age > 18)  # <3>\n```\n:::\n\n1. Pfad zum Datensatz; Sie müssen online sein, um die Daten herunterzuladen.\n2. Daten einlesen\n3. Auf Erwachsene Personen begrenzen (d.h. Alter > 18)\n\n\n### Einstieg\n\n\n:::{#exm-wdh-lm}\n### Grundkonzepte der linearen Regression\nFassen Sie die Grundkonzepte der linearen Regression kurz zusammen! $\\square$\n:::\n\n:::{#exm-wdh-post}\n### Was ist eine Post-Verteilung und wozu ist sie gut?\nErklären Sie kurz, was eine Post-Verteilung ist - insbesondere im Zusammenhang mit den Koeffizienten einer einfachen Regression - und wozu sie gut ist. $\\square$\n:::\n\n\n### Überblick\n\nDieses Kapitel stellt ein einfaches Regressionsmodell vor, wo die Körpergröße auf das Gewicht zurückgeführt wird; also ein sehr eingängiges Modell.  \nNeu ist dabei lediglich, dass die Parameter des Modells - $\\beta_0$, $\\beta_1$, $\\sigma$ - jetzt über eine Post-Verteilung verfügen. \nDie Post-Verteilung ist der Zusatznutzen der Bayes-Statistik.\nDie \"normale\" Regression hat uns nur einzelne Werte für die Modellparameter geliefert (\"Punktschätzer\"). \nMit Bayes haben wir eine ganz Verteilung pro Parameter.\n\n\n\n\n## Post-Verteilung der Regression\n\n\n### Einfache Regression\n\n\n\nDie (einfache) Regression prüft, inwieweit zwei Variablen, $Y$ und $X$ linear zusammenhängen.\nJe mehr sie zusammenhängen, desto besser kann man $X$ nutzen, um $Y$ vorherzusagen (und umgekehrt).\nHängen $X$ und $Y$ zusammen, heißt das nicht (unbedingt), dass es einen *kausalen* Zusammenhang zwischen $X$ und $Y$ gibt.\n*Linear* ist ein Zusammenhang, wenn der Zuwachs in $Y$ relativ zu $X$ konstant ist: wenn $X$ um eine Einheit steigt, steigt $Y$ immer um $b$ Einheiten (nicht kausal, sondern deskriptiv gemeint).^[\n[Datenquelle](https://raw.githubusercontent.com/sebastiansauer/Lehre/main/data/Howell1a.csv), @mcelreath_statistical_2020.]\n\nLaden wir die !Kung-Daten und visualisieren wir uns den Zusammenhang zwischen Gewicht (X) und Größe (Y), @fig-kung-zshg.\n\n\n\n\n:::{#fig-kung-zshg}\n\n\n\n::: {.figure-content}\n\n:::{.panel-tabset}\n\n### Mit `ggplot2`\n\n\n::: {.cell}\n\n```{.r .cell-code}\nd2 %>% \n  ggplot(\n       aes(x = weight, y = height)) +\n  geom_point(alpha = .7) +\n  geom_smooth(method = \"lm\")\n```\n\n::: {.cell-output-display}\n![](0900-lineare-modelle_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\n\n### Mit `ggpubr`\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggscatter(d2,\n          x = \"weight\", y = \"height\",\n          add = \"reg.line\")\n```\n\n::: {.cell-output-display}\n![](0900-lineare-modelle_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n\n:::\n:::\n\n\n\nDer Zusammenhang zwischen Gewicht (X) und Größe (Y)\n\n:::\n\n\n\n### Statistiken zum !Kung-Datensatz\n\n\n::: {.cell}\n\n:::\n\n\n\nDie Daten können Sie [hier](https://raw.githubusercontent.com/sebastiansauer/Lehre/main/data/Howell1a.csv) herunterladen, s. @dec-data-lm.\n\n\n@tbl-kung1 zeigt die zentralen deskriptiven Statistiken zum !Kung-Datensatz.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nKung_path <- \"data/Howell1a.csv\"  \nd <- read_csv(Kung_path)  \n\nd2 <- d %>% filter(age > 18)\n\ndescribe_distribution(d2)\n```\n:::\n\n::: {#tbl-kung1 .cell tbl-cap='Verteiung der (metrischen) Variablen im !Kung-Datensatz'}\n::: {.cell-output-display}\n\n\n|Variable |   Mean |    SD |   IQR |            Range | Skewness | Kurtosis |   n | n_Missing |\n|:--------|:------:|:-----:|:-----:|:----------------:|:--------:|:--------:|:---:|:---------:|\n|height   | 154.64 |  7.77 | 12.06 | (136.53, 179.07) |     0.14 |    -0.50 | 346 |         0 |\n|weight   |  45.05 |  6.46 |  9.14 |   (31.52, 62.99) |     0.14 |    -0.53 | 346 |         0 |\n|age      |  41.54 | 15.81 | 22.00 |   (19.00, 88.00) |     0.68 |    -0.20 | 346 |         0 |\n|male     |   0.47 |  0.50 |  1.00 |     (0.00, 1.00) |     0.10 |    -2.00 | 346 |         0 |\n\n\n:::\n:::\n\n\n\nWie aus @tbl-kung1 abzulesen ist, beträgt das mittlere Körpergewicht (`weight`) liegt ca. 45kg (sd 7 kg).\n\n\n### Etwas mehr EDA\n\n\n\n\nWir brauchen die EDA hier nicht wirklich, aber es ist praktisch. Das Paket `DataExplorer` hat ein paar nette Hilfen zur explorativen Datenanalyse.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(DataExplorer)\n```\n:::\n\n\n#### Gibt es fehlende Werte?\n\nNein, s. Abb. @fig-na.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nd2 %>% plot_missing()\n```\n\n::: {.cell-output-display}\n![Fehlende Werte - fehlen.](0900-lineare-modelle_files/figure-html/fig-na-1.png){#fig-na width=672}\n:::\n:::\n\n\n\n\n#### Verteilung der numerischen Variablen\n\nBetrachten wir die Verteilung der *numerischen* Variablen des Datensatzes, s. @fig-d2-hists.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nd2 %>% plot_histogram()\n```\n\n::: {.cell-output-display}\n![Verteilung (als Histogramme dargestellt) der numerischen Variablen des Datensatzes](0900-lineare-modelle_files/figure-html/fig-d2-hists-1.png){#fig-d2-hists width=672}\n:::\n:::\n\n\n\n\n#### Verteilung der kategorialen Variablen\n\n\nBetrachten wir die Verteilung der *kategorialen* Variablen des Datensatzes, s. @fig-d2-bars.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nd2 %>% plot_bar()\n```\n\n::: {.cell-output-display}\n![Verteilung (als Balkendiagramme dargestellt) der kategorialen Variablen des Datensatzes](0900-lineare-modelle_files/figure-html/fig-d2-bars-1.png){#fig-d2-bars width=672}\n:::\n:::\n\n\n\n\n#### Korrelationen\n\nDie Korrelationen der (numerischen) Variablen sind in @fig-num-korrs dargestellt.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nd2 %>% plot_correlation()\n```\n\n::: {.cell-output-display}\n![Korrelationsmatrix](0900-lineare-modelle_files/figure-html/fig-num-korrs-1.png){#fig-num-korrs width=672}\n:::\n:::\n\n\n\n:::{#exr-Bonus}\n### EDA-Bericht\n\nProbieren Sie mal die folgende Funktion aus, die Ihnen einen Bericht zur EDA erstellt: `create_report(d2)`. $\\square$\n:::\n\n\n\n\n\n\n\n### Prädiktor zentrieren \n\n\n\n\nZieht man von jedem Gewichtswert den Mittelwert ab, so bekommt man die Abweichung des Gewichts vom Mittelwert (Prädiktor \"zentrieren\", engl. to *c*enter).\nWenn man den Prädiktor (`weight`) zentriert hat, ist der Achsenabschnitt, $\\beta_0$, einfacher zu verstehen.\nIn einem Modell mit zentriertem Prädiktor (`weight`) gibt der Achsenabschnitt die Größe einer Person mit durchschnittlichem Gewicht an. \nWürde man `weight` nicht zentrieren, gibt der Achsenabschnitt die Größe einer Person mit `weight=0` an, was nicht wirklich sinnvoll zu interpretieren ist.\nVgl. @gelman_regression_2021, Kap. 10.4,  12.2.\n\n\n\n\nSo kann man das Zentrieren bewerkstelligen (mit Hilfe von `center` aus `{easystats}`):\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nd3 <- \n  d2 %>% \n  mutate(weight_c = as.numeric(center(weight)))\n```\n:::\n\n\n\n\nOder so, von Hand:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nd3 <-\n  d2 %>% \n  mutate(weight_c = weight - mean(weight))\n```\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"wonwwrwcmr\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#wonwwrwcmr table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#wonwwrwcmr thead, #wonwwrwcmr tbody, #wonwwrwcmr tfoot, #wonwwrwcmr tr, #wonwwrwcmr td, #wonwwrwcmr th {\n  border-style: none;\n}\n\n#wonwwrwcmr p {\n  margin: 0;\n  padding: 0;\n}\n\n#wonwwrwcmr .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#wonwwrwcmr .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#wonwwrwcmr .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#wonwwrwcmr .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#wonwwrwcmr .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#wonwwrwcmr .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#wonwwrwcmr .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#wonwwrwcmr .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#wonwwrwcmr .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#wonwwrwcmr .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#wonwwrwcmr .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#wonwwrwcmr .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#wonwwrwcmr .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#wonwwrwcmr .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#wonwwrwcmr .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#wonwwrwcmr .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#wonwwrwcmr .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#wonwwrwcmr .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#wonwwrwcmr .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#wonwwrwcmr .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#wonwwrwcmr .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#wonwwrwcmr .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#wonwwrwcmr .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#wonwwrwcmr .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#wonwwrwcmr .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#wonwwrwcmr .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#wonwwrwcmr .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#wonwwrwcmr .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#wonwwrwcmr .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#wonwwrwcmr .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#wonwwrwcmr .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#wonwwrwcmr .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#wonwwrwcmr .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#wonwwrwcmr .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#wonwwrwcmr .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#wonwwrwcmr .gt_left {\n  text-align: left;\n}\n\n#wonwwrwcmr .gt_center {\n  text-align: center;\n}\n\n#wonwwrwcmr .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#wonwwrwcmr .gt_font_normal {\n  font-weight: normal;\n}\n\n#wonwwrwcmr .gt_font_bold {\n  font-weight: bold;\n}\n\n#wonwwrwcmr .gt_font_italic {\n  font-style: italic;\n}\n\n#wonwwrwcmr .gt_super {\n  font-size: 65%;\n}\n\n#wonwwrwcmr .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#wonwwrwcmr .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#wonwwrwcmr .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#wonwwrwcmr .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#wonwwrwcmr .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#wonwwrwcmr .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#wonwwrwcmr .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"height\">height</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"weight\">weight</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"age\">age</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"male\">male</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"weight_c\">weight_c</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"height\" class=\"gt_row gt_right\">152</td>\n<td headers=\"weight\" class=\"gt_row gt_right\">48</td>\n<td headers=\"age\" class=\"gt_row gt_right\">63</td>\n<td headers=\"male\" class=\"gt_row gt_right\">1</td>\n<td headers=\"weight_c\" class=\"gt_row gt_right\">3</td></tr>\n    <tr><td headers=\"height\" class=\"gt_row gt_right\">140</td>\n<td headers=\"weight\" class=\"gt_row gt_right\">36</td>\n<td headers=\"age\" class=\"gt_row gt_right\">63</td>\n<td headers=\"male\" class=\"gt_row gt_right\">0</td>\n<td headers=\"weight_c\" class=\"gt_row gt_right\">−9</td></tr>\n    <tr><td headers=\"height\" class=\"gt_row gt_right\">137</td>\n<td headers=\"weight\" class=\"gt_row gt_right\">32</td>\n<td headers=\"age\" class=\"gt_row gt_right\">65</td>\n<td headers=\"male\" class=\"gt_row gt_right\">0</td>\n<td headers=\"weight_c\" class=\"gt_row gt_right\">−13</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\nWie man sieht, ist die Verteilung \"zur Seite geschoben\": Der Mittelwert liegt jetzt eben bei 0, s. @fig-d3-center.\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![Das Zentrieren ändert die Verteilungsform nicht, sondern \"schiebt\" die Verteilung nur zur Seite](0900-lineare-modelle_files/figure-html/fig-d3-center-1.png){#fig-d3-center width=672}\n:::\n:::\n\n\n\n\nDas schwierigste ist dabei, nicht zu vergessen, dass `d3` die Tabelle mit zentriertem Prädiktor ist, nicht `d2`.\n\n\n## Modell m43: zentrierter Prädiktor\n\n📺 [Prädiktoren zentrieren](https://youtu.be/3Z1dXPO_MSE)\n\n\nEinige Regressionskoeffizienten, wie der Achsenabschnitt (Intercept) sind schwer zu interpretieren:\nBei einem (erwachsenen) Menschen mit *Gewicht 0*, was wäre wohl die Körpergröße?\nHm, Philosophie steht heute nicht auf der Tagesordnung.\n\nDa wäre es schön, wenn wir die Daten so umformen könnten, dass der Achsenabschnitt eine sinnvolle Aussage macht.\nZum Glück geht das leicht: Wir zentrieren den Prädiktor (Gewicht)!\n\n\n:::callout-important\nDurch Zentrieren kann man die Ergebnisse einer Regression einfacher interpretieren.\n:::\n\n\n\n\n\n### Modelldefinition von `m43`\n\nFür jede Ausprägung des Prädiktors (`weight_centered`), $wc_i$, wird eine Post-Verteilung für die abhängige Variable (`height`, $h_i$) berechnet.\nDer Mittelwert $\\mu$ für jede Post-Verteilung ergibt sich aus dem linearen Modell (unserer Regressionsformel).\n Die Post-Verteilung berechnet sich auf Basis der Priori-Werte und des Likelihood (Bayes-Formel).\n Wir brauchen Priori-Werte für die Steigung $\\beta_1$ und den Achsenabschnitt $\\beta_0$ der Regressionsgeraden.\n Außerdem brauchen wir einen Priori-Wert, der die Streuung $\\sigma$ der Größe (`height`) angibt; dieser Wert wird als exonentialverteilt angenommen.\n Der Likelihood gibt an, wie wahrscheinlich ein Wert `height` ist, gegeben $\\mu$ und $\\sigma$. \n@eq-modm42 stellt die Modelldefinition dar.\n\n\n$$\\begin{align*}\n\\color{red}{\\text{height}_i} & \\color{red}\\sim \\color{red}{\\operatorname{Normal}(\\mu_i, \\sigma)} && \\color{red}{\\text{Likelihood}} \\\\\n\\color{green}{\\mu_i} & \\color{green}= \\color{green}{\\alpha + \\beta\\cdot \\text{weightcentered}_i}  && \\color{green}{\\text{Lineares Modell} } \\\\\n\\color{blue}\\alpha & \\color{blue}\\sim \\color{blue}{\\operatorname{Normal}(178, 20)} && \\color{blue}{\\text{Priori}} \\\\\n\\color{blue}\\beta  & \\color{blue}\\sim \\color{blue}{\\operatorname{Normal}(0, 10)}  && \\color{blue}{\\text{Priori}}\\\\\n\\color{blue}\\sigma & \\color{blue}\\sim \\color{blue}{\\operatorname{Exp}(0.1)}  && \\color{blue}{\\text{Priori}}\n\\end{align*}$${#eq-modm42}\n\n\n\n:::callout-note\nDer Achsenabschnit (engl. *intercept*) eines Regressionsmodell wird in der Literatur oft mit $\\beta_0$ bezeichnet,\naber manchmal auch mit $\\beta_0$.\nUnd manchmal mit noch anderen Buchstaben, das Alphabet ist weit. 🤷\n:::\n\n\n\n\n\n\n### Likelihood, `m43`\n\n\n\n$$\n\\begin{aligned}\n\\color{red}{\\text{height}_i} & \\color{red}\\sim \\color{red}{\\operatorname{Normal}(\\mu_i, \\sigma)} && \\color{red}{\\text{Likelihood}}\n\\end{aligned}\n$$\n\n\n\n\n Der Likelihood von `m43` ist ähnlich zu den vorherigen Modellen (`m41, m42`).\n Nur gibt es jetzt ein kleines \"Index-i\" am $\\mu$ und am $h$ (h wie `heights`).\n Es gibt jetzt nicht mehr nur einen Mittelwert $\\mu$, sondern für jede Beobachtung (Zeile) einen Mittelwert $\\mu_i$.\n Lies  etwa so:\n\n>    \"Die Wahrscheinlichkeit, eine bestimmte Größe bei Person $i$ zu beobachten, gegeben $\\mu$ und $\\sigma$ ist normalverteilt (mit Mittelwert $\\mu$ und Streuung $\\sigma$)\".\n\n\n\n\n### Regressionsformel, `m43`\n\n\n$$\n\\begin{aligned}\n\\color{green}{\\mu_i} & \\color{green}= \\color{green}{\\alpha + \\beta\\cdot \\text{weight}_i}  && \\color{green}{\\text{Lineares Modell} } \\\\\n\\end{aligned}\n$$\n\n\n $\\mu$ ist jetzt nicht mehr ein Parameter, der (stochastisch) geschätzt werden muss. $\\mu$ wird jetzt (deterministisch) *berechnet*. Gegeben $\\beta_0$ und $\\beta_1$ ist $\\mu$ ohne Ungewissheit bekannt.\n $\\text{weight}_i$ ist der Prädiktorwert (`weight`) der $i$ten Beobachtung, also einer !Kung-Person (Zeile $i$ im Datensatz).\nLies  etwa so:\n\n>    \"Der Mittelwert $\\mu_i$ der $i$ten Person berechnet sich als Summe von $\\beta_0$ und $\\beta_1$ mal  $\\text{weight}_i$\".\n\n\n $\\mu_i$ ist eine lineare Funktion von `weight`.\n $\\beta_1$ gibt den Unterschied in `height` zweier Beobachtung an, die sich um eine Einheit in `weight` unterscheiden (Steigung der Regressionsgeraden).\n $\\beta_0$ gibt an, wie groß $\\mu$ ist, wenn `weight` Null ist (Achsenabschnitt, engl. intercept).\n\n\n\n### Priori-Werte des Modells `m43`\n\n\n\n\\begin{align*}\n\\color{blue}\\alpha & \\color{blue}\\sim \\color{blue}{\\operatorname{Normal}(178, 20)} && \\color{blue}{\\text{Priori Achsenabschnitt}} \\\\\n\\color{blue}\\beta  & \\color{blue}\\sim \\color{blue}{\\operatorname{Normal}(0, 10)}  && \\color{blue}{\\text{Priori Regressionsgewicht}}\\\\\n\\color{blue}\\sigma & \\color{blue}\\sim \\color{blue}{\\operatorname{Exp}(0.1)}  && \\color{blue}{\\text{Priori Sigma}}\n\\end{align*}\n\nParameter sind hypothetische Kreaturen: Man kann sie nicht beobachten, sie existieren nicht wirklich. Ihre Verteilungen nennt man Priori-Verteilungen.\n$\\beta_0$ wurde in `m41` als $\\mu$ bezeichnet, da wir dort eine \"Regression ohne Prädiktoren\" berechnet haben.\n$\\sigma$ ist uns schon als Parameter bekannt und behält seine Bedeutung aus dem letzten Kapitel.\nDa `height` nicht zentriert ist, der Mittelwert von $\\beta_0$ bei 178 und nicht 0.\n$\\beta_1$ fasst unser Vorwissen, ob und wie sehr der Zusammenhang zwischen Gewicht und Größe positiv (gleichsinnig) ist.\nDie Anzahl der Prioris entspricht der Anzahl der Parameter des Modells.\n\n\n\n\n\n\n\n\n\n## Die Post-Verteilung befragen\n\n\n📺 [Post-Verteilung auslesen 1](https://youtu.be/9ZUyN4GUNBY)\n\n📺 [Post-Verteilung auslesen 2](https://youtu.be/8NrUQ1_d7vI)\n\n### m43a\n\n\nSagen wir, auf Basis gut geprüfter Evidenz haben wir folgendes Modell festgelegt: `height ~ weight_c`, s. @eq-m43a.\n\nPrioris:\n\n$$\\beta_1 \\sim N(5,3); \\\\\n\\beta_0 \\sim N(178, 20); \\\\\n\\sigma \\sim E(0.1)$${#eq-m43a}\n\n\nWir nennen das Modell `m43a`^[Wer ist hier für die Namensgebung zuständig? Besoffen oder was?], s. @lst-m43a.\n\n\n\n\n```{#lst-m43a .r lst-cap=\"Modelldefinition von m43a in R\"}\nm43a <-\n  stan_glm(\n    height ~ weight_c,  # Regressionsformel\n    prior = normal(5, 3),  # Regressionsgewicht (beta 1)\n    prior_intercept = normal(178, 20),  # mu\n    prior_aux = exponential(0.1),  # sigma\n    refresh = 0,  # zeig mir keine Details\n    seed = 42,  # lege die Zufallszahlen fest für Reproduzierbarkeit\n    data = d3)\n```\n\n\n\n\n\n::: {.cell}\n\n:::\n\n\n\n:::callout-note\nMit `seed` kann man die Zufallszahlen fixieren,\nso dass jedes Mal die gleichen Werte resultieren.\nSo ist die Nachprüfbarkeit der Ergebnisse (\"Reproduzierbarkeit\") sichergestellt^[oder zumindest *besser* sichergestellt].\nWelche Wert für `seed` man verwendet, ist egal,\nsolange alle den gleichen verwenden.\nDer Autor verwendet z.B. oft den Wert 42.\nZur Erinnerung: Der Golem zieht Zufallszahlen,\ndamit erstellt er Stichproben, die die Postverteilung schätzen.\n:::\n\n\n\n\n### Mittelwerte von $\\beta_0$ und $\\beta_1$ aus der Post-Verteilung\n\n\n\nDie ersten paar Zeilen:\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"lsuicnmjvw\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#lsuicnmjvw table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#lsuicnmjvw thead, #lsuicnmjvw tbody, #lsuicnmjvw tfoot, #lsuicnmjvw tr, #lsuicnmjvw td, #lsuicnmjvw th {\n  border-style: none;\n}\n\n#lsuicnmjvw p {\n  margin: 0;\n  padding: 0;\n}\n\n#lsuicnmjvw .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#lsuicnmjvw .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#lsuicnmjvw .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#lsuicnmjvw .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#lsuicnmjvw .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#lsuicnmjvw .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#lsuicnmjvw .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#lsuicnmjvw .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#lsuicnmjvw .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#lsuicnmjvw .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#lsuicnmjvw .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#lsuicnmjvw .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#lsuicnmjvw .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#lsuicnmjvw .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#lsuicnmjvw .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#lsuicnmjvw .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#lsuicnmjvw .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#lsuicnmjvw .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#lsuicnmjvw .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#lsuicnmjvw .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#lsuicnmjvw .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#lsuicnmjvw .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#lsuicnmjvw .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#lsuicnmjvw .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#lsuicnmjvw .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#lsuicnmjvw .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#lsuicnmjvw .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#lsuicnmjvw .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#lsuicnmjvw .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#lsuicnmjvw .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#lsuicnmjvw .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#lsuicnmjvw .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#lsuicnmjvw .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#lsuicnmjvw .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#lsuicnmjvw .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#lsuicnmjvw .gt_left {\n  text-align: left;\n}\n\n#lsuicnmjvw .gt_center {\n  text-align: center;\n}\n\n#lsuicnmjvw .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#lsuicnmjvw .gt_font_normal {\n  font-weight: normal;\n}\n\n#lsuicnmjvw .gt_font_bold {\n  font-weight: bold;\n}\n\n#lsuicnmjvw .gt_font_italic {\n  font-style: italic;\n}\n\n#lsuicnmjvw .gt_super {\n  font-size: 65%;\n}\n\n#lsuicnmjvw .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#lsuicnmjvw .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#lsuicnmjvw .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#lsuicnmjvw .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#lsuicnmjvw .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#lsuicnmjvw .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#lsuicnmjvw .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"id\">id</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"(Intercept)\">(Intercept)</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"weight_c\">weight_c</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"sigma\">sigma</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"id\" class=\"gt_row gt_right\">1</td>\n<td headers=\"(Intercept)\" class=\"gt_row gt_right\">155.1</td>\n<td headers=\"weight_c\" class=\"gt_row gt_right\">0.9</td>\n<td headers=\"sigma\" class=\"gt_row gt_right\">5.0</td></tr>\n    <tr><td headers=\"id\" class=\"gt_row gt_right\">2</td>\n<td headers=\"(Intercept)\" class=\"gt_row gt_right\">155.5</td>\n<td headers=\"weight_c\" class=\"gt_row gt_right\">0.8</td>\n<td headers=\"sigma\" class=\"gt_row gt_right\">5.1</td></tr>\n    <tr><td headers=\"id\" class=\"gt_row gt_right\">3</td>\n<td headers=\"(Intercept)\" class=\"gt_row gt_right\">155.5</td>\n<td headers=\"weight_c\" class=\"gt_row gt_right\">0.9</td>\n<td headers=\"sigma\" class=\"gt_row gt_right\">5.1</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\nHier sind die Zusammenfassungen der Stichproben aus der Post-Verteilung, komfortabel zu erhalten mit dem Befehle `parameters`, s. @tbl-m43a-params.\n\n\n::: {#tbl-m43a-params .cell tbl-cap='Parameter von m43a'}\n\n```{.r .cell-code}\nparameters(m43a)\n```\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n\n\n|Parameter   | Median |           95% CI |   pd |  Rhat |     ESS |              Prior |\n|:-----------|:------:|:----------------:|:----:|:-----:|:-------:|:------------------:|\n|(Intercept) | 154.65 | (154.14, 155.19) | 100% | 0.999 | 3214.00 | Normal (178 +- 20) |\n|weight_c    |   0.91 |     (0.82, 0.99) | 100% | 1.001 | 4134.00 |    Normal (5 +- 3) |\n\n\n:::\n:::\n\n\n\n\n::: {#def-pd}\n\n### Effektwahrscheinlichkeit\n\nDie Kennzahl  `pd` (propability of direction) gibt die *Effektwahrscheinlichkeit* an: Die Wahrscheinlichkeit,\ndass der Effekt positiv (also größer als Null) oder negativ ist (je nachdem ob der Median des Effekts positiv oder negativ ist).\n`pd` gibt aber nicht an, wie stark der Effekt ist, nur ob er klar auf einer Seite der Null liegt.\nDamit ist er so etwas (grob!) Ähnliches wie der p-Wert in der Frequentistischen Statistik [@makowski_indices_2019].\n\n:::\n\n\nAm besten das Diagramm dazu anschauen, s @fig-pd1.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(p_direction(m43a))\n```\n\n::: {.cell-output-display}\n![Diagramm zur Probability of Direction, Modell m43a](0900-lineare-modelle_files/figure-html/fig-pd1-1.png){#fig-pd1 width=672}\n:::\n:::\n\n\n\n\n`Rhat` und `ESS` sind Kennzahlen, die untersuchen, ob mit der Stichprobenziehung im Bayes-Modell alles gut funktioniert hat. Bei einfachen Modellen (die wir hier berechnen) sollte da in der Regel alles in Ordnung sein.\n`Rhat` sollte nicht (viel) größer als 1 oder 1,01 sein. `ESS` (effective sample size) gibt die Anzahl der effektiv nutzbaren Stichproben an (im Standard werden 4000 berechnet). Die Zahl sollte nicht deutlich geringer sein.\n\nWir werden uns aber mit diesen beiden Kennwerten nicht weiter beschäftigen in diesem Kurs.\n\n\n### Visualisieren der \"mittleren\" Regressiongeraden\n\n\n\nZur Erinnerung: Die Bayes-Analyse liefert uns viele Stichproben zu den gesuchten Parametern,\nhier $\\beta_0$, $\\beta_1$ und $\\sigma$.\nÜberzeugen wir uns mit einem Blick in die Post-Verteilung von `m43a`:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm43a %>% \n  as_tibble() %>% \n  head()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"(Intercept)\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"weight_c\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"sigma\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"155.1421\",\"2\":\"0.8581434\",\"3\":\"5.042898\"},{\"1\":\"155.4658\",\"2\":\"0.8348727\",\"3\":\"5.071101\"},{\"1\":\"155.4522\",\"2\":\"0.8549260\",\"3\":\"5.144382\"},{\"1\":\"155.2342\",\"2\":\"0.8816371\",\"3\":\"5.352756\"},{\"1\":\"155.3172\",\"2\":\"0.8745051\",\"3\":\"5.349856\"},{\"1\":\"154.9315\",\"2\":\"0.9030495\",\"3\":\"5.207581\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\nWir können z.B. ein Lagemaß wie den Median hernehmen, um die \"mittlere\" Regressionsgerade zu betrachten.\n\n\n:::{.panel-tabset}\n\n### Mit `ggplot`\n\n\n::: {.cell}\n\n```{.r .cell-code}\nd3 %>% \n  ggplot() +\n  aes(x = weight_c, y = height) +\n  geom_point() +\n  geom_abline(\n    slope = 0.9,  # Median beta 1\n    intercept = 154,  # Median beta 0\n    color = \"blue\")\n```\n\n::: {.cell-output-display}\n![](0900-lineare-modelle_files/figure-html/Post-Regression-befragen-6-1.png){width=672}\n:::\n:::\n\n\n\n### Mit `easystats`\n\nEinfacher ist die Syntax vielleicht, wenn man die Funktion `estimate_expectation` benutzt, s. @fig-expect-m43a-expect.\nMit \"expectation\" sind hier die erwarteten Werte, also die Regressionsgerade, gemeint.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm43_expect <- estimate_expectation(m43a)   # aus {easystats}\nplot(m43_expect)\n```\n\n::: {.cell-output-display}\n![Erwartete Werte des Modell m43a, sprich, die Regressionsgerade](0900-lineare-modelle_files/figure-html/fig-expect-m43a-expect-1.png){#fig-expect-m43a-expect width=672}\n:::\n:::\n\n\n:::\n\n\n### Zentrale Statistiken zu den Parametern\n\nIn diesem Modell gibt es drei Parameter: $\\beta_0, \\beta_1, \\sigma$.^[In manchen Lehrbüchern wird $\\beta_0$ auch als $\\alpha$ bezeichnet.]\nHier folgen einige Beispiele an Fragen, die wir an unser Modell bzw. die Post-Verteilung stellen können.\n\n\n#### Lagemaße zu den Parametern\n\n- Was ist die mittlere Größe einer !Kung-Person? ($\\beta_0$)\n- Was ist der Schätzwert für den Zusammenhang von Gewicht und Größe? ($\\beta_1$)\n- Was ist der Schätzwert für Ungewissheit in der Schätzung der Größe? ($\\sigma$)\n- Was ist der wahrscheinlichste Wert für z.B: $\\beta_1$?\n\n\nEine nützliche Zusammenfassung der Post-Verteilung bekommt man mit `parameters(modell)`, s. @tbl-m43a-params.\n\n<!-- ```{r Post-Regression-befragen-7, echo = TRUE} -->\n<!-- #| eval: false -->\n<!-- m43a %>%  -->\n<!--   parameters() -->\n<!-- ``` -->\n\n\n\n::: {.cell}\n\n:::\n\n\n\nWandelt man das Ausgabe-Objekt der Bayes-Regression, d.h. `m43a`, mit `as_tibble()` in eine Tabelle um,\nso bekommt man eine Tabelle mit den Stichproben der Post-Verteilung:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm43a_post <- \n  m43a %>% \n  as_tibble()\n\nm43a_post %>% \n  head()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"(Intercept)\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"weight_c\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"sigma\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"155.1421\",\"2\":\"0.8581434\",\"3\":\"5.042898\"},{\"1\":\"155.4658\",\"2\":\"0.8348727\",\"3\":\"5.071101\"},{\"1\":\"155.4522\",\"2\":\"0.8549260\",\"3\":\"5.144382\"},{\"1\":\"155.2342\",\"2\":\"0.8816371\",\"3\":\"5.352756\"},{\"1\":\"155.3172\",\"2\":\"0.8745051\",\"3\":\"5.349856\"},{\"1\":\"154.9315\",\"2\":\"0.9030495\",\"3\":\"5.207581\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\nWie wir gesehen haben, nutzen wir diese Tabelle der Post-Verteilung immer wieder.\nSpeichern wir uns sie also als ein Objekt ab, `m43_post`.\nJetzt haben wir wieder eine schöne Tabelle mit Stichproben aus der Post-Verteilung,\ndie wir wie gewohnt befragen können.\nEine Visualisierung zeigt gut sowohl Lage- als auch Streuungsmaße der Parameter, zumindest grob.,\n\n\n\n\n\nOder man erstellt selber ein Diagramm mit `ggplot` oder `ggpubr`, s. @fig-m43a-post.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm43a_post %>% \n  ggplot(aes(x = weight_c)) +\n  geom_density(fill = \"orange\")\n```\n\n::: {.cell-output-display}\n![Postverteilung für den Parameter Gewicht (zentriert)](0900-lineare-modelle_files/figure-html/fig-m43a-post-1.png){#fig-m43a-post width=672}\n:::\n:::\n\n\n\n@fig-m43a-post zeigt, dass Mittelwert, Median und Modus eng zusammenliegen.\nZur Erinnerung: Der Modus gibt den häufigsten, d.h. hier also den wahrscheinlichsten, Wert an.\nDer Modus wird hier auch *Maximum a Posteriori* (MAP) genannt, daher:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm43a_post %>% \n  summarise(map_b1 = map_estimate(weight_c))\n```\n:::\n\n\n\n\n\n\nHier ist die Verteilung von $\\sigma$ visualisiert, s. @fig-m43a-post2.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm43a_post %>% \n  ggplot(aes(x = sigma)) +\n  geom_density(fill = \"orange\")\n```\n\n::: {.cell-output-display}\n![Die Post-Verteilung für den Parameter sigma, m43a](0900-lineare-modelle_files/figure-html/fig-m43a-post2-1.png){#fig-m43a-post2 width=672}\n:::\n:::\n\n\n\nAlternativ kann man sich die Verteilung eines Parameters auch so ausgeben lassen,\ngleich mit Intervallgrenzen, z.B. 95%, s. @fig-m43a-plot.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm43a_hdi <- hdi(m43a_post)  # analog mit eti(m43a)\n\nplot(m43a_hdi)\n```\n\n::: {.cell-output-display}\n![Die Parameter Gewicht (zentriert) und sigma des Modells m43a](0900-lineare-modelle_files/figure-html/fig-m43a-plot-1.png){#fig-m43a-plot width=672}\n:::\n:::\n\n\nErgänzt man bei `plot()` noch `show_intercept = TRUE` wird auch der Achsenabschnitt angezeigt.\n\n\n\n\n\n### Streuungsmaße zu den Parametern\n\n\n- Wie unsicher sind wir uns in den Schätzungen der Parameter?\n\n\n\nDiese Frage wird durch die Ungewissheitsintervalle in der Ausgabe beantwortet.\n\n\n:::callout-note\nAn einigen Stellen wird empfohlen, anstelle eines (gebräuchlichen) 95%-Intervalls \nauf ein 90%- oder 89%-Intervall auszuweichen, aufgrund der besseren numerischen Stabilität.\n:::\n\n\n### Ungewissheit von $\\beta_0$ und $\\beta_1$ aus der Post-Verteilung visualisiert\n\n\n\n:::{.panel-tabset}\n\n### 10\n\nDie ersten 10 Stichproben:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nd3 %>% \n  ggplot(aes(x = weight_c, \n             y = height)) +\n  geom_point() +\n  geom_abline(\n    data = m43a_post %>% \n      slice_head(n = 10),\n    aes(slope = weight_c,\n        intercept = `(Intercept)`),\n    alpha = .3)\n```\n\n::: {.cell-output-display}\n![](0900-lineare-modelle_files/figure-html/Post-Regression-befragen-10-1.png){width=672}\n:::\n:::\n\n\n## 100\n\nDie ersten 100 Stichproben:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nd3 %>% \n  ggplot(aes(x = weight_c, \n             y = height)) +\n  geom_point() +\n  geom_abline(\n    data = m43a_post %>% \n      slice_head(n = 100),\n     aes(slope = weight_c,\n        intercept = `(Intercept)`),\n    alpha = .1)\n```\n\n::: {.cell-output-display}\n![](0900-lineare-modelle_files/figure-html/Post-Regression-befragen-11-ersten-1000-1.png){width=672}\n:::\n:::\n\n\n\n### 1000\n\nDie ersten `1e3` Stichproben:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nd3 %>% \n  ggplot(aes(x = weight_c, \n             y = height)) +\n  geom_point() +\n  geom_abline(\n    data = m43a_post %>% \n      slice_head(n = 1e3),\n     aes(slope = weight_c,\n        intercept = `(Intercept)`),\n    alpha = .01)\n```\n\n::: {.cell-output-display}\n![](0900-lineare-modelle_files/figure-html/Post-Regression-befragen-11-die-ersten-1000-1.png){width=672}\n:::\n:::\n\n\n\n\n### 1000000\n\nDie ersten 1000000^[1e6] ... okay, lassen wir es gut sein^[Im Standard beschert uns `stan_glm()` 4000 Stichproben.].\n\n:::\n\n\nEinfacher ist die Visualisierung mit `estimate_expectation`, s. @fig-m43a-estimate-expectation.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nestimate_expectation(m43a, seed = 42) %>% plot()\n```\n\n::: {.cell-output-display}\n![Schätzbereich für die bedingten mittleren Körpergröße, also die Regressionsgerade mit Unsicherheitsintervall](0900-lineare-modelle_files/figure-html/fig-m43a-estimate-expectation-1.png){#fig-m43a-estimate-expectation width=672}\n:::\n:::\n\n\n\n### Fragen zu Quantilen des Achsenabschnitts \n\n:::callout-note\nZur Erinnerung: Bei einem zentrierten Prädiktor misst der Achsenabschnitt die mittlere Größe^[$\\mu$].\n:::\n\n- Welche mittlere Größe wird mit einer Wahrscheinlichkeit von 50%, 90% bzw. 95% Wahrscheinlichkeit nicht überschritten?\n- Welche mittlere Größe mit Wahrscheinlichkeit von 95% nicht unterschritten?\n- Von wo bis wo reicht der innere 50%-Schätzbereich der mittleren Größe?\n\n\n\nQuantile:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm43a_post %>% \n  summarise(\n    q_50 = quantile(`(Intercept)`, prob = .5),\n    q_90 = quantile(`(Intercept)`, prob = .9),\n    q_05 = quantile(`(Intercept)`, prob = .95))\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"q_50\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"q_90\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"q_05\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"154.6548\",\"2\":\"155.0032\",\"3\":\"155.0951\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n50%-PI:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm43a %>% \n  eti(ci = .5)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"Parameter\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"CI\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"CI_low\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"CI_high\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Effects\"],\"name\":[5],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Component\"],\"name\":[6],\"type\":[\"chr\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"(Intercept)\",\"2\":\"0.5\",\"3\":\"154.4632928\",\"4\":\"154.8373635\",\"5\":\"fixed\",\"6\":\"conditional\",\"_rn_\":\"1\"},{\"1\":\"weight_c\",\"2\":\"0.5\",\"3\":\"0.8772824\",\"4\":\"0.9354291\",\"5\":\"fixed\",\"6\":\"conditional\",\"_rn_\":\"2\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\n\n### Fragen zu Wahrscheinlichkeitsmassen des Achsenabschnitts \n\n\n\nWie wahrscheinlich ist es, dass die mittlere Größe bei mind. 155 cm liegt?\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm43a_post %>% \n  count(gross = `(Intercept)` >= 155) %>% \n  mutate(prop = n / sum(n))\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"gross\"],\"name\":[1],\"type\":[\"lgl\"],\"align\":[\"right\"]},{\"label\":[\"n\"],\"name\":[2],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"prop\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"FALSE\",\"2\":\"3593\",\"3\":\"0.89825\"},{\"1\":\"TRUE\",\"2\":\"407\",\"3\":\"0.10175\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n::: {.cell}\n\n:::\n\n\nDie Wahrscheinlichkeit beträgt 0.1.\n\n\nWie wahrscheinlich ist es, dass die mittlere Größe höchstens 154.5 cm beträgt?\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm43a_post %>% \n  count(klein = (`(Intercept)` <= 154.5)) %>% \n  mutate(prop = n / sum(n))\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"klein\"],\"name\":[1],\"type\":[\"lgl\"],\"align\":[\"right\"]},{\"label\":[\"n\"],\"name\":[2],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"prop\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"FALSE\",\"2\":\"2833\",\"3\":\"0.70825\"},{\"1\":\"TRUE\",\"2\":\"1167\",\"3\":\"0.29175\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n::: {.cell}\n\n:::\n\n\n\nDie Wahrscheinlichkeit beträgt 0.29.\n\n\n\n\n\n\n<!-- ### Ungewissheit von Achsenabschnitt und Steigung  -->\n\n<!-- ... als Histogramme visualisiert -->\n\n<!--  -->\n\n<!-- ### Achsenabschnitt -->\n\n<!-- ```{r Post-Regression-befragen-13, echo = TRUE, eval = TRUE} -->\n<!-- post_m43a %>%  -->\n<!--   ggplot(aes(x = a)) + -->\n<!--   geom_density() -->\n<!-- ``` -->\n\n<!-- ] -->\n\n<!-- .pull-right[ -->\n\n<!-- ### Regressionsgewicht (Steigung) -->\n\n<!-- ```{r Post-Regression-befragen-14, echo = TRUE} -->\n<!-- post_m43a %>%  -->\n<!--   ggplot(aes(x = b)) + -->\n<!--   geom_density() -->\n<!-- ``` -->\n\n<!-- ] -->\n\n\n\n### Typischer Bayes-Nutzer in Aktion\n\n![Typischer Bayes-Nutzer, der ein Ungewissheitsintervall berechnet. Bildquelle: Easystats, bayestestR](img/bayesianMaster.jpg){width=\"50%\" fig-align=\"center\"}\n\n[Quelle](https://easystats.github.io/bayestestR/articles/bayestestR.html)\n\n\n\n\n\n## Post-Verteilung bedingt auf einen Prädiktorwert\n\n\n### Bei jedem Prädiktorwert eine Post-Verteilung für $\\mu$\n\n\nKomfort pur: Unser Modell erlaubt uns für jeden beliebigen Wert des Prädiktors eine Post-Verteilung (von $\\mu$) zu berechnen.\n\nHier am Beispiel von `m42`, s. @fig-post42.\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![Für jeden beliebigen Prädiktorwert kann man eine Post-Verteilung bekommen. A: Regressionsmodell mit einigen ausgewählten Gewichtswerten. B: Für jeden beliebigen Gewichtswert bekommt man eine Post-Verteilung](0900-lineare-modelle_files/figure-html/fig-post42-1.png){#fig-post42 width=100%}\n:::\n:::\n\n\n\n\n\n\n\n### Visualisierung\n\n\nWas ist wohl die Wahrscheinlichkeit der Körpergröße bei einem bestimmten Gewicht?\n\nAngenommen wir wissen, dass das Gewicht bei, sagen wir 45 kg liegt.\nWelche Körpergröße ist (im Schnitt) zu erwarten? Wie unsicher sind wir uns über diesen Mittelwert?\n\nEtwas formaler ausgedrückt:\n\n$\\mu|\\text{weight}=45$\n\n\n45 kg entspricht genau dem Mittelwert von `weight`. Geht man von zentrierten Prädiktorwerten aus, gilt in dem Fall `weight_c = 0`.\nErstellen wir uns dazu eine Tabelle:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmu_at_45 <-\n  m43a_post %>% \n  mutate(mu_at_45 = `(Intercept)`)\n```\n:::\n\n\nUnd plotten diese, s. @fig-mu-at-45.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmu_at_45 %>% \n  ggplot(aes(x = mu_at_45)) +\n  geom_density()\n```\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![Post-Verteilung der Größe (laut unserem Modell) bei einem Gewicht von 45kg](0900-lineare-modelle_files/figure-html/fig-mu-at-45-1.png){#fig-mu-at-45 width=672}\n:::\n:::\n\n\n\nAnalog können wir fragen,\nwie groß wohl eine Person mit 50 kg im Mittelwert sein wird und wie (un)gewiss wir uns über diesen Mittelwert sind.\n\n\n50 kg, das sind 5 über dem Mittelwert, in zentrierten Einheiten ausgedrückt also `weight_c = 5`. Auch dazu erstellen wir uns eine Tabelle, s. @tbl-mu-at-50.\n\n\n\n\n::: {#tbl-mu-at-50 .cell tbl-cap='Die Verteilung von mu bedingt auf ein Gewicht von 50kg.'}\n\n```{.r .cell-code}\nmu_at_50 <-\n  mu_at_45 %>% \n  mutate(mu_at_50 = `(Intercept)` + 5 * weight_c)\n\nhead(mu_at_50)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"(Intercept)\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"weight_c\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"sigma\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"mu_at_45\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"mu_at_50\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"155.1421\",\"2\":\"0.8581434\",\"3\":\"5.042898\",\"4\":\"155.1421\",\"5\":\"159.4329\"},{\"1\":\"155.4658\",\"2\":\"0.8348727\",\"3\":\"5.071101\",\"4\":\"155.4658\",\"5\":\"159.6402\"},{\"1\":\"155.4522\",\"2\":\"0.8549260\",\"3\":\"5.144382\",\"4\":\"155.4522\",\"5\":\"159.7269\"},{\"1\":\"155.2342\",\"2\":\"0.8816371\",\"3\":\"5.352756\",\"4\":\"155.2342\",\"5\":\"159.6424\"},{\"1\":\"155.3172\",\"2\":\"0.8745051\",\"3\":\"5.349856\",\"4\":\"155.3172\",\"5\":\"159.6897\"},{\"1\":\"154.9315\",\"2\":\"0.9030495\",\"3\":\"5.207581\",\"4\":\"154.9315\",\"5\":\"159.4467\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\nDie Verteilung der mittleren Größe bei einem Gewicht von 50kg ist weiter \"rechts\" (Richtung höhere Größe) zentriert, s. @fig-mu-at-50.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmu_at_50 %>% \n  ggplot(aes(x = mu_at_50)) +\n  geom_density()\n```\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![Post-Verteilung der mittleren Größe (laut unserem Modell) bedingt auf ein Gewicht von 50 kg](0900-lineare-modelle_files/figure-html/fig-mu-at-50-1.png){#fig-mu-at-50 width=672}\n:::\n:::\n\n\n\n\n\n### Lagemaße und Streuungen\n\nBefragen wir die bedingte Post-Verteilung. Eine erste Frage zielt nach den typischen deskriptiven Statistiken, also nach Lage und Streuung der Verteilung der Körpergröße.\n\n\n\n\nWas ist das 90% PI für $\\mu|w=50$ ?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmu_at_50 %>% \n  eti(mu_at_50, ci = .9)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"Parameter\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"CI\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"CI_low\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"CI_high\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"(Intercept)\",\"2\":\"0.9\",\"3\":\"154.2144131\",\"4\":\"155.0950875\"},{\"1\":\"weight_c\",\"2\":\"0.9\",\"3\":\"0.8358413\",\"4\":\"0.9763181\"},{\"1\":\"sigma\",\"2\":\"0.9\",\"3\":\"4.8298399\",\"4\":\"5.4758137\"},{\"1\":\"mu_at_45\",\"2\":\"0.9\",\"3\":\"154.2144131\",\"4\":\"155.0950875\"},{\"1\":\"mu_at_50\",\"2\":\"0.9\",\"3\":\"158.6294638\",\"4\":\"159.7578370\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\nDie mittlere Größe - gegeben $w=50$ - liegt mit 90% Wahrscheinlichkeit zwischen den beiden Werten (ca.) 159cm und 160cm.\n\n\n\nWelche mittlere Größe wird mit 95% Wahrscheinlichkeit nicht überschritten, wenn die Person 45kg wiegt?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmu_at_45 %>% \n  summarise(q_95 = quantile(mu_at_45, prob = .95))\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"q_95\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"155.0951\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\n\n\n\n\n\n## Prior-Prädiktiv-Verteilung\n\n🏎🏎️ VERTIEFUNG (nicht prüfungsrelevant ) 🏎🏎\n\n\n\n\n### Moment\n\n 🤔 Moment. Dieser Prior, $\\beta_1$ in `m43` erachtet positive und negative Zusammenhang als gleich wahrscheinlich?!\n\nSind wir wirklich indifferent, ob der Zusammenhang von Gewicht und Größe positiv oder negativ ist? [Nein, sind wir nicht.](https://media.giphy.com/media/daPCSjwus6UR2JxRX1/giphy.gif) \n    \n\n\n### Priori-Prädiktiv-Verteilung für `m43`\n\n\n\nWas denkt [wir](https://media.giphy.com/media/Aausss8uUBIe3bZ3d2/giphy.gif) bzw. unser Golem *apriori* über den Zusammenhang von Größe und Gewicht?\nUm diese Frage zu beantworten ziehen wir Stichproben aus den Priori-Verteilungen des Modells, also für $\\beta_0$, $\\beta_1$ und $\\sigma$.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm43_prior_pred <-\n    stan_glm(height ~ weight_c, \n             prior = normal(0, 10),\n             prior_intercept = normal(178, 20),  # mu\n             prior_aux = exponential(0.1),  # sigma\n             refresh = FALSE, \n             prior_PD = TRUE,  # Schalter für Prior-Pred-Verteilung\n             data = d3)\n\n\nm43_prior_pred_draws <- \n  m43_prior_pred %>% \n  as_tibble() %>% \n  rename(a = `(Intercept)`,\n         b = weight_c) %>% \n  slice_sample(n = 50)\n```\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"ehwzvzavic\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#ehwzvzavic table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#ehwzvzavic thead, #ehwzvzavic tbody, #ehwzvzavic tfoot, #ehwzvzavic tr, #ehwzvzavic td, #ehwzvzavic th {\n  border-style: none;\n}\n\n#ehwzvzavic p {\n  margin: 0;\n  padding: 0;\n}\n\n#ehwzvzavic .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#ehwzvzavic .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#ehwzvzavic .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#ehwzvzavic .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#ehwzvzavic .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ehwzvzavic .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ehwzvzavic .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ehwzvzavic .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#ehwzvzavic .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#ehwzvzavic .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#ehwzvzavic .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#ehwzvzavic .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#ehwzvzavic .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#ehwzvzavic .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#ehwzvzavic .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#ehwzvzavic .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#ehwzvzavic .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#ehwzvzavic .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#ehwzvzavic .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ehwzvzavic .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#ehwzvzavic .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#ehwzvzavic .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#ehwzvzavic .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ehwzvzavic .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#ehwzvzavic .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#ehwzvzavic .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ehwzvzavic .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ehwzvzavic .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#ehwzvzavic .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ehwzvzavic .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#ehwzvzavic .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ehwzvzavic .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ehwzvzavic .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ehwzvzavic .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ehwzvzavic .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ehwzvzavic .gt_left {\n  text-align: left;\n}\n\n#ehwzvzavic .gt_center {\n  text-align: center;\n}\n\n#ehwzvzavic .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#ehwzvzavic .gt_font_normal {\n  font-weight: normal;\n}\n\n#ehwzvzavic .gt_font_bold {\n  font-weight: bold;\n}\n\n#ehwzvzavic .gt_font_italic {\n  font-style: italic;\n}\n\n#ehwzvzavic .gt_super {\n  font-size: 65%;\n}\n\n#ehwzvzavic .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#ehwzvzavic .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#ehwzvzavic .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#ehwzvzavic .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#ehwzvzavic .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#ehwzvzavic .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#ehwzvzavic .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"a\">a</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"b\">b</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"sigma\">sigma</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"a\" class=\"gt_row gt_right\">193.0</td>\n<td headers=\"b\" class=\"gt_row gt_right\">24.7</td>\n<td headers=\"sigma\" class=\"gt_row gt_right\">24.6</td></tr>\n    <tr><td headers=\"a\" class=\"gt_row gt_right\">192.1</td>\n<td headers=\"b\" class=\"gt_row gt_right\">1.7</td>\n<td headers=\"sigma\" class=\"gt_row gt_right\">3.1</td></tr>\n    <tr><td headers=\"a\" class=\"gt_row gt_right\">173.1</td>\n<td headers=\"b\" class=\"gt_row gt_right\">−8.3</td>\n<td headers=\"sigma\" class=\"gt_row gt_right\">0.5</td></tr>\n    <tr><td headers=\"a\" class=\"gt_row gt_right\">178.7</td>\n<td headers=\"b\" class=\"gt_row gt_right\">12.3</td>\n<td headers=\"sigma\" class=\"gt_row gt_right\">1.0</td></tr>\n    <tr><td headers=\"a\" class=\"gt_row gt_right\">174.3</td>\n<td headers=\"b\" class=\"gt_row gt_right\">17.6</td>\n<td headers=\"sigma\" class=\"gt_row gt_right\">9.2</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n\nJede Zeile definiert eine Regressionsgerade.\n\n\n\n### Prior-Prädiktiv-Simulation für `m43` mit `stan_glm()` \n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm43_prior_pred <-\n    stan_glm(height ~ weight_c, \n             prior = normal(0, 10),  # beta\n             prior_intercept = normal(178, 20),  # alpha\n             prior_aux = exponential(0.1),  # sigma\n             refresh = FALSE, \n             prior_PD = TRUE,  # DIESER Schalter macht's\n             data = d3)\n\nm43_prior_pred_draws <- \n  m43_prior_pred %>% \n  as_tibble() %>% \n  rename(a = `(Intercept)`,\n         b = weight_c) %>% \n  slice_sample(n = 50)\n```\n:::\n\n::: {.cell}\n\n:::\n\n\n\n\n\n\n\n\n\n\n### Visualisieren der Prior-Prädiktiv-Verteilung\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nd3 %>% ggplot() +\n  geom_point(aes(x = weight_c, y = height)) + \n  geom_abline(data = m43_prior_pred_draws,\naes(intercept = a, slope = b), color = \"skyblue\", size = 0.2) +\n  scale_y_continuous(limits = c(0, 500)) +\n  geom_hline(yintercept = 272, size = .5) +\n  geom_hline(yintercept = 0, linetype = \"dashed\")\n```\n:::\n\n\n\n\n🤯 Einige dieser Regressionsgeraden sind unsinnig!\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nd3 %>% ggplot() +\n  geom_point(aes(x = weight_c, y = height)) + \n  geom_abline(data = m43_prior_pred_draws,\naes(intercept = a, slope = b), color = \"skyblue\", size = 0.2) +\n  scale_y_continuous(limits = c(0, 500)) +\n  geom_hline(yintercept = 272, size = .5) +\n  geom_hline(yintercept = 0, linetype = \"dashed\")\n```\n\n::: {.cell-output-display}\n![](0900-lineare-modelle_files/figure-html/unnamed-chunk-27-1.png){width=672}\n:::\n:::\n\n\n\nDie durchgezogene horizontale Linie gibt die Größe des [größten Menschens, Robert Pershing Wadlow](https://en.wikipedia.org/wiki/Robert_Wadlow), an.\n\n\n\n\n\n### Ein positiver Wert für $\\beta_1$ ist plausibler\n\n\n#### Oh no\n\nEine Normalverteilung mit viel Streuung:\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](0900-lineare-modelle_files/figure-html/Post-Regression-16-1.png){width=672}\n:::\n:::\n\n\n👎 $\\beta=-20$ wäre mit diesem Prior gut möglich: Pro kg Gewicht sind Menschen im Schnitt 20cm kleiner, laut dem Modell. Quatsch.\n\n\n\n\n#### Oh yes\n\nWir bräuchten eher so eine Verteilung, mit mehr Masse auf der positiven Seite (x>0):\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](0900-lineare-modelle_files/figure-html/Post-Regression-17-1.png){width=672}\n:::\n:::\n\n\n👍 Vermutlich besser: Ein Großteil der Wahrscheinlichkeitsmasse ist $X>0$. Allerdings gibt's keine Gewähr, dass unser Prior \"richtig\" ist.\n\n\n\n\n### Priori-Prädiktiv-Simulation, 2. Versuch\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm43a_prior_pred <-\n    stan_glm(\n      height ~ weight_c, \n      prior = normal(2, 2),  # Regressionsgewicht\n      prior_intercept = normal(178, 20),  # mu\n      prior_aux = exponential(0.1),  # sigma\n      refresh = FALSE, \n      # Schalter für Prior-Pred-Verteilung:\n      prior_PD = TRUE, \n      data = d3)\n\n\nm43a_prior_pred_draws <- \n  m43a_prior_pred %>% \n  as_tibble() %>% \n  # Spaltennamen kürzen: \n  rename(a = `(Intercept)`) %>%  \n  rename(b = weight_c,\n         s = sigma)\n```\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"zhhlidaxhb\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#zhhlidaxhb table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#zhhlidaxhb thead, #zhhlidaxhb tbody, #zhhlidaxhb tfoot, #zhhlidaxhb tr, #zhhlidaxhb td, #zhhlidaxhb th {\n  border-style: none;\n}\n\n#zhhlidaxhb p {\n  margin: 0;\n  padding: 0;\n}\n\n#zhhlidaxhb .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#zhhlidaxhb .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#zhhlidaxhb .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#zhhlidaxhb .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#zhhlidaxhb .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#zhhlidaxhb .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#zhhlidaxhb .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#zhhlidaxhb .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#zhhlidaxhb .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#zhhlidaxhb .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#zhhlidaxhb .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#zhhlidaxhb .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#zhhlidaxhb .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#zhhlidaxhb .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#zhhlidaxhb .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#zhhlidaxhb .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#zhhlidaxhb .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#zhhlidaxhb .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#zhhlidaxhb .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#zhhlidaxhb .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#zhhlidaxhb .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#zhhlidaxhb .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#zhhlidaxhb .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#zhhlidaxhb .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#zhhlidaxhb .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#zhhlidaxhb .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#zhhlidaxhb .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#zhhlidaxhb .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#zhhlidaxhb .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#zhhlidaxhb .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#zhhlidaxhb .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#zhhlidaxhb .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#zhhlidaxhb .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#zhhlidaxhb .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#zhhlidaxhb .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#zhhlidaxhb .gt_left {\n  text-align: left;\n}\n\n#zhhlidaxhb .gt_center {\n  text-align: center;\n}\n\n#zhhlidaxhb .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#zhhlidaxhb .gt_font_normal {\n  font-weight: normal;\n}\n\n#zhhlidaxhb .gt_font_bold {\n  font-weight: bold;\n}\n\n#zhhlidaxhb .gt_font_italic {\n  font-style: italic;\n}\n\n#zhhlidaxhb .gt_super {\n  font-size: 65%;\n}\n\n#zhhlidaxhb .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#zhhlidaxhb .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#zhhlidaxhb .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#zhhlidaxhb .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#zhhlidaxhb .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#zhhlidaxhb .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#zhhlidaxhb .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"a\">a</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"b\">b</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"s\">s</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"a\" class=\"gt_row gt_right\">187.0</td>\n<td headers=\"b\" class=\"gt_row gt_right\">0.6</td>\n<td headers=\"s\" class=\"gt_row gt_right\">10.9</td></tr>\n    <tr><td headers=\"a\" class=\"gt_row gt_right\">170.6</td>\n<td headers=\"b\" class=\"gt_row gt_right\">7.2</td>\n<td headers=\"s\" class=\"gt_row gt_right\">11.5</td></tr>\n    <tr><td headers=\"a\" class=\"gt_row gt_right\">182.1</td>\n<td headers=\"b\" class=\"gt_row gt_right\">3.4</td>\n<td headers=\"s\" class=\"gt_row gt_right\">22.5</td></tr>\n    <tr><td headers=\"a\" class=\"gt_row gt_right\">184.6</td>\n<td headers=\"b\" class=\"gt_row gt_right\">−0.2</td>\n<td headers=\"s\" class=\"gt_row gt_right\">5.5</td></tr>\n    <tr><td headers=\"a\" class=\"gt_row gt_right\">185.7</td>\n<td headers=\"b\" class=\"gt_row gt_right\">1.2</td>\n<td headers=\"s\" class=\"gt_row gt_right\">3.7</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n\nDas Argument `prior_PD = TRUE` sorgt dafür, dass keine Posteriori-Verteilung, sondern eine Prior-Prädiktiv-Verteilung berechnet wird.\n\n\n\n\n### Visualisieren der Prior-Prädiktiv-Verteilung, `m43a`\n\n\nUnsere Priori-Werte scheinen einigermaßen vernünftige Vorhersagen zu tätigen. Allerdings erwartet unser Golem einige Riesen.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nd3 %>% \n  ggplot(aes(x = weight_c, y = height)) +\n  geom_point() +\n  geom_abline(data = {m43a_prior_pred_draws %>% slice_head(n=50)},\n              aes(slope = b,\n                  intercept = a),\n              color = \"skyblue\",\n              size = .2,\n              alpha = .7) +\n  geom_hline(yintercept = 272, size = .5) +\n  geom_hline(yintercept = 0, linetype = \"dashed\")+\n  scale_y_continuous(limits = c(0, 500)) \n```\n\n::: {.cell-output-display}\n![](0900-lineare-modelle_files/figure-html/unnamed-chunk-30-1.png){width=672}\n:::\n:::\n\n\n\nDie durchgezogene horizontale Linie gibt die Größe des [größten Menschens, Robert Pershing Wadlow](https://en.wikipedia.org/wiki/Robert_Wadlow), an.\n\n\n\n\n\n\n\n\n### Moment, kann hier jeder machen, was er will?\n\n\n\nEs doch den einen, richtigen, objektiven Priori-Wert geben?!\n\nKann denn jeder hier machen, was er will?! Wo kommen wir da hin?!\n\n\n>    This is a mistake. There is no more a uniquely correct prior than there is a uniquely correct likelihood. Statistical models are machines for inference. Many machines will work, but some work better than others. Priors can be wrong, but only in the same sense that a kind of hammer can be wrong for building a table.  \n\n@mcelreath_statistical_2020, p. 96.\n\n\n\n\n\n### Hier ist unser Modell, `m43a`\n\n\n\n\n\\begin{align}\n\\text{height}_i &\\sim \\operatorname{Normal}(\\mu_i, \\sigma) \\\\\n\\mu_i &= \\alpha + \\beta \\cdot  \\text{weight}_i\\\\\n\\alpha &\\sim \\operatorname{Normal}(178, 20)\\\\\n\\beta &\\sim \\operatorname{Normal}(5,3)\\\\\n\\sigma &\\sim \\operatorname{Exp}(0.1)\n\\end{align}\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Posteriori-Vert. berechnen:\nm43a <-\n  stan_glm(\n    height ~ weight_c,  # Regressionsformel\n    prior = normal(5, 3),  # Regressionsgewicht (beta 1)\n    prior_intercept = normal(178, 20),  # mu\n    prior_aux = exponential(0.1),  # sigma\n    refresh = 0,  # zeig mir keine Details\n    seed = 42,  # Zufallszahlen festlegen\n    data = d3)\n```\n:::\n\n\n\n\n\n\n### Eine Zusammenfassung der Posteriori-Verteilung für `m43a`\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm43a %>% \n  parameters()\n```\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n\n\n|Parameter   | Median |           95% CI |   pd |  Rhat |     ESS |              Prior |\n|:-----------|:------:|:----------------:|:----:|:-----:|:-------:|:------------------:|\n|(Intercept) | 154.65 | (154.14, 155.19) | 100% | 0.999 | 3214.00 | Normal (178 +- 20) |\n|weight_c    |   0.91 |     (0.82, 0.99) | 100% | 1.001 | 4134.00 |    Normal (5 +- 3) |\n\n\n:::\n:::\n\n\n\n\nUnser Modell `m43a` schätzt die typische Körpergröße einer !Kung-Person *mittleren Gewichts* (`weight_c = 0`) auf knapp 155 cm, und ist sich dieses Werts ziemlich sicher.\nPro Kilogramm kommt (laut unserem Modell) ein knapper Zentimeter hinzu, typischerweise;\nauch hier ist sich das Modell ziemlich sicher, da dass zugehörige 95%-CI keine 20 Zentimenter umfasst.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n## Die PPV befragen\n\n\n🏎🏎️ VERTIEFUNG (nicht prüfungsrelevant ) 🏎🏎\n\n\n\n\n\n\n\n\nDie Posterior-Prädiktiv-Verteilung (PPV) gibt uns die Möglichkeit,\nnach der Wahrscheinlichkeit *tatsächlicher* Körpergrößen zu fragen - \nund nicht nur nach *mittleren* Körpergrößen anhand der Post-Verteilung.\n\n\n:::callout-important\nDie Post-Verteilung macht *nur* Aussagen zur *mittleren* Körpergröße,\ndenn das ist was wir modellieren wollten.\nMöchten wir Aussagen zur Wahrscheinlichkeit *tatsächlicher* Größen treffen,\nbrauchen wir die PPV.\nAllgemeiner gesagt: Die PPV macht Vorhersagen auf Basis eines Modells. \nFür jede Vorhersage gibt es eine Verteilung, \ndie wir zu einem Punktschätzer (z.B. Median) und einem Schätzbereich (z.B. 89%-HDI) zusammenfassen können.\n:::\n\nAn dieser Stelle sollten wir uns vor Augen führen, dass die PPV *mehr* Ungewissheit beinhaltet,\ndenn sie berücksichtigt derer zweier Arten:\n\n1. Ungewissheit bzgl. der Modellparameter (Steigung und Achsenabschnitt der Regressionsgeraden)\n2. Ungewissheit der Vorhersagen (das Modell macht keine perfekten Vorhersagen)\n\n\nDie *Post-Verteilung* berücksichtigt nur die Ungewissheit in den Modellparametern,\nmacht also nur Aussagen zur Regressionsgeraden.\n\nDie PPV macht Aussagen für konkrete Beobachtungen.\nDer Unterschied ist in @fig-ppv-vs-post dargestellt; die Funktionen stammen übrigens aus `{easystats}`.\n\n\n\n::: {#fig-ppv-vs-post .cell layout-ncol=\"2\"}\n\n```{.r .cell-code}\nestimate_prediction(m43a) %>% plot()\nestimate_relation(m43a) %>% plot()\n```\n\n::: {.cell-output-display}\n![PPV mit viel Ungewissheit](0900-lineare-modelle_files/figure-html/fig-ppv-vs-post-1.png){#fig-ppv-vs-post-1 width=672}\n:::\n\n::: {.cell-output-display}\n![Post-Verteilung mit wenig(er) Ungewissheit](0900-lineare-modelle_files/figure-html/fig-ppv-vs-post-2.png){#fig-ppv-vs-post-2 width=672}\n:::\n\nPPV vs. Post-Verteilung\n:::\n\n\n\n### Perzentil-Intervalle für bestimmte Prädiktor-Werte\n\n\n\n>    Wie groß ist ein !Kung-Mann mit mittlerem Gewicht?\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(42)\nestimate_prediction(m43a, data = tibble(weight_c = 0), seed = 42)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"weight_c\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Predicted\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"SE\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"CI_low\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"CI_high\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"0\",\"2\":\"154.5787\",\"3\":\"5.162584\",\"4\":\"144.2798\",\"5\":\"164.5835\",\"_rn_\":\"1\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\nUnser Modell, `ma43a` schätzt ca. 145cm bis 165cm.\n\n\nWir können uns auch eine Sequenz an Prädiktorwerten, die uns interessieren, erstellen, s. `weight_df`:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nweight_df <- tibble(weight_c = seq(-20,20, by = 5))\n```\n:::\n\n\n\nFür diese Werte lassen wir uns dann die Perzentil-Intervalle (PI) ausgeben:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmus <- \n  estimate_prediction(m43a, data = weight_df) \n\nhead(mus)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"weight_c\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Predicted\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"SE\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"CI_low\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"CI_high\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"-20\",\"2\":\"136.5669\",\"3\":\"5.371291\",\"4\":\"125.8810\",\"5\":\"147.3205\",\"_rn_\":\"1\"},{\"1\":\"-15\",\"2\":\"141.0826\",\"3\":\"5.250343\",\"4\":\"130.6368\",\"5\":\"151.1919\",\"_rn_\":\"2\"},{\"1\":\"-10\",\"2\":\"145.7617\",\"3\":\"5.144039\",\"4\":\"135.5270\",\"5\":\"155.5853\",\"_rn_\":\"3\"},{\"1\":\"-5\",\"2\":\"150.0022\",\"3\":\"5.174693\",\"4\":\"139.5637\",\"5\":\"159.9117\",\"_rn_\":\"4\"},{\"1\":\"0\",\"2\":\"154.5556\",\"3\":\"5.178200\",\"4\":\"144.5177\",\"5\":\"164.8595\",\"_rn_\":\"5\"},{\"1\":\"5\",\"2\":\"159.2914\",\"3\":\"5.138765\",\"4\":\"149.2243\",\"5\":\"169.2083\",\"_rn_\":\"6\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\nUm die Perzentilintervalle zu erstellen, wird von `estimate_prediction()` für jeden Prädiktorwert eine PPV erstellt und (in der Voreinstellung) das 5%- sowie 95%-Quantil dafür berechnet. \nSie können die Voreinstellung ändern mittels des Arguments `ci`;\num ein 89%-PI zu berechnen, würde man z.B. schreiben `ci = .89`.\n\nUm Reproduzierbarkeit sicherzustellen,\nhaben wir mit `set.seed(42)` die Zufallszahlen fixiert.\n\n\nHoppla! Das ist ja viel ungenauer, als die Angaben der Post-Verteilung oben.\nJa, denn die Post-Verteilung hat die Ungewissheit zum *Mittelwert* ausgedrückt;\ndie PPV gibt die Ungewissheit *tatsächlicher* beobachtbarer Körpergrößen aus,\nnicht nur die Ungewissheit zum Mittelwert.\n\n\nBerechnen wir die PPV für die bestehenden Beobachtungen aus `m43a`:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nppv_m43a <- estimate_prediction(\n  m43a,\n  data = weight_df)\n\nmus \n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"weight_c\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Predicted\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"SE\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"CI_low\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"CI_high\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"-20\",\"2\":\"136.5669\",\"3\":\"5.371291\",\"4\":\"125.8810\",\"5\":\"147.3205\",\"_rn_\":\"1\"},{\"1\":\"-15\",\"2\":\"141.0826\",\"3\":\"5.250343\",\"4\":\"130.6368\",\"5\":\"151.1919\",\"_rn_\":\"2\"},{\"1\":\"-10\",\"2\":\"145.7617\",\"3\":\"5.144039\",\"4\":\"135.5270\",\"5\":\"155.5853\",\"_rn_\":\"3\"},{\"1\":\"-5\",\"2\":\"150.0022\",\"3\":\"5.174693\",\"4\":\"139.5637\",\"5\":\"159.9117\",\"_rn_\":\"4\"},{\"1\":\"0\",\"2\":\"154.5556\",\"3\":\"5.178200\",\"4\":\"144.5177\",\"5\":\"164.8595\",\"_rn_\":\"5\"},{\"1\":\"5\",\"2\":\"159.2914\",\"3\":\"5.138765\",\"4\":\"149.2243\",\"5\":\"169.2083\",\"_rn_\":\"6\"},{\"1\":\"10\",\"2\":\"163.6660\",\"3\":\"5.220188\",\"4\":\"153.4377\",\"5\":\"174.0912\",\"_rn_\":\"7\"},{\"1\":\"15\",\"2\":\"168.2456\",\"3\":\"5.249081\",\"4\":\"158.2699\",\"5\":\"178.4302\",\"_rn_\":\"8\"},{\"1\":\"20\",\"2\":\"172.7290\",\"3\":\"5.322229\",\"4\":\"162.4394\",\"5\":\"183.2873\",\"_rn_\":\"9\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\n\n\n\n\n### Perzentilintervalle für verschiedenen Prädiktorwerte visualisiert\n\n@fig-m43a-nochmal visualisiert die Ungewissheit von Vorhersagen laut der PPV.\nDie Ungewissheit in @fig-m43a-nochmal ist die Antwort auf die Frage: \"Wie sicher sind wir uns,\nzur Größe einer !Kung-Person, gegeben dass die z.B. 10 kg mehr als der Durchschnitt wiegt?\"\nEine Vorhersage bezeichnet man auch als \"bedingte Verteilung\", da man den Wert einer Verteilung voraussagt,\n*gegeben* einer Bedingung, z.B. `weight_c = 10`.  \n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![Visualisierung der Ungewissheit der Vorhersagen laut PPV: Die Vorhersage von Beobachtungen beinhaltet mehr Ungewissheit als die Vorhersage von zu erwartenden Werten, daher sind die Ungewissheitsintervalle der PPV größer als die der Post-Verteilung.](0900-lineare-modelle_files/figure-html/fig-m43a-nochmal-1.png){#fig-m43a-nochmal width=672}\n:::\n:::\n\n\n\nDie vertikalen Balken geben die 95%-KI wieder, die wir jeweils zu erwarten haben.\n\nNoch eine andere Visualisierung, s. @fig-katzenaugen; \nje dicker die \"Katzenaugen\", desto mehr Stichproben (samples) liegen vor an der Stelle,\nund umso genauer ist die Schätzung.\n\n\n\n::: {.cell layout-ncol=\"2\"}\n::: {.cell-output-display}\n![Die PPV für bestimmte Gewichtswerte w, visualisiert mit Katzenaugen-Diagrammen](0900-lineare-modelle_files/figure-html/fig-katzenaugen-1.png){#fig-katzenaugen width=672}\n:::\n:::\n\n\n\nAlso: Je dicker die Violine, desto wahrscheinlicher $\\mu | w_i$.\n\n\n\n### Die PPV über alle Beobachtungen visualisiert\n\nGerade eben haben wir *bedingte* PPVen angeschaut: Also eine PPV für einen *bestimmten* Prädiktorwert, z.B. bei einer Person mittleren Gewichts.\nWir können auch den Mittelwert über alle bedingten PPV anschauen, sozusagen die \"*Master-PPV*\" oder \"unbedingte PPV\" oder schlicht PPV.\nVergleichen wir die echten Werte für `height`, $y$, mit den von der PPV simulierten Werten für `height`, $y_{rep}$, s. @fig-ppv-check.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncheck_predictions(m43a)  # aus easystatss\n```\n\n::: {.cell-output-display}\n![Vergleich der Vorhersagen für y (leichte, blaue Linien) mit der beobachteten Verteilung von y](0900-lineare-modelle_files/figure-html/fig-ppv-check-1.png){#fig-ppv-check width=672}\n:::\n:::\n\n\n`?check_predictions` zeigt Hilfe für diese Funktion. \nDie Funktion zeigt die Vorhersagen für die AV laut der Posteriori-Verteilung.\n\n\n\nDie zwei Gipfel hat unser Modell nicht mitgekriegt, \nansonsten decken sich die Vorhersagen der PPV gut mit den echten Daten.\n\n\n\n\n\n\n\n\n### Fragen an die Master-PPV\n\n- Wie groß sind die !Kung im Schnitt?\n- Welche Größe wird von 90% der Personen nicht überschritten?\n- Wie groß sind die 10% kleinsten?\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nppv_m43a <- posterior_predict(\n  m43a,\n  newdata = weight_df,\n  draws = 100) %>% \n  as_tibble() %>% \n  pivot_longer(\n    cols = everything(),\n    names_to = \"weight_condition\",\n    values_to = \"height\")\nhead(ppv_m43a)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"weight_condition\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"height\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1\",\"2\":\"132.5265\"},{\"1\":\"2\",\"2\":\"136.7188\"},{\"1\":\"3\",\"2\":\"147.7576\"},{\"1\":\"4\",\"2\":\"143.1540\"},{\"1\":\"5\",\"2\":\"156.0412\"},{\"1\":\"6\",\"2\":\"157.4500\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nppv_m43a <-\n  ppv_m43a <- posterior_predict(\n  m43a,\n  newdata = weight_df,\n  draws = 100) %>% \n  as_tibble() %>% \n  pivot_longer(\n    cols = everything(),\n    names_to = \"weight_condition\",\n    values_to = \"height\")\n\nhead(ppv_m43a)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"weight_condition\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"height\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1\",\"2\":\"144.0829\"},{\"1\":\"2\",\"2\":\"144.6354\"},{\"1\":\"3\",\"2\":\"141.7168\"},{\"1\":\"4\",\"2\":\"153.3734\"},{\"1\":\"5\",\"2\":\"153.9631\"},{\"1\":\"6\",\"2\":\"157.1561\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nppv_m43a %>% \n  summarise(\n    q_10 = quantile(height, prob = .1),\n    height_mean = mean(height),\n    q_50 = quantile(height, prob = .5),\n    q_90 = quantile(height, prob = .9)\n  )\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"q_10\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"height_mean\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"q_50\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"q_90\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"137.6442\",\"2\":\"154.7309\",\"3\":\"154.7682\",\"4\":\"171.8652\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\nWas ist der 50% Bereich der Körpergröße?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nppv_m43a %>% \n  eti(ci = .5)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"Parameter\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"CI\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"CI_low\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"CI_high\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"height\",\"2\":\"0.5\",\"3\":\"144.9652\",\"4\":\"165.2586\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\n## Fazit\n\n\n\n### Ausstieg\n\n:::{#exm-ausstieg-post}\n### Fassen Sie das Wesentliche zusammen!\nSchreiben Sie 5-10 Sätze zum Wesentlichen Stoff dieses Kapitels und reichen Sie bei der von Lehrkraft vorgegebenen Stelle ein! $\\square$\n:::\n\n\n### Vertiefung\n\n@mcelreath_statistical_2020 bietet eine tiefere Darstellung von linearen Modellen auf Basis der Bayes-Statistik, insbesondere Kapitel 4 daraus vertieft die Themen dieses Kapitels. @kurz_statistical_2021 greift die R-Inhalte von @mcelreath_statistical_2020 auf und setzt sie mit anderen R-Methoden um; ein interessanter Blickwinkel, wenn man tiefer in die R-Umsetzung einsteigen möchte.\n@gelman_regression_2021 bieten ebenfalls viele erhellende Einblicke in das Thema Regressionsanalyse, sowohl aus einem frequentistischen als auch aus einer Bayes-Perspektive.\n\n## Aufgaben\n\n\n\n1. [Bayes-Ziel1](https://datenwerk.netlify.app/posts/bayes-ziel1/bayes-ziel1)\n2. [Bayesmod-bestimmen01](https://datenwerk.netlify.app/posts/bayesmod-bestimmen01/bayesmod-bestimmen01)\n3. [Likelihood2](https://datenwerk.netlify.app/posts/likelihood2/likelihood2)\n4. [Post-befragen1](https://datenwerk.netlify.app/posts/post-befragen1/post-befragen1)\n5. [Postvert-Regr-01](https://datenwerk.netlify.app/posts/postvert-regr-01/postvert-regr-01)\n6. [regression1a](https://datenwerk.netlify.app/posts/regression1a/regression1a.html)\n7. [Regression2](https://datenwerk.netlify.app/posts/regression2/regression2)\n8. [Bed-Post-Wskt1](https://datenwerk.netlify.app/posts/bed-post-wskt1/bed-post-wskt1)\n9. [Priorwahl1](https://datenwerk.netlify.app/posts/priorwahl1/priorwahl1)\n10. [Bayesmod-bestimmen02](https://datenwerk.netlify.app/posts/bayesmod-bestimmen02/bayesmod-bestimmen02)\n11. [Aussagen-einfache-Regr](https://datenwerk.netlify.app/posts/aussagen-einfache-regr/aussagen-einfache-regr)\n12. [Likelihood-identifizieren](https://datenwerk.netlify.app/posts/likelihood-identifizieren/likelihood-identifizieren)\n13. [Priorwahl2](https://datenwerk.netlify.app/posts/priorwahl2/priorwahl2)\n14. [penguins-stan-01](https://datenwerk.netlify.app/posts/penguins-stan-01/penguins-stan-01.html)\n\n\n\n\n\n\n\n\n## ---\n\n\n\n![](img/outro-09.jpg){width=100%}\n\n\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}