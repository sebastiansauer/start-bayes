{
  "hash": "f5a92a9d117345f1b0be52ba56bfad30",
  "result": {
    "markdown": "# Vorhersage-Verteilung\n\n\n\n\n![Bayes:Start!](img/Golem_hex.png){width=5%}\n\n\n\n\n\n\n\n\n## Lernsteuerung\n\n\n### Lernziele\n\nNach Absolvieren des jeweiligen Kapitels sollen folgende Lernziele erreicht sein.\n\nSie k√∂nnen ...\n\n- erl√§utern, was eine Posteriori-Pr√§diktiv-Verteilung (PPV) ist, und inwiefern Sie vor √úbergewissheit sch√ºtzt\n- eine informelle Modellpr√ºfung f√ºr das Beispiel aus dem Unterricht anhand der Posteriori-Pr√§diktiv-Verteilung durchf√ºhren\n\n\n\n### Vorbereitung im Eigenstudium\n\n- [Statistik1, Kap. \"Daten verbildlichen\"](https://statistik1.netlify.app/040-verbildlichen#vertiefung)\n\n\n### Ben√∂tigte R-Pakete\n\n\n\n\n\n\n::: {.cell hash='0700-ppv_cache/html/unnamed-chunk-2_933450c8f708de6083a3bab9b545641b'}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(ggpubr)  # dataviz\n```\n:::\n\n::: {.cell hash='0700-ppv_cache/html/QM2-Thema2-kleineModelle-28_c5f1fdfcd78a9a653b107b97440bf311'}\n\n:::\n\n\n\n\n\n## Der zwielichte Dozent: Stichproben-Vert. vs. Post-Vert.\n\nIn einer dunklen Gasse fordert Sie ein Statistik-Dozent zu einem Gl√ºcksspiel heraus^[Hier br√§uchte es ein passendes Meme; Vorschl√§ge bitte an mich.]. M√ºnzwurf; wenn er gewinnt, m√ºssen Sie 10 Euro zahlen. Gewinnen Sie, bekommen Sie 11 Euro. Klingt nach einer guten Partie, nicht war? Nat√ºrlich nehmen Sie sofort an. \n\nSie spielen also M√ºnzwurf; der Dozent setzt auf Zahl. Sie spielen 10 Runden. Leider gewinnt der Dozent 9 von 10 Mal^[was er mit lautem Gel√§chter quittiert].\n\n*Ist die M√ºnze fair oder zieht der mich √ºber den Tisch?*, das ist die Frage, \ndie Ihnen brennend durch den Kopf zieht.\n\n\"Sind 9 von 10 Treffern noch realistisch erwartbar, wenn es mit rechten Dingen zugeht,\noder beweist das Ergebnis, dass die M√ºnze gezinkt ist?\"\n\nW√ºtend (und mit leeren Taschen) ziehen Sie von dannen.\n\n\nZusammengefasst: Daten: 9 von 10 Treffern beim M√ºnzwurf. Forschungsfrage: Ist die M√ºnze fair?\n\n\nSchauen wir uns zun√§chst einmal an, wie wahrscheinlich 9 von 10 Treffern sind,\n*wenn* die M√ºnze fair ist, s. @fig-stiprovert-post-zwielicht, links.\n\n\n\n::: {.cell hash='0700-ppv_cache/html/QM2-Thema3-Post-befragen-21_8c121e07ac63897a47f36effbc09420d'}\n\n:::\n\n\nDie *Stichprobenverteilung* zeigt, wie wahrscheinlich die empirischen Daten $D$ (z.B. 9 von 10 Treffer) sind, *gegeben* eines Parameterwerts $\\pi$ (z.B. $p=0.5$): $Pr(D|\\pi)$^[Das griechische kleine $p$ wird \"pi\" genannt und $\\pi$ geschrieben. Zur Erinnerung: Parameter- oder Populationskennwerte werden in der Statistik h√§ufig mit griechischen Buchstaben benannt, um sie von Stichprobenkennwerten abzugrenzen.].\n\nAnders gesagt, die Stichprobenverteilung zeigt die Verteilung der Likelihoods eines bestimmten Parameterwerts.\n\n\n\nIn der Bayes-Statistik ist die Post-Verteilung Dreh- und Angelpunkt der Entscheidung √ºber eine Hypothese.\nIn @fig-stiprovert-post-zwielicht ist die Posteriori-Verteilung f√ºr die Daten zum zwielichten Dozent dargestellt.\n\n\n\n\n::: {.cell hash='0700-ppv_cache/html/zwielicht-daten_1be0f73c4a6b197beb6287905af12e55'}\n\n```{.r .cell-code}\n# Post-Verteilung:\nd_zwielicht <-\n  tibble(\n    p_grid = seq( from=0 , to=1 , length.out=100),\n    prior = 1,  # Priori-Gewichte\n    likelihood = dbinom(8, size = 10, prob=p_grid) ,\n    unstandardisierte_posterior = likelihood * prior ,\n    posterior = unstandardisierte_posterior / sum(unstandardisierte_posterior))\n\n# Stichproben ziehen aus der Posteriori-Verteilung:\nsamples_zwielicht <- \n  tibble(\n    gewinnchance_muenze = sample(\n      d_zwielicht$p_grid , \n      prob=d_zwielicht$posterior, \n      size=1e4, \n      replace=TRUE)) %>% \n  mutate(\n    id = row_number())\n```\n:::\n\n::: {.cell hash='0700-ppv_cache/html/fig-stiprovert-post-zwielicht_308f43c8960a6138e1d26b2ec9b7c72c'}\n::: {.cell-output-display}\n![Post-Verteilung f√ºr den Parameter p zu den Daten des zwielichten Dozenten (9 von 10 Treffern im wiederholten M√ºnzwurf)](0700-ppv_files/figure-html/fig-stiprovert-post-zwielicht-1.png){#fig-stiprovert-post-zwielicht width=672}\n:::\n:::\n\n::: {.cell hash='0700-ppv_cache/html/unnamed-chunk-3_ad1d12b6b34cdf0862d9131bf2f33ba8'}\n\n```{.r .cell-code}\ngghistogram(samples_zwielicht,\n            x = \"gewinnchance_muenze\",\n            title = \"Posteriori-Verteilung f√ºr p\",\n            subtitle = \"Priori: Gleichverteilung; Daten: 9 von 10 Treffern, binomialverteilt\",\n            xlab = \"p (Gewinchance der M√ºnze)\",\n            fill = \"grey60\") +\n  geom_vline(xintercept = 0.5)\n```\n:::\n\n\nHilfe f√ºr die Funktion `gghistogram()` finden Sie auf der [Hilfeseite der Funktion](https://rpkgs.datanovia.com/ggpubr/reference/gghistogram.html).\n\nDie *Posteriori-Verteilung* gibt die Wahrscheinlichkeit jedes Parameterwerts $p$ wider, gegeben der empirischen Daten $D$: $Pr(p|D)$. \n\n\nDie meisten Forschungsfragen lassen sich mit der Post-Verteilung beantworten, nicht mit der Stichprobenverteilung.\n\n\nJetzt k√∂nnen wir wieder die Post-Verteilung auslesen,\num die Hypothese zu beantworten.\nSchauen wir uns einige Beispiel dazu an.\n\n\n:::{#exm-zwielicht1}\n\n### Einigerma√üen fair?\n\nWie wahrscheinlich ist es, dass die M√ºnze \"einigerma√üen\" fair ist,\nsagen wir, eine Trefferwahrscheinlichkeit $0.45 < \\pi < 0.55$^[zwischen 45% und 55% mit anderen Worten] aufweist?\n\n\n\n::: {.cell hash='0700-ppv_cache/html/unnamed-chunk-4_2aa5f8a580c7a68c9ce591a4267f055a'}\n\n```{.r .cell-code}\nsamples_zwielicht %>% \n  count(gewinnchance_muenze > 0.45 & gewinnchance_muenze < 0.55) %>% \n  mutate(prop = n/sum(n))\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"gewinnchance_muenze > 0.45 & gewinnchance_muenze < 0.55\"],\"name\":[1],\"type\":[\"lgl\"],\"align\":[\"right\"]},{\"label\":[\"n\"],\"name\":[2],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"prop\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"FALSE\",\"2\":\"9485\",\"3\":\"0.9485\"},{\"1\":\"TRUE\",\"2\":\"515\",\"3\":\"0.0515\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\nDie Wahrscheinlichkeit f√ºr eine \"einigerma√üen faire\" M√ºnze ist klein, etwa 5%!\n\n:::\n\n\n:::{#exr-vis-zwieliecht}\n### Visualisieren Sie @fig-stiprovert-post-zwielicht\nSie finden Details zur Aufgabenstellung (sowie die L√∂sung üôà) [hier](https://datenwerk.netlify.app/posts/postvert-vis-zwielicht/postvert-vis-zwielicht).$\\square$\n:::\n\n\n:::{#exm-zwielicht2}\n\n### M√ºnze gezinkt?\n\nSchauen wir uns an, wie wahrscheinlich es ist - gegeben der Daten und unserem Modell -\ndass die M√ºnze massiv gezinkt ist. \"Massiv\" definieren wir dabei mit \"mindestens 70% Trefferwahrscheinlichkeit\"^[ja, das ist subjektiv], also $\\pi >= .7$^[F√ºhrende Nullen bei Anteilen werden oft weggelassen, man schreibt also oft .7 wenn man 0.7 bzw. 70% meint. Das ist nicht nur k√ºrzer, sondern man wei√ü auch direkt dass es sich um einen Anteil handelt. Beh√§lt man die f√ºhrende Null bei, etwa 0.77, so w√ºrde das signalisieren, dass die Zahl auch gr√∂√üer als Null sein k√∂nnte.].\n\n\n::: {.cell hash='0700-ppv_cache/html/unnamed-chunk-5_142198ac41b5c695202b0cf75a648a51'}\n\n```{.r .cell-code}\nsamples_zwielicht %>% \n  count(gewinnchance_muenze > .7) %>% \n  mutate(prop = n / sum(n))\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"gewinnchance_muenze > 0.7\"],\"name\":[1],\"type\":[\"lgl\"],\"align\":[\"right\"]},{\"label\":[\"n\"],\"name\":[2],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"prop\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"FALSE\",\"2\":\"3211\",\"3\":\"0.3211\"},{\"1\":\"TRUE\",\"2\":\"6789\",\"3\":\"0.6789\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\nWir finden eine recht hohe Wahrscheinlichkeit f√ºr eine \"massive\" Manipulation der M√ºnze.\n\n:::\n\n\n:::callout-important\nIst es nicht einfach und sch√∂n, wie wir mit Hilfe des Stichprobenziehens allerlei Forschungsfragen beantworten k√∂nnen?\nEine Post-Verteilung aus Stichproben erlaubt uns, viele Fragen mit einfachen Methoden,\nn√§mlich schlichtes Z√§hlen, zu beantworten.\n:::\n\nNat√ºrlich k√∂nnte (und sollte?) man unser Modell kritisieren.\nIst es wirklich sinnvoll, die Trefferwahrscheinlichkeit apriori als gleichverteilt anzunehmen?\nDas hei√üt ja, wir glauben, dass eine Trefferwahrscheinlichkeit von 99,99999% genauso wahrscheinlich ist wie 50,55555%.\nAuf der anderen Seite: Der Charme einer Gleichverteilung ist, dass sie objektiv ist,\nin dem Sinne, dass wir keinerlei Information einflie√üen lassen.\nWir sind indifferent gegen√ºber dem Parameter $\\pi$, der Trefferwahrscheinlichkeit.\n\n\n\n:::callout-note\nIn einem zweiten Versuch k√∂nnten wir jetzt unsere Post-Verteilung als Priori-Verteilung \nnutzen. \nDas Ergebnis des ersten Versuchs wird dann hergenommen als Ausgangspunkt f√ºr \neinen zweiten Versuch.\nDamit wird das Wissen der Wissenschaft weitergegeben^[√ºbrigens auf mathematisch gesehen ideale Art und Weise.], so wie es sein sollte.\n:::\n\n\n\n## Mit Stichproben neue Beobachtungen simulieren\n\n\nZur Erinnerung: Der Likelihood (L) zeigt die Wahrscheinlichkeit eine Trefferzahl gegeben eines bestimmten Parameterwerts.\nIn unseren Beispiel k√∂nnten wir z.B. die drei Likelihoods f√ºr $w=0,1,2$ ausrechnen, gegeben $N=2$ und $p = 0.5$:\n\n\n::: {.cell hash='0700-ppv_cache/html/QM2-Thema3-Post-befragen-23_cbf535805485a61e42a215d6712d6ea0'}\n\n```{.r .cell-code}\nL <- dbinom(0:2, size = 2, prob = 0.5)\nL\n## [1] 0.25 0.50 0.25\n```\n:::\n\n\n\nAh, die Wahrscheinlichkeit f√ºr 0 oder 2 Treffer betr√§gt 50%, wenn $pi=1/2$; f√ºr 1 Treffer betr√§gt sie entsprechend 50%^[das sollte uns bekannt vorkommen].\n\n\n\n### Wir simulieren die Wasserzahl bei Globusw√ºrfen {#sec-rbinom}\n\nZur√ºck zu unserem Globusversuch!\n\nWir k√∂nnten uns jetzt Globusb√§lle basteln mit verschiedenen Wasseranteilen, \nund diese oft hochwerfen.\nDamit k√∂nnten wir herausfinden, welche Trefferzahlen sich bei verschiedenen Wasseranteilen finden lassen w√ºrden.\n\nWer gerne bastelt, freut sich darauf. Kritischere Geister^[oder weniger bastelfreundliche] w√ºrden den Aufwand bem√§ngeln und die Frage nach dem Zweck der √úbung stellen^[bravo!].\n\n:::callout-important\nWenn wir wissen, welche Trefferzahlen laut einem Modell zu erwarten sind,\nk√∂nnen wir die *echten* (beobachteten) Trefferzahlen mit den laut Modell zu erwartenden vergleichen.\nDamit haben wir eine Methode, mit dem wir ein Modell auf Herz und Nieren pr√ºfen k√∂nnen.\nEin schlechtes Modell wird mit seinen Vorhersagen an der Realit√§t scheitern: Erwartung des Modells und beobachtete Daten passen nicht zusammen.\nSagt ein Modell etwa $W=9$ vorher bei $N=9$, aber wir finden $W=0$,\nso wird unser Vertrauen in das Modell ersch√ºttert sein.\nSimulation von Trefferzahlen sind also ein Modell, um die Glaubw√ºrdigkeit unseres Golems zu pr√ºfen. (Nicht nur) bei Golems gilt: Vertrauen ist gut, Kontrolle ist besser.\n:::\n\n\nLos geht's: \nWir simulieren $n=1$ neuen Globusversuch mit $N=2, p=0.7$ und z√§hlen die (Wasser-)Treffer:\n\n\n::: {.cell hash='0700-ppv_cache/html/QM2-Thema3-Post-befragen-25_6d3eca9b0fd7ebb8ba26424835edfb4c'}\n\n```{.r .cell-code}\nset.seed(42)  # Zufallszahlen festlegen\nrbinom(n = 1, size = 2, prob = .7)  # 0 Treffer (Wasser)\n## [1] 0\n```\n:::\n\n\n\nDas geht wie man sieht mit `rbinom`: *r* wie *random* (zuf√§llig) und *binom* wie binomial verteilt,\ndie M√ºnzwurfverteilung.\n\nHier sind die Argumente der Funktion `rbinom` noch etwas n√§her erkl√§rt:\n\n\n::: {.cell hash='0700-ppv_cache/html/unnamed-chunk-6_ec04beb7de20daba6c435d929f3b067c'}\n\n```{.r .cell-code}\nrbinom(n = Wie oft soll der Versuch wiederholt werden?,\n       size = Wie viele Globusw√ºrfe pro Versuch (Stichprobengr√∂√üe),\n       prob = Wie hoch ist die Wahrscheinlichkeit f√ºr Wasser (bzw. f√ºr einen Treffer))\n```\n:::\n\n\n\nWeiter: Warum nicht $n=10$ neue Globusversuche simulieren?\n\n\n::: {.cell hash='0700-ppv_cache/html/QM2-Thema3-Post-befragen-27_66c25dfa8b8b5789b687f019b3f8cb8b'}\n\n```{.r .cell-code}\nrbinom(n = 10, size = 2, prob = 0.7)\n##  [1] 0 2 1 1 1 1 2 1 1 2\n```\n:::\n\n\n\n\"Simulieren\" hei√üt hier, wir lassen den Computer den Globus werfen,\nganz anschaulich gesprochen.\nNat√ºrlich wirft der Computer nicht in Wirklichkeit einen Globus oder eine M√ºnze,\nsondern er zieht aus der Menge `{0,1}` eine Zahl, und wir geben die Wahrscheinlichkeit f√ºr jedes der beiden Elemente vor, z.B. jeweils 50%.^[√úbrigens k√∂nnen Computer nicht echten Zufall erzeugen (das kann vermutlich niemand), aber durch gewisse verzwickte Rechnungen sind die Zahlen, die der Computer uns pr√§sentiert, nicht oder kaum vom \"Zufall\" zu unterscheiden, also z.B. gleichverteilt ohne besondere Muster.].\n\n:::callout-important\nSimulationsdaten geben Aufschluss, welche Daten (wie oft Wasser) man bei einem bestimmten Modell, $p,N$, erwarten kann. \nM√ºnzw√ºrfe - und analoge Versuche, wie Globusw√ºrfe - kann man in R mit `rbinom` erstellen (simulieren).\n:::\n\n\n\n### Traue niemals einem Golem (einem Modell)\n\n\n\n\n\n![Never trust a Golem](img/5qmhmo.jpg){width=25%}\n\n\nQuelle: https://imgflip.com/i/5qmhmo\n\n\n\nImmer pr√ºfen und wachsam bleiben:\n\n- (Inwieweit) decken sich die simulierten Daten mit den tats√§chlichen Beobachtungen?\n- Wie realistisch sind die Modellannahmen?\n- Kann man das Modell aus verschiedenen Perspektiven pr√ºfen?\n\n\n\n## Mit guten Simulationen kommt man den wahren Werten nahe\n\n\nWarum nicht $n=10^6$ neue Globusversuche simulieren^[Wer R nicht mag, ist eingeladen, diesen Versuch von Hand mit selbstgebastelten Globusb√§llen zu wiederholen.]:\n\n\n::: {.cell hash='0700-ppv_cache/html/QM2-Thema3-Post-befragen-28_0ea7d275f85783e3fa12ab5880a4dff1'}\n\n```{.r .cell-code}\ndraws <- \n  tibble(\n    draws = rbinom(1e6, size = 2, prob = .7))\n\ndraws %>% \n  count(draws) %>% \n  mutate(prop = n / sum(n))\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n| draws|      n|     prop|\n|-----:|------:|--------:|\n|     0|  89770| 0.089770|\n|     1| 420629| 0.420629|\n|     2| 489601| 0.489601|\n\n</div>\n:::\n:::\n\n\nDiese simulierten H√§ufigkeiten sind sehr √§hnlich zu den theoretisch bestimmten H√§ufigkeiten mit `dbinom`: Unser Modell liefert plausible Vorhersagen^[Braver Golem!].\n\n\n::: {.cell hash='0700-ppv_cache/html/QM2-Thema3-Post-befragen-29_5698dc060d8a54d3c30deec0ba063334'}\n\n```{.r .cell-code}\ndbinom(0:2, size = 2, prob = .7)\n## [1] 0.09 0.42 0.49\n```\n:::\n\n\n\n## Stichprobenverteilung\n\nWir ziehen viele ($n=10^6$) Stichproben f√ºr unseren typischen Globusversuch: $N=9$ Globusw√ºrfe mit $p=0.7$. \n\nWie viele Wasser (W) erhalten wir wohl typischerweise in diesem Versuch?\nDie Verteilung der zu erwartenden Treffer ist in @fig-globus-striprovert dargestellt.\n\n\n\n::: {.cell hash='0700-ppv_cache/html/QM2-Thema3-Post-befragen-30_5842fc284e0e80163f0aa7753916285e'}\n\n```{.r .cell-code}\nn_draws <- 1e6\n\ndraws_df <- \n  tibble(draws = rbinom(n_draws, size = 9, prob = .7))\n\ndraws_df %>% gghistogram(x = \"draws\")\n```\n:::\n\n::: {.cell hash='0700-ppv_cache/html/fig-globus-striprovert_2aff900e201b0e2ecab2e1d3126c1b2c'}\n::: {.cell-output-display}\n![Anteile (Wahrscheinlichkeit), die man f√ºr jede Wasserzahl in unserem Globusversuch erwarten kann](0700-ppv_files/figure-html/fig-globus-striprovert-1.png){#fig-globus-striprovert width=50%}\n:::\n:::\n\n\nDie *Stichprobenverteilung* zeigt, welche Stichprobendaten laut unserem Modell (einem bestimmten Parameterwert) zu erwarten sind. Wir k√∂nnen jetzt pr√ºfen, ob die echten Daten zu den Vorhersagen des Modells passen.\n\n:::callout-note\nDie Stichprobenverteilung ist keine empirische Verteilung: Wir f√ºhren diese vielen Versuche nicht wirklich durch^[Nur die extremen Bastelfreunde machen das], wir simulieren sie nur am Computer.\n:::\n\n\n\n## Die Posterior-Pr√§diktiv-Verteilung (PPV)\n\n\n### Was ist die PPV und wozu ist sie gut?\n\n\nUnsere Stichprobenverteilung zeigt, welche Trefferzahlen bei einem bestimmten Parameterwert, z.B. $\\pi=.7$ in welchen Anteilen zu erwarten sind.\nAllerdings sind wir uns ja nicht sicher, dass der Wasseranteil genau 70% betr√§gt.\nUnser (Un-)Wissen √ºber den Wasseranteil wird ja gerade in der Post-Verteilung gespeichert.\n\nUm eine ehrliche(re) Antwort auf die Frage zu erhalten, wie viele Treffer^[Im Globusversuch ist Wasser der \"Treffer\"; in einem M√ºnzwurf-Versuch k√∂nnte \"Kopf\" der Treffer und die Anzahl der geworfenen K√∂pfe die Trefferzahl sein] zu erhalten ist, m√ºssen wir die Post-Verteilung ber√ºcksichtigen.\n\nWir brauche ein Stichprobenverteilung f√ºr *jeden* Wert der Post-Verteilung.\nWenn wir dann die resultierenden Strichprobenverteilungen mitteln,\nhaben wir einen ehrlichen √úberblick √ºber die zu erwartenden Trefferzahlen.\nDabei sollten wir nat√ºrlich wahrscheinliche Parameterwerte h√∂her gewichten als unwahrscheinliche.\nSo sollte etwa der (hoch wahrscheinliche) Wasseranteil von 70% ein hohes Gewicht beim Mitteln der Stichprobenverteilung erhalten;\nder sehr unwahrscheinliche Wasseranteil^[zumindest laut unserer Post-Verteilung] von 1% Wasser, sollte entsprechend weniger gewichtet werden, beim Zusammenfassen (d.h. Mittelwert bilden) der Stichprobenverteilungen.\n\nDie resultierende Verteilung - gemittelte Stichprobenverteilungen √ºber alle Werte der Post-Verteilungen - nennt man *Posterior-Pr√§diktiv-Verteilung* (PPV).\n\n\n:::callout-important\n\nDie PPV entsteht als gewichteter Mittelwert der Stichprobenverteilungen. Die Gewichte sind die Wahrscheinlichkeiten (bzw. Wahrscheinlichkeitsdichten) der Post-Verteilung.\n:::\n\n\n\n:::{#exm-wozu-ppv}\n\n## Magnus Lagrande braucht die PPV\n\n\nIm Jahre $10^{99}$ wird das Universum von Magnus Lagrande regiert.\nDie Weltraumbeh√∂rde, f√ºr die Sie arbeiten, ist ihm unterstellt.\nDer Regent findet Ihre Untersuchungen zwar ganz nett,\naber leider versteht er keine Wahrscheinlichkeit.\nIst ihm zu abstrakt, sagt er. \n\"Oder k√∂nnen Sie mir mal so eine Wahrscheinlichkeit in die Hand geben?\nK√∂nnen Sie sagen, Achtung, da hinten rennt eine Wahrscheinlichkeit, fang sie!\"\nMagnus ist also ein Freund f√ºr des Konkreten. \nEinige einflussreiche Gruppen an Statistikis [unterst√ºtzen diese Haltung](https://www.routledge.com/Predictive-Inference/Geisser/p/book/9780367449919)\n\nJedenfalls h√§tte Magnus gerne eine Aussage wie \n\"Vermutlich sehen wir beim n√§chsten Versuch irgendwas zwischen 4 und 7 Treffern\".\n\nNat√ºrlich haben Sie den Anspruch,\neine wissenschaftlich belastbare Aussage zu t√§tigen.\n\nWas nun? Sie m√ºssen sozusagen die Post-Verteilung in eine Post-Verteilung der Beobachtungen,\nalso der konkreten Werte - in diesem Fall die Anzahl der Wassertreffer - √ºbersetzen.\nGenau das macht die PPV f√ºr Sie!\n:::\n\n\n\n\n\n\n### Visualisierung der PPV\n\nDer Prozess des gewichteten Zusammenfassens der Stichprobenverteilungen ist in @fig-ppv dargestellt.\n\n![PPV als gewichtetes Kombinieren der Stichprobenverteilungen](img/ppv.png){#fig-ppv}\n\nQuelle: @mcelreath_statistical_2020\n\n\n\n### PPV berechnen\n\n\n\n<!-- Hier fehlt `posterior_predict` aus rstanarm oder `estimate_prediction` aus modelbased: https://easystats.github.io/modelbased/reference/estimate_expectation.html -->\n\n\n\nDie PPV f√ºr unseren Standard-Globusversuch ($N=9$) berechnen wir so:\n\nWir berechnen viele (z.B. $10^4$) Stichprobenverteilungen.\nDabei m√ºssen wir jedes Mal fragen, wie gro√ü die Wahrscheinlichkeit $\\pi$ f√ºr Wasser^[d.h. einen Treffer] ist.\nWasseranteile $\\pi$,  die laut Post-Verteilung *wahrscheinlich* sind,\nm√ºssen wir entsprechend *oft* als Parameterwert ($\\pi$) der Stichprobenverteilung verwenden;\numgekehrt d√ºrfen  wir nur wenige Stichprobenverteilungen f√ºr unwahrscheinliche Parameterwerte erstellen.\n\nBeispielsweise w√ºrden wir *viele* Stichprobenverteilungen f√ºr $\\pi=.7$ erstellen;\nf√ºr $\\pi=0.01$ w√ºrden wir *wenige* Stichprobenverteilungen erstellen, s. @fig-ppv.\n\nGl√ºcklicherweise spiegelt unsere Stichproben-Postverteilung `samples` wahrscheinlichere Parameterwerte wieder, indem wahrscheinlichere Parameterwerte h√§ufiger vorkommen.\n\n\n::: callout-note\nWahrscheinliche Parameterwerte kommen in der Stichproben-Postverteilung `samples` h√§ufiger vor.\nDie H√§ufigkeit der Parameterwerte spiegelt die Wahrscheinlichkeit der jeweiligen Parameterwerte in der (theoretischen) Postverteilung wider.\n:::\n\n\nSchauen Sie sich vielleicht zur Erinnerung noch einmal die Definition von `samples` an,  s. @lst-post-sample. \nTabelle `samples`, die aus Stichproben aus der Post-Verteilung besteht, ist (in Ausz√ºgen) in @tbl-postsample1 dargestellt. \nWie die Post-Verteilung auf Basis von Stichproben dann aussieht sieht man in @fig-samples1.\nGlobusversuche kann man mit `rbinom` simulieren, s. @sec-rbinom.\n\n\n\nWir simulieren also viele (z.B $10^4$) Globusversuche, jeweils mit $N=9$ W√ºrfen.\nWahrscheinliche Parameterwerte, etwa $\\pi=7$, sollen h√§ufiger verwendet werden (bei unseren vielen Globusversuchen) als unwahrscheinliche.\n\nPraktischerweise sind die Werte in der Spalte `p_grid` in `samples` so h√§ufig vertreten, wie ihre Wahrscheinlichkeit es erwarten l√§sst. Hier ist ein Auszug aus `samples`:\n\n\n::: {.cell hash='0700-ppv_cache/html/unnamed-chunk-7_bbf76bf7f62e14cd3a86cd6179986c0e'}\n\n```{.r .cell-code}\nsamples %>% \n  select(p_grid) %>% \n  slice_head(n = 10)\n```\n:::\n\n::: {.cell hash='0700-ppv_cache/html/unnamed-chunk-8_ee8d9175fc29a5c5f6f038f00a1d2b91'}\n::: {.cell-output-display}\n|p_grid |\n|:------|\n|0.78   |\n|0.56   |\n|0.56   |\n|0.78   |\n|0.44   |\n|0.67   |\n|0.67   |\n|0.44   |\n|0.56   |\n|0.67   |\n:::\n:::\n\n\nWie man sieht, sind wahrscheinliche Parameterwerte h√§ufiger vertreten.^[An dieser Stelle sollten Sie sichd die ganze Spalte `p_grid` anschauen, um sich von dieser Behauptung mit eigenen Augen zu √ºberzeugen.]\n\n\n\n`p_grid` ist also eine Liste^[technisch in R ein *Vektor*] von Parameterwerten, deren H√§ufigkeit die Wahrscheinlichkeit der Parameterwerte gewichtet.\n\nAuf dieser Basis k√∂nnen wir die PPV erstellen:\n\n\n\n\n\n\n::: {.cell hash='0700-ppv_cache/html/ppv1_939fef46eb6ff966972bfac6e2fc36b1'}\n\n```{.r .cell-code}\nppv <- \n  rbinom(1e4, \n         size = 9, \n         prob = samples$p_grid) %>% \n  as_tibble()\n\nhead(ppv)\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n| value|\n|-----:|\n|     8|\n|     4|\n|     5|\n|     7|\n|     5|\n|     4|\n\n</div>\n:::\n:::\n\n\n\nSchauen wir uns ein Histogramm aller Trefferzahlen an, s. @fig-ppv2.^[Es kann auch dem Verst√§ndnis helfen, dass Sie sich alle Werte der Tabelle `ppv` selber in Ruhe anschauen, um sich zu √ºberzeugen, welche Wasserzahlen (Trefferzahlen) h√§ufiger und welche seltener vorkommen.]\n\n\n::: {.cell hash='0700-ppv_cache/html/fig-ppv2_8c8d677098af0b3403cff8b559c4ffa9'}\n::: {.cell-output-display}\n![Die PPV f√ºr unseren Standard-Globusversuch (N=9)](0700-ppv_files/figure-html/fig-ppv2-1.png){#fig-ppv2 width=672}\n:::\n:::\n\n\n\n\n\n\nDie PPV unseres Modells zeigt uns (@fig-ppv2), dass wir in k√ºnftigen Versuchen zumeist 6 Treffer zu erwarten haben. \nAber ein relativer breiter Bereich an Treffern ist ebenfalls gut laut unserer PPV erwartbar.\n\n\n:::callout-important\nDie PPV zeigt, welche Beobachtungen laut unserem Modell h√§ufig und welche selten sind.\nDie PPV zeigt keine Parameterwerte, sondern welche Daten (Beobachtungen, Wasserzahlen) wir in k√ºnftigen Versuchen wie h√§ufig erwarten k√∂nnen.\n:::\n\n\n:::{#exm-ppv1}\n\n## Der n√§chste Planet\n\nNur zum Spa√ü spulen wir kurz die Zeit im Universum vor, sagen wir so $10^{99}$ Jahre.\nSie arbeiten bei einer Raumfahrtbeh√∂rde, die nach neuen Planeten sucht.\nNun wurde ein aussichtsreicher Planet gesichtet. \nIhre Beh√∂rde hat eine Studie gestartet, im Rahmen derer 9 Sonden zu diesem (weit entfernten) Planeten geschossen sind. Von den 9 Sonden sind 6 im Wasser gelandet,\nwas aus Gr√ºnden intergalaktischer Wasserknappheit eine gute Nachricht ist.\n\n\n>   \"Der n√§chste Planet wird sicher 6 von 9 Wassertreffer erzielen!\"\n\n-- Presse-Chefi der intergalaktischer SpaceY Raumfahrtsbeh√∂rde\n\n\n\nJetzt plant Ihre Beh√∂rde den Versuch zu wiederholen: Wieder sollen 9 Sonden zu diesem Planeten geschossen werden.\nDis Presse-Chefi^[In der Zeit dieses Beispiels ist es √ºblich, kein fixes Geschlecht zu haben] t√∂nt vollmundig: \"Ich bin sicher, dass wir wieder 6 von 9 Treffer, also 6 von 9 Mal Wasser, haben werden!\".\n\nKann man diese Aussage mit (hoher) Sicherheit leisten? Perfekte Sicherheit gibt es bekanntlich nur, was Tod und Steuern betrifft, aber kann diese Aussage mit zumindest hoher Sicherheit geleistet werden?\n\nNein, die PPV (@fig-ppv2) zeigt deutlich, dass unser Wissen nicht ausreicht, um pr√§zise Vorhersagen √ºber k√ºnftige Ausg√§nge des Versuchs zu leisten. So sind auch 5 oder 7 Treffer gut m√∂glich. Auch 4 oder 8 Treffer sind nicht so selten. Sogar 9 Treffer sind nicht super selten.\n\nDis Presse-Chefi Ihrer Beh√∂rde sollte also den Mund nicht so voll nehmen.\n\n:::\n\n\n\n## Fazit\n\n\n### Vorhersagen sind schwierig\n\n\n... gerade wenn sie die Zukunft betreffen, so ein Sprichwort.\n\nDas zeigt uns die PPV: Der PPV unseres Modells gelingt es zwar, der theoretisch wahrscheinlichste Parameterwert ist auch der h√§ufigste in unseren Stichproben, aber die Vorhersagen haben eine gro√üe Streuung, bergen also recht hohe Ungewissheit.\nDie PPV zeigt also, welche Beobachtungen laut unserem Modell k√ºnftig zu erwarten sind, s. @fig-ppv2.\n\nW√ºrde man die Vorhersagen nur anhand eines bestimmten Parameterwertes (z.B $p=0.6$) vornehmen, h√§tten die Vorhersagen *zu wenig Streuung* in den Vorhersagen, w√ºrden also die Ungewissheit nicht ausreichend abbilden. Es w√ºrde *√úbergewissheit* (Overconfidence, Overfitting) resultieren.\n\n[Wir brauchen die PPV](https://imgflip.com/i/6zm1hh). Ohne die PPV k√∂nnen wir nicht seri√∂s absch√§tzen, wie viel Ungewissheit in unseren Vorhersagen steckt.\n\n\n\n\n\n\n### Zwei Arten von Ungewissheit in Vorhersagen von Modellen\n\n\n1. *Ungewissheit innerhalb des Modells* (\"intrinsische\" Ungewissheit): Auch wenn der (oder die) Modellparameter eines Modells mit Sicherheit bekannt sind, so bleibt Unsicherheit, welche Beobachtung eintreten wird: Auch wenn man sicher wei√ü, dass $p=1/4$ Murmeln blau sind, so kann man nicht sicher sagen, welche Farbe die n√§chste Murmel haben wird (Ausnahme: $p=1$ oder $p=0$).\n\n2. *Ungewissheit in den Modellparametern*: Wir sind uns nicht sicher, welchen Wert $p$ (bzw. die Modellparameter) haben. Diese Unsicherheit ist in der Post-Verteilung dargestellt. \n\nUm zu realistischen Vorhersagen zu kommen, m√∂chte man beide Arten von Ungewissheit ber√ºcksichtigen: Das macht die *Posteriori-Pr√§diktiv-Verteilung (PPV)*.\n\n\n\nDie PPV zeigt, welche Daten das Modell vorhersagt (pr√§diktiv) und mit welcher H√§ufigkeit, basierend auf der Post-Verteilung.\n\n\n:::callout-note\nDer Unterschied zwischen der Post-Verteilung und der PPV ist erstmal,\ndass die PPV *Auspr√§gungen* in ihrer Wahrscheinlichkeit bemisst,\nalso z.B. wie wahrscheinlich 4 von 9 Wassertreffern sind.\nDie Post-Verteilung bemisst die Wahrscheinlichkeit von Parameterwerten,\nalso z.B. des Wasseranteils.\n\nEtwas tiefer betrachtet zeigt die PPV zwei Arten von Ungewissheit,\ndie Post-Verteilung nur eine. \nDie PPV zeigt erstens die Ungewissheit zur Verteilung des Parameters (wie die Post-Verteilung),\naber auch noch die intrinsische Ungewissheit.\nDenn auch wenn wir keine Ungewissheit zum Parameter h√§tten,\nbliebe Ungewissheit, welche Beobachtungen sich manifestieren.\nInsofern ist die PVV \"ehrlicher\",\nsie spiegelt die Ungewissheit zu den Beobachtungen wider.\n:::\n\n\n\n### Vergleich der Verteilungen\n\n@fig-post-pred-ppv-anim stellt die in diesem Kapitel diskutierten Verteilungen gegen√ºber:\n\n\n\n- Links - *Posterior-Verteilung*: Wahrscheinlichkeiten der Parameterwerte\n- Mitte - *Stichprobenverteilung*: Wahrscheinlichkeiten der Beobachtungen gegeben eines bestimmten Parameterwertes\n- Rechts - *Posterior-Pr√§diktiv-Verteilung*: Wahrscheinlichkeiten der Beobachtungen unter Ber√ºcksichtigung der Unsicherheit der Posteriori-Verteilung\n\n\n::: {.cell hash='0700-ppv_cache/html/fig-post-pred-ppv-anim_df170cf031dd2ce40bde922d210b0fb2'}\n::: {.cell-output-display}\n![Post- vs. Stichproben- vs. PP-Verteilungen](img/post-pred-ppv-anim.gif){#fig-post-pred-ppv-anim}\n:::\n:::\n\n\n\n\n\n\n\n[Quelle: R. McElreath](https://twitter.com/rlmcelreath/status/1448978045247893505)\n\n\n\n\n\n\n### So viele Verteilungen... \n\n\n\n\n- Die *Posteriori-Verteilung* gibt Aufschluss zur H√§ufigkeit (Wahrscheinlichkeit) von Parameterwerten:\n    - Wie wahrscheinlich ist es, dass \"in Wirklichkeit\" der Wasseranteil 70% betr√§gt, also $\\pi=.7$\n    - In der Wissenschaft ist man meist an den Parametern interessiert.\n    \n- Die *PPV* gibt Aufschluss zur H√§ufigkeit von neuen Beobachtungen:\n    - Welche Beobachtungen (wie viele Wasser/Treffer) sind in Zukunft, bei erneuter Durchf√ºhrung, zu erwarten.\n    - F√ºr die Praxis kann das eine interessante Frage sein.\n    \n- Der *Likelihood* gibt Aufschluss, wie gut eine bestimmte Hypothese die Datenlage erkl√§rt.\n    - Wie gut passt die Hypothese $\\pi=0.7$ auf die Datenlage 6 von 9 Treffern beim Globusversuch?\n    - Der Likelihood kann aus der Stichprobenverteilung herausgelesen werden. \n\n\n::: {.cell hash='0700-ppv_cache/html/QM2-Thema3-Post-befragen-33_fbde884bba1f160b18659d310e3b5625'}\n\n:::\n\n::: {.cell hash='0700-ppv_cache/html/PP2_e494b8071a0ba04633744f35c163482a'}\n\n:::\n\n\n\n\n## Aufgaben\n\n\n1. [Zwielichter Dozent-Bayes](https://datenwerk.netlify.app/posts/zwielichter-dozent-bayes/zwielichter-dozent-bayes)\n2. [Warum Bayes?](https://datenwerk.netlify.app/posts/warum-bayes/warum-bayes)\n3. [subjektiv-Bayes](https://datenwerk.netlify.app/posts/subjektiv-bayes/subjektiv-bayes)\n4. [Likelihood2](https://datenwerk.netlify.app/posts/likelihood2/likelihood2)\n5. [Anteil-Apple](https://datenwerk.netlify.app/posts/anteil-apple/anteil-apple)\n6. [ReThink3m1](https://datenwerk.netlify.app/posts/rethink3m1/rethink3m1)\n7. [ReThink3m2](https://datenwerk.netlify.app/posts/rethink3m2/rethink3m2)\n8. [ReThink3m3](https://datenwerk.netlify.app/posts/rethink3m3/rethink3m3)\n9. [ReThink3m4](https://datenwerk.netlify.app/posts/rethink3m4/rethink3m4)\n10. [ReThink3m5](https://datenwerk.netlify.app/posts/rethink3m5/rethink3m5)\n11. [Quiz zu Verteilungen](https://datenwerk.netlify.app/#category=Verteilungen-Quiz)\n12. [postvert-vis-zwielicht](https://datenwerk.netlify.app/posts/postvert-vis-zwielicht/postvert-vis-zwielicht)\n\n\n\n\n\n\n\n\n\n\n\n## ---\n\n\n\n![](img/outro-07.jpg){width=100%}\n\n\n\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}