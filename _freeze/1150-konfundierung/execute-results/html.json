{
  "hash": "a9a173e131135190012a9a4a549b6067",
  "result": {
    "engine": "knitr",
    "markdown": "\n# Konfundierung {#sec-kausal}\n\n\n## Lernsteuerung\n\n### Position im Modulverlauf\n\n@fig-modulverlauf gibt einen √úberblick zum aktuellen Standort im Modulverlauf.\n\n\n\n### R-Pakete\n\n\\newcommand{\\indep}{\\perp \\!\\!\\! \\perp}\n\n\n\nF√ºr dieses Kapitel ben√∂tigen Sie folgende R-Pakete:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dagitty)  # DAGs zeichnen\nlibrary(tidyverse)\nlibrary(rstanarm)\nlibrary(easystats)\n```\n:::\n\n::: {.cell}\n\n:::\n\n\n\n\n### Daten  {#sec-kausal-daten}\n\n\nWir nutzen den Datensatz [Saratoga County](https://vincentarelbundock.github.io/Rdatasets/csv/mosaicData/SaratogaHouses.csv); s. @tbl-saratoga.\nHier gibt es eine \n[Beschreibung des Datensatzes](https://vincentarelbundock.github.io/Rdatasets/doc/mosaicData/SaratogaHouses.html).\n\n\n\n\n{{< downloadthis data/SaratogaHouses.csv dname=\"SaratogaHouses\" >}}\n\n\n\n\n\n\nSie k√∂nnen ihn entweder √ºber die Webseite herunterladen:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nSaratogaHouses_path <- \"https://vincentarelbundock.github.io/Rdatasets/csv/mosaicData/SaratogaHouses.csv\"\n\nd <- read.csv(SaratogaHouses_path)\n```\n:::\n\n\n\n\nOder aber √ºber das Paket `mosaic` importieren:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(\"SaratogaHouses\", package = \"mosaicData\")\nd <- SaratogaHouses  # k√ºrzerer Name, das ist leichter zu tippen\n```\n:::\n\n\n\n\n\n\n### Lernziele\n\n\nNach Absolvieren des jeweiligen Kapitels sollen folgende Lernziele erreicht sein.\n\nSie k√∂nnen ... \n\n- erkl√§ren, was eine Konfundierung ist\n- DAGs lesen und zeichen\n- Konfundierung in einem DAG erkennen\n\n### Begleitliteratur\n\nDieses Kapitel vermittelt die Grundlagen der Kausalinferenz mittels graphischer Modelle. √Ñhnliche Darstellungen wie in diesem Kapitel findet sich bei @rohrer2018.\n\n\n### √úberblick\n\nIn diesem Kapitel steigen wir ein in das Themengebiet *Kausalanalyse* (oder synonym Kausalinferenz).\nWir besch√§ftigen uns also mit der f√ºr die Wissenschaft (und den Rest des Universums) zentralen Frage, was die Ursache eines Ph√§nomens ist.\nIn diesem ersten Kapitel zu dem Thema geht es um einen h√§ufigen Fall von \"Scheinkorrelation\", also eines Zusammenhangs zwischen UV und AV, der aber gar kein echter kausaler ist, sondern nur Schein. \nBei diesem Scheinzusammenhang handelt es sich um die Konfundierung.\nIm n√§chsten Kapitel schauen wir uns die verbleibenden Grundbausteine der Kausalinferenz an.\n\n\n\n### Einstieg\n\n:::{.exm-storks}\n### Von St√∂rchen und Babies\nKennen Sie die Geschichte von St√∂rchen und Babies? Ich meine nicht die aus dem Biologieunterricht in der f√ºnften Klasse, sondern in einem statistischen Zusammenhang.\nWas war da noch mal die Moral von der Geschichte?^[Nur weil die Variablen `Anzahl_Stoerche` und `Anzahl_Babies` korreliert sind, hei√üt das nicht, dass das eine die Ursache des anderen sein muss.] $\\square$\n:::\n\n:::{.exm-regr-nicht-kausal}\n### Erlaubt eine Regressionsanalyse Kausalschl√ºsse?\nFindet man in einer Regressionsanalyse einen \"Effekt\", also ein Regressionsgewicht ungleich Null, hei√üt das dann, dass die UV die Ursache der AV ist?^[Nein]\nErkl√§ren Sie diesen Sachverhalt genauer. $\\square$\n:::\n\n\n\n\n\n\n\n## Statistik, was soll ich tun?\n\n\n### Studie A: √ñstrogen\n\n#### Medikament einnehmen?\n\nMit Blick auf @tbl-studie-a: Was raten Sie dem Arzt? Medikament einnehmen, ja oder nein?\n\n</br>\n\n\n\n\n::: {#tbl-studie-a .cell tbl-cap='Daten zur Studie A'}\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"lpgxyqtrwk\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#lpgxyqtrwk table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#lpgxyqtrwk thead, #lpgxyqtrwk tbody, #lpgxyqtrwk tfoot, #lpgxyqtrwk tr, #lpgxyqtrwk td, #lpgxyqtrwk th {\n  border-style: none;\n}\n\n#lpgxyqtrwk p {\n  margin: 0;\n  padding: 0;\n}\n\n#lpgxyqtrwk .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#lpgxyqtrwk .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#lpgxyqtrwk .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#lpgxyqtrwk .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#lpgxyqtrwk .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#lpgxyqtrwk .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#lpgxyqtrwk .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#lpgxyqtrwk .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#lpgxyqtrwk .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#lpgxyqtrwk .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#lpgxyqtrwk .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#lpgxyqtrwk .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#lpgxyqtrwk .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#lpgxyqtrwk .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#lpgxyqtrwk .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#lpgxyqtrwk .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#lpgxyqtrwk .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#lpgxyqtrwk .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#lpgxyqtrwk .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#lpgxyqtrwk .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#lpgxyqtrwk .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#lpgxyqtrwk .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#lpgxyqtrwk .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#lpgxyqtrwk .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#lpgxyqtrwk .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#lpgxyqtrwk .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#lpgxyqtrwk .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#lpgxyqtrwk .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#lpgxyqtrwk .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#lpgxyqtrwk .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#lpgxyqtrwk .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#lpgxyqtrwk .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#lpgxyqtrwk .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#lpgxyqtrwk .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#lpgxyqtrwk .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#lpgxyqtrwk .gt_left {\n  text-align: left;\n}\n\n#lpgxyqtrwk .gt_center {\n  text-align: center;\n}\n\n#lpgxyqtrwk .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#lpgxyqtrwk .gt_font_normal {\n  font-weight: normal;\n}\n\n#lpgxyqtrwk .gt_font_bold {\n  font-weight: bold;\n}\n\n#lpgxyqtrwk .gt_font_italic {\n  font-style: italic;\n}\n\n#lpgxyqtrwk .gt_super {\n  font-size: 65%;\n}\n\n#lpgxyqtrwk .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#lpgxyqtrwk .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#lpgxyqtrwk .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#lpgxyqtrwk .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#lpgxyqtrwk .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#lpgxyqtrwk .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#lpgxyqtrwk .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#lpgxyqtrwk .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#lpgxyqtrwk div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Gruppe\">Gruppe</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Mit-Medikament\">Mit Medikament</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Ohne-Medikament\">Ohne Medikament</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"Gruppe\" class=\"gt_row gt_left\">M√§nner</td>\n<td headers=\"Mit Medikament\" class=\"gt_row gt_left\">81/87 √ºberlebt (93%)</td>\n<td headers=\"Ohne Medikament\" class=\"gt_row gt_left\">234/270 √ºberlebt (87%)</td></tr>\n    <tr><td headers=\"Gruppe\" class=\"gt_row gt_left\">Frauen</td>\n<td headers=\"Mit Medikament\" class=\"gt_row gt_left\">192/263 √ºberlebt (73%)</td>\n<td headers=\"Ohne Medikament\" class=\"gt_row gt_left\">55/80 √ºberlebt (69%)</td></tr>\n    <tr><td headers=\"Gruppe\" class=\"gt_row gt_left\">Gesamt</td>\n<td headers=\"Mit Medikament\" class=\"gt_row gt_left\">273/350 √ºberlebt (78%)</td>\n<td headers=\"Ohne Medikament\" class=\"gt_row gt_left\">289/350 √ºberlebt (83%)</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n\n</br>\n\n\nDie Daten stammen aus einer (fiktiven) klinischen Studie, $n=700$, hoher Qualit√§t (Beobachtungsstudie).\nBei M√§nnern scheint das Medikament zu helfen; \nbei Frauen auch.\nAber *insgesamt* (Summe von Frauen und M√§nnern) *nicht*?!\nWas sollen wir den Arzt raten? Soll er das Medikament verschreiben? \nVielleicht nur dann, wenn er das Geschlecht kennt [@pearl2016]?\n\n\n\n\n\n#### Kausalmodell zur Studie A\n\n\n\nIn Wahrheit sehe die kausale Struktur so aus:\nDas Geschlecht (√ñstrogen) hat einen Einfluss (+) auf Einnahme des Medikaments und auf Heilung (-).\nDas Medikament hat einen Einfluss (+) auf Heilung.\nBetrachtet man die Gesamt-Daten zur Heilung, so ist der Effekt von Geschlecht (√ñstrogen) und Medikament *vermengt* (konfundiert, confounded).\nDie kausale Struktur, also welche Variable beeinflusst bzw. nicht,\nist in @fig-dag-studie-a dargestellt.\n\n\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![Zwei direkte Effekte (gender, drug) und ein indirekter Effekt (gender √ºber drug) auf recovery](1150-konfundierung_files/figure-html/fig-dag-studie-a-1.png){#fig-dag-studie-a width=50%}\n:::\n:::\n\n\n\n\n\nBetrachtung der Gesamtdaten zeigt in diesem Fall einen *konfundierten* Effekt: Geschlecht konfundiert den Zusammenhang von Medikament und Heilung.\n\n\n:::callout-important\nBetrachtung der Teildaten (d.h. stratifiziert pro Gruppe) zeigt in diesem Fall den wahren, kausalen Effekt. \nStratifizieren ist also in diesem Fall der korrekte, richtige Weg.\nAchtung: Das Stratifizieren ist nicht immer und nicht automatisch die richtige L√∂sung.\nStratifizieren bedeutet,\nden Gesamtdatensatz in Gruppen oder \"Schichten\" (\"Strata\").\n:::\n\n\n\n\n### Studie B: Blutdruck\n\n\n#### Medikament einnehmen?\n\nMit Blick auf @tbl-studie-b: Was raten Sie dem Arzt? Medikament einnehmen, ja oder nein?\n\n\n\n\n\n::: {#tbl-studie-b .cell tbl-cap='Daten zur Wirksamkeit eines Medikaments (Studie B)'}\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"rlkeicldkw\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#rlkeicldkw table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#rlkeicldkw thead, #rlkeicldkw tbody, #rlkeicldkw tfoot, #rlkeicldkw tr, #rlkeicldkw td, #rlkeicldkw th {\n  border-style: none;\n}\n\n#rlkeicldkw p {\n  margin: 0;\n  padding: 0;\n}\n\n#rlkeicldkw .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#rlkeicldkw .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#rlkeicldkw .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#rlkeicldkw .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#rlkeicldkw .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#rlkeicldkw .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#rlkeicldkw .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#rlkeicldkw .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#rlkeicldkw .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#rlkeicldkw .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#rlkeicldkw .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#rlkeicldkw .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#rlkeicldkw .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#rlkeicldkw .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#rlkeicldkw .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#rlkeicldkw .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#rlkeicldkw .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#rlkeicldkw .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#rlkeicldkw .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#rlkeicldkw .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#rlkeicldkw .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#rlkeicldkw .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#rlkeicldkw .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#rlkeicldkw .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#rlkeicldkw .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#rlkeicldkw .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#rlkeicldkw .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#rlkeicldkw .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#rlkeicldkw .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#rlkeicldkw .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#rlkeicldkw .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#rlkeicldkw .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#rlkeicldkw .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#rlkeicldkw .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#rlkeicldkw .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#rlkeicldkw .gt_left {\n  text-align: left;\n}\n\n#rlkeicldkw .gt_center {\n  text-align: center;\n}\n\n#rlkeicldkw .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#rlkeicldkw .gt_font_normal {\n  font-weight: normal;\n}\n\n#rlkeicldkw .gt_font_bold {\n  font-weight: bold;\n}\n\n#rlkeicldkw .gt_font_italic {\n  font-style: italic;\n}\n\n#rlkeicldkw .gt_super {\n  font-size: 65%;\n}\n\n#rlkeicldkw .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#rlkeicldkw .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#rlkeicldkw .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#rlkeicldkw .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#rlkeicldkw .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#rlkeicldkw .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#rlkeicldkw .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#rlkeicldkw .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#rlkeicldkw div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Gruppe\">Gruppe</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Ohne-Medikament\">Ohne Medikament</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Mit-Medikament\">Mit Medikament</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"Gruppe\" class=\"gt_row gt_left\">geringer Blutdruck</td>\n<td headers=\"Ohne Medikament\" class=\"gt_row gt_left\">81/87 √ºberlebt (93%)</td>\n<td headers=\"Mit Medikament\" class=\"gt_row gt_left\">234/270 √ºberlebt (87%)</td></tr>\n    <tr><td headers=\"Gruppe\" class=\"gt_row gt_left\">hoher Blutdruck</td>\n<td headers=\"Ohne Medikament\" class=\"gt_row gt_left\">192/263 √ºberlebt (73%)</td>\n<td headers=\"Mit Medikament\" class=\"gt_row gt_left\">55/80 √ºberlebt (69%)</td></tr>\n    <tr><td headers=\"Gruppe\" class=\"gt_row gt_left\">Gesamt</td>\n<td headers=\"Ohne Medikament\" class=\"gt_row gt_left\">273/350 √ºberlebt (78%)</td>\n<td headers=\"Mit Medikament\" class=\"gt_row gt_left\">289/350 √ºberlebt (83%)</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n\n\n\n\n\n\nDie Daten stammen aus einer (fiktiven) klinischen Studie, $n=700$, hoher Qualit√§t (Beobachtungsstudie).\nBei geringem Blutdruck scheint das Medikament zu schaden.\nBei hohem Blutdrck scheint das Medikamenet auch zu schaden.\nAber *insgesamt* (Summe √ºber beide Gruppe) *nicht*, da scheint es zu nutzen?!\nWas sollen wir den Arzt raten? Soll er das Medikament verschreiben? Vielleicht nur dann, \nwenn er den Blutdruck nicht kennt [@pearl2016]?\n\n\n#### Kausalmodell zur Studie B\n\n\n\n\n\nDas Medikament hat einen (absenkenden) Einfluss auf den Blutdruck.\nGleichzeitig hat das Medikament einen (toxischen) Effekt auf die Heilung.\nVerringerter Blutdruck hat einen positiven Einfluss auf die Heilung.\nSucht man innerhalb der Leute mit gesenktem Blutdruck nach Effekten, findet man nur den toxischen Effekt: Gegeben diesen Blutdruck ist das Medikament sch√§dlich aufgrund des toxischen Effekts. Der positive Effekt der Blutdruck-Senkung ist auf diese Art nicht zu sehen.\n\nDas Kausalmodell von Studie B ist in @fig-dag-studie-b dargestellt.\n\n\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![Drug hat keinen direkten, aber zwei indirekte Effekt auf recovery, einer davon ist heilsam, einer sch√§dlich](1150-konfundierung_files/figure-html/fig-dag-studie-b-1.png){#fig-dag-studie-b width=50%}\n:::\n:::\n\n\n\n\nBetrachtung der Teildaten zeigt nur den toxischen Effekt des Medikaments, nicht den n√ºtzlichen (Reduktion des Blutdrucks).\n\n\n\n\n:::callout-important\nBetrachtung der Gesamtdaten zeigt in diesem Fall den wahren, kausalen Effekt. \nStratifizieren w√§re falsch, da dann nur der toxische Effekt, aber nicht der heilsame Effekt sichtbar w√§re.\n:::\n\n\n\n\n\n\n### Studie A und B: Gleiche Daten, unterschiedliches Kausalmodell\n\n\nVergleichen Sie die DAGs @fig-dag-studie-a und @fig-dag-studie-b,\ndie die *Kausalmodelle* der Studien A und B darstellen:\nSie sind *unterschiedlich*.\nAber: Die *Daten* sind *identisch*.\n\n\n\nKausale Interpretation - und damit Entscheidungen f√ºr Handlungen - war nur m√∂glich, da das Kausalmodell bekannt ist. \nDie Daten alleine reichen nicht.\nGut merken.\n\n\n\n\n\n### Sorry, Statistik: Du allein schaffst es nicht\n\n\n\n\nStatistik alleine reicht nicht f√ºr Kausalschl√ºsse. üßü\n\nStatistik plus Theorie erlaubt Kausalschl√ºsse. üìö‚ûïüìä  üü∞  ü§©\n\n\n\n:::callout-important\nF√ºr Entscheidungen (\"Was soll ich tun?\") braucht man kausales Wissen.\nKausales Wissen basiert auf einer Theorie (Kausalmodell) plus Daten.\n:::\n\n\n### Vertiefung^[Dieser Abschnitt ist pr√ºfungsrelevant, birgt aber nichts Neues.]\n\n\n\n\n#### Studie C: Nierensteine\n\n\n\nNehmen wir an, es gibt zwei Behandlungsvarianten bei Nierensteinen, Behandlung A und B. √Ñrzte tendieren zu Behandlung A bei gro√üen Steinen (die einen schwereren Verlauf haben); bei kleineren Steinen tendieren die √Ñrzte zu Behandlung B. \n\n\nSollte ein Patient, der nicht wei√ü, ob sein Nierenstein gro√ü oder klein ist, die Wirksamkeit in der Gesamtpopulation (Gesamtdaten) oder in den stratifizierten Daten (Teildaten nach Steingr√∂√üe) betrachten, um zu entscheiden, welche Behandlungsvariante er (oder sie) w√§hlt?\n\n\n\n\n\n\n\n\n\n\nDie Gr√∂√üe der Nierensteine hat einen Einfluss auf die Behandlungsmethode.\nDie Behandlung hat einen Einfluss auf die Heilung.\nDamit gibt es eine Mediation (\"Kette\") von Gr√∂√üe $\\rightarrow$ Behandlung $\\rightarrow$ Heilung.\nDar√ºber hinaus gibt es noch einen Einfluss von Gr√∂√üe der Nierensteine auf die Heilung.\n\nDas Kausalmodell ist in @fig-dag-studie-c dargestellt; @fig-dag-studie-c2 visualisiert alternativ. Beide Varianten zeigen das Gleiche. Sie k√∂nnen sich einen aussuchen. Hier sind beide Varianten gezeigt, damit Sie wissen, dass verschiedene Darstellungsformen m√∂glich sind.\n\nSollte man hier `size` kontrollieren,\nwenn man den Kausaleffekt von `treatment` sch√§tzen m√∂chte? \nOder lieber nicht kontrollieren?\n\n:::{.panel-tabset}\n\n### DAG links-rechts\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![DAG zur Nierenstein-Studie](1150-konfundierung_files/figure-html/fig-dag-studie-c-1.png){#fig-dag-studie-c width=50%}\n:::\n:::\n\n\n\n\n### DAG oben-unten\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![DAG zur Nierenstein-Studie in zweiter Darstellungsform](1150-konfundierung_files/figure-html/fig-dag-studie-c2-1.png){#fig-dag-studie-c2 width=50%}\n:::\n:::\n\n\n\n\n:::\n\nJa: In diesem Fall sollte man `size` kontrollieren,\ndenn man ist am Effekt des `treatments` interessiert.\nW√ºrde man nicht `size` kontrollieren,\nbek√§me man den \"vermengten\" Effekt von `size ` und `treatment`,\nalso keine (belastbare) Aussage √ºber den Effekt der Behandlung.\n\n\n\n\n#### Mehr Beispiele\n\n\n\n:::{#exm-heiraten}\nStudien zeigen, dass Einkommen und Heiraten (bzw. verheiratete sein) hoch korrelieren. Daher wird sich dein Einkommen erh√∂hen, wenn du heiratest. $\\square$\n:::\n\n\n\n\n:::{#exm-besprechung}\nStudien zeigen, dass Leute, die sich beeilen, zu sp√§t zu ihrer Besprechung kommen. Daher lieber nicht beeilen, oder du kommst zu sp√§t zu deiner Besprechung. $\\square$\n:::\n\n\n\n\n\n\n\n### Zwischenfazit\n\nBei *Beobachtungsstudien* ist aus den Daten alleine nicht herauszulesen,\nob eine Intervention wirksam ist,\nob es also einen kausalen Effekt von der Intervention (angenommen Ursache) auf eine AV (Wirkung) gibt.\nDamit ist auch nicht zu erkennen, welche Entscheidung zu treffen ist.\nNur Kenntnis des Kausalmodells zus√§tzlich zu den Daten erlaubt,\neine Entscheidung sinnvoll zu treffen.\n\nBei *experimentellen Daten* ist die Kenntnis des Kausalmodells nicht n√∂tig (wenn das Experiment handwerklich gut gestaltet ist):\nDas Randomisieren der Versuchspersonen zu Gruppen und das Kontrollieren der Versuchsbedingungen sorgen daf√ºr,\ndass es keine Konfundierung gibt.\n\n\n\n\n\n## Konfundierung\n\n### Die Geschichte von Angie und Don\n\n\n\n\n\n:::: {.columns}\n\n::: {.column width=\"30%\"}\n:::{.xlarge}\nüßë\n:::\nDon, Immobilienmogul, Auftraggeber\n:::\n\n::: {.column width=\"30%\"}\n:::{.xlarge}\nüë©\n:::\nAngie, Data Scientistin.\n:::\n\n::: {.column width=\"30%\"}\n:::{.xlarge}\nüßû\n:::\nWolfie, Post-Nerd, kommt in dieser Geschichte aber nicht vor\n:::\n\n::::\n\nüì∫ [Don und Angie](https://www.youtube.com/watch?v=LslpcT8aosI)\n\n\n\n### Datensatz 'Hauspreise im Saratoga County'\n\nImportieren Sie den Datensatz `SaratogaHouses`, s. @sec-kausal-daten.\n\n\n\n\n\n::: {#tbl-saratoga .cell tbl-cap='Saratoga-County-Datensatz'}\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"price\"],\"name\":[1],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"livingArea\"],\"name\":[2],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bedrooms\"],\"name\":[3],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"waterfront\"],\"name\":[4],\"type\":[\"fct\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"132500\",\"2\":\"906\",\"3\":\"2\",\"4\":\"No\"},{\"1\":\"181115\",\"2\":\"1953\",\"3\":\"3\",\"4\":\"No\"},{\"1\":\"109000\",\"2\":\"1944\",\"3\":\"4\",\"4\":\"No\"},{\"1\":\"155000\",\"2\":\"1944\",\"3\":\"3\",\"4\":\"No\"},{\"1\":\"86060\",\"2\":\"840\",\"3\":\"2\",\"4\":\"No\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[5],\"max\":[5]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\n\n\n\n\n### Immobilienpreise in einer schicken Wohngegend vorhersagen\n\n\n\n>   \"Finden Sie den Wert meiner Immobilie heraus! Die Immobilie muss viel wert sein!\"\n\nüßë Das ist Don, Immobilienmogul, Auftraggeber.\n\n\n\n>   Das finde ich heraus. Ich mach das wissenschaftlich.\n\nüë© üî¨ Das ist Angie, Data Scientistin.\n\n\n\n### Modell 1: Preis als Funktion der Anzahl der Zimmer\n\n\n\n>   \"Hey Don! Mehr Zimmer, mehr Kohle!\"\nüë© üî¨\n\n\nModell 1 (`m1`) modelliert den Hauspreis als Funktion der Zimmerzahl, s. @fig-m1.\n\n\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![Modell m1](1150-konfundierung_files/figure-html/fig-m1-1.png){#fig-m1 width=672}\n:::\n:::\n\n\n\n\n\n\n\n\n\n>   \"Jedes Zimmer mehr ist knapp 50 Tausend wert. Dein Haus hat einen Wert von etwa 150 Tausend Dollar, Don.\"\n\nüë©\n\n>   Zu wenig! ü§¨\n\nüßë\n\n\nBerechnen wir das Modell `m1`; der Punktsch√§tzer des Parameters `bedroom` steht in @tbl-m1-hdi.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm1 <- stan_glm(price ~ bedrooms,\n               refresh = 0,\n               seed = 42,\n               data = d)\n\npoint_estimate(m1)\n```\n:::\n\n::: {#tbl-m1-hdi .cell tbl-cap='Parameter f√ºr m1'}\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"Parameter\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Median\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Mean\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"MAP\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Effects\"],\"name\":[5],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Component\"],\"name\":[6],\"type\":[\"chr\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"(Intercept)\",\"2\":\"59993.53\",\"3\":\"59932.38\",\"4\":\"61117.34\",\"5\":\"fixed\",\"6\":\"conditional\",\"_rn_\":\"1\"},{\"1\":\"bedrooms\",\"2\":\"48214.48\",\"3\":\"48200.60\",\"4\":\"48368.43\",\"5\":\"fixed\",\"6\":\"conditional\",\"_rn_\":\"2\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[5],\"max\":[5]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\n\n\n`point_estimates(modell)` gibt die Punktsch√§tzer der Parameter eines Modells zur√ºck,\naber nicht die Sch√§tzbereiche. M√∂chten Sie beides, k√∂nnen Sie die Funktion `parameters(modell)` nutzen.^[In aller Regel macht es mehr Sinn, die Sch√§tzbereiche der Punktsch√§tzer auch zu betrachten. Nur die Punktsch√§tzer zu betrachten vernachl√§ssigt wesentliche Information.]\n\nMit `estimate_predictions` k√∂nnen wir Vorhersagen berechnen (bzw. sch√§tzen; die Vorhersagen sind ja mit Ungewissheit verbunden, daher ist \"sch√§tzen\" vielleicht das treffendere Wort).\n@tbl-m1-pred zeigt den laut `m1` vorhergesagten Hauspreis f√ºr ein Haus mit 2 Zimmern.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndons_house <- tibble(bedrooms = 2)\nestimate_prediction(m1, data = dons_house)\n```\n:::\n\n::: {#tbl-m1-pred .cell tbl-cap='Vorhersage des Hauspreises f√ºr ein Haus mit 2 Zimmern'}\n::: {.cell-output-display}\n\n\nTable: Model-based Prediction\n\n|bedrooms | Predicted|      SE |               95% CI |\n|:--------|---------:|:--------|:---------------------|\n|2.00     |  1.55e+05|90870.40 |(-22094.06, 3.32e+05) |\n\nVariable predicted: price\n\n\n\n:::\n:::\n\n\n\n\n\n\n### Don hat eine Idee \n\n\n\n>   \"Ich bau eine Mauer! Genial! An die Arbeit, Angie!\" \nüßë\n\nDon hofft, durch Verdopplung der Zimmerzahl den doppelten Verkaufspreis zu erzielen. Ob das klappt?\n\n>   \"Das ist keine gute Idee, Don.\"\n\nüë©\n\nBerechnen wir die Vorhersagen f√ºr Dons neues Haus (mit den durch Mauern halbierten Zimmern), s. @tbl-m1-pred2a.^[Anstelle  von `estimate_relation()` kann man auch (einfacher vielleicht) `predict()` verwenden: `predict(m1, newdata = dons_new_house)`. Allerdings gibt `predict()` nur den vorhergesagten Wert aus. `estimate_prediction()` gibt noch zus√§tzlich das *Vorhersageintervall* aus, ber√ºcksichtigt also die (doppelte) Ungewissheit der Vorhersage. Mit anderen Worten: `estimate_prediction` gibt die PPV aus.]\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndons_new_house <- tibble(bedrooms = 4)\nestimate_prediction(m1, dons_new_house)\npredict(m1, newdata = dons_new_house)\n```\n:::\n\n::: {#tbl-m1-pred2a .cell tbl-cap='Vorhergesagter Hauspreis laut m1 f√ºr ein Haus mit 4 Zimmern'}\n::: {.cell-output-display}\n\n\nTable: Model-based Prediction\n\n|bedrooms | Predicted|      SE |              95% CI |\n|:--------|---------:|:--------|:--------------------|\n|4.00     |  2.51e+05|91587.76 |(73848.50, 4.28e+05) |\n\nVariable predicted: price\n\n\n\n:::\n:::\n\n\n\n\n\n\nMit 4 statt 2 Schlafzimmer steigt der Wert auf 250k, laut `m1`, s. @fig-m1.\n\n\n>   \"Volltreffer! Jetzt verdien ich 100 Tausend mehr! ü§ë Ich bin der Gr√∂√üte!\"\nüßë\n\n\n\n\n:::callout-note\nZur Erinnerung: \"4e+05\" ist die Kurzform der wissenschaftlichen Schreibweise und bedeutet: $4 \\cdot 100000 = 4\\cdot10^5 = 400000$\n:::\n\n\n### R-Funktionen, um Beobachtungen vorhersagen \n\n\n`predict(m1, dons_new_house)` oder `point_estimate(m1, dons_new_house)` sagt einen *einzelnen Wert* vorher (den sog. Punktsch√§tzer der Vorhersage).^[Bei `predict` ist dieser Wert der Median der Post-Verteilung; bei `point_estimate` kann man sich aussuchen, ob der Median, der Mittelwert oder der wahrscheinlichste Wert der Post-Verteilung als Sch√§tzwert verwendet wird.]  Ein Intervall wird *nicht* ausgegeben.\n\n`estimate_prediction(m1, dons_new_house)` erstellt *Vorhersageintervalle*, ber√ºcksichtigt also *zwei Quellen* von Ungewissheit:\n\n- Ungewissheiten in den Parametern (Modellkoeffizienten, $\\beta_0, \\beta_1, ...$)\n- Ungewissheit im \"Strukturmodell\": Wenn also z.B. in unserem Modell ein wichtiger Pr√§diktor fehlt, so kann die Vorhersagen nicht pr√§zise sein. Fehler im Strukturmodell schlagen sich in breiten Sch√§tzintervallen (bedingt durch ein gro√ües $\\sigma$) nieder.\n\n\n\n`estimate_expectation(m1, dons_new_house)` erstellt *Konfidenzintervalle*.  ber√ºcksichtigt also nur *eine Quelle* von Ungewissheit:\n\n- Ungewissheiten in den Parametern (Modellkoeffizienten)\n\n\nDie Sch√§tzbereiche sind in dem Fall deutlich kleiner, s. @tbl-m1-dons-new.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nestimate_expectation(m1, dons_new_house)\n```\n:::\n\n::: {#tbl-m1-dons-new .cell tbl-cap='Ungewissheit f√ºr die Parameter, also die Regressionsgerade, nicht die Beobachtungen'}\n::: {.cell-output-display}\n\n\nTable: Model-based Expectation\n\n|bedrooms | Predicted|     SE |              95% CI |\n|:--------|---------:|:-------|:--------------------|\n|4.00     |  2.53e+05|3109.34 |(2.47e+05, 2.59e+05) |\n\nVariable predicted: price\n\n\n\n:::\n:::\n\n\n\n\n\n\n### Modell 2\n\n\nBerechnen wir das Modell  `m2: price ~ bedrooms + livingArea`.\n@tbl-m2 gibt den Punktsch√§tzer f√ºr die Koeffizienten wider.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm2 <- stan_glm(price ~ bedrooms + livingArea, \n               data = d, \n               seed = 42,\n               refresh = 0)\n\npoint_estimate(m2, centrality = \"median\")\n```\n:::\n\n::: {#tbl-m2 .cell tbl-cap='Parameter (Punktsch√§tzer, keine Sch√§tzung der Ungewissheit) von m2'}\n::: {.cell-output-display}\n\n\nTable: Point Estimate\n\n|Parameter   |    Median|\n|:-----------|---------:|\n|(Intercept) |  36890.16|\n|bedrooms    | -14206.16|\n|livingArea  |    125.36|\n\n\n:::\n:::\n\n\n\n\n\n\nWas sind die Vorhersagen des Modell? \n@tbl-m2-pred gibt Aufschluss f√ºr den laut `m2` vorhersagten Kaufpreis eines Hauses\nmit 4 Zimmern und 1200 Quadratfu√ü Wohnfl√§che; @tbl-m2-pred2 gibt die Sch√§tzung (laut `m2`) f√ºr den Preis eines Hauses mit 2 Zimmern (und der gleichen Wohnfl√§che).\nDie Vorhersage erh√§lt man mit dem Befehl `predict()`:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npredict(m2, newdata = data.frame(bedrooms = 4, livingArea = 1200))\n##        1 \n## 130369.5\n```\n:::\n\n::: {#tbl-m2-pred .cell tbl-cap='Vorhersage von m2 f√ºr ein Haus mit *4* Zimmern und 1200 Einheiten Wohnfl√§che'}\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"bedrooms\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"livingArea\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Predicted\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"SE\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"CI_low\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"CI_high\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"4\",\"2\":\"1200\",\"3\":\"129471.7\",\"4\":\"68842.33\",\"5\":\"-4678.329\",\"6\":\"262365.4\",\"_rn_\":\"1\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[5],\"max\":[5]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n::: {#tbl-m2-pred2 .cell tbl-cap='Vorhersage von m2 f√ºr ein Haus mit *2* Zimmern und 1200 Einheiten Wohnfl√§che'}\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"bedrooms\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"livingArea\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Predicted\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"SE\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"CI_low\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"CI_high\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"2\",\"2\":\"1200\",\"3\":\"159257.9\",\"4\":\"68792.58\",\"5\":\"29066.68\",\"6\":\"295674.6\",\"_rn_\":\"1\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[5],\"max\":[5]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\n\n\n\n\nAndere, aber √§hnliche Frage: Wieviel kostet ein Haus mit sagen wir 4 Zimmer *gemittelt* √ºber die verschiedenen Gr√∂√üen von `livingArea`? \nStellen Sie sich alle H√§user mit 4 Zimmern vor (also mit verschiedenen Wohnfl√§chen). \nWir m√∂chten nur wissen, was so ein Haus \"im Mittel\" kostet.\nWir m√∂chten also die Mittelwerte pro `bedroom` sch√§tzen, \ngemittelt f√ºr jeden Wert von `bedroom` √ºber `livingArea`.\nDie Ergebnisse stehen in @tbl-m2-estimate-pred2 und sind in @fig-m2-preds visualisiert.\n\n\n\n\n::: {#tbl-m2-estimate-pred2 .cell tbl-cap='Vorhersagen des Preises von H√§usern mit verschiedener Zimmerzahl gemittelt √ºber die verschiedenen Werte der Wohnfl√§che; basierend auf m2.'}\n\n```{.r .cell-code}\nestimate_means(m2, at = \"bedrooms\", length = 7)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"bedrooms\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Mean\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"CI_low\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"CI_high\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"pd\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1\",\"2\":\"242581.5\",\"3\":\"230686.2\",\"4\":\"254859.1\",\"5\":\"1\"},{\"1\":\"2\",\"2\":\"228419.6\",\"3\":\"221506.0\",\"4\":\"235395.3\",\"5\":\"1\"},{\"1\":\"3\",\"2\":\"214175.2\",\"3\":\"210746.6\",\"4\":\"217741.8\",\"5\":\"1\"},{\"1\":\"4\",\"2\":\"200007.9\",\"3\":\"194180.7\",\"4\":\"205536.1\",\"5\":\"1\"},{\"1\":\"5\",\"2\":\"185829.8\",\"3\":\"175060.4\",\"4\":\"195934.3\",\"5\":\"1\"},{\"1\":\"6\",\"2\":\"171634.8\",\"3\":\"155743.5\",\"4\":\"186738.7\",\"5\":\"1\"},{\"1\":\"7\",\"2\":\"157398.0\",\"3\":\"136169.4\",\"4\":\"177865.5\",\"5\":\"1\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[5],\"max\":[5]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![Hauspreis als Funktion der Zimmerzahl, laut m2](1150-konfundierung_files/figure-html/fig-m2-preds-1.png){#fig-m2-preds width=672}\n:::\n:::\n\n\n\n\n\n\n\n>   \"Die Zimmer zu halbieren,\nhat den Wert des Hauses *verringert*,\nDon!\"\n\nüë©\n\n\n>   \"Verringert!? Weniger Geld?! Oh nein!\"\n\nüßë\n\n\n\n\n\n### Die Zimmerzahl ist negativ mit dem Preis korreliert \n\n... wenn man die Wohnfl√§che (Quadratmeter) kontrolliert, s. @fig-m2-negativ.\n\n\n\n>   **\"Ne-Ga-Tiv!\"**\n\nüë©\n\n\n![Hauspreis stratifizieren](img/hauspreis1.png){#fig-m2-negativ fig-asp=.5}\n\n[Quellcode](https://github.com/sebastiansauer/QM2-Folien/blob/main/Themen/children/Hauspreis-stratifizieren.Rmd)\n\n\n\n::: callout-note\nAussagen, gleich ob sie statistischer, wissenshaftlicher oder sonstiger Couleur sind, k√∂nnen immer nur dann richtig sein, wenn ihre Annahmen richtig sind. \nBehauptet etwa ein Modell, dass der Wert einer Immobilie steigt, wenn man mehr Zimmer hat, so ist das kein Naturgesetz, sondern eine Aussage, die nur richtig sein kann, wenn das zugrundeliegende Modell richtig ist. $\\square$\n:::\n\n\n### Kontrollieren von Variablen\n\n\nüí° Durch das Aufnehmen von Pr√§diktoren in die multiple Regression werden die Pr√§diktoren *kontrolliert* (adjustiert, konditioniert):\n\nDie Koeffizienten einer multiplen Regression zeigen den Zusammenhang $\\beta$ des einen Pr√§diktors mit $y$, \nwenn man den (oder die) anderen Pr√§diktoren statistisch *konstant h√§lt*. \n\nMan nennt die Koeffizienten einer multiplen Regression daher auch *parzielle Regressionskoeffizienten*. \nManchmal spricht man, eher umgangssprachlich, auch vom \"Netto-Effekt\" eines Pr√§diktors, \noder davon, dass ein Pr√§diktor \"bereinigt\" wurde vom (linearen) Einfluss der anderen Pr√§diktoren auf $y$.\n\nDamit kann man die Regressionskoeffizienten so interpretieren, \ndass Sie den Effekt des Pr√§diktors $x_1$ auf $y$ anzeigen *unabh√§ngig* vom Effekt der anderen Pr√§diktoren, $x_2,x_3,...$ auf $y$.\n\nMan kann sich dieses Konstanthalten vorstellen als eine Aufteilung in Gruppen: Der Effekt eines Pr√§diktors $x_1$ wird f√ºr jede Auspr√§gung (Gruppe) des Pr√§diktors $x_2$ berechnet.\n\n\n\n\n::: callout-important\nDas Hinzuf√ºgen von Pr√§diktoren kann die Gewichte der √ºbrigen Pr√§diktoren √§ndern. $\\square$\n:::\n\n\n\n\n\n\n>   Aber welche und wie viele Pr√§diktoren soll ich denn jetzt in mein Modell aufnehmen?! Und welches Modell ist jetzt richtig?!\n\nüßë\n\n>   Leider kann die Statistik keine Antwort darauf geben.\n\nüë©\n\n\n>   Wozu ist sie dann gut?!\n\nüßë\n\n\n:::callout-important\nIn Beobachtungsstudien hilft nur ein (korrektes) Kausalmodell. \nOhne Kausalmodell ist es *nutzlos*, die Regressionskoeffizienten (oder eine andere Statistik) zur Erkl√§rung der Ursachen heranzuziehen:\nDie Regressionskoeffizienten k√∂nnen sich wild √§ndern, wenn man Pr√§diktoren hinzuf√ºgt oder wegl√§sst. \nEs k√∂nnen sich sogar die *Vorzeichen der Regressionsgewichte √§ndern*;\nin dem Fall spricht man von einem Simpson-Paradox.\n:::\n\n\n\n\n### Welches Modell richtig ist, kann die Statistik nicht sagen\n\n>   Often people want statistical modeling to do things that statical modeling cannot do.\nFor example, we'd like to know wheter an effect is \"real\" or rather spurios.\nUnfortunately, modeling merely quantifies uncertainty in the precise way that the model understands the problem.\nUsually answers to lage world questions about truth and causation depend upon information not included in the model.\nFor example, any observed correlation between an outcome and predictor could be eliminated or reversed once another predictor is added to the model.\nBut if we cannot think of the right variable,\nwe might never notice.\nTherefore all statical models are vulnerable to and demand critique,\nregardless of the precision of their estimates\nand apparaent accuracy of their predictions.\nRounds of model criticism and revision embody the real tests of scientific hypotheses.\nA true hypothesis will pass and fail many statistical \"tests\" on its way to acceptance.\n\n\n-- @mcelreath2020, S. 139\n\n\n\n### Kausalmodell f√ºr Konfundierung, `km1`\n\nDas Kausalmodell `km1` ist in @fig-km1 dargestellt; vgl.  @fig-m2-negativ.\n\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![Kausalmodell km1 - Eine Erkl√§rung (von mehreren) f√ºr m1 bzw. die Daten, die m1 zugrunde liegen](1150-konfundierung_files/figure-html/fig-km1-1.png){#fig-km1 width=864}\n:::\n:::\n\n\n\n\nWenn dieses Kausalmodell stimmt, findet man eine *Scheinkorrelation* zwischen `price` und `bedrooms`.\nEine Scheinkorrelation ist ein Zusammenhang, der *nicht* auf eine kausalen Einfluss beruht.\n`d_connected` hei√üt, dass die betreffenden Variablen \"verbunden\" sind durch einen gerichteten (`d` wie directed) Pfad, durch den die Assoziation (Korrelation) wie durch einen Fluss flie√üt üåä. `d_separated` hei√üt, dass sie *nicht* `d_connected` sind.\n\n\n### `m2` kontrolliert die Konfundierungsvariable `livingArea`\n\n\n:::{#exm-confound1}\nIn @fig-km1 ist `living area` eine Konfundierungsvariable f√ºr den Zusammenhang von `bedrooms` und `price`. $\\square$\n:::\n\n:::{#def-confound}\n### Konfundierungsvariable\nEine Konfundierungsvariable (Konfundierer) ist eine Variable, \ndie den Zusammenhang zwischen UV und AV verzerrt, \nwenn sie nicht kontrolliert wird [@vanderweele_definition_2013]. $\\square$\n:::\n\nWenn das Kausalmodell stimmt, dann zeigt `m2` den kausalen Effekt von `livingArea`.\n\n>   Was tun wir jetzt blo√ü?! Oh jeh!\n\nüßë\n\n\n>   Wir m√ºssen die Konfundierungsvariable kontrollieren.\n\nüë©\n\n\n@fig-km1-controlled zeigt, dass `bedrooms` und `price` *unkorreliert* werden (`d_separated`), wenn man `living area` kontrolliert.\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![Durch Kontrolle von living area wird die Assoziation von price und bedrooms aufgehoben.](1150-konfundierung_files/figure-html/fig-km1-controlled-1.png){#fig-km1-controlled width=2700}\n:::\n:::\n\n\n\n\n\n\nDurch das Kontrollieren (\"adjustieren\"), sind `bedrooms` und `price` nicht mehr korreliert, \nnicht mehr `d_connected`, sondern jetzt `d_separated`.\n\n\n:::{#def-blocking}\n### Blockieren\nDas Kontrollieren eines Konfundierers (wie `living_area`) \"blockt\" den betreffenden Pfad, \nf√ºhrt also dazu, \ndass √ºber diesen Pfad keine Assoziation (z.B. Korrelation) zwischwen UV (`bedrooms`) und AV (`price`) mehr vorhanden ist. \nUV und AV sind dann `d_separated` (\"getrennt\"). $\\square$\n:::\n\n\n### Konfundierer kontrollieren\n\nGehen wir in diesem Abschnitt davon aus, dass `km1` richtig ist.\n\n\n\n\n\n::: {.cell}\n\n:::\n\n\n\n\n\n\n*Ohne* Kontrollieren der Konfundierungsvariablen:\nRegressionsmodell `y ~ x`, @fig-p-konf1, links:\nEs wird (f√§lschlich) eine Korrelation zwischen `x` und `y`  angezeigt: Scheinkorrelation.\n*Mit* Kontrollieren der Konfundierungsvariablen: Regressionsmodell `y ~ x + group`, @fig-p-konf1, rechts.\n\n\n\n\n::: {#fig-p-konf1 .cell layout-ncol=\"2\"}\n::: {.cell-output-display}\n![Ohne Kontrolle der Konfundierungsvariablen: Konfundierung tritt auf.](1150-konfundierung_files/figure-html/fig-p-konf1-1.png){#fig-p-konf1-1 width=672}\n:::\n\n::: {.cell-output-display}\n![Mit Kontrolle der Konfundierungsvariablen: Konfundierung tritt nicht auf.](1150-konfundierung_files/figure-html/fig-p-konf1-2.png){#fig-p-konf1-2 width=672}\n:::\n\nKonfundierung von y und x!\n:::\n\n\n\n\n\n\n\n\n@fig-p-konf1, rechts, zeigt korrekt, dass es keine Korrelation zwischen `x` und `y` gibt, wenn `group` kontrolliert wird.\nAu√üerdem sieht man im rechten Teildiagramm, \ndass es ein Kontrollieren der Variable `group` durch Aufnahme als Pr√§diktor in die Regressionsgleichung einem Stratifizieren entspricht (getrennte Berechnung der Regressionsgerade pro Gruppe).\n\n\n\n\n\n\n::: callout-important\nKontrollieren Sie Konfundierer. $\\square$\n:::\n\n\n\n### `m1` und `m2` passen nicht zu den Daten, wenn `km1` stimmt\n\n\n\n\n\n\nLaut `km1` d√ºrfte es keine Assoziation (Korrelation) zwischen `bedrooms` und `price` geben, wenn man `livingArea` kontrolliert, wie in @fig-km1 dargestellt.\nEs gibt aber noch eine Assoziation zwischen `bedrooms` und `price` geben, wenn man `livingArea` kontrolliert.\n Daher sind sowohl `m1` und `m2` nicht mit dem Kausalmodell `km1` vereinbar.\n\n\n\n\n\n### Kausalmodell 2, `km2` \n\nUnser Modell `m2` sagt uns, \ndass beide Pr√§diktoren jeweils einen eigenen Beitrag zur Erkl√§rung der AV haben.\n\n\n\nDaher k√∂nnte das folgende Kausalmodell, `km2` besser passen.\n\nIn diesem Modell gibt es eine *Wirkkette*: $a \\rightarrow b \\rightarrow p$.\n\nInsgesamt gibt es zwei Kausaleinfl√ºsse von `a` auf `p`:\n    - $a \\rightarrow p$\n    - $a \\rightarrow b \\rightarrow p$\n\nMan nennt die mittlere Variable einer Wirkkette auch einen *Mediator* und den Pfad von der UV (`a`) √ºber den Mediator (`b`) zur AV (`p`) auch *Mediation*, s. @fig-m1-mediation.\n\n\n\n\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![Der Effekt von livingArea wird √ºber den Mediator bedrooms auf price vermittelt.](1150-konfundierung_files/figure-html/fig-m1-mediation-1.png){#fig-m1-mediation width=672}\n:::\n:::\n\n\n\n\n\n\n\n\n\n### Dons Kausalmodell, `km3`\n\nSo sieht Dons Kausalmodell aus, s. @fig-km3.\n\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![Dons Kausalmodell](1150-konfundierung_files/figure-html/fig-km3-1.png){#fig-km3 width=50%}\n:::\n:::\n\n\n\n\n\n\n>   \"Ich glaube aber an mein Kausalmodell. Mein Kausalmodell ist das gr√∂√üte! Alle anderen Kausalmodelle sind ein Disaster!\"\n\nüßë\n\n</br>\n\n>   \"Don, nach deinem Kausalmodell m√ºssten `bedrooms` und `livingArea` unkorreliert sein. Sind sie aber nicht.\"\n\nüßë\n\n\nRechne doch selber die Korrelation aus, Don:\n\n\n>   \"√Ñh, wie ging das nochmal?\"\n\nüßë\n\n\nSo k√∂nntest du das rechnen, Don: `correlation(d, select = c(\"bedrooms\", \"livingArea\"))`. \nOder z.B. so:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndons_r <- d %>% \n  summarise(cor(bedrooms, livingArea))\n```\n:::\n\n\n\n\nDie Korrelation liegt also bei 0.66\n\n\n>   \"Bitte, gerne hab ich dir geholfen, Don.\"\n\nüë©\n\n\n\n\n\n\n### Unabh√§ngigkeiten laut der Kausalmodelle\n\n\n`km1`: `b`: bedrooms, `p`: price, `a` area (living area), s. @fig-km1.\n\n\n\nDas Kausalmodell `km1` behauptet: $b \\indep p \\, |\\, a$: `bedrooms` sind unabh√§ngig von `price`, wenn man `livingArea` kontrolliert.\n\n*Kontrollieren* einer Variable $Z$ erreicht man auf einfache Art,\nindem man sie in zus√§tzlich zur vermuteten Ursache $X$ in die Regressionsgleichung mit aufnimmt, also `y ~ x + z`. \n\n\nAber diese behauptete Unabh√§ngigkeit findet sich *nicht* in den Daten wieder, s. @tbl-m2. Also: ‚õàÔ∏è Passt nicht zu den Daten!\n\n\n\n\n\n\n`km2` `b`: bedrooms, `p`: price, `a` area (living area), s. @fig-m1-mediation.\n\n\n\nDas Kausalmodell `km2` postuliert *keine* Unabh√§ngigkeiten:\nLaut `km2`sind alle Variablen des Modells miteinander assoziiert (korreliert).\n\n:::callout-note\nEin Modell, in dem alle Variablen miteinander korreliert sind,\nnennt man auch *satuiert* oder saturiertes Modell.\nSo ein Modell ist empirisch *schwach*.\nDenn: Behauptet ein Modell, \ndass die Korrelation zwischen zwei Variablen irgendeinen Wert zwischen -1 und +1 betr√§gt (nur nicht exakt Null), \nso ist das eine sehr schwache Aussage (und kaum zu falsifizieren). \nSo ein Modell ist wissenschaftlich wenig wert. \nDas ist so √§hnlich wie ein Modell, \ndas voraussagt,\ndass es morgen irgendeine Temperatur hat zwischen -30 und +30 Grad (nur nicht exakt Null). \nTrifft diese Temperaturvorhersage ein,\nso werden wir nicht gerade beeindruckt sein. ü•±\n:::\n\nFazit: `km2` passt zu den Daten, aber wir sind nicht gerade beeindruckt vom Modell.\n\n\n\n\n\n\n`km3`: `b`: bedrooms, `p`: price, `a` area (living area), s. @fig-km3.\n\n\n\n\n\n$b \\indep a$: `bedrooms` sind unabh√§ngig von `livingArea` (`a`)\n\n\n‚õàÔ∏è `km3` passt nicht zu den Daten/zum Modell!\n\n\n\n\n\n## DAGs: Directed Acyclic Graphs\n\n\nWas sind DAGs? Wir haben in diesem Kapitel schon viele Beispiele gesehen, z.B.  @fig-km3.\n\n\n:::{#def-dag}\n### DAG\n\nDAGs sind eine bestimmte Art von Graphen zur Analyse von Kausalstrukturen.\nEin *Graph* besteht aus Knoten (Variablen) und Kanten (Linien), die die Knoten verbinden.\nDAGs sind *gerichtet*; die Pfeile zeigen immer in eine Richtung (und zwar von Ursache zu Wirkung).\nDAGs sind *azyklisch*; die Wirkung eines Knoten darf nicht wieder auf ihn zur√ºckf√ºhren. $\\square$\n:::\n\n\n:::{#def-pfad}\n### Pfad\n\nEin *Pfad* ist ein Weg durch den DAG, von Knoten zu Knoten √ºber die Kanten, unabh√§ngig von der Pfeilrichtung. $\\square$\n:::\n\n\n\nDer DAG von `km1` ist in @fig-km1 zu sehen.\n\n\n### Leider passen potenziell viele DAGs zu einer Datenlage\n\n\nAuf Basis der in Dons Modell dargestellten (Un-)Abh√§ngigkeiten der Variablen sind noch weitere Kausalmodelle m√∂glich.\n\nIn @fig-kms sind diesen weiteren, m√∂glichen Kausalmodelle f√ºr Dons Modell dargestellt. Dabei sind folgende Abk√ºrzungen verwendet: `b`: bedrooms, `p`: price, `a` area (living area).\n\nJa, der Job der Wissenschaft ist kein Zuckerschlecken.\nAber wenn es einfach w√§re, die Kausalstruktur der Ph√§nomene zu entdecken,\nw√§ren sie l√§ngst erkannt, und alle Probleme der Menschheit gel√∂st.\n\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![Kausalmodelle, die potenziell geeignet sind f√ºr Dons Fragestellung](1150-konfundierung_files/figure-html/fig-kms-1.png){#fig-kms width=864}\n:::\n:::\n\n\n\n\n\nAlle diese DAgs in @fig-km1 haben die *gleichen* Implikationen hinsichtlich der (Un-)Abh√§ngigkeiten zwischen der Variablen.\nWir k√∂nnen also leider empirisch nicht bestimmen,\nwelcher der DAGs der richtige ist.\nUm den richtigen DAG zu identifizieren, br√§uchten wir z.B. einen reichhaltigeren DAG,\nalso mit mehr Variablen.\n\n\n\n\n### Was ist eigentlich eine Ursache?\n\nEtwas verursachen kann man auch (hochtrabend) als \"Kausation\" bezeichnen.\n\n:::callout-note\nWei√ü man, was die Wirkung $W$ einer Handlung $H$ (Intervention) ist,  so hat man $H$ als Ursache von $W$ erkannt [@mcelreath2020]. $\\square$\n:::\n  \n\n:::{#def-abh}\n### Kausale Abh√§ngigkeit\nIst $X$ die Ursache von $Y$, so h√§ngt $Y$ von $X$ ab: $Y$ ist (kausal) *abh√§ngig* von $X$. $\\square$\n:::\n\n\nViele Menschen denken - f√§lschlich - dass Korrelation Kausation bedeuten muss, s. @fig-xkcd-causation.\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![xkcd zum Thema Kausation](img/correlation.png){#fig-xkcd-causation fig-align='center' width=50%}\n:::\n:::\n\n\n\n\n\n[Quelle](https://xkcd.com/552/) und [Erkl√§rung](https://www.explainxkcd.com/wiki/index.php/552:_Correlation)\n\n\n\n\n\n\n\n\n\n\n:::{#exm-schokidag}\n### Der Schoki-Dag\nDer \"Schoki-DAG\" in @fig-schoki-dag zeigt den DAG f√ºr das Schokoloaden-Nobelpreis-Modell. $\\square$\n:::\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![Macht Schokolade Nobelpreise?](1150-konfundierung_files/figure-html/fig-schoki-dag-1.png){#fig-schoki-dag width=672}\n:::\n:::\n\n\n\n\n\n\n\n\n## Fazit\n\n\n\n\n\n\n### Zusammenfassung\n\nSind zwei Variablen korreliert (abh√§ngig, assoziiert), so kann es daf√ºr zwei Gr√ºnde geben:\n\n1. Kausaler (\"echter\") Zusammenhang\n2. Nichtkausaler Zusammenhang (\"Scheinkorrelation\")\n\nMan ist daran interessiert, echten (also kausalen) Zusammenhang aufzudecken^[zu \"identifizieren\"] und Scheinkorrelation auszuschlie√üen.\n\nEine von zwei m√∂glichen Ursachen einer Scheinkorrelation ist Konfundierung.^[Die andere Ursache ist die Kollisionsverzerrung, s. #sec-kausal.]\n\nKonfundierung kann man aufdecken, indem man die angenommene Konfundierungsvariable kontrolliert (adjustiert), z.B. indem man ihn als Pr√§diktor in eine Regression aufnimmt.\n\nIst die Annahme einer Konfundierung korrekt, so l√∂st sich der Scheinzusammenhang nach dem Adjustieren auf.\n\nL√∂st sich der Scheinzusammenhang nicht auf, sondern drehen sich die Vorzeichen der Zusammenh√§nge nach Adjustieren um, so spricht man einem *Simpson-Paradox*.\n\nDie *Daten alleine* k√∂nnen *nie* sagen, welches Kausalmodell der Fall ist in einer Beobachtungsstudie. \nFachwissen (inhaltliches wissenschaftliches Wissen) ist n√∂tig, um DAGs auszuschlie√üen.\n\n\n\n\n\n\n### Ausstieg\n\n\n\n\n:::{#exm-schoki}\n### Schoki macht Nobelpreis!?\n\n\n\n\n\nEine Studie fand eine starke Korrelation, $r=0.79$ \nzwischen der H√∂he des Schokoladenkonsums eines Landes und der Anzahl der Nobelpreise eines Landes \n[@messerli2012], s. @fig-schoki.\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![Je mehr Schoki, desto mehr Nobelpreise](img/correlation_550.png){#fig-schoki fig-align='center' width=50%}\n:::\n:::\n\n\n\n\n\n\n:::callout-important\nKorrelation ungleich Kausation! Korrelation *kann* bedeuten, dass eine Kausation vorliegt, aber es muss auch nicht sein, dass Kausation vorliegt.\nLiegt Korrelation ohne Kausation vor, so spricht man von einer *Scheinkorrelation*.\nUm Scheinkorrelation von echter Assoziation (auf Basis von Kausation) abzugrenzen,\nmuss man die Kausalmodelle √ºberpr√ºfen,\nso wie wir das hier tun.\n:::\n\n\n:::\n\n\n\n\n### Vertiefung\n\nEs gibt viel Literatur zu dem Thema Kausalinferenz. Ein Artikel, \nder einen vertieften Einblick in das Thema Konfundierung liefert \nz.B. @tennant2020 oder @suttorp2015.\nAllerdings sollte man neben Konfundierung noch die drei anderen \"Atome\" der Kausalinferenz - Kollision, \nMediation (und Nachfahre) - kennen, um g√§ngige Fragen der Kausalinferenz bearbeiten zu k√∂nnen.\n\n\n\n\n## Aufgaben\n\n\n- [Sammlung \"kausal\"](https://datenwerk.netlify.app/#category=causal)\n\n\n\n\n\n\n\n\n\n## ---\n\n\n\n![](img/outro-11.jpg){width=100%}\n\n\n\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}