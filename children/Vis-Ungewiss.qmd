### Visualisierung von Ungewissheit


::: {#def-punktschaetzer}

### Punktsch√§tzer

Gibt man nur einen Punktwert an, wie 42%, als Ergebnis einer Inferenz, spricht man von einem *Punktsch√§tzer*.


Punktsch√§tzer beinhalten *keine Angabe* der Sch√§tz(un)genauigkeit, s. Abb. @fig-ungewiss2, links. Rot markiert: Die Punktsch√§tzung von `mpg` f√ºr `hp=200`.

:::


<!-- ![Eine Punktsch√§tzung der Regressionsgeraden und die zugeh√∂rige Ungewissheit Ungewissheit](img/fig-punktschaetzer.png){#fig-punktschaetzer2} -->




```{r fig-punktschaetzer-ALT-DONT-RUN}
#| echo: false
#| message: false
#| eval: true

lm1_glm <- lm(mpg ~ hp, data = mtcars)

mtcars <-
  mtcars %>%
  mutate(pred = 30 - hp*0.07)


pred_interval <-
  tibble(
    hp = seq(min(mtcars$hp), max(mtcars$hp), by = 1),
    mpg = predict(lm1_glm, newdata = data.frame(hp)),
    lwr = mpg - 2*3,
    upr = mpg + 2*3
  )

plot1 <-
  ggplot(mtcars,
       aes(x = hp, y = mpg)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE) +
  annotate("point", x = 200,
           y = predict(lm1_glm, newdata = data.frame(hp = 200)),
           color = "red",
           alpha = .5,
           size = 5)


lm1_glm <- lm(mpg ~ hp, data = mtcars)

mtcars <-
  mtcars %>%
  mutate(pred = 30 - hp*0.07)


pred_interval <-
  tibble(
    hp = seq(min(mtcars$hp), max(mtcars$hp), by = 1),
    mpg = predict(lm1_glm, newdata = data.frame(hp)),
    lwr = mpg - 2*3,
    upr = mpg + 2*3
  )


plot2 <-
  ggplot(mtcars,
       aes(x = hp, y = mpg)) +
  geom_point() +
  geom_smooth(method = "lm", se = TRUE) +
  annotate("point", x = 200,
           y = predict(lm1_glm, newdata = data.frame(hp = 200)),
           color = "red",
           alpha = .5,
           size = 5)
```


```{r}
#| echo: false
lm1 <- lm(mpg ~ hp, data = mtcars)

p_ungewiss1 <-
  mtcars %>%
  ggplot(aes(x = hp, y = mpg)) +
  geom_point() +
  geom_smooth(method = "lm") +
  scale_y_continuous(limits = c(0,40)) +
  annotate("point", x = 200, y = predict(lm1, newdata = data.frame(hp=200)),
           color = "red", size = 5, alpha = .5)

```







In Abb. @fig-ungewiss2, links, ist die Ungewissheit in den *Regressionskoeffizienten* visualisiert:
Wie sicher sind wir uns bzgl. der Lage der Regressionskoeffizienten? Vgl. @def-punktschaetzer.



Auch wenn wir uns *sicher* w√§ren im Hinblick auf die Regressionsgewichte in Abb. @fig-ungewiss2, links,
bliebe Ungewissheit bei der Vorhersage des Bereichs plausibler Werte f√ºr individuelle Vorhersagen, s. @fig-ungewiss2, rechts.
Unsere Sch√§tzungen w√§ren auch dann nicht sicher, nicht fehlerfrei, wenn wir den genauen Verlauf der Regressiongerade sicher w√ºssten.
Das liegt daran, da das Modell nicht alle Einfl√ºsse auf Y ber√ºcksichtigt, sondern nur einen einzigen, hier als X bezeichnet.
Das Modell hat also keine perfekte Information, es ist ungewiss √ºber alle m√∂glichen Einflussfaktoren auf Y.
W√ºsste unser Modell alle Einflussfaktoren genau, so w√§re unser Vorhersageintervall sehr schmal (bzw. h√§tte null Breite).

In Abb. @fig-ungewiss2, rechts, ist nicht nur die Ungewissheit durch die Regressionsgewichte,
sondern auch die Ungewissheit zur Vorhersage der Y-Werte individueller Beobachtungen dargestellt.
In diesem Fall spricht man von einem "Vorhersageintervall",
da man nicht nur von "typischen F√§llen" auf der Regressiongeraden spricht,
sondern f√ºr echte F√§lle Vorhersagen (Sch√§tzungen) t√§tigt, wo auch die Ungewissheit der Modellg√ºte relevant ist.


<!-- ![Das Vorhersageintevall zeigt eine Punktsch√§tzung und ihre Ungewissheit](img/fig-predintervall.png){fig-ungewiss2 width="50%"} -->


```{r p-zweifach}
#| echo: false
#| fig-cap: Die zwei Arten der Ungewissheit visualisiert
#| label: fig-ungewiss2
#| message: false
#| layout-ncol: 2
#| eval: true
#| fig-subcap:
#|   - Eine Punktsch√§tzung der Regressionsgeraden und die zugeh√∂rige Ungewissheit der Koeffizienten
#|   - "Das Vorhersageintevall zur Regressionsgeraden zeigt die Ungewissheit f√ºr die jeweiligen Beobachtungen"


lm1_pred <- predict(lm1, interval = "prediction")

mtcars <-
  mtcars %>%
  mutate(upr = predict(lm1, interval = "prediction")[, 3],
         lwr = predict(lm1, interval = "prediction")[, 2])

p_ungewiss2 <- ggplot(mtcars) +
  aes(x = hp, y = mpg) +
  geom_point()+
  # geom_line(aes(x = hp, y = upr), linetype = "dashed") +
  geom_ribbon(aes(ymin = lwr, ymax = upr, x = hp), fill = "#56B4E9FF", alpha = .3) +
  geom_smooth(method = "lm", se = FALSE) +
  annotate("point", x = 200,
           y = predict(lm1, newdata = data.frame(hp = 200)),
           color = "#E69F00FF",
           alpha = .5,
           size = 5) +
  annotate("errorbar", x = 200, ymin = 8.5, ymax = 24.5, color = "#009E73FF", size = 2) +
  scale_y_continuous(limits = c(0,40))


p_ungewiss1
p_ungewiss2
```

@fig-ungewiss2 zeigt auch, dass f√ºr eine Beobachtung mit `hp=200` der *Punktsch√§tzer*
der gesch√§tzte Wert von `mpg` bei ca `16.5` liegt.
Das ist sozusagen unser *Best Guess*.
Weiterhin ist (in gr√ºn) das *Vorhersageintervall* f√ºr `hp=200` angezeigt.
F√ºr Beobachtungen mit `hp=200` liegt der Bereich plausibler `mpg`-Werte
in dem (gr√ºn) markierten Bereich (ca. 8 bis 25).

:::{#def-vorhersageintervall}
### Vorhersageintervall
Ein Vorhersageintervall zeigt den Bereich plausibler Werte (laut unserer Analyse)
f√ºr eine Beobachtung mit bestimmten Pr√§diktor-Werten.$\square$
:::



Wie man sieht, wird die Ungewissheit *gr√∂√üer*, wenn man beide Arten der Ungewissheit ber√ºcksichtigt.
Das Vorhersage-Intervall ber√ºcksichtigt Ungewissheit in erstens der Regressionsgerade, $\beta_0, \beta_1$, und in der Pr√§zision der Vorhersagen,  $\sigma$, bei der Vorhersage von $\hat{y_i}$.


:::{#exr-zweifache-ungewissheit}
üèã Geben Sie ein vergleichbares Beispiel an!
:::
